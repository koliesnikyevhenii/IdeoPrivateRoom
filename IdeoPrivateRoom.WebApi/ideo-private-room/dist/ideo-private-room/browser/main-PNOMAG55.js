import{$ as Bs,$a as Su,$b as Xt,$c as gg,A as fr,Aa as _u,Ab as De,Ac as $s,B as lf,Ba as Eu,Bb as ku,Bc as jn,C as yu,Ca as Fc,Cb as Mt,Cc as og,D as ut,Db as Qt,Dc as jc,E as df,Ea as Ef,Eb as Ot,Ec as Wc,F as uf,Fa as Sf,Fb as Bc,Fc as sg,G as Pc,Ga as zs,Gb as Lf,Gc,H as gr,Ha as _,Hb as Ff,Hc as ag,I as Hs,Ia as x,Ib as Ru,Ic as Yc,J as hf,Ja as Af,Jb as Du,K as Us,Ka as Hc,Kb as Hf,L as pf,La as Yt,Lb as Ks,M as un,Ma as If,Mb as Tr,N as uo,Na as po,Nb as Uf,O as Ze,Oa as Dt,Ob as Bf,P as mf,Pa as bf,Pb as Vf,Q as Ft,Qa as kf,Qb as Vc,Qc as xu,R as Qe,Ra as Rf,Rb as pn,Rc as cg,S as Z,Sa as $,Sb as zf,Sc as lg,T as ff,Ta as Df,Tb as Mu,Tc as dg,U as he,Ua as Mf,Ub as Kf,Uc as Qc,V as Ct,Va as Et,Vb as qf,Vc as ug,W as gf,Wa as S,Wb as Je,Wc as go,X as Xe,Xa as Kn,Xb as Ou,Xc as hg,Y as Cu,Ya as Ve,Yb as _r,Yc as pg,Z as se,Zb as tt,Zc as mg,_ as V,_a as hn,_b as $f,_c as fg,a as tf,aa as ue,ab as Au,ac as bn,ad as vg,b as nf,ba as wt,bb as C,bc as mn,bd as Xc,c as mr,ca as et,cb as w,cc as jf,cd as yg,d as mu,da as ho,db as G,dc as Wf,e as fu,ea as Nc,eb as Of,ec as qs,f as be,fa as vf,fb as Ce,fc as Jt,fd as Jc,g as yt,ga as yf,gb as L,gc as Gf,gd as Cg,h as Oc,ha as xc,hb as b,hd as Er,i as An,ia as zn,ib as Pe,ic as zc,id as wg,j as gu,ja as In,jb as B,jc as Yf,jd as vo,k as Be,ka as P,kb as Ht,kc as Ut,kd as Sr,l as Q,la as N,lb as yr,lc as Qf,ld as Ar,m as oi,ma as Vs,mb as Cr,mc as Xf,n as rf,na as Cf,nb as qn,nc as Pu,o as of,oa as Lc,ob as wr,oc as Jf,p as ne,pa as vr,pb as mo,pc as Zf,q as lo,qa as wf,qb as Ne,qc as eg,r as dt,ra as W,rb as st,rc as tg,s as sf,sa as ht,sb as $n,sc as ng,t as vu,ta as wu,tb as pt,tc as rg,u as Fs,ub as Uc,uc as ig,v as af,va as Tt,vb as Pf,vc as Kc,w as cf,wa as Tf,wb as Iu,wc as qc,x as ln,xa as Tu,xb as Nf,xc as Nu,y as qe,ya as _f,yb as xf,yc as fo,z as dn,za as si,zb as bu,zc as $c}from"./chunk-J6PIFLLY.js";import"./chunk-X6YHEMIY.js";import{a as g,b as U,c as Rt,d as cn,e as Ls,f}from"./chunk-ZY7WU73K.js";var Hu=class extends qf{constructor(){super(...arguments),this.supportsDOMEvents=!0}},Uu=class r extends Hu{static makeCurrent(){Kf(new r)}onAndCancel(e,t,n){return e.addEventListener(t,n),()=>{e.removeEventListener(t,n)}}dispatchEvent(e,t){e.dispatchEvent(t)}remove(e){e.remove()}createElement(e,t){return t=t||this.getDefaultDocument(),t.createElement(e)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(e){return e.nodeType===Node.ELEMENT_NODE}isShadowRoot(e){return e instanceof DocumentFragment}getGlobalEventTarget(e,t){return t==="window"?window:t==="document"?e:t==="body"?e.body:null}getBaseHref(e){let t=sT();return t==null?null:aT(t)}resetBaseElement(){js=null}getUserAgent(){return window.navigator.userAgent}getCookie(e){return $f(document.cookie,e)}},js=null;function sT(){return js=js||document.querySelector("base"),js?js.getAttribute("href"):null}function aT(r){return new URL(r,document.baseURI).pathname}var cT=(()=>{let e=class e{build(){return new XMLHttpRequest}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),Zc=new Xe(""),Eg=(()=>{let e=class e{constructor(n,i){this._zone=i,this._eventNameToPlugin=new Map,n.forEach(o=>{o.manager=this}),this._plugins=n.slice().reverse()}addEventListener(n,i,o){return this._findPluginFor(i).addEventListener(n,i,o)}getZone(){return this._zone}_findPluginFor(n){let i=this._eventNameToPlugin.get(n);if(i)return i;if(i=this._plugins.find(s=>s.supports(n)),!i)throw new Z(5101,!1);return this._eventNameToPlugin.set(n,i),i}};e.\u0275fac=function(i){return new(i||e)(se(Zc),se(ht))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),Ws=class{constructor(e){this._doc=e}},Lu="ng-app-id",Sg=(()=>{let e=class e{constructor(n,i,o,s={}){this.doc=n,this.appId=i,this.nonce=o,this.platformId=s,this.styleRef=new Map,this.hostNodes=new Set,this.styleNodesInDOM=this.collectServerRenderedStyles(),this.platformIsServer=Pu(s),this.resetHostNodes()}addStyles(n){for(let i of n)this.changeUsageCount(i,1)===1&&this.onStyleAdded(i)}removeStyles(n){for(let i of n)this.changeUsageCount(i,-1)<=0&&this.onStyleRemoved(i)}ngOnDestroy(){let n=this.styleNodesInDOM;n&&(n.forEach(i=>i.remove()),n.clear());for(let i of this.getAllStyles())this.onStyleRemoved(i);this.resetHostNodes()}addHost(n){this.hostNodes.add(n);for(let i of this.getAllStyles())this.addStyleToHost(n,i)}removeHost(n){this.hostNodes.delete(n)}getAllStyles(){return this.styleRef.keys()}onStyleAdded(n){for(let i of this.hostNodes)this.addStyleToHost(i,n)}onStyleRemoved(n){let i=this.styleRef;i.get(n)?.elements?.forEach(o=>o.remove()),i.delete(n)}collectServerRenderedStyles(){let n=this.doc.head?.querySelectorAll(`style[${Lu}="${this.appId}"]`);if(n?.length){let i=new Map;return n.forEach(o=>{o.textContent!=null&&i.set(o.textContent,o)}),i}return null}changeUsageCount(n,i){let o=this.styleRef;if(o.has(n)){let s=o.get(n);return s.usage+=i,s.usage}return o.set(n,{usage:i,elements:[]}),i}getStyleElement(n,i){let o=this.styleNodesInDOM,s=o?.get(i);if(s?.parentNode===n)return o.delete(i),s.removeAttribute(Lu),s;{let a=this.doc.createElement("style");return this.nonce&&a.setAttribute("nonce",this.nonce),a.textContent=i,this.platformIsServer&&a.setAttribute(Lu,this.appId),n.appendChild(a),a}}addStyleToHost(n,i){let o=this.getStyleElement(n,i),s=this.styleRef,a=s.get(i)?.elements;a?a.push(o):s.set(i,{elements:[o],usage:1})}resetHostNodes(){let n=this.hostNodes;n.clear(),n.add(this.doc.head)}};e.\u0275fac=function(i){return new(i||e)(se(Je),se(Tu),se(Eu,8),se(si))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),Fu={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},zu=/%COMP%/g,Ag="%COMP%",lT=`_nghost-${Ag}`,dT=`_ngcontent-${Ag}`,uT=!0,hT=new Xe("",{providedIn:"root",factory:()=>uT});function pT(r){return dT.replace(zu,r)}function mT(r){return lT.replace(zu,r)}function Ig(r,e){return e.map(t=>t.replace(zu,r))}var el=(()=>{let e=class e{constructor(n,i,o,s,a,c,l,d=null){this.eventManager=n,this.sharedStylesHost=i,this.appId=o,this.removeStylesOnCompDestroy=s,this.doc=a,this.platformId=c,this.ngZone=l,this.nonce=d,this.rendererByCompId=new Map,this.platformIsServer=Pu(c),this.defaultRenderer=new Gs(n,a,l,this.platformIsServer)}createRenderer(n,i){if(!n||!i)return this.defaultRenderer;this.platformIsServer&&i.encapsulation===Bs.ShadowDom&&(i=U(g({},i),{encapsulation:Bs.Emulated}));let o=this.getOrCreateRenderer(n,i);return o instanceof tl?o.applyToHost(n):o instanceof Ys&&o.applyStyles(),o}getOrCreateRenderer(n,i){let o=this.rendererByCompId,s=o.get(i.id);if(!s){let a=this.doc,c=this.ngZone,l=this.eventManager,d=this.sharedStylesHost,u=this.removeStylesOnCompDestroy,m=this.platformIsServer;switch(i.encapsulation){case Bs.Emulated:s=new tl(l,d,i,this.appId,u,a,c,m);break;case Bs.ShadowDom:return new Bu(l,d,n,i,a,c,this.nonce,m);default:s=new Ys(l,d,i,u,a,c,m);break}o.set(i.id,s)}return s}ngOnDestroy(){this.rendererByCompId.clear()}};e.\u0275fac=function(i){return new(i||e)(se(Eg),se(Sg),se(Tu),se(hT),se(Je),se(si),se(ht),se(Eu))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),Gs=class{constructor(e,t,n,i){this.eventManager=e,this.doc=t,this.ngZone=n,this.platformIsServer=i,this.data=Object.create(null),this.throwOnSyntheticProps=!0,this.destroyNode=null}destroy(){}createElement(e,t){return t?this.doc.createElementNS(Fu[t]||t,e):this.doc.createElement(e)}createComment(e){return this.doc.createComment(e)}createText(e){return this.doc.createTextNode(e)}appendChild(e,t){(Tg(e)?e.content:e).appendChild(t)}insertBefore(e,t,n){e&&(Tg(e)?e.content:e).insertBefore(t,n)}removeChild(e,t){t.remove()}selectRootElement(e,t){let n=typeof e=="string"?this.doc.querySelector(e):e;if(!n)throw new Z(-5104,!1);return t||(n.textContent=""),n}parentNode(e){return e.parentNode}nextSibling(e){return e.nextSibling}setAttribute(e,t,n,i){if(i){t=i+":"+t;let o=Fu[i];o?e.setAttributeNS(o,t,n):e.setAttribute(t,n)}else e.setAttribute(t,n)}removeAttribute(e,t,n){if(n){let i=Fu[n];i?e.removeAttributeNS(i,t):e.removeAttribute(`${n}:${t}`)}else e.removeAttribute(t)}addClass(e,t){e.classList.add(t)}removeClass(e,t){e.classList.remove(t)}setStyle(e,t,n,i){i&(zs.DashCase|zs.Important)?e.style.setProperty(t,n,i&zs.Important?"important":""):e.style[t]=n}removeStyle(e,t,n){n&zs.DashCase?e.style.removeProperty(t):e.style[t]=""}setProperty(e,t,n){e!=null&&(e[t]=n)}setValue(e,t){e.nodeValue=t}listen(e,t,n){if(typeof e=="string"&&(e=Mu().getGlobalEventTarget(this.doc,e),!e))throw new Error(`Unsupported event target ${e} for event ${t}`);return this.eventManager.addEventListener(e,t,this.decoratePreventDefault(n))}decoratePreventDefault(e){return t=>{if(t==="__ngUnwrap__")return e;(this.platformIsServer?this.ngZone.runGuarded(()=>e(t)):e(t))===!1&&t.preventDefault()}}};function Tg(r){return r.tagName==="TEMPLATE"&&r.content!==void 0}var Bu=class extends Gs{constructor(e,t,n,i,o,s,a,c){super(e,o,s,c),this.sharedStylesHost=t,this.hostEl=n,this.shadowRoot=n.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let l=Ig(i.id,i.styles);for(let d of l){let u=document.createElement("style");a&&u.setAttribute("nonce",a),u.textContent=d,this.shadowRoot.appendChild(u)}}nodeOrShadowRoot(e){return e===this.hostEl?this.shadowRoot:e}appendChild(e,t){return super.appendChild(this.nodeOrShadowRoot(e),t)}insertBefore(e,t,n){return super.insertBefore(this.nodeOrShadowRoot(e),t,n)}removeChild(e,t){return super.removeChild(null,t)}parentNode(e){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(e)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Ys=class extends Gs{constructor(e,t,n,i,o,s,a,c){super(e,o,s,a),this.sharedStylesHost=t,this.removeStylesOnCompDestroy=i,this.styles=c?Ig(c,n.styles):n.styles}applyStyles(){this.sharedStylesHost.addStyles(this.styles)}destroy(){this.removeStylesOnCompDestroy&&this.sharedStylesHost.removeStyles(this.styles)}},tl=class extends Ys{constructor(e,t,n,i,o,s,a,c){let l=i+"-"+n.id;super(e,t,n,o,s,a,c,l),this.contentAttr=pT(l),this.hostAttr=mT(l)}applyToHost(e){this.applyStyles(),this.setAttribute(e,this.hostAttr,"")}createElement(e,t){let n=super.createElement(e,t);return super.setAttribute(n,this.contentAttr,""),n}},fT=(()=>{let e=class e extends Ws{constructor(n){super(n)}supports(n){return!0}addEventListener(n,i,o){return n.addEventListener(i,o,!1),()=>this.removeEventListener(n,i,o)}removeEventListener(n,i,o){return n.removeEventListener(i,o)}};e.\u0275fac=function(i){return new(i||e)(se(Je))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),gT=(()=>{let e=class e extends Ws{constructor(n){super(n),this.delegate=V(Bf,{optional:!0})}supports(n){return this.delegate?this.delegate.supports(n):!1}addEventListener(n,i,o){return this.delegate.addEventListener(n,i,o)}removeEventListener(n,i,o){return this.delegate.removeEventListener(n,i,o)}};e.\u0275fac=function(i){return new(i||e)(se(Je))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),_g=["alt","control","meta","shift"],vT={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},yT={alt:r=>r.altKey,control:r=>r.ctrlKey,meta:r=>r.metaKey,shift:r=>r.shiftKey},CT=(()=>{let e=class e extends Ws{constructor(n){super(n)}supports(n){return e.parseEventName(n)!=null}addEventListener(n,i,o){let s=e.parseEventName(i),a=e.eventCallback(s.fullKey,o,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>Mu().onAndCancel(n,s.domEventName,a))}static parseEventName(n){let i=n.toLowerCase().split("."),o=i.shift();if(i.length===0||!(o==="keydown"||o==="keyup"))return null;let s=e._normalizeKey(i.pop()),a="",c=i.indexOf("code");if(c>-1&&(i.splice(c,1),a="code."),_g.forEach(d=>{let u=i.indexOf(d);u>-1&&(i.splice(u,1),a+=d+".")}),a+=s,i.length!=0||s.length===0)return null;let l={};return l.domEventName=o,l.fullKey=a,l}static matchEventFullKeyCode(n,i){let o=vT[n.key]||n.key,s="";return i.indexOf("code.")>-1&&(o=n.code,s="code."),o==null||!o?!1:(o=o.toLowerCase(),o===" "?o="space":o==="."&&(o="dot"),_g.forEach(a=>{if(a!==o){let c=yT[a];c(n)&&(s+=a+".")}}),s+=o,s===i)}static eventCallback(n,i,o){return s=>{e.matchEventFullKeyCode(s,n)&&o.runGuarded(()=>i(s))}}static _normalizeKey(n){return n==="esc"?"escape":n}};e.\u0275fac=function(i){return new(i||e)(se(Je))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})();function bg(r,e){return Uf(g({rootComponent:r},wT(e)))}function wT(r){return{appProviders:[...AT,...r?.providers??[]],platformProviders:ST}}function TT(){Uu.makeCurrent()}function _T(){return new wu}function ET(){return Tf(document),document}var ST=[{provide:si,useValue:Qf},{provide:_f,useValue:TT,multi:!0},{provide:Je,useFactory:ET,deps:[]}];var AT=[{provide:yf,useValue:"root"},{provide:wu,useFactory:_T,deps:[]},{provide:Zc,useClass:fT,multi:!0,deps:[Je,ht,si]},{provide:Zc,useClass:CT,multi:!0,deps:[Je]},{provide:Zc,useClass:gT,multi:!0},el,Sg,Eg,{provide:Hc,useExisting:el},{provide:Jf,useClass:cT,deps:[]},[]];var kg=(()=>{let e=class e{constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}};e.\u0275fac=function(i){return new(i||e)(se(Je))},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();var Vu=function(r){return r[r.NoHttpTransferCache=0]="NoHttpTransferCache",r[r.HttpTransferCacheOptions=1]="HttpTransferCacheOptions",r[r.I18nSupport=2]="I18nSupport",r[r.EventReplay=3]="EventReplay",r}(Vu||{});function Rg(...r){let e=[],t=new Set,n=t.has(Vu.HttpTransferCacheOptions);for(let{\u0275providers:i,\u0275kind:o}of r)t.add(o),i.length&&e.push(i);return Nc([[],Vf(),t.has(Vu.NoHttpTransferCache)||n?[]:ig({}),e])}var me="primary",ha=Symbol("RouteTitle"),Wu=class{constructor(e){this.params=e||{}}has(e){return Object.prototype.hasOwnProperty.call(this.params,e)}get(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t[0]:t}return null}getAll(e){if(this.has(e)){let t=this.params[e];return Array.isArray(t)?t:[t]}return[]}get keys(){return Object.keys(this.params)}};function Eo(r){return new Wu(r)}function bT(r,e,t){let n=t.path.split("/");if(n.length>r.length||t.pathMatch==="full"&&(e.hasChildren()||n.length<r.length))return null;let i={};for(let o=0;o<n.length;o++){let s=n[o],a=r[o];if(s[0]===":")i[s.substring(1)]=a;else if(s!==a.path)return null}return{consumed:r.slice(0,n.length),posParams:i}}function kT(r,e){if(r.length!==e.length)return!1;for(let t=0;t<r.length;++t)if(!kn(r[t],e[t]))return!1;return!0}function kn(r,e){let t=r?Gu(r):void 0,n=e?Gu(e):void 0;if(!t||!n||t.length!=n.length)return!1;let i;for(let o=0;o<t.length;o++)if(i=t[o],!Hg(r[i],e[i]))return!1;return!0}function Gu(r){return[...Object.keys(r),...Object.getOwnPropertySymbols(r)]}function Hg(r,e){if(Array.isArray(r)&&Array.isArray(e)){if(r.length!==e.length)return!1;let t=[...r].sort(),n=[...e].sort();return t.every((i,o)=>n[o]===i)}else return r===e}function Ug(r){return r.length>0?r[r.length-1]:null}function br(r){return rf(r)?r:Lf(r)?Be(Promise.resolve(r)):Q(r)}var RT={exact:Vg,subset:zg},Bg={exact:DT,subset:MT,ignored:()=>!0};function Dg(r,e,t){return RT[t.paths](r.root,e.root,t.matrixParams)&&Bg[t.queryParams](r.queryParams,e.queryParams)&&!(t.fragment==="exact"&&r.fragment!==e.fragment)}function DT(r,e){return kn(r,e)}function Vg(r,e,t){if(!ci(r.segments,e.segments)||!il(r.segments,e.segments,t)||r.numberOfChildren!==e.numberOfChildren)return!1;for(let n in e.children)if(!r.children[n]||!Vg(r.children[n],e.children[n],t))return!1;return!0}function MT(r,e){return Object.keys(e).length<=Object.keys(r).length&&Object.keys(e).every(t=>Hg(r[t],e[t]))}function zg(r,e,t){return Kg(r,e,e.segments,t)}function Kg(r,e,t,n){if(r.segments.length>t.length){let i=r.segments.slice(0,t.length);return!(!ci(i,t)||e.hasChildren()||!il(i,t,n))}else if(r.segments.length===t.length){if(!ci(r.segments,t)||!il(r.segments,t,n))return!1;for(let i in e.children)if(!r.children[i]||!zg(r.children[i],e.children[i],n))return!1;return!0}else{let i=t.slice(0,r.segments.length),o=t.slice(r.segments.length);return!ci(r.segments,i)||!il(r.segments,i,n)||!r.children[me]?!1:Kg(r.children[me],e,o,n)}}function il(r,e,t){return e.every((n,i)=>Bg[t](r[i].parameters,n.parameters))}var Gn=class{constructor(e=new Ee([],{}),t={},n=null){this.root=e,this.queryParams=t,this.fragment=n}get queryParamMap(){return this._queryParamMap??=Eo(this.queryParams),this._queryParamMap}toString(){return NT.serialize(this)}},Ee=class{constructor(e,t){this.segments=e,this.children=t,this.parent=null,Object.values(t).forEach(n=>n.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return ol(this)}},ai=class{constructor(e,t){this.path=e,this.parameters=t}get parameterMap(){return this._parameterMap??=Eo(this.parameters),this._parameterMap}toString(){return $g(this)}};function OT(r,e){return ci(r,e)&&r.every((t,n)=>kn(t.parameters,e[n].parameters))}function ci(r,e){return r.length!==e.length?!1:r.every((t,n)=>t.path===e[n].path)}function PT(r,e){let t=[];return Object.entries(r.children).forEach(([n,i])=>{n===me&&(t=t.concat(e(i,n)))}),Object.entries(r.children).forEach(([n,i])=>{n!==me&&(t=t.concat(e(i,n)))}),t}var wh=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:()=>new na,providedIn:"root"});let r=e;return r})(),na=class{parse(e){let t=new Qu(e);return new Gn(t.parseRootSegment(),t.parseQueryParams(),t.parseFragment())}serialize(e){let t=`/${Qs(e.root,!0)}`,n=FT(e.queryParams),i=typeof e.fragment=="string"?`#${xT(e.fragment)}`:"";return`${t}${n}${i}`}},NT=new na;function ol(r){return r.segments.map(e=>$g(e)).join("/")}function Qs(r,e){if(!r.hasChildren())return ol(r);if(e){let t=r.children[me]?Qs(r.children[me],!1):"",n=[];return Object.entries(r.children).forEach(([i,o])=>{i!==me&&n.push(`${i}:${Qs(o,!1)}`)}),n.length>0?`${t}(${n.join("//")})`:t}else{let t=PT(r,(n,i)=>i===me?[Qs(r.children[me],!1)]:[`${i}:${Qs(n,!1)}`]);return Object.keys(r.children).length===1&&r.children[me]!=null?`${ol(r)}/${t[0]}`:`${ol(r)}/(${t.join("//")})`}}function qg(r){return encodeURIComponent(r).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function nl(r){return qg(r).replace(/%3B/gi,";")}function xT(r){return encodeURI(r)}function Yu(r){return qg(r).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function sl(r){return decodeURIComponent(r)}function Mg(r){return sl(r.replace(/\+/g,"%20"))}function $g(r){return`${Yu(r.path)}${LT(r.parameters)}`}function LT(r){return Object.entries(r).map(([e,t])=>`;${Yu(e)}=${Yu(t)}`).join("")}function FT(r){let e=Object.entries(r).map(([t,n])=>Array.isArray(n)?n.map(i=>`${nl(t)}=${nl(i)}`).join("&"):`${nl(t)}=${nl(n)}`).filter(t=>t);return e.length?`?${e.join("&")}`:""}var HT=/^[^\/()?;#]+/;function Ku(r){let e=r.match(HT);return e?e[0]:""}var UT=/^[^\/()?;=#]+/;function BT(r){let e=r.match(UT);return e?e[0]:""}var VT=/^[^=?&#]+/;function zT(r){let e=r.match(VT);return e?e[0]:""}var KT=/^[^&#]+/;function qT(r){let e=r.match(KT);return e?e[0]:""}var Qu=class{constructor(e){this.url=e,this.remaining=e}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Ee([],{}):new Ee([],this.parseChildren())}parseQueryParams(){let e={};if(this.consumeOptional("?"))do this.parseQueryParam(e);while(this.consumeOptional("&"));return e}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let e=[];for(this.peekStartsWith("(")||e.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),e.push(this.parseSegment());let t={};this.peekStartsWith("/(")&&(this.capture("/"),t=this.parseParens(!0));let n={};return this.peekStartsWith("(")&&(n=this.parseParens(!1)),(e.length>0||Object.keys(t).length>0)&&(n[me]=new Ee(e,t)),n}parseSegment(){let e=Ku(this.remaining);if(e===""&&this.peekStartsWith(";"))throw new Z(4009,!1);return this.capture(e),new ai(sl(e),this.parseMatrixParams())}parseMatrixParams(){let e={};for(;this.consumeOptional(";");)this.parseParam(e);return e}parseParam(e){let t=BT(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let i=Ku(this.remaining);i&&(n=i,this.capture(n))}e[sl(t)]=sl(n)}parseQueryParam(e){let t=zT(this.remaining);if(!t)return;this.capture(t);let n="";if(this.consumeOptional("=")){let s=qT(this.remaining);s&&(n=s,this.capture(n))}let i=Mg(t),o=Mg(n);if(e.hasOwnProperty(i)){let s=e[i];Array.isArray(s)||(s=[s],e[i]=s),s.push(o)}else e[i]=o}parseParens(e){let t={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let n=Ku(this.remaining),i=this.remaining[n.length];if(i!=="/"&&i!==")"&&i!==";")throw new Z(4010,!1);let o;n.indexOf(":")>-1?(o=n.slice(0,n.indexOf(":")),this.capture(o),this.capture(":")):e&&(o=me);let s=this.parseChildren();t[o]=Object.keys(s).length===1?s[me]:new Ee([],s),this.consumeOptional("//")}return t}peekStartsWith(e){return this.remaining.startsWith(e)}consumeOptional(e){return this.peekStartsWith(e)?(this.remaining=this.remaining.substring(e.length),!0):!1}capture(e){if(!this.consumeOptional(e))throw new Z(4011,!1)}};function jg(r){return r.segments.length>0?new Ee([],{[me]:r}):r}function Wg(r){let e={};for(let[n,i]of Object.entries(r.children)){let o=Wg(i);if(n===me&&o.segments.length===0&&o.hasChildren())for(let[s,a]of Object.entries(o.children))e[s]=a;else(o.segments.length>0||o.hasChildren())&&(e[n]=o)}let t=new Ee(r.segments,e);return $T(t)}function $T(r){if(r.numberOfChildren===1&&r.children[me]){let e=r.children[me];return new Ee(r.segments.concat(e.segments),e.children)}return r}function li(r){return r instanceof Gn}function jT(r,e,t=null,n=null){let i=Gg(r);return Yg(i,e,t,n)}function Gg(r){let e;function t(o){let s={};for(let c of o.children){let l=t(c);s[c.outlet]=l}let a=new Ee(o.url,s);return o===r&&(e=a),a}let n=t(r.root),i=jg(n);return e??i}function Yg(r,e,t,n){let i=r;for(;i.parent;)i=i.parent;if(e.length===0)return qu(i,i,i,t,n);let o=WT(e);if(o.toRoot())return qu(i,i,new Ee([],{}),t,n);let s=GT(o,i,r),a=s.processChildren?Zs(s.segmentGroup,s.index,o.commands):Xg(s.segmentGroup,s.index,o.commands);return qu(i,s.segmentGroup,a,t,n)}function al(r){return typeof r=="object"&&r!=null&&!r.outlets&&!r.segmentPath}function ra(r){return typeof r=="object"&&r!=null&&r.outlets}function qu(r,e,t,n,i){let o={};n&&Object.entries(n).forEach(([c,l])=>{o[c]=Array.isArray(l)?l.map(d=>`${d}`):`${l}`});let s;r===e?s=t:s=Qg(r,e,t);let a=jg(Wg(s));return new Gn(a,o,i)}function Qg(r,e,t){let n={};return Object.entries(r.children).forEach(([i,o])=>{o===e?n[i]=t:n[i]=Qg(o,e,t)}),new Ee(r.segments,n)}var cl=class{constructor(e,t,n){if(this.isAbsolute=e,this.numberOfDoubleDots=t,this.commands=n,e&&n.length>0&&al(n[0]))throw new Z(4003,!1);let i=n.find(ra);if(i&&i!==Ug(n))throw new Z(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function WT(r){if(typeof r[0]=="string"&&r.length===1&&r[0]==="/")return new cl(!0,0,r);let e=0,t=!1,n=r.reduce((i,o,s)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let a={};return Object.entries(o.outlets).forEach(([c,l])=>{a[c]=typeof l=="string"?l.split("/"):l}),[...i,{outlets:a}]}if(o.segmentPath)return[...i,o.segmentPath]}return typeof o!="string"?[...i,o]:s===0?(o.split("/").forEach((a,c)=>{c==0&&a==="."||(c==0&&a===""?t=!0:a===".."?e++:a!=""&&i.push(a))}),i):[...i,o]},[]);return new cl(t,e,n)}var wo=class{constructor(e,t,n){this.segmentGroup=e,this.processChildren=t,this.index=n}};function GT(r,e,t){if(r.isAbsolute)return new wo(e,!0,0);if(!t)return new wo(e,!1,NaN);if(t.parent===null)return new wo(t,!0,0);let n=al(r.commands[0])?0:1,i=t.segments.length-1+n;return YT(t,i,r.numberOfDoubleDots)}function YT(r,e,t){let n=r,i=e,o=t;for(;o>i;){if(o-=i,n=n.parent,!n)throw new Z(4005,!1);i=n.segments.length}return new wo(n,!1,i-o)}function QT(r){return ra(r[0])?r[0].outlets:{[me]:r}}function Xg(r,e,t){if(r??=new Ee([],{}),r.segments.length===0&&r.hasChildren())return Zs(r,e,t);let n=XT(r,e,t),i=t.slice(n.commandIndex);if(n.match&&n.pathIndex<r.segments.length){let o=new Ee(r.segments.slice(0,n.pathIndex),{});return o.children[me]=new Ee(r.segments.slice(n.pathIndex),r.children),Zs(o,0,i)}else return n.match&&i.length===0?new Ee(r.segments,{}):n.match&&!r.hasChildren()?Xu(r,e,t):n.match?Zs(r,0,i):Xu(r,e,t)}function Zs(r,e,t){if(t.length===0)return new Ee(r.segments,{});{let n=QT(t),i={};if(Object.keys(n).some(o=>o!==me)&&r.children[me]&&r.numberOfChildren===1&&r.children[me].segments.length===0){let o=Zs(r.children[me],e,t);return new Ee(r.segments,o.children)}return Object.entries(n).forEach(([o,s])=>{typeof s=="string"&&(s=[s]),s!==null&&(i[o]=Xg(r.children[o],e,s))}),Object.entries(r.children).forEach(([o,s])=>{n[o]===void 0&&(i[o]=s)}),new Ee(r.segments,i)}}function XT(r,e,t){let n=0,i=e,o={match:!1,pathIndex:0,commandIndex:0};for(;i<r.segments.length;){if(n>=t.length)return o;let s=r.segments[i],a=t[n];if(ra(a))break;let c=`${a}`,l=n<t.length-1?t[n+1]:null;if(i>0&&c===void 0)break;if(c&&l&&typeof l=="object"&&l.outlets===void 0){if(!Pg(c,l,s))return o;n+=2}else{if(!Pg(c,{},s))return o;n++}i++}return{match:!0,pathIndex:i,commandIndex:n}}function Xu(r,e,t){let n=r.segments.slice(0,e),i=0;for(;i<t.length;){let o=t[i];if(ra(o)){let c=JT(o.outlets);return new Ee(n,c)}if(i===0&&al(t[0])){let c=r.segments[e];n.push(new ai(c.path,Og(t[0]))),i++;continue}let s=ra(o)?o.outlets[me]:`${o}`,a=i<t.length-1?t[i+1]:null;s&&a&&al(a)?(n.push(new ai(s,Og(a))),i+=2):(n.push(new ai(s,{})),i++)}return new Ee(n,{})}function JT(r){let e={};return Object.entries(r).forEach(([t,n])=>{typeof n=="string"&&(n=[n]),n!==null&&(e[t]=Xu(new Ee([],{}),0,n))}),e}function Og(r){let e={};return Object.entries(r).forEach(([t,n])=>e[t]=`${n}`),e}function Pg(r,e,t){return r==t.path&&kn(e,t.parameters)}var ea="imperative",mt=function(r){return r[r.NavigationStart=0]="NavigationStart",r[r.NavigationEnd=1]="NavigationEnd",r[r.NavigationCancel=2]="NavigationCancel",r[r.NavigationError=3]="NavigationError",r[r.RoutesRecognized=4]="RoutesRecognized",r[r.ResolveStart=5]="ResolveStart",r[r.ResolveEnd=6]="ResolveEnd",r[r.GuardsCheckStart=7]="GuardsCheckStart",r[r.GuardsCheckEnd=8]="GuardsCheckEnd",r[r.RouteConfigLoadStart=9]="RouteConfigLoadStart",r[r.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",r[r.ChildActivationStart=11]="ChildActivationStart",r[r.ChildActivationEnd=12]="ChildActivationEnd",r[r.ActivationStart=13]="ActivationStart",r[r.ActivationEnd=14]="ActivationEnd",r[r.Scroll=15]="Scroll",r[r.NavigationSkipped=16]="NavigationSkipped",r}(mt||{}),Zt=class{constructor(e,t){this.id=e,this.url=t}},ia=class extends Zt{constructor(e,t,n="imperative",i=null){super(e,t),this.type=mt.NavigationStart,this.navigationTrigger=n,this.restoredState=i}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ir=class extends Zt{constructor(e,t,n){super(e,t),this.urlAfterRedirects=n,this.type=mt.NavigationEnd}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},Vt=function(r){return r[r.Redirect=0]="Redirect",r[r.SupersededByNewNavigation=1]="SupersededByNewNavigation",r[r.NoDataFromResolver=2]="NoDataFromResolver",r[r.GuardRejected=3]="GuardRejected",r}(Vt||{}),Ju=function(r){return r[r.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",r[r.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",r}(Ju||{}),Wn=class extends Zt{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=mt.NavigationCancel}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},di=class extends Zt{constructor(e,t,n,i){super(e,t),this.reason=n,this.code=i,this.type=mt.NavigationSkipped}},oa=class extends Zt{constructor(e,t,n,i){super(e,t),this.error=n,this.target=i,this.type=mt.NavigationError}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},ll=class extends Zt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=mt.RoutesRecognized}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Zu=class extends Zt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=mt.GuardsCheckStart}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},eh=class extends Zt{constructor(e,t,n,i,o){super(e,t),this.urlAfterRedirects=n,this.state=i,this.shouldActivate=o,this.type=mt.GuardsCheckEnd}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},th=class extends Zt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=mt.ResolveStart}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},nh=class extends Zt{constructor(e,t,n,i){super(e,t),this.urlAfterRedirects=n,this.state=i,this.type=mt.ResolveEnd}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},rh=class{constructor(e){this.route=e,this.type=mt.RouteConfigLoadStart}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ih=class{constructor(e){this.route=e,this.type=mt.RouteConfigLoadEnd}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},oh=class{constructor(e){this.snapshot=e,this.type=mt.ChildActivationStart}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},sh=class{constructor(e){this.snapshot=e,this.type=mt.ChildActivationEnd}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ah=class{constructor(e){this.snapshot=e,this.type=mt.ActivationStart}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ch=class{constructor(e){this.snapshot=e,this.type=mt.ActivationEnd}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var sa=class{},So=class{constructor(e,t){this.url=e,this.navigationBehaviorOptions=t}};function ZT(r,e){return r.providers&&!r._injector&&(r._injector=Rf(r.providers,e,`Route: ${r.path}`)),r._injector??e}function fn(r){return r.outlet||me}function e_(r,e){let t=r.filter(n=>fn(n)===e);return t.push(...r.filter(n=>fn(n)!==e)),t}function pa(r){if(!r)return null;if(r.routeConfig?._injector)return r.routeConfig._injector;for(let e=r.parent;e;e=e.parent){let t=e.routeConfig;if(t?._loadedInjector)return t._loadedInjector;if(t?._injector)return t._injector}return null}var lh=class{get injector(){return pa(this.route?.snapshot)??this.rootInjector}set injector(e){}constructor(e){this.rootInjector=e,this.outlet=null,this.route=null,this.children=new gl(this.rootInjector),this.attachRef=null}},gl=(()=>{let e=class e{constructor(n){this.rootInjector=n,this.contexts=new Map}onChildOutletCreated(n,i){let o=this.getOrCreateContext(n);o.outlet=i,this.contexts.set(n,o)}onChildOutletDestroyed(n){let i=this.getContext(n);i&&(i.outlet=null,i.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let i=this.getContext(n);return i||(i=new lh(this.rootInjector),this.contexts.set(n,i)),i}getContext(n){return this.contexts.get(n)||null}};e.\u0275fac=function(i){return new(i||e)(se(xc))},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),dl=class{constructor(e){this._root=e}get root(){return this._root.value}parent(e){let t=this.pathFromRoot(e);return t.length>1?t[t.length-2]:null}children(e){let t=dh(e,this._root);return t?t.children.map(n=>n.value):[]}firstChild(e){let t=dh(e,this._root);return t&&t.children.length>0?t.children[0].value:null}siblings(e){let t=uh(e,this._root);return t.length<2?[]:t[t.length-2].children.map(i=>i.value).filter(i=>i!==e)}pathFromRoot(e){return uh(e,this._root).map(t=>t.value)}};function dh(r,e){if(r===e.value)return e;for(let t of e.children){let n=dh(r,t);if(n)return n}return null}function uh(r,e){if(r===e.value)return[e];for(let t of e.children){let n=uh(r,t);if(n.length)return n.unshift(e),n}return[]}var Bt=class{constructor(e,t){this.value=e,this.children=t}toString(){return`TreeNode(${this.value})`}};function Co(r){let e={};return r&&r.children.forEach(t=>e[t.value.outlet]=t),e}var ul=class extends dl{constructor(e,t){super(e),this.snapshot=t,Th(this,e)}toString(){return this.snapshot.toString()}};function Jg(r){let e=t_(r),t=new yt([new ai("",{})]),n=new yt({}),i=new yt({}),o=new yt({}),s=new yt(""),a=new ui(t,n,o,s,i,me,r,e.root);return a.snapshot=e.root,new ul(new Bt(a,[]),e)}function t_(r){let e={},t={},n={},i="",o=new To([],e,n,i,t,me,r,null,{});return new pl("",new Bt(o,[]))}var ui=class{constructor(e,t,n,i,o,s,a,c){this.urlSubject=e,this.paramsSubject=t,this.queryParamsSubject=n,this.fragmentSubject=i,this.dataSubject=o,this.outlet=s,this.component=a,this._futureSnapshot=c,this.title=this.dataSubject?.pipe(ne(l=>l[ha]))??Q(void 0),this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(ne(e=>Eo(e))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(ne(e=>Eo(e))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function hl(r,e,t="emptyOnly"){let n,{routeConfig:i}=r;return e!==null&&(t==="always"||i?.path===""||!e.component&&!e.routeConfig?.loadComponent)?n={params:g(g({},e.params),r.params),data:g(g({},e.data),r.data),resolve:g(g(g(g({},r.data),e.data),i?.data),r._resolvedData)}:n={params:g({},r.params),data:g({},r.data),resolve:g(g({},r.data),r._resolvedData??{})},i&&ev(i)&&(n.resolve[ha]=i.title),n}var To=class{get title(){return this.data?.[ha]}constructor(e,t,n,i,o,s,a,c,l){this.url=e,this.params=t,this.queryParams=n,this.fragment=i,this.data=o,this.outlet=s,this.component=a,this.routeConfig=c,this._resolve=l}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=Eo(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=Eo(this.queryParams),this._queryParamMap}toString(){let e=this.url.map(n=>n.toString()).join("/"),t=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${e}', path:'${t}')`}},pl=class extends dl{constructor(e,t){super(t),this.url=e,Th(this,t)}toString(){return Zg(this._root)}};function Th(r,e){e.value._routerState=r,e.children.forEach(t=>Th(r,t))}function Zg(r){let e=r.children.length>0?` { ${r.children.map(Zg).join(", ")} } `:"";return`${r.value}${e}`}function $u(r){if(r.snapshot){let e=r.snapshot,t=r._futureSnapshot;r.snapshot=t,kn(e.queryParams,t.queryParams)||r.queryParamsSubject.next(t.queryParams),e.fragment!==t.fragment&&r.fragmentSubject.next(t.fragment),kn(e.params,t.params)||r.paramsSubject.next(t.params),kT(e.url,t.url)||r.urlSubject.next(t.url),kn(e.data,t.data)||r.dataSubject.next(t.data)}else r.snapshot=r._futureSnapshot,r.dataSubject.next(r._futureSnapshot.data)}function hh(r,e){let t=kn(r.params,e.params)&&OT(r.url,e.url),n=!r.parent!=!e.parent;return t&&!n&&(!r.parent||hh(r.parent,e.parent))}function ev(r){return typeof r.title=="string"||r.title===null}var _h=(()=>{let e=class e{constructor(){this.activated=null,this._activatedRoute=null,this.name=me,this.activateEvents=new W,this.deactivateEvents=new W,this.attachEvents=new W,this.detachEvents=new W,this.parentContexts=V(gl),this.location=V(po),this.changeDetector=V(Tr),this.inputBinder=V(vl,{optional:!0}),this.supportsBindingToComponentInputs=!0}get activatedComponentRef(){return this.activated}ngOnChanges(n){if(n.name){let{firstChange:i,previousValue:o}=n.name;if(i)return;this.isTrackedInParentContexts(o)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(o)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new Z(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new Z(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new Z(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,i){this.activated=n,this._activatedRoute=i,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,i){if(this.isActivated)throw new Z(4013,!1);this._activatedRoute=n;let o=this.location,a=n.snapshot.component,c=this.parentContexts.getOrCreateContext(this.name).children,l=new ph(n,c,o.injector);this.activated=o.createComponent(a,{index:o.length,injector:l,environmentInjector:i}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275dir=et({type:e,selectors:[["router-outlet"]],inputs:{name:"name"},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],standalone:!0,features:[In]});let r=e;return r})(),ph=class r{__ngOutletInjector(e){return new r(this.route,this.childContexts,e)}constructor(e,t,n){this.route=e,this.childContexts=t,this.parent=n}get(e,t){return e===ui?this.route:e===gl?this.childContexts:this.parent.get(e,t)}},vl=new Xe(""),Ng=(()=>{let e=class e{constructor(){this.outletDataSubscriptions=new Map}bindActivatedRouteToOutletComponent(n){this.unsubscribeFromRouteData(n),this.subscribeToRouteData(n)}unsubscribeFromRouteData(n){this.outletDataSubscriptions.get(n)?.unsubscribe(),this.outletDataSubscriptions.delete(n)}subscribeToRouteData(n){let{activatedRoute:i}=n,o=lo([i.queryParams,i.params,i.data]).pipe(Ze(([s,a,c],l)=>(c=g(g(g({},s),a),c),l===0?Q(c):Promise.resolve(c)))).subscribe(s=>{if(!n.isActivated||!n.activatedComponentRef||n.activatedRoute!==i||i.component===null){this.unsubscribeFromRouteData(n);return}let a=zf(i.component);if(!a){this.unsubscribeFromRouteData(n);return}for(let{templateName:c}of a.inputs)n.activatedComponentRef.setInput(c,s[c])});this.outletDataSubscriptions.set(n,o)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})();function n_(r,e,t){let n=aa(r,e._root,t?t._root:void 0);return new ul(n,e)}function aa(r,e,t){if(t&&r.shouldReuseRoute(e.value,t.value.snapshot)){let n=t.value;n._futureSnapshot=e.value;let i=r_(r,e,t);return new Bt(n,i)}else{if(r.shouldAttach(e.value)){let o=r.retrieve(e.value);if(o!==null){let s=o.route;return s.value._futureSnapshot=e.value,s.children=e.children.map(a=>aa(r,a)),s}}let n=i_(e.value),i=e.children.map(o=>aa(r,o));return new Bt(n,i)}}function r_(r,e,t){return e.children.map(n=>{for(let i of t.children)if(r.shouldReuseRoute(n.value,i.value.snapshot))return aa(r,n,i);return aa(r,n)})}function i_(r){return new ui(new yt(r.url),new yt(r.params),new yt(r.queryParams),new yt(r.fragment),new yt(r.data),r.outlet,r.component,r)}var ca=class{constructor(e,t){this.redirectTo=e,this.navigationBehaviorOptions=t}},tv="ngNavigationCancelingError";function ml(r,e){let{redirectTo:t,navigationBehaviorOptions:n}=li(e)?{redirectTo:e,navigationBehaviorOptions:void 0}:e,i=nv(!1,Vt.Redirect);return i.url=t,i.navigationBehaviorOptions=n,i}function nv(r,e){let t=new Error(`NavigationCancelingError: ${r||""}`);return t[tv]=!0,t.cancellationCode=e,t}function o_(r){return rv(r)&&li(r.url)}function rv(r){return!!r&&r[tv]}var s_=(r,e,t,n)=>ne(i=>(new mh(e,i.targetRouterState,i.currentRouterState,t,n).activate(r),i)),mh=class{constructor(e,t,n,i,o){this.routeReuseStrategy=e,this.futureState=t,this.currState=n,this.forwardEvent=i,this.inputBindingEnabled=o}activate(e){let t=this.futureState._root,n=this.currState?this.currState._root:null;this.deactivateChildRoutes(t,n,e),$u(this.futureState.root),this.activateChildRoutes(t,n,e)}deactivateChildRoutes(e,t,n){let i=Co(t);e.children.forEach(o=>{let s=o.value.outlet;this.deactivateRoutes(o,i[s],n),delete i[s]}),Object.values(i).forEach(o=>{this.deactivateRouteAndItsChildren(o,n)})}deactivateRoutes(e,t,n){let i=e.value,o=t?t.value:null;if(i===o)if(i.component){let s=n.getContext(i.outlet);s&&this.deactivateChildRoutes(e,t,s.children)}else this.deactivateChildRoutes(e,t,n);else o&&this.deactivateRouteAndItsChildren(t,n)}deactivateRouteAndItsChildren(e,t){e.value.component&&this.routeReuseStrategy.shouldDetach(e.value.snapshot)?this.detachAndStoreRouteSubtree(e,t):this.deactivateRouteAndOutlet(e,t)}detachAndStoreRouteSubtree(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=Co(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);if(n&&n.outlet){let s=n.outlet.detach(),a=n.children.onOutletDeactivated();this.routeReuseStrategy.store(e.value.snapshot,{componentRef:s,route:e,contexts:a})}}deactivateRouteAndOutlet(e,t){let n=t.getContext(e.value.outlet),i=n&&e.value.component?n.children:t,o=Co(e);for(let s of Object.values(o))this.deactivateRouteAndItsChildren(s,i);n&&(n.outlet&&(n.outlet.deactivate(),n.children.onOutletDeactivated()),n.attachRef=null,n.route=null)}activateChildRoutes(e,t,n){let i=Co(t);e.children.forEach(o=>{this.activateRoutes(o,i[o.value.outlet],n),this.forwardEvent(new ch(o.value.snapshot))}),e.children.length&&this.forwardEvent(new sh(e.value.snapshot))}activateRoutes(e,t,n){let i=e.value,o=t?t.value:null;if($u(i),i===o)if(i.component){let s=n.getOrCreateContext(i.outlet);this.activateChildRoutes(e,t,s.children)}else this.activateChildRoutes(e,t,n);else if(i.component){let s=n.getOrCreateContext(i.outlet);if(this.routeReuseStrategy.shouldAttach(i.snapshot)){let a=this.routeReuseStrategy.retrieve(i.snapshot);this.routeReuseStrategy.store(i.snapshot,null),s.children.onOutletReAttached(a.contexts),s.attachRef=a.componentRef,s.route=a.route.value,s.outlet&&s.outlet.attach(a.componentRef,a.route.value),$u(a.route.value),this.activateChildRoutes(e,null,s.children)}else s.attachRef=null,s.route=i,s.outlet&&s.outlet.activateWith(i,s.injector),this.activateChildRoutes(e,null,s.children)}else this.activateChildRoutes(e,null,n)}},fl=class{constructor(e){this.path=e,this.route=this.path[this.path.length-1]}},_o=class{constructor(e,t){this.component=e,this.route=t}};function a_(r,e,t){let n=r._root,i=e?e._root:null;return Xs(n,i,t,[n.value])}function c_(r){let e=r.routeConfig?r.routeConfig.canActivateChild:null;return!e||e.length===0?null:{node:r,guards:e}}function Io(r,e){let t=Symbol(),n=e.get(r,t);return n===t?typeof r=="function"&&!gf(r)?r:e.get(r):n}function Xs(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=Co(e);return r.children.forEach(s=>{l_(s,o[s.value.outlet],t,n.concat([s.value]),i),delete o[s.value.outlet]}),Object.entries(o).forEach(([s,a])=>ta(a,t.getContext(s),i)),i}function l_(r,e,t,n,i={canDeactivateChecks:[],canActivateChecks:[]}){let o=r.value,s=e?e.value:null,a=t?t.getContext(r.value.outlet):null;if(s&&o.routeConfig===s.routeConfig){let c=d_(s,o,o.routeConfig.runGuardsAndResolvers);c?i.canActivateChecks.push(new fl(n)):(o.data=s.data,o._resolvedData=s._resolvedData),o.component?Xs(r,e,a?a.children:null,n,i):Xs(r,e,t,n,i),c&&a&&a.outlet&&a.outlet.isActivated&&i.canDeactivateChecks.push(new _o(a.outlet.component,s))}else s&&ta(e,a,i),i.canActivateChecks.push(new fl(n)),o.component?Xs(r,null,a?a.children:null,n,i):Xs(r,null,t,n,i);return i}function d_(r,e,t){if(typeof t=="function")return t(r,e);switch(t){case"pathParamsChange":return!ci(r.url,e.url);case"pathParamsOrQueryParamsChange":return!ci(r.url,e.url)||!kn(r.queryParams,e.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!hh(r,e)||!kn(r.queryParams,e.queryParams);case"paramsChange":default:return!hh(r,e)}}function ta(r,e,t){let n=Co(r),i=r.value;Object.entries(n).forEach(([o,s])=>{i.component?e?ta(s,e.children.getContext(o),t):ta(s,null,t):ta(s,e,t)}),i.component?e&&e.outlet&&e.outlet.isActivated?t.canDeactivateChecks.push(new _o(e.outlet.component,i)):t.canDeactivateChecks.push(new _o(null,i)):t.canDeactivateChecks.push(new _o(null,i))}function ma(r){return typeof r=="function"}function u_(r){return typeof r=="boolean"}function h_(r){return r&&ma(r.canLoad)}function p_(r){return r&&ma(r.canActivate)}function m_(r){return r&&ma(r.canActivateChild)}function f_(r){return r&&ma(r.canDeactivate)}function g_(r){return r&&ma(r.canMatch)}function iv(r){return r instanceof of||r?.name==="EmptyError"}var rl=Symbol("INITIAL_VALUE");function Ao(){return Ze(r=>lo(r.map(e=>e.pipe(ut(1),uo(rl)))).pipe(ne(e=>{for(let t of e)if(t!==!0){if(t===rl)return rl;if(t===!1||v_(t))return t}return!0}),qe(e=>e!==rl),ut(1)))}function v_(r){return li(r)||r instanceof ca}function y_(r,e){return dt(t=>{let{targetSnapshot:n,currentSnapshot:i,guards:{canActivateChecks:o,canDeactivateChecks:s}}=t;return s.length===0&&o.length===0?Q(U(g({},t),{guardsResult:!0})):C_(s,n,i,r).pipe(dt(a=>a&&u_(a)?w_(n,o,r,e):Q(a)),ne(a=>U(g({},t),{guardsResult:a})))})}function C_(r,e,t,n){return Be(r).pipe(dt(i=>A_(i.component,i.route,t,e,n)),gr(i=>i!==!0,!0))}function w_(r,e,t,n){return Be(e).pipe(fr(i=>sf(__(i.route.parent,n),T_(i.route,n),S_(r,i.path,t),E_(r,i.route,t))),gr(i=>i!==!0,!0))}function T_(r,e){return r!==null&&e&&e(new ah(r)),Q(!0)}function __(r,e){return r!==null&&e&&e(new oh(r)),Q(!0)}function E_(r,e,t){let n=e.routeConfig?e.routeConfig.canActivate:null;if(!n||n.length===0)return Q(!0);let i=n.map(o=>vu(()=>{let s=pa(e)??t,a=Io(o,s),c=p_(a)?a.canActivate(e,r):zn(s,()=>a(e,r));return br(c).pipe(gr())}));return Q(i).pipe(Ao())}function S_(r,e,t){let n=e[e.length-1],o=e.slice(0,e.length-1).reverse().map(s=>c_(s)).filter(s=>s!==null).map(s=>vu(()=>{let a=s.guards.map(c=>{let l=pa(s.node)??t,d=Io(c,l),u=m_(d)?d.canActivateChild(n,r):zn(l,()=>d(n,r));return br(u).pipe(gr())});return Q(a).pipe(Ao())}));return Q(o).pipe(Ao())}function A_(r,e,t,n,i){let o=e&&e.routeConfig?e.routeConfig.canDeactivate:null;if(!o||o.length===0)return Q(!0);let s=o.map(a=>{let c=pa(e)??i,l=Io(a,c),d=f_(l)?l.canDeactivate(r,e,t,n):zn(c,()=>l(r,e,t,n));return br(d).pipe(gr())});return Q(s).pipe(Ao())}function I_(r,e,t,n){let i=e.canLoad;if(i===void 0||i.length===0)return Q(!0);let o=i.map(s=>{let a=Io(s,r),c=h_(a)?a.canLoad(e,t):zn(r,()=>a(e,t));return br(c)});return Q(o).pipe(Ao(),ov(n))}function ov(r){return nf(Qe(e=>{if(typeof e!="boolean")throw ml(r,e)}),ne(e=>e===!0))}function b_(r,e,t,n){let i=e.canMatch;if(!i||i.length===0)return Q(!0);let o=i.map(s=>{let a=Io(s,r),c=g_(a)?a.canMatch(e,t):zn(r,()=>a(e,t));return br(c)});return Q(o).pipe(Ao(),ov(n))}var la=class{constructor(e){this.segmentGroup=e||null}},da=class extends Error{constructor(e){super(),this.urlTree=e}};function yo(r){return oi(new la(r))}function k_(r){return oi(new Z(4e3,!1))}function R_(r){return oi(nv(!1,Vt.GuardRejected))}var fh=class{constructor(e,t){this.urlSerializer=e,this.urlTree=t}lineralizeSegments(e,t){let n=[],i=t.root;for(;;){if(n=n.concat(i.segments),i.numberOfChildren===0)return Q(n);if(i.numberOfChildren>1||!i.children[me])return k_(`${e.redirectTo}`);i=i.children[me]}}applyRedirectCommands(e,t,n,i,o){if(typeof t!="string"){let a=t,{queryParams:c,fragment:l,routeConfig:d,url:u,outlet:m,params:p,data:v,title:T}=i,I=zn(o,()=>a({params:p,data:v,queryParams:c,fragment:l,routeConfig:d,url:u,outlet:m,title:T}));if(I instanceof Gn)throw new da(I);t=I}let s=this.applyRedirectCreateUrlTree(t,this.urlSerializer.parse(t),e,n);if(t[0]==="/")throw new da(s);return s}applyRedirectCreateUrlTree(e,t,n,i){let o=this.createSegmentGroup(e,t.root,n,i);return new Gn(o,this.createQueryParams(t.queryParams,this.urlTree.queryParams),t.fragment)}createQueryParams(e,t){let n={};return Object.entries(e).forEach(([i,o])=>{if(typeof o=="string"&&o[0]===":"){let a=o.substring(1);n[i]=t[a]}else n[i]=o}),n}createSegmentGroup(e,t,n,i){let o=this.createSegments(e,t.segments,n,i),s={};return Object.entries(t.children).forEach(([a,c])=>{s[a]=this.createSegmentGroup(e,c,n,i)}),new Ee(o,s)}createSegments(e,t,n,i){return t.map(o=>o.path[0]===":"?this.findPosParam(e,o,i):this.findOrReturn(o,n))}findPosParam(e,t,n){let i=n[t.path.substring(1)];if(!i)throw new Z(4001,!1);return i}findOrReturn(e,t){let n=0;for(let i of t){if(i.path===e.path)return t.splice(n),i;n++}return e}},gh={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function D_(r,e,t,n,i){let o=Eh(r,e,t);return o.matched?(n=ZT(e,n),b_(n,e,t,i).pipe(ne(s=>s===!0?o:g({},gh)))):Q(o)}function Eh(r,e,t){if(e.path==="**")return M_(t);if(e.path==="")return e.pathMatch==="full"&&(r.hasChildren()||t.length>0)?g({},gh):{matched:!0,consumedSegments:[],remainingSegments:t,parameters:{},positionalParamSegments:{}};let i=(e.matcher||bT)(t,r,e);if(!i)return g({},gh);let o={};Object.entries(i.posParams??{}).forEach(([a,c])=>{o[a]=c.path});let s=i.consumed.length>0?g(g({},o),i.consumed[i.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:i.consumed,remainingSegments:t.slice(i.consumed.length),parameters:s,positionalParamSegments:i.posParams??{}}}function M_(r){return{matched:!0,parameters:r.length>0?Ug(r).parameters:{},consumedSegments:r,remainingSegments:[],positionalParamSegments:{}}}function xg(r,e,t,n){return t.length>0&&N_(r,t,n)?{segmentGroup:new Ee(e,P_(n,new Ee(t,r.children))),slicedSegments:[]}:t.length===0&&x_(r,t,n)?{segmentGroup:new Ee(r.segments,O_(r,t,n,r.children)),slicedSegments:t}:{segmentGroup:new Ee(r.segments,r.children),slicedSegments:t}}function O_(r,e,t,n){let i={};for(let o of t)if(yl(r,e,o)&&!n[fn(o)]){let s=new Ee([],{});i[fn(o)]=s}return g(g({},n),i)}function P_(r,e){let t={};t[me]=e;for(let n of r)if(n.path===""&&fn(n)!==me){let i=new Ee([],{});t[fn(n)]=i}return t}function N_(r,e,t){return t.some(n=>yl(r,e,n)&&fn(n)!==me)}function x_(r,e,t){return t.some(n=>yl(r,e,n))}function yl(r,e,t){return(r.hasChildren()||e.length>0)&&t.pathMatch==="full"?!1:t.path===""}function L_(r,e,t,n){return fn(r)!==n&&(n===me||!yl(e,t,r))?!1:Eh(e,r,t).matched}function F_(r,e,t){return e.length===0&&!r.children[t]}var vh=class{};function H_(r,e,t,n,i,o,s="emptyOnly"){return new yh(r,e,t,n,i,s,o).recognize()}var U_=31,yh=class{constructor(e,t,n,i,o,s,a){this.injector=e,this.configLoader=t,this.rootComponentType=n,this.config=i,this.urlTree=o,this.paramsInheritanceStrategy=s,this.urlSerializer=a,this.applyRedirects=new fh(this.urlSerializer,this.urlTree),this.absoluteRedirectCount=0,this.allowRedirects=!0}noMatchError(e){return new Z(4002,`'${e.segmentGroup}'`)}recognize(){let e=xg(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(e).pipe(ne(({children:t,rootSnapshot:n})=>{let i=new Bt(n,t),o=new pl("",i),s=jT(n,[],this.urlTree.queryParams,this.urlTree.fragment);return s.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(s),{state:o,tree:s}}))}match(e){let t=new To([],Object.freeze({}),Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),me,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,e,me,t).pipe(ne(n=>({children:n,rootSnapshot:t})),dn(n=>{if(n instanceof da)return this.urlTree=n.urlTree,this.match(n.urlTree.root);throw n instanceof la?this.noMatchError(n):n}))}processSegmentGroup(e,t,n,i,o){return n.segments.length===0&&n.hasChildren()?this.processChildren(e,t,n,o):this.processSegment(e,t,n,n.segments,i,!0,o).pipe(ne(s=>s instanceof Bt?[s]:[]))}processChildren(e,t,n,i){let o=[];for(let s of Object.keys(n.children))s==="primary"?o.unshift(s):o.push(s);return Be(o).pipe(fr(s=>{let a=n.children[s],c=e_(t,s);return this.processSegmentGroup(e,c,a,s,i)}),pf((s,a)=>(s.push(...a),s)),yu(null),hf(),dt(s=>{if(s===null)return yo(n);let a=sv(s);return B_(a),Q(a)}))}processSegment(e,t,n,i,o,s,a){return Be(t).pipe(fr(c=>this.processSegmentAgainstRoute(c._injector??e,t,c,n,i,o,s,a).pipe(dn(l=>{if(l instanceof la)return Q(null);throw l}))),gr(c=>!!c),dn(c=>{if(iv(c))return F_(n,i,o)?Q(new vh):yo(n);throw c}))}processSegmentAgainstRoute(e,t,n,i,o,s,a,c){return L_(n,i,o,s)?n.redirectTo===void 0?this.matchSegmentAgainstRoute(e,i,n,o,s,c):this.allowRedirects&&a?this.expandSegmentAgainstRouteUsingRedirect(e,i,t,n,o,s,c):yo(i):yo(i)}expandSegmentAgainstRouteUsingRedirect(e,t,n,i,o,s,a){let{matched:c,parameters:l,consumedSegments:d,positionalParamSegments:u,remainingSegments:m}=Eh(t,i,o);if(!c)return yo(t);typeof i.redirectTo=="string"&&i.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>U_&&(this.allowRedirects=!1));let p=new To(o,l,Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,Lg(i),fn(i),i.component??i._loadedComponent??null,i,Fg(i)),v=hl(p,a,this.paramsInheritanceStrategy);p.params=Object.freeze(v.params),p.data=Object.freeze(v.data);let T=this.applyRedirects.applyRedirectCommands(d,i.redirectTo,u,p,e);return this.applyRedirects.lineralizeSegments(i,T).pipe(dt(I=>this.processSegment(e,n,t,I.concat(m),s,!1,a)))}matchSegmentAgainstRoute(e,t,n,i,o,s){let a=D_(t,n,i,e,this.urlSerializer);return n.path==="**"&&(t.children={}),a.pipe(Ze(c=>c.matched?(e=n._injector??e,this.getChildConfig(e,n,i).pipe(Ze(({routes:l})=>{let d=n._loadedInjector??e,{parameters:u,consumedSegments:m,remainingSegments:p}=c,v=new To(m,u,Object.freeze(g({},this.urlTree.queryParams)),this.urlTree.fragment,Lg(n),fn(n),n.component??n._loadedComponent??null,n,Fg(n)),T=hl(v,s,this.paramsInheritanceStrategy);v.params=Object.freeze(T.params),v.data=Object.freeze(T.data);let{segmentGroup:I,slicedSegments:k}=xg(t,m,p,l);if(k.length===0&&I.hasChildren())return this.processChildren(d,l,I,v).pipe(ne(D=>new Bt(v,D)));if(l.length===0&&k.length===0)return Q(new Bt(v,[]));let O=fn(n)===o;return this.processSegment(d,l,I,k,O?me:o,!0,v).pipe(ne(D=>new Bt(v,D instanceof Bt?[D]:[])))}))):yo(t)))}getChildConfig(e,t,n){return t.children?Q({routes:t.children,injector:e}):t.loadChildren?t._loadedRoutes!==void 0?Q({routes:t._loadedRoutes,injector:t._loadedInjector}):I_(e,t,n,this.urlSerializer).pipe(dt(i=>i?this.configLoader.loadChildren(e,t).pipe(Qe(o=>{t._loadedRoutes=o.routes,t._loadedInjector=o.injector})):R_(t))):Q({routes:[],injector:e})}};function B_(r){r.sort((e,t)=>e.value.outlet===me?-1:t.value.outlet===me?1:e.value.outlet.localeCompare(t.value.outlet))}function V_(r){let e=r.value.routeConfig;return e&&e.path===""}function sv(r){let e=[],t=new Set;for(let n of r){if(!V_(n)){e.push(n);continue}let i=e.find(o=>n.value.routeConfig===o.value.routeConfig);i!==void 0?(i.children.push(...n.children),t.add(i)):e.push(n)}for(let n of t){let i=sv(n.children);e.push(new Bt(n.value,i))}return e.filter(n=>!t.has(n))}function Lg(r){return r.data||{}}function Fg(r){return r.resolve||{}}function z_(r,e,t,n,i,o){return dt(s=>H_(r,e,t,n,s.extractedUrl,i,o).pipe(ne(({state:a,tree:c})=>U(g({},s),{targetSnapshot:a,urlAfterRedirects:c}))))}function K_(r,e){return dt(t=>{let{targetSnapshot:n,guards:{canActivateChecks:i}}=t;if(!i.length)return Q(t);let o=new Set(i.map(c=>c.route)),s=new Set;for(let c of o)if(!s.has(c))for(let l of av(c))s.add(l);let a=0;return Be(s).pipe(fr(c=>o.has(c)?q_(c,n,r,e):(c.data=hl(c,c.parent,r).resolve,Q(void 0))),Qe(()=>a++),Hs(1),dt(c=>a===s.size?Q(t):An))})}function av(r){let e=r.children.map(t=>av(t)).flat();return[r,...e]}function q_(r,e,t,n){let i=r.routeConfig,o=r._resolve;return i?.title!==void 0&&!ev(i)&&(o[ha]=i.title),$_(o,r,e,n).pipe(ne(s=>(r._resolvedData=s,r.data=hl(r,r.parent,t).resolve,null)))}function $_(r,e,t,n){let i=Gu(r);if(i.length===0)return Q({});let o={};return Be(i).pipe(dt(s=>j_(r[s],e,t,n).pipe(gr(),Qe(a=>{if(a instanceof ca)throw ml(new na,a);o[s]=a}))),Hs(1),df(o),dn(s=>iv(s)?An:oi(s)))}function j_(r,e,t,n){let i=pa(e)??n,o=Io(r,i),s=o.resolve?o.resolve(e,t):zn(i,()=>o(e,t));return br(s)}function ju(r){return Ze(e=>{let t=r(e);return t?Be(t).pipe(ne(()=>e)):Q(e)})}var cv=(()=>{let e=class e{buildTitle(n){let i,o=n.root;for(;o!==void 0;)i=this.getResolvedTitleForRoute(o)??i,o=o.children.find(s=>s.outlet===me);return i}getResolvedTitleForRoute(n){return n.data[ha]}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:()=>V(W_),providedIn:"root"});let r=e;return r})(),W_=(()=>{let e=class e extends cv{constructor(n){super(),this.title=n}updateTitle(n){let i=this.buildTitle(n);i!==void 0&&this.title.setTitle(i)}};e.\u0275fac=function(i){return new(i||e)(se(kg))},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Cl=new Xe("",{providedIn:"root",factory:()=>({})}),G_=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=ue({type:e,selectors:[["ng-component"]],standalone:!0,features:[Ne],decls:1,vars:0,template:function(i,o){i&1&&G(0,"router-outlet")},dependencies:[_h],encapsulation:2});let r=e;return r})();function Sh(r){let e=r.children&&r.children.map(Sh),t=e?U(g({},r),{children:e}):g({},r);return!t.component&&!t.loadComponent&&(e||t.loadChildren)&&t.outlet&&t.outlet!==me&&(t.component=G_),t}var Ah=new Xe(""),Y_=(()=>{let e=class e{constructor(){this.componentLoaders=new WeakMap,this.childrenLoaders=new WeakMap,this.compiler=V(Du)}loadComponent(n){if(this.componentLoaders.get(n))return this.componentLoaders.get(n);if(n._loadedComponent)return Q(n._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(n);let i=br(n.loadComponent()).pipe(ne(lv),Qe(s=>{this.onLoadEndListener&&this.onLoadEndListener(n),n._loadedComponent=s}),Pc(()=>{this.componentLoaders.delete(n)})),o=new fu(i,()=>new be).pipe(mu());return this.componentLoaders.set(n,o),o}loadChildren(n,i){if(this.childrenLoaders.get(i))return this.childrenLoaders.get(i);if(i._loadedRoutes)return Q({routes:i._loadedRoutes,injector:i._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(i);let s=Q_(i,this.compiler,n,this.onLoadEndListener).pipe(Pc(()=>{this.childrenLoaders.delete(i)})),a=new fu(s,()=>new be).pipe(mu());return this.childrenLoaders.set(i,a),a}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function Q_(r,e,t,n){return br(r.loadChildren()).pipe(ne(lv),dt(i=>i instanceof kf||Array.isArray(i)?Q(i):Be(e.compileModuleAsync(i))),ne(i=>{n&&n(r);let o,s,a=!1;return Array.isArray(i)?(s=i,a=!0):(o=i.create(t).injector,s=o.get(Ah,[],{optional:!0,self:!0}).flat()),{routes:s.map(Sh),injector:o}}))}function X_(r){return r&&typeof r=="object"&&"default"in r}function lv(r){return X_(r)?r.default:r}var Ih=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:()=>V(J_),providedIn:"root"});let r=e;return r})(),J_=(()=>{let e=class e{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,i){return n}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Z_=new Xe("");var eE=new Xe(""),tE=(()=>{let e=class e{get hasRequestedNavigation(){return this.navigationId!==0}constructor(){this.currentNavigation=null,this.currentTransition=null,this.lastSuccessfulNavigation=null,this.events=new be,this.transitionAbortSubject=new be,this.configLoader=V(Y_),this.environmentInjector=V(xc),this.urlSerializer=V(wh),this.rootContexts=V(gl),this.location=V(_r),this.inputBindingEnabled=V(vl,{optional:!0})!==null,this.titleStrategy=V(cv),this.options=V(Cl,{optional:!0})||{},this.paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly",this.urlHandlingStrategy=V(Ih),this.createViewTransition=V(Z_,{optional:!0}),this.navigationErrorHandler=V(eE,{optional:!0}),this.navigationId=0,this.afterPreactivation=()=>Q(void 0),this.rootComponentType=null;let n=o=>this.events.next(new rh(o)),i=o=>this.events.next(new ih(o));this.configLoader.onLoadEndListener=i,this.configLoader.onLoadStartListener=n}complete(){this.transitions?.complete()}handleNavigationRequest(n){let i=++this.navigationId;this.transitions?.next(U(g(g({},this.transitions.value),n),{id:i}))}setupNavigations(n,i,o){return this.transitions=new yt({id:0,currentUrlTree:i,currentRawUrl:i,extractedUrl:this.urlHandlingStrategy.extract(i),urlAfterRedirects:this.urlHandlingStrategy.extract(i),rawUrl:i,extras:{},resolve:()=>{},reject:()=>{},promise:Promise.resolve(!0),source:ea,restoredState:null,currentSnapshot:o.snapshot,targetSnapshot:null,currentRouterState:o,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null}),this.transitions.pipe(qe(s=>s.id!==0),ne(s=>U(g({},s),{extractedUrl:this.urlHandlingStrategy.extract(s.rawUrl)})),Ze(s=>{let a=!1,c=!1;return Q(s).pipe(Ze(l=>{if(this.navigationId>s.id)return this.cancelNavigationTransition(s,"",Vt.SupersededByNewNavigation),An;this.currentTransition=s,this.currentNavigation={id:l.id,initialUrl:l.rawUrl,extractedUrl:l.extractedUrl,targetBrowserUrl:typeof l.extras.browserUrl=="string"?this.urlSerializer.parse(l.extras.browserUrl):l.extras.browserUrl,trigger:l.source,extras:l.extras,previousNavigation:this.lastSuccessfulNavigation?U(g({},this.lastSuccessfulNavigation),{previousNavigation:null}):null};let d=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),u=l.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!d&&u!=="reload"){let m="";return this.events.next(new di(l.id,this.urlSerializer.serialize(l.rawUrl),m,Ju.IgnoredSameUrlNavigation)),l.resolve(!1),An}if(this.urlHandlingStrategy.shouldProcessUrl(l.rawUrl))return Q(l).pipe(Ze(m=>{let p=this.transitions?.getValue();return this.events.next(new ia(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),p!==this.transitions?.getValue()?An:Promise.resolve(m)}),z_(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),Qe(m=>{s.targetSnapshot=m.targetSnapshot,s.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation=U(g({},this.currentNavigation),{finalUrl:m.urlAfterRedirects});let p=new ll(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(p)}));if(d&&this.urlHandlingStrategy.shouldProcessUrl(l.currentRawUrl)){let{id:m,extractedUrl:p,source:v,restoredState:T,extras:I}=l,k=new ia(m,this.urlSerializer.serialize(p),v,T);this.events.next(k);let O=Jg(this.rootComponentType).snapshot;return this.currentTransition=s=U(g({},l),{targetSnapshot:O,urlAfterRedirects:p,extras:U(g({},I),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.finalUrl=p,Q(s)}else{let m="";return this.events.next(new di(l.id,this.urlSerializer.serialize(l.extractedUrl),m,Ju.IgnoredByUrlHandlingStrategy)),l.resolve(!1),An}}),Qe(l=>{let d=new Zu(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot);this.events.next(d)}),ne(l=>(this.currentTransition=s=U(g({},l),{guards:a_(l.targetSnapshot,l.currentSnapshot,this.rootContexts)}),s)),y_(this.environmentInjector,l=>this.events.next(l)),Qe(l=>{if(s.guardsResult=l.guardsResult,l.guardsResult&&typeof l.guardsResult!="boolean")throw ml(this.urlSerializer,l.guardsResult);let d=new eh(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects),l.targetSnapshot,!!l.guardsResult);this.events.next(d)}),qe(l=>l.guardsResult?!0:(this.cancelNavigationTransition(l,"",Vt.GuardRejected),!1)),ju(l=>{if(l.guards.canActivateChecks.length)return Q(l).pipe(Qe(d=>{let u=new th(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(u)}),Ze(d=>{let u=!1;return Q(d).pipe(K_(this.paramsInheritanceStrategy,this.environmentInjector),Qe({next:()=>u=!0,complete:()=>{u||this.cancelNavigationTransition(d,"",Vt.NoDataFromResolver)}}))}),Qe(d=>{let u=new nh(d.id,this.urlSerializer.serialize(d.extractedUrl),this.urlSerializer.serialize(d.urlAfterRedirects),d.targetSnapshot);this.events.next(u)}))}),ju(l=>{let d=u=>{let m=[];u.routeConfig?.loadComponent&&!u.routeConfig._loadedComponent&&m.push(this.configLoader.loadComponent(u.routeConfig).pipe(Qe(p=>{u.component=p}),ne(()=>{})));for(let p of u.children)m.push(...d(p));return m};return lo(d(l.targetSnapshot.root)).pipe(yu(null),ut(1))}),ju(()=>this.afterPreactivation()),Ze(()=>{let{currentSnapshot:l,targetSnapshot:d}=s,u=this.createViewTransition?.(this.environmentInjector,l.root,d.root);return u?Be(u).pipe(ne(()=>s)):Q(s)}),ne(l=>{let d=n_(n.routeReuseStrategy,l.targetSnapshot,l.currentRouterState);return this.currentTransition=s=U(g({},l),{targetRouterState:d}),this.currentNavigation.targetRouterState=d,s}),Qe(()=>{this.events.next(new sa)}),s_(this.rootContexts,n.routeReuseStrategy,l=>this.events.next(l),this.inputBindingEnabled),ut(1),Qe({next:l=>{a=!0,this.lastSuccessfulNavigation=this.currentNavigation,this.events.next(new Ir(l.id,this.urlSerializer.serialize(l.extractedUrl),this.urlSerializer.serialize(l.urlAfterRedirects))),this.titleStrategy?.updateTitle(l.targetRouterState.snapshot),l.resolve(!0)},complete:()=>{a=!0}}),Ft(this.transitionAbortSubject.pipe(Qe(l=>{throw l}))),Pc(()=>{!a&&!c&&this.cancelNavigationTransition(s,"",Vt.SupersededByNewNavigation),this.currentTransition?.id===s.id&&(this.currentNavigation=null,this.currentTransition=null)}),dn(l=>{if(c=!0,rv(l))this.events.next(new Wn(s.id,this.urlSerializer.serialize(s.extractedUrl),l.message,l.cancellationCode)),o_(l)?this.events.next(new So(l.url,l.navigationBehaviorOptions)):s.resolve(!1);else{let d=new oa(s.id,this.urlSerializer.serialize(s.extractedUrl),l,s.targetSnapshot??void 0);try{let u=zn(this.environmentInjector,()=>this.navigationErrorHandler?.(d));if(u instanceof ca){let{message:m,cancellationCode:p}=ml(this.urlSerializer,u);this.events.next(new Wn(s.id,this.urlSerializer.serialize(s.extractedUrl),m,p)),this.events.next(new So(u.redirectTo,u.navigationBehaviorOptions))}else{this.events.next(d);let m=n.errorHandler(l);s.resolve(!!m)}}catch(u){this.options.resolveNavigationPromiseOnError?s.resolve(!1):s.reject(u)}}return An}))}))}cancelNavigationTransition(n,i,o){let s=new Wn(n.id,this.urlSerializer.serialize(n.extractedUrl),i,o);this.events.next(s),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),i=this.currentNavigation?.targetBrowserUrl??this.currentNavigation?.extractedUrl;return n.toString()!==i?.toString()&&!this.currentNavigation?.extras.skipLocationChange}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function nE(r){return r!==ea}var rE=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:()=>V(iE),providedIn:"root"});let r=e;return r})(),Ch=class{shouldDetach(e){return!1}store(e,t){}shouldAttach(e){return!1}retrieve(e){return null}shouldReuseRoute(e,t){return e.routeConfig===t.routeConfig}},iE=(()=>{let e=class e extends Ch{};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Vs(e)))(o||e)}})(),e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),dv=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:()=>V(oE),providedIn:"root"});let r=e;return r})(),oE=(()=>{let e=class e extends dv{constructor(){super(...arguments),this.location=V(_r),this.urlSerializer=V(wh),this.options=V(Cl,{optional:!0})||{},this.canceledNavigationResolution=this.options.canceledNavigationResolution||"replace",this.urlHandlingStrategy=V(Ih),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.currentUrlTree=new Gn,this.rawUrlTree=this.currentUrlTree,this.currentPageId=0,this.lastSuccessfulId=-1,this.routerState=Jg(null),this.stateMemento=this.createStateMemento()}getCurrentUrlTree(){return this.currentUrlTree}getRawUrlTree(){return this.rawUrlTree}restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}getRouterState(){return this.routerState}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(i=>{i.type==="popstate"&&n(i.url,i.state)})}handleRouterEvent(n,i){if(n instanceof ia)this.stateMemento=this.createStateMemento();else if(n instanceof di)this.rawUrlTree=i.initialUrl;else if(n instanceof ll){if(this.urlUpdateStrategy==="eager"&&!i.extras.skipLocationChange){let o=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl);this.setBrowserUrl(i.targetBrowserUrl??o,i)}}else n instanceof sa?(this.currentUrlTree=i.finalUrl,this.rawUrlTree=this.urlHandlingStrategy.merge(i.finalUrl,i.initialUrl),this.routerState=i.targetRouterState,this.urlUpdateStrategy==="deferred"&&!i.extras.skipLocationChange&&this.setBrowserUrl(i.targetBrowserUrl??this.rawUrlTree,i)):n instanceof Wn&&(n.code===Vt.GuardRejected||n.code===Vt.NoDataFromResolver)?this.restoreHistory(i):n instanceof oa?this.restoreHistory(i,!0):n instanceof Ir&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,i){let o=n instanceof Gn?this.urlSerializer.serialize(n):n;if(this.location.isCurrentPathEqualTo(o)||i.extras.replaceUrl){let s=this.browserPageId,a=g(g({},i.extras.state),this.generateNgRouterState(i.id,s));this.location.replaceState(o,"",a)}else{let s=g(g({},i.extras.state),this.generateNgRouterState(i.id,this.browserPageId+1));this.location.go(o,"",s)}}restoreHistory(n,i=!1){if(this.canceledNavigationResolution==="computed"){let o=this.browserPageId,s=this.currentPageId-o;s!==0?this.location.historyGo(s):this.currentUrlTree===n.finalUrl&&s===0&&(this.resetState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(i&&this.resetState(n),this.resetUrlToCurrentUrlTree())}resetState(n){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n.finalUrl??this.rawUrlTree)}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.rawUrlTree),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,i){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:i}:{navigationId:n}}};e.\u0275fac=(()=>{let n;return function(o){return(n||(n=Vs(e)))(o||e)}})(),e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})(),Js=function(r){return r[r.COMPLETE=0]="COMPLETE",r[r.FAILED=1]="FAILED",r[r.REDIRECTING=2]="REDIRECTING",r}(Js||{});function sE(r,e){r.events.pipe(qe(t=>t instanceof Ir||t instanceof Wn||t instanceof oa||t instanceof di),ne(t=>t instanceof Ir||t instanceof di?Js.COMPLETE:(t instanceof Wn?t.code===Vt.Redirect||t.code===Vt.SupersededByNewNavigation:!1)?Js.REDIRECTING:Js.FAILED),qe(t=>t!==Js.REDIRECTING),ut(1)).subscribe(()=>{e()})}function aE(r){throw r}var cE={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},lE={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},fa=(()=>{let e=class e{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}constructor(){this.disposed=!1,this.console=V(Bc),this.stateManager=V(dv),this.options=V(Cl,{optional:!0})||{},this.pendingTasks=V(wf),this.urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred",this.navigationTransitions=V(tE),this.urlSerializer=V(wh),this.location=V(_r),this.urlHandlingStrategy=V(Ih),this._events=new be,this.errorHandler=this.options.errorHandler||aE,this.navigated=!1,this.routeReuseStrategy=V(rE),this.onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore",this.config=V(Ah,{optional:!0})?.flat()??[],this.componentInputBindingEnabled=!!V(vl,{optional:!0}),this.eventsSubscription=new tf,this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this,this.currentUrlTree,this.routerState).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(i=>{try{let o=this.navigationTransitions.currentTransition,s=this.navigationTransitions.currentNavigation;if(o!==null&&s!==null){if(this.stateManager.handleRouterEvent(i,s),i instanceof Wn&&i.code!==Vt.Redirect&&i.code!==Vt.SupersededByNewNavigation)this.navigated=!0;else if(i instanceof Ir)this.navigated=!0;else if(i instanceof So){let a=i.navigationBehaviorOptions,c=this.urlHandlingStrategy.merge(i.url,o.currentRawUrl),l=g({browserUrl:o.extras.browserUrl,info:o.extras.info,skipLocationChange:o.extras.skipLocationChange,replaceUrl:o.extras.replaceUrl||this.urlUpdateStrategy==="eager"||nE(o.source)},a);this.scheduleNavigation(c,ea,null,l,{resolve:o.resolve,reject:o.reject,promise:o.promise})}}uE(i)&&this._events.next(i)}catch(o){this.navigationTransitions.transitionAbortSubject.next(o)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),ea,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,i)=>{setTimeout(()=>{this.navigateToSyncWithBrowser(n,"popstate",i)},0)})}navigateToSyncWithBrowser(n,i,o){let s={replaceUrl:!0},a=o?.navigationId?o:null;if(o){let l=g({},o);delete l.navigationId,delete l.\u0275routerPageId,Object.keys(l).length!==0&&(s.state=l)}let c=this.parseUrl(n);this.scheduleNavigation(c,i,a,s)}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return this.navigationTransitions.currentNavigation}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Sh),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,i={}){let{relativeTo:o,queryParams:s,fragment:a,queryParamsHandling:c,preserveFragment:l}=i,d=l?this.currentUrlTree.fragment:a,u=null;switch(c??this.options.defaultQueryParamsHandling){case"merge":u=g(g({},this.currentUrlTree.queryParams),s);break;case"preserve":u=this.currentUrlTree.queryParams;break;default:u=s||null}u!==null&&(u=this.removeEmptyProps(u));let m;try{let p=o?o.snapshot:this.routerState.snapshot.root;m=Gg(p)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),m=this.currentUrlTree.root}return Yg(m,n,u,d??null)}navigateByUrl(n,i={skipLocationChange:!1}){let o=li(n)?n:this.parseUrl(n),s=this.urlHandlingStrategy.merge(o,this.rawUrlTree);return this.scheduleNavigation(s,ea,null,i)}navigate(n,i={skipLocationChange:!1}){return dE(n),this.navigateByUrl(this.createUrlTree(n,i),i)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.urlSerializer.parse("/")}}isActive(n,i){let o;if(i===!0?o=g({},cE):i===!1?o=g({},lE):o=i,li(n))return Dg(this.currentUrlTree,n,o);let s=this.parseUrl(n);return Dg(this.currentUrlTree,s,o)}removeEmptyProps(n){return Object.entries(n).reduce((i,[o,s])=>(s!=null&&(i[o]=s),i),{})}scheduleNavigation(n,i,o,s,a){if(this.disposed)return Promise.resolve(!1);let c,l,d;a?(c=a.resolve,l=a.reject,d=a.promise):d=new Promise((m,p)=>{c=m,l=p});let u=this.pendingTasks.add();return sE(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(u))}),this.navigationTransitions.handleNavigationRequest({source:i,restoredState:o,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:s,resolve:c,reject:l,promise:d,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),d.catch(m=>Promise.reject(m))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac,providedIn:"root"});let r=e;return r})();function dE(r){for(let e=0;e<r.length;e++)if(r[e]==null)throw new Z(4008,!1)}function uE(r){return!(r instanceof sa)&&!(r instanceof So)}var uv=(()=>{let e=class e{constructor(n,i,o,s,a,c){this.router=n,this.route=i,this.tabIndexAttribute=o,this.renderer=s,this.el=a,this.locationStrategy=c,this.href=null,this.onChanges=new be,this.preserveFragment=!1,this.skipLocationChange=!1,this.replaceUrl=!1,this.routerLinkInput=null;let l=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=l==="a"||l==="area",this.isAnchorElement?this.subscription=n.events.subscribe(d=>{d instanceof Ir&&this.updateHref()}):this.setTabIndexIfNotOnNativeEl("0")}setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&this.updateHref(),this.onChanges.next(this)}set routerLink(n){n==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(li(n)?this.routerLinkInput=n:this.routerLinkInput=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0"))}onClick(n,i,o,s,a){let c=this.urlTree;if(c===null||this.isAnchorElement&&(n!==0||i||o||s||a||typeof this.target=="string"&&this.target!="_self"))return!0;let l={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(c,l),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.href=n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n)):null;let i=this.href===null?null:Ef(this.href,this.el.nativeElement.tagName.toLowerCase(),"href");this.applyAttributeValue("href",i)}applyAttributeValue(n,i){let o=this.renderer,s=this.el.nativeElement;i!==null?o.setAttribute(s,n,i):o.removeAttribute(s,n)}get urlTree(){return this.routerLinkInput===null?null:li(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}};e.\u0275fac=function(i){return new(i||e)(x(fa),x(ui),Cf("tabindex"),x(Yt),x(Tt),x(Ou))},e.\u0275dir=et({type:e,selectors:[["","routerLink",""]],hostVars:1,hostBindings:function(i,o){i&1&&L("click",function(a){return o.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),i&2&&Et("target",o.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",Vc],skipLocationChange:[2,"skipLocationChange","skipLocationChange",Vc],replaceUrl:[2,"replaceUrl","replaceUrl",Vc],routerLink:"routerLink"},standalone:!0,features:[bf,In]});let r=e;return r})();var hE=new Xe("");function hv(r,...e){return Nc([{provide:Ah,multi:!0,useValue:r},[],{provide:ui,useFactory:pE,deps:[fa]},{provide:Ff,multi:!0,useFactory:mE},e.map(t=>t.\u0275providers)])}function pE(r){return r.routerState.root}function pv(r,e){return{\u0275kind:r,\u0275providers:e}}function mE(){let r=V(Lc);return e=>{let t=r.get(Ru);if(e!==t.components[0])return;let n=r.get(fa),i=r.get(fE);r.get(gE)===1&&n.initialNavigation(),r.get(vE,null,Cu.Optional)?.setUpPreloading(),r.get(hE,null,Cu.Optional)?.init(),n.resetRootComponentType(t.componentTypes[0]),i.closed||(i.next(),i.complete(),i.unsubscribe())}}var fE=new Xe("",{factory:()=>new be}),gE=new Xe("",{providedIn:"root",factory:()=>1});var vE=new Xe("");function mv(r){return pv(5,[{provide:Cl,useValue:r}])}function fv(){return pv(8,[Ng,{provide:vl,useExisting:Ng}])}function q(r){let e=Object.prototype.toString.call(r);return r instanceof Date||typeof r=="object"&&e==="[object Date]"?new r.constructor(+r):typeof r=="number"||e==="[object Number]"||typeof r=="string"||e==="[object String]"?new Date(r):new Date(NaN)}function at(r,e){return r instanceof Date?new r.constructor(e):new Date(e)}function bo(r,e){let t=q(r);return isNaN(e)?at(r,NaN):(e&&t.setDate(t.getDate()+e),t)}function wl(r,e){let t=q(r);if(isNaN(e))return at(r,NaN);if(!e)return t;let n=t.getDate(),i=at(r,t.getTime());i.setMonth(t.getMonth()+e+1,0);let o=i.getDate();return n>=o?i:(t.setFullYear(i.getFullYear(),i.getMonth(),n),t)}function ko(r,e){let t=+q(r);return at(r,t+e)}var CE=Math.pow(10,8)*24*60*60*1e3,TR=-CE,gv=6048e5,vv=864e5,Tl=6e4,yv=36e5;var wE=3600;var Cv=wE*24,_R=Cv*7,TE=Cv*365.2425,_E=TE/12,ER=_E*3;function wv(r,e){return ko(r,e*yv)}var EE={};function _l(){return EE}function El(r,e){let t=_l(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=q(r),o=i.getDay(),s=(o<n?7:0)+o-n;return i.setDate(i.getDate()-s),i.setHours(0,0,0,0),i}function hi(r){return El(r,{weekStartsOn:1})}function Tv(r){let e=q(r),t=e.getFullYear(),n=at(r,0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);let i=hi(n),o=at(r,0);o.setFullYear(t,0,4),o.setHours(0,0,0,0);let s=hi(o);return e.getTime()>=i.getTime()?t+1:e.getTime()>=s.getTime()?t:t-1}function kr(r){let e=q(r);return e.setHours(0,0,0,0),e}function bh(r){let e=q(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function _v(r,e){let t=kr(r),n=kr(e),i=+t-bh(t),o=+n-bh(n);return Math.round((i-o)/vv)}function Ev(r){let e=Tv(r),t=at(r,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),hi(t)}function Sv(r,e){return ko(r,e*Tl)}function Av(r,e){return ko(r,e*1e3)}function Sl(r,e){let t=e*7;return bo(r,t)}function Iv(r){let e;return r.forEach(function(t){let n=q(t);(e===void 0||e<n||isNaN(Number(n)))&&(e=n)}),e||new Date(NaN)}function bv(r,e){let t=kr(r),n=kr(e);return+t==+n}function Rv(r,e){let t=q(r),n=q(e),i=kv(t,n),o=Math.abs(_v(t,n));t.setDate(t.getDate()-i*o);let s=+(kv(t,n)===-i),a=i*(o-s);return a===0?0:a}function kv(r,e){let t=r.getFullYear()-e.getFullYear()||r.getMonth()-e.getMonth()||r.getDate()-e.getDate()||r.getHours()-e.getHours()||r.getMinutes()-e.getMinutes()||r.getSeconds()-e.getSeconds()||r.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function Al(r){return e=>{let n=(r?Math[r]:Math.trunc)(e);return n===0?0:n}}function Il(r,e){return+q(r)-+q(e)}function Dv(r,e,t){let n=Il(r,e)/Tl;return Al(t?.roundingMethod)(n)}function Mv(r){let e=q(r);return e.setHours(23,59,59,999),e}function Ov(r){let e=q(r),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function Pv(r,e,t){let n=Il(r,e)/1e3;return Al(t?.roundingMethod)(n)}function Nv(r){let e=q(r);return e.setSeconds(0,0),e}function xv(r){let e=q(r);return e.setDate(1),e.setHours(0,0,0,0),e}function Lv(r,e){let t=_l(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=q(r),o=i.getDay(),s=(o<n?-7:0)+6-(o-n);return i.setDate(i.getDate()+s),i.setHours(23,59,59,999),i}function Fv(r){let e=q(r),t=+hi(e)-+Ev(e);return Math.round(t/gv)+1}function Hv(r){return q(r).getDate()}function Uv(r){return q(r).getDay()}function Bv(r){let e=q(r),t=e.getFullYear(),n=e.getMonth(),i=at(r,0);return i.setFullYear(t,n+1,0),i.setHours(0,0,0,0),i.getDate()}function Vv(r){return q(r).getHours()}function zv(r){return q(r).getMinutes()}function Kv(r){return q(r).getMonth()}function qv(r){return q(r).getFullYear()}function kh(r,e){let t=q(r),n=q(e);return+t<+n}function $v(r,e){let t=q(r),n=q(e);return t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()}function Rh(r){let e=q(r);return e.setMilliseconds(0),e}function jv(r,e){let t=Rh(r),n=Rh(e);return+t==+n}function Wv(r,e){return bo(r,-e)}function Gv(r,e){let t=q(r),n=t.getFullYear(),i=t.getDate(),o=at(r,0);o.setFullYear(n,e,15),o.setHours(0,0,0,0);let s=Bv(o);return t.setMonth(e,Math.min(i,s)),t}function Yv(r,e){let t=q(r);return t.setDate(e),t}function Qv(r,e){let t=q(r);return t.setHours(e),t}function Xv(r,e){let t=q(r);return t.setMinutes(e),t}function Jv(r,e){let t=q(r);return isNaN(+t)?at(r,NaN):(t.setFullYear(e),t)}function Zv(r,e){return wl(r,-e)}function ey(r,e){return Sl(r,-e)}function Dh(r){return typeof r.setHours=="function"}function Mh(){return r=>{let e=r.value;if(!Dh(e))return{notADate:!0};let t=new Date;return e.setHours(0,0,0,0),t.setHours(0,0,0,0),e===null||kh(e,t)?{dateBeforeToday:!0}:null}}function ty(r,e){return t=>{let n=t.get(r),i=t.get(e),o=n?.value,s=i?.value;return Dh(o)?Dh(s)?(o.setHours(0,0,0,0),s.setHours(0,0,0,0),kh(s,o)?{endsBeforeStart:!0}:null):{endDateNotADate:!0}:{startDateNotADate:!0}}}function ny(r){return{id:r.id,name:r.name,icon:r.icon}}var bl=(()=>{class r{usersUrl=`${Er.apiUrl}/users`;http=V(Zf);users=Dt([]);allUsers=this.users.asReadonly();loadUsers(){return this.fetchUsers("Something gone wrong trying to load users...").pipe(Qe(t=>this.users.set(t)))}fetchUsers(t){return this.http.get(this.usersUrl).pipe(ne(n=>n.map(ny)),dn(()=>oi(()=>new Error(t))))}static \u0275fac=function(n){return new(n||r)};static \u0275prov=he({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var SE=r=>({"dropdown-multiselect--active":r});function AE(r,e){if(r&1&&(C(0,"span"),B(1),w()),r&2){let t=b();_(),Ht(t._placeholder)}}function IE(r,e){if(r&1){let t=Ce();C(0,"span",15)(1,"span",16)(2,"span"),B(3),w(),C(4,"a",17),L("click",function(i){let o=P(t).$implicit,s=b();return N(s.onItemClick(i,o))}),B(5,"x"),w()()()}if(r&2){let t=e.$implicit,n=e.index,i=b();_(),S("hidden",n>i._settings.itemsShowLimit-1),_(2),yr("",t.text,"\xA0")}}function bE(r,e){if(r&1&&(C(0,"span",18),B(1),w()),r&2){let t=b();_(),yr("+",t.itemShowRemaining(),"")}}function kE(r,e){if(r&1){let t=Ce();C(0,"li",19),L("click",function(){P(t);let i=b();return N(i.toggleSelectAll())}),G(1,"input",20),C(2,"div"),B(3),w()()}if(r&2){let t=b();_(),S("checked",t.isAllItemsSelected())("disabled",t.disabled||t.isLimitSelectionReached()),_(2),Ht(t.isAllItemsSelected()?t._settings.unSelectAllText:t._settings.selectAllText)}}function RE(r,e){if(r&1){let t=Ce();C(0,"li",21)(1,"input",22),wr("ngModelChange",function(i){P(t);let o=b();return qn(o.filter.text,i)||(o.filter.text=i),N(i)}),L("ngModelChange",function(i){P(t);let o=b();return N(o.onFilterTextChange(i))}),w()()}if(r&2){let t=b();_(),S("readOnly",t.disabled)("placeholder",t._settings.searchPlaceholderText),Cr("ngModel",t.filter.text)}}function DE(r,e){if(r&1){let t=Ce();C(0,"li",23),L("click",function(i){let o=P(t).$implicit,s=b();return N(s.onItemClick(i,o))}),G(1,"input",24),C(2,"div"),B(3),w()()}if(r&2){let t=e.$implicit,n=b();_(),S("checked",n.isSelected(t))("disabled",n.disabled||n.isLimitSelectionReached()&&!n.isSelected(t)||t.isDisabled),Et("aria-label",t.text),_(2),Ht(t.text)}}function ME(r,e){if(r&1&&(C(0,"li",25)(1,"h5"),B(2),w()()),r&2){let t=b();_(2),Ht(t._settings.noFilteredDataAvailablePlaceholderText)}}function OE(r,e){if(r&1&&(C(0,"li",26)(1,"h5"),B(2),w()()),r&2){let t=b();_(2),Ht(t._settings.noDataAvailablePlaceholderText)}}var Yn=class{id;text;isDisabled;constructor(e){(typeof e=="string"||typeof e=="number")&&(this.id=this.text=e,this.isDisabled=!1),typeof e=="object"&&(this.id=e.id,this.text=e.text,this.isDisabled=e.isDisabled)}},Oh=(()=>{class r{transform(t,n){return!t||!n?t:t.filter(i=>this.applyFilter(i,n))}applyFilter(t,n){return typeof t.text=="string"&&typeof n.text=="string"?!(n.text&&t.text&&t.text.toLowerCase().indexOf(n.text.toLowerCase())===-1):!(n.text&&t.text&&t.text.toString().toLowerCase().indexOf(n.text.toString().toLowerCase())===-1)}static \u0275fac=function(n){return new(n||r)};static \u0275pipe=ho({name:"multiSelectFilter",type:r,pure:!1})}return r})(),PE=(()=>{class r{_elementRef;constructor(t){this._elementRef=t}clickOutside=new W;onClick(t,n){if(!n)return;this._elementRef.nativeElement.contains(n)||this.clickOutside.emit(t)}static \u0275fac=function(n){return new(n||r)(x(Tt))};static \u0275dir=et({type:r,selectors:[["","clickOutside",""]],hostBindings:function(n,i){n&1&&L("click",function(s){return i.onClick(s,s.target)},!1,Sf)},outputs:{clickOutside:"clickOutside"}})}return r})(),NE={provide:Kc,useExisting:ff(()=>ga),multi:!0},ry=()=>{},ga=(()=>{class r{listFilterPipe;cdr;_settings;_data=[];selectedItems=[];isDropdownOpen=!0;_placeholder="Select";_sourceDataType=null;_sourceDataFields=[];filter=new Yn(this.data);defaultSettings={singleSelection:!1,idField:"id",textField:"text",disabledField:"isDisabled",enableCheckAll:!0,selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!1,limitSelection:-1,clearSearchFilter:!0,maxHeight:197,itemsShowLimit:999999999999,searchPlaceholderText:"Search",noDataAvailablePlaceholderText:"No data available",noFilteredDataAvailablePlaceholderText:"No filtered data available",closeDropDownOnSelection:!1,showSelectedItemsAtTop:!1,defaultOpen:!1,allowRemoteDataSearch:!1};set placeholder(t){t?this._placeholder=t:this._placeholder="Select"}disabled=!1;set settings(t){t?this._settings=Object.assign(this.defaultSettings,t):this._settings=Object.assign(this.defaultSettings)}set data(t){if(!t)this._data=[];else{let n=t[0];this._sourceDataType=typeof n,this._sourceDataFields=this.getFields(n),this._data=t.map(i=>typeof i=="string"||typeof i=="number"?new Yn(i):new Yn({id:i[this._settings.idField],text:i[this._settings.textField],isDisabled:i[this._settings.disabledField]}))}}onFilterChange=new W;onDropDownClose=new W;onSelect=new W;onDeSelect=new W;onSelectAll=new W;onDeSelectAll=new W;onTouchedCallback=ry;onChangeCallback=ry;onFilterTextChange(t){this.onFilterChange.emit(t)}constructor(t,n){this.listFilterPipe=t,this.cdr=n}onItemClick(t,n){if(this.disabled||n.isDisabled)return!1;let i=this.isSelected(n),o=this._settings.limitSelection===-1||this._settings.limitSelection>0&&this.selectedItems.length<this._settings.limitSelection;i?this.removeSelected(n):o&&this.addSelected(n),this._settings.singleSelection&&this._settings.closeDropDownOnSelection&&this.closeDropdown()}writeValue(t){if(t!=null&&t.length>0)if(this._settings.singleSelection)try{if(t.length>=1){let n=t[0];this.selectedItems=[typeof n=="string"||typeof n=="number"?new Yn(n):new Yn({id:n[this._settings.idField],text:n[this._settings.textField],isDisabled:n[this._settings.disabledField]})]}}catch{}else{let n=t.map(i=>typeof i=="string"||typeof i=="number"?new Yn(i):new Yn({id:i[this._settings.idField],text:i[this._settings.textField],isDisabled:i[this._settings.disabledField]}));this._settings.limitSelection>0?this.selectedItems=n.splice(0,this._settings.limitSelection):this.selectedItems=n}else this.selectedItems=[];this.onChangeCallback(t),this.cdr.markForCheck()}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}onTouched(){this.onTouchedCallback()}trackByFn(t,n){return n.id}isSelected(t){let n=!1;return this.selectedItems.forEach(i=>{t.id===i.id&&(n=!0)}),n}isLimitSelectionReached(){return this._settings.limitSelection===this.selectedItems.length}isAllItemsSelected(){let t=this.listFilterPipe.transform(this._data,this.filter),n=t.filter(i=>i.isDisabled).length;return(!this.data||this.data.length===0)&&this._settings.allowRemoteDataSearch?!1:t.length===this.selectedItems.length+n}showButton(){return this._settings.singleSelection?!1:!(this._settings.limitSelection>0)}itemShowRemaining(){return this.selectedItems.length-this._settings.itemsShowLimit}addSelected(t){this._settings.singleSelection?(this.selectedItems=[],this.selectedItems.push(t)):this.selectedItems.push(t),this.onChangeCallback(this.emittedValue(this.selectedItems)),this.onSelect.emit(this.emittedValue(t))}removeSelected(t){this.selectedItems.forEach(n=>{t.id===n.id&&this.selectedItems.splice(this.selectedItems.indexOf(n),1)}),this.onChangeCallback(this.emittedValue(this.selectedItems)),this.onDeSelect.emit(this.emittedValue(t))}emittedValue(t){let n=[];if(Array.isArray(t))t.map(i=>{n.push(this.objectify(i))});else if(t)return this.objectify(t);return n}objectify(t){if(this._sourceDataType==="object"){let n={};return n[this._settings.idField]=t.id,n[this._settings.textField]=t.text,this._sourceDataFields.includes(this._settings.disabledField)&&(n[this._settings.disabledField]=t.isDisabled),n}return this._sourceDataType==="number"?Number(t.id):t.text}toggleDropdown(t){t.preventDefault(),!(this.disabled&&this._settings.singleSelection)&&(this._settings.defaultOpen=!this._settings.defaultOpen,this._settings.defaultOpen||this.onDropDownClose.emit())}closeDropdown(){this._settings.defaultOpen=!1,this._settings.clearSearchFilter&&(this.filter.text=""),this.onDropDownClose.emit()}toggleSelectAll(){if(this.disabled)return!1;this.isAllItemsSelected()?(this.selectedItems=[],this.onDeSelectAll.emit(this.emittedValue(this.selectedItems))):(this.selectedItems=this.listFilterPipe.transform(this._data,this.filter).filter(t=>!t.isDisabled).slice(),this.onSelectAll.emit(this.emittedValue(this.selectedItems))),this.onChangeCallback(this.emittedValue(this.selectedItems))}getFields(t){let n=[];if(typeof t!="object")return n;for(let i in t)n.push(i);return n}static \u0275fac=function(n){return new(n||r)(x(Oh),x(Tr))};static \u0275cmp=ue({type:r,selectors:[["ng-multiselect-dropdown"]],hostBindings:function(n,i){n&1&&L("blur",function(){return i.onTouched()})},inputs:{placeholder:"placeholder",disabled:"disabled",settings:"settings",data:"data"},outputs:{onFilterChange:"onFilterChange",onDropDownClose:"onDropDownClose",onSelect:"onSelect",onDeSelect:"onDeSelect",onSelectAll:"onSelectAll",onDeSelectAll:"onDeSelectAll"},features:[mo([NE])],decls:18,vars:23,consts:[["tabindex","0",1,"multiselect-dropdown",3,"blur","clickOutside"],["tabindex","-1",1,"dropdown-btn",3,"click"],[4,"ngIf"],["class","selected-item-container",4,"ngFor","ngForOf","ngForTrackBy"],[2,"float","right !important","padding-right","4px",3,"ngClass"],["style","padding-right: 15px;",4,"ngIf"],[1,"dropdown-multiselect__caret"],[1,"dropdown-list",3,"hidden"],[1,"item1"],["class","multiselect-item-checkbox","style","border-bottom: 1px solid #ccc;padding:10px",3,"click",4,"ngIf"],["class","filter-textbox",4,"ngIf"],[1,"item2"],["class","multiselect-item-checkbox",3,"click",4,"ngFor","ngForOf"],["class","no-filtered-data",4,"ngIf"],["class","no-data",4,"ngIf"],[1,"selected-item-container"],[1,"selected-item",3,"hidden"],[2,"padding-left","2px","color","white",3,"click"],[2,"padding-right","15px"],[1,"multiselect-item-checkbox",2,"border-bottom","1px solid #ccc","padding","10px",3,"click"],["type","checkbox","aria-label","multiselect-select-all",3,"checked","disabled"],[1,"filter-textbox"],["type","text","aria-label","multiselect-search",3,"ngModelChange","readOnly","placeholder","ngModel"],[1,"multiselect-item-checkbox",3,"click"],["type","checkbox",3,"checked","disabled"],[1,"no-filtered-data"],[1,"no-data"]],template:function(n,i){n&1&&(C(0,"div",0),L("blur",function(){return i.onTouched()})("clickOutside",function(){return i.closeDropdown()}),C(1,"div")(2,"span",1),L("click",function(s){return i.toggleDropdown(s)}),$(3,AE,2,1,"span",2)(4,IE,6,2,"span",3),C(5,"span",4),$(6,bE,2,1,"span",5),G(7,"span",6),w()()(),C(8,"div",7)(9,"ul",8),$(10,kE,4,3,"li",9)(11,RE,2,3,"li",10),w(),C(12,"ul",11),$(13,DE,4,4,"li",12),De(14,"multiSelectFilter"),$(15,ME,3,1,"li",13),De(16,"multiSelectFilter"),$(17,OE,3,1,"li",14),w()()()),n&2&&(_(),Ve("disabled",i.disabled),_(2),S("ngIf",i.selectedItems.length==0),_(),S("ngForOf",i.selectedItems)("ngForTrackBy",i.trackByFn),_(),S("ngClass",$n(21,SE,i._settings.defaultOpen)),_(),S("ngIf",i.itemShowRemaining()>0),_(2),S("hidden",!i._settings.defaultOpen),_(2),S("ngIf",(i._data.length>0||i._settings.allowRemoteDataSearch)&&!i._settings.singleSelection&&i._settings.enableCheckAll&&i._settings.limitSelection===-1),_(),S("ngIf",(i._data.length>0||i._settings.allowRemoteDataSearch)&&i._settings.allowSearchFilter),_(),Kn("max-height",i._settings.maxHeight+"px"),_(),S("ngForOf",Mt(14,15,i._data,i.filter)),_(2),S("ngIf",i._data.length!=0&&Mt(16,18,i._data,i.filter).length==0&&!i._settings.allowRemoteDataSearch),_(2),S("ngIf",i._data.length==0&&!i._settings.allowRemoteDataSearch))},dependencies:[Xt,bn,mn,qc,fo,og,PE,Oh],styles:['.multiselect-dropdown[_ngcontent-%COMP%]{position:relative;width:100%;font-size:inherit;font-family:inherit}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]{display:inline-block;border:1px solid #adadad;width:100%;padding:6px 12px;margin-bottom:0;font-weight:400;line-height:1.52857143;text-align:left;vertical-align:middle;cursor:pointer;background-image:none;border-radius:4px}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]{display:flex;float:left}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]{border:1px solid #337ab7;margin-right:4px;background:#337ab7;padding:0 5px;color:#fff;border-radius:2px;float:left;max-width:100px}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]:hover{box-shadow:1px 1px #959595}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]{line-height:16px;display:block;position:absolute;box-sizing:border-box;width:40px;height:38px;right:1px;top:0;padding:4px 8px;margin:0;text-decoration:none;text-align:center;cursor:pointer;transition:transform .2s ease}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]:before{position:relative;right:0;top:65%;color:#999;margin-top:4px;border-style:solid;border-width:8px 8px 0 8px;border-color:#999999 transparent;content:""}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect--active[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]{transform:rotate(180deg)}.multiselect-dropdown[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{background-color:#eceeef}.dropdown-list[_ngcontent-%COMP%]{position:absolute;padding-top:6px;width:100%;z-index:9999;border:1px solid #ccc;border-radius:3px;background:#fff;margin-top:10px;box-shadow:0 1px 5px #959595}.dropdown-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style:none;overflow:auto;margin:0}.dropdown-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:6px 10px;cursor:pointer;text-align:left}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;position:relative;padding:10px}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:0px;width:100%;padding:0 0 0 26px}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.multiselect-item-checkbox[_ngcontent-%COMP%]:hover{background-color:#e4e3e3}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:focus + div[_ngcontent-%COMP%]:before, .multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]:before{border-color:#337ab7;background-color:#f2f2f2}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active + div[_ngcontent-%COMP%]:before{transition-duration:0s}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{position:relative;padding-left:2em;vertical-align:middle;-webkit-user-select:none;user-select:none;cursor:pointer;margin:0;color:#000}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:before{box-sizing:content-box;content:"";color:#337ab7;position:absolute;top:50%;left:0;width:14px;height:14px;margin-top:-9px;border:2px solid #337ab7;text-align:center;transition:all .4s ease}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:after{box-sizing:content-box;content:"";background-color:#337ab7;position:absolute;top:50%;left:4px;width:10px;height:10px;margin-top:-5px;transform:scale(0);transform-origin:50%;transition:transform .2s ease-out}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled + div[_ngcontent-%COMP%]:before{border-color:#ccc}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:focus + div[_ngcontent-%COMP%]:before   .multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:hover + div[_ngcontent-%COMP%]:before{background-color:inherit}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:checked + div[_ngcontent-%COMP%]:before{background-color:#ccc}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:after{background-color:transparent;top:50%;left:4px;width:8px;height:3px;margin-top:-4px;border-style:solid;border-color:#fff;border-width:0 0 3px 3px;border-image:none;transform:rotate(-45deg) scale(0)}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:after{content:"";transform:rotate(-45deg) scale(1);transition:transform .2s ease-out}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:before{animation:_ngcontent-%COMP%_borderscale .2s ease-in;background:#337ab7}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:after{transform:rotate(-45deg) scale(1)}@keyframes _ngcontent-%COMP%_borderscale{50%{box-shadow:0 0 0 2px #337ab7}}'],changeDetection:0})}return r})(),Ro=(()=>{class r{static forRoot(){return{ngModule:r}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=wt({type:r});static \u0275inj=Ct({providers:[Oh],imports:[Ut,ag]})}return r})();function xE(r,e){r&1&&(C(0,"div",13),B(1,"Select an employee."),w())}function LE(r,e){if(r&1&&(C(0,"div",3)(1,"label",19),B(2,"Employee"),w(),G(3,"ng-multiselect-dropdown",20),$(4,xE,2,0,"div",13),w()),r&2){let t=b();_(3),S("settings",t.employeeDropdownSettings)("data",t.employees()),_(),hn(t.invalidEmployee?4:-1)}}function FE(r,e){r&1&&(C(0,"div",13),B(1,"Start date is invalid."),w())}function HE(r,e){r&1&&(C(0,"div",13),B(1," End date should be greater or equal to start date. "),w())}function UE(r,e){r&1&&(C(0,"div",13),B(1,"End date is invalid."),w())}var ay=(()=>{class r{modalService=V(Xc);userService=V(bl);eventListService=V(Sr);eventFiltersService=V(Ar);destroyRef=V(vr);isFetching=Dt(!1);error=Dt("");employees=pn(()=>this.userService.allUsers());form=new $s({employee:new jn(void 0,{validators:[Nu.required]}),comment:new jn(""),dates:new $s({startDate:new jn(new Date,{validators:[Mh()]}),endDate:new jn(new Date,{validators:[Mh()]})},{validators:[Nu.required,ty("startDate","endDate")]})});employeeDropdownSettings={singleSelection:!0,idField:"id",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:3,allowRemoteDataSearch:!0,allowSearchFilter:!0,defaultOpen:!1};get invalidEmployee(){let t=this.form.controls.employee;return t.touched&&t.invalid}get invalidStartDate(){let t=this.form.controls.dates.get("startDate");return t?.touched&&t?.errors||this.form.controls.dates.errors?.startDateNotADate}get invalidEndDate(){let t=this.form.controls.dates.get("endDate");return t?.touched&&t?.errors||this.form.controls.dates.errors?.endDateNotADate}get endDateBeforeStartDate(){let t=this.form.controls.dates;return(t.get("endDate")?.touched||t.get("startDate")?.touched)&&t?.errors&&t.errors.endsBeforeStart==!0}get currentDate(){return new Date}onSubmit(){if(this.form.markAllAsTouched(),this.form.invalid)return;let t=this.form.controls.employee.value,n=this.form.controls.comment.value,i=this.form.controls.dates.controls.startDate.value,o=this.form.controls.dates.controls.endDate.value;if(t?.[0]&&i&&o){let s=this.eventListService.createEvent(t[0].id,i,o,n).subscribe({complete:()=>this.eventFiltersService.loadFilteredEvents().subscribe(),error:a=>{this.error.set(a.message)}});this.destroyRef.onDestroy(()=>{s.unsubscribe()}),this.modalService.close()}}onCancel(){this.modalService.close()}ngOnInit(){this.isFetching.set(!0);let t=this.userService.loadUsers().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-add-event-form"]],standalone:!0,features:[mo([{provide:lg,useClass:ug}]),Ne],decls:31,vars:4,consts:[["startDate","ngbDatepicker"],["endDate","ngbDatepicker"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","comment",1,"form-label"],["type","text","id","comment","formControlName","comment",1,"form-control"],["formGroupName","dates",1,"row","mb-3"],[1,"col-6"],["for","startDate",1,"form-label"],[1,"input-group"],["ngbDatepicker","","id","startDate","formControlName","startDate",1,"form-control"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],["src","date-select-ico.svg","width","24px","height","24px"],[1,"invalid"],["for","endDate",1,"form-label"],["ngbDatepicker","","id","endDate","formControlName","endDate",1,"form-control"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-danger","btn-action"],["type","button",1,"btn","btn-secondary","ms-2","btn-action",3,"click"],["for","employee",1,"form-label"],["formControlName","employee","id","employee","name","employee","placeholder","Select employees",3,"settings","data"]],template:function(n,i){if(n&1){let o=Ce();C(0,"form",2),L("ngSubmit",function(){return P(o),N(i.onSubmit())}),$(1,LE,5,3,"div",3),C(2,"div",3)(3,"label",4),B(4,"Comment (Optional)"),w(),G(5,"input",5),w(),C(6,"div",6)(7,"div",7)(8,"label",8),B(9,"Start"),w(),C(10,"div",9),G(11,"input",10,0),C(13,"button",11),L("click",function(){P(o);let a=Pe(12);return N(a.toggle())}),G(14,"img",12),w()(),$(15,FE,2,0,"div",13)(16,HE,2,0,"div",13),w(),C(17,"div",7)(18,"label",14),B(19,"End"),w(),C(20,"div",9),G(21,"input",15,1),C(23,"button",11),L("click",function(){P(o);let a=Pe(22);return N(a.toggle())}),G(24,"img",12),w()(),$(25,UE,2,0,"div",13),w()(),C(26,"div",16)(27,"button",17),B(28,"Submit"),w(),C(29,"button",18),L("click",function(){return P(o),N(i.onCancel())}),B(30," Cancel "),w()()()}n&2&&(S("formGroup",i.form),_(),hn(i.employees()?1:-1),_(14),hn(i.invalidStartDate?15:i.endDateBeforeStartDate?16:-1),_(10),hn(i.invalidEndDate?25:-1))},dependencies:[Yc,jc,qc,fo,$c,Wc,Gc,sg,go,Qc,Ro,ga],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}.invalid[_ngcontent-%COMP%]{width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}"]})}return r})();var cy=(()=>{class r{activeModal=V(Xc);onClose(){this.activeModal.close()}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-add-event"]],standalone:!0,features:[Ne],decls:7,vars:0,consts:[[1,"modal-content","w-100"],[1,"modal-header"],["id","exampleModalLabel1",1,"modal-title"],["type","button","data-mdb-button-init","","data-mdb-ripple-init","","data-mdb-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","p-4"]],template:function(n,i){n&1&&(C(0,"div",0)(1,"div",1)(2,"h5",2),B(3,"Add Event"),w(),C(4,"button",3),L("click",function(){return i.onClose()}),w()(),C(5,"div",4),G(6,"app-add-event-form"),w()())},dependencies:[ay],changeDetection:0})}return r})();function BE(r,e){if(r&1){let t=Ce();C(0,"span",11),L("mouseenter",function(){let i=P(t).$implicit,o=b();return N(o.hoveredDate=i)})("mouseleave",function(){P(t);let i=b();return N(i.hoveredDate=null)}),B(1),w()}if(r&2){let t=e.$implicit,n=e.focused,i=b();Ve("focused",n)("range",i.isRange(t))("faded",i.isHovered(t)||i.isInside(t)),_(),yr(" ",t.day," ")}}var ly=(()=>{class r{calendar;formatter;hoveredDate=null;fromDate;toDate;constructor(t,n){this.calendar=t,this.formatter=n,this.fromDate=t.getToday(),this.toDate=t.getNext(t.getToday(),"d",10)}onDateSelection(t){this.markAsTouched(),this.disabled||(!this.fromDate&&!this.toDate?this.fromDate=t:this.fromDate&&!this.toDate&&t&&t.after(this.fromDate)?this.toDate=t:(this.toDate=null,this.fromDate=t),this.onChange({fromDate:this.fromDate,toDate:this.toDate}))}isHovered(t){return this.fromDate&&!this.toDate&&this.hoveredDate&&t.after(this.fromDate)&&t.before(this.hoveredDate)}isInside(t){return this.toDate&&t.after(this.fromDate)&&t.before(this.toDate)}isRange(t){return t.equals(this.fromDate)||this.toDate&&t.equals(this.toDate)||this.isInside(t)||this.isHovered(t)}validateInput(t,n){let i=this.formatter.parse(n);return i&&this.calendar.isValid(xu.from(i))?xu.from(i):t}touched=!1;disabled=!1;onChange=t=>{};onTouched=()=>{};writeValue(t){this.fromDate=t.fromDate,this.toDate=t.toDate}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}markAsTouched(){this.touched||(this.onTouched(),this.touched=!0)}setDisabledState(t){this.disabled=t}static \u0275fac=function(n){return new(n||r)(x(cg),x(dg))};static \u0275cmp=ue({type:r,selectors:[["app-range-datepicker"]],standalone:!0,features:[mo([{provide:Kc,multi:!0,useExisting:r}]),Ne],decls:13,vars:6,consts:[["datepicker","ngbDatepicker"],["t",""],["dpFromDate",""],["dpToDate",""],[1,"col-12"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"dateSelect","autoClose","displayMonths","dayTemplate","startDate"],["placeholder","yyyy-mm-dd","name","dpFromDate",1,"form-control",3,"input","value"],["placeholder","yyyy-mm-dd","name","dpToDate",1,"form-control",3,"input","value"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(n,i){if(n&1){let o=Ce();C(0,"div",4)(1,"div",5)(2,"div",6)(3,"input",7,0),L("dateSelect",function(a){return P(o),N(i.onDateSelection(a))}),w(),$(5,BE,2,7,"ng-template",null,1,Ot),w()(),C(7,"div",6)(8,"input",8,2),L("input",function(){P(o);let a=Pe(9);return N(i.fromDate=i.validateInput(i.fromDate,a.value))}),w(),C(10,"input",9,3),L("input",function(){P(o);let a=Pe(11);return N(i.toDate=i.validateInput(i.toDate,a.value))}),w(),C(12,"button",10),L("click",function(){P(o);let a=Pe(4);return N(a.toggle())}),w()()()}if(n&2){let o=Pe(6);_(3),S("autoClose","outside")("displayMonths",2)("dayTemplate",o)("startDate",i.fromDate),_(5),S("value",i.formatter.format(i.fromDate)),_(2),S("value",i.formatter.format(i.toDate))}},dependencies:[go,Qc],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]})}return r})();function VE(r,e){if(r&1){let t=Ce();C(0,"div",1)(1,"label",2),B(2,"Employee"),w(),G(3,"ng-multiselect-dropdown",3),w(),C(4,"div",1)(5,"label",2),B(6,"Status"),w(),G(7,"ng-multiselect-dropdown",4),w(),C(8,"div",1)(9,"label",5),B(10,"Event dates"),w(),G(11,"app-range-datepicker",6),w(),C(12,"div",7)(13,"button",8),B(14,"Apply"),w(),C(15,"button",9),L("click",function(){P(t);let i=b();return N(i.onClose())}),B(16," Cancel "),w()()}if(r&2){let t=b();_(3),S("settings",t.employeeDropdownSettings)("data",t.employees()),_(4),S("settings",t.statusDropdownSettings)("data",t.statuses)}}var dy=(()=>{class r{userService=V(bl);offCanvasService=V(Jc);eventFiltersService=V(Ar);destroyRef=V(vr);isFetching=Dt(!1);error=Dt("");employeeDropdownSettings={singleSelection:!1,selectAllText:"Select All",unSelectAllText:"UnSelect All",idField:"id",textField:"name",itemsShowLimit:3,allowRemoteDataSearch:!0,allowSearchFilter:!0,defaultOpen:!1};statusDropdownSettings={singleSelection:!1,selectAllText:"Select All",unSelectAllText:"Unselect All",itemsShowLimit:3,allowRemoteDataSearch:!1,allowSearchFilter:!1,defaultOpen:!1};employees=pn(()=>this.userService.allUsers());statuses=Object.keys(wg).filter(t=>isNaN(Number(t)));activeFilters=this.eventFiltersService.readonlyEventFilters;form=new $s({employee:new jn(this.activeFilters()?.employee??[]),status:new jn(this.activeFilters()?.status??[]),dates:new jn(this.activeFilters()?.dates??{fromDate:null,toDate:null})});onSubmit(){if(!this.form.valid)return;let t=this.form.controls.employee.value,n=this.form.controls.status.value,i=this.form.controls.dates.value;this.eventFiltersService.setEventFilters({employee:t,status:n,dates:i}),this.offCanvasService.close()}onClose(){this.offCanvasService.close()}ngOnInit(){this.isFetching.set(!0);let t=this.userService.loadUsers().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-event-filters-form"]],standalone:!0,features:[Ne],decls:2,vars:2,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","employee",1,"form-label"],["formControlName","employee","id","employee","name","employee","placeholder","Select employees",3,"settings","data"],["formControlName","status","id","status","name","status","placeholder","Select status",3,"settings","data"],["for","dates",1,"form-label"],["id","dates","name","dates","formControlName","dates"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-outline-secondary","ms-2",3,"click"]],template:function(n,i){n&1&&(C(0,"form",0),L("ngSubmit",function(){return i.onSubmit()}),$(1,VE,17,4),w()),n&2&&(S("formGroup",i.form),_(),hn(i.employees()?1:-1))},dependencies:[Yc,jc,fo,$c,Wc,Gc,Ro,ga,go,ly],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}.invalid[_ngcontent-%COMP%]{width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}"]})}return r})();var uy=(()=>{class r{offCanvasService=V(Jc);onClose(){this.offCanvasService.close()}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-event-filters"]],standalone:!0,features:[Ne],decls:7,vars:0,consts:[[1,"offcanvas-header"],[1,"offcanvas-title"],["type","button","aria-label","Close",1,"btn-close","text-reset",3,"click"],[1,"offcanvas-body"],[1,"row","mb-2"]],template:function(n,i){n&1&&(C(0,"div",0)(1,"h5",1),B(2,"Filter events"),w(),C(3,"button",2),L("click",function(){return i.onClose()}),w()(),C(4,"div",3)(5,"div",4),G(6,"app-event-filters-form"),w()())},dependencies:[dy],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}"]})}return r})();function zE(r,e){if(r&1){let t=Ce();C(0,"button",15),L("click",function(){P(t);let i=b();return N(i.onClearFilters())}),B(1," Clear "),w()}}var hy=(()=>{class r{modalService=V(yg);offcanvasService=V(Cg);eventFiltersService=V(Ar);eventListService=V(Sr);activeFilters=this.eventFiltersService.readonlyEventFilters;viewMode=pn(()=>vo[this.eventListService.readonlyViewMode()]);onAddEvent(){this.modalService.open(cy)}onOpenFiltersMenu(){this.offcanvasService.open(uy,{backdrop:"static"})}onClearFilters(){this.eventFiltersService.clearFilters()}switchCardsMode(){this.eventListService.changeViewMode(vo.Cards)}switchTableMode(){this.eventListService.changeViewMode(vo.Table)}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-event-list-header"]],standalone:!0,features:[Ne],decls:17,vars:5,consts:[[1,"px-3","py-2","border-bottom","mb-3"],[1,"container-flex","d-flex","flex-wrap"],[1,"col-12","col-lg-auto","mb-lg-0","me-lg-auto"],["type","button",1,"btn","btn-outline-primary","btn-menu","me-2",3,"click"],[1,"bi","bi-filter"],["type","button",1,"btn","btn-outline-secondary","me-2"],[1,"text-end"],["type","button",1,"btn","btn-outline-primary","me-2",3,"click"],["ngbDropdown","",1,"d-inline-block","me-2"],["type","button","id","mode-dropdown","ngbDropdownToggle","",1,"btn","btn-outline-primary","dropdown-toggle"],[1,"bi","bi-three-dots-vertical"],["ngbDropdownMenu",""],["ngbDropdownItem","",1,"btn","py-2","btn-outline-primary",3,"click"],[1,"bi","bi-table"],[1,"bi","bi-list-ul"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click"]],template:function(n,i){n&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),L("click",function(){return i.onOpenFiltersMenu()}),G(4,"i",4),w(),$(5,zE,2,0,"button",5),w(),C(6,"div",6)(7,"button",7),L("click",function(){return i.onAddEvent()}),B(8," Add Event "),w(),C(9,"div",8)(10,"button",9),G(11,"i",10),w(),C(12,"div",11)(13,"button",12),L("click",function(){return i.switchTableMode()}),G(14,"i",13),w(),C(15,"button",12),L("click",function(){return i.switchCardsMode()}),G(16,"i",14),w()()()()()()),n&2&&(_(5),hn(i.activeFilters()?5:-1),_(8),Ve("active",i.viewMode()==="Table"),_(2),Ve("active",i.viewMode()==="Cards"))},dependencies:[vg,gg,fg,mg,hg,pg],styles:[".dropdown-menu[_ngcontent-%COMP%]{min-width:60px;text-align:center}.dropdown-item[_ngcontent-%COMP%]{padding:.5rem;font-size:1.5rem}.dropdown-item[_ngcontent-%COMP%]:not(:focus):not(.active){color:#0d6efd!important}"]})}return r})();var py=(r,e)=>e.id,KE=()=>[import("./chunk-QB653Y55.js").then(r=>r.EventCardComponent),import("./chunk-QYM357GF.js").then(r=>r.EventListTableRowComponent)];function qE(r,e){if(r&1&&G(0,"app-event-list-table-row",7),r&2){let t=e.$implicit;S("card",t)}}function $E(r,e){if(r&1&&(C(0,"table",0)(1,"thead",3)(2,"tr",4)(3,"th",5),B(4,"Name"),w(),C(5,"th",6),B(6,"Dates"),w(),C(7,"th",5),B(8,"Approvals"),w(),C(9,"th",5),B(10,"Status"),w(),C(11,"th",5),B(12,"Actions"),w()()(),C(13,"tbody"),Su(14,qE,1,1,"app-event-list-table-row",7,py),w()()),r&2){let t=b(2);_(14),Au(t.cards())}}function jE(r,e){if(r&1&&G(0,"app-event-card",8),r&2){let t=e.$implicit;S("card",t)}}function WE(r,e){if(r&1&&(C(0,"div",1),Su(1,jE,1,1,"app-event-card",8,py),w()),r&2){let t=b(2);_(),Au(t.cards())}}function GE(r,e){r&1&&(C(0,"div",2)(1,"p"),B(2,"There are no added vacation requests yet."),w()())}function YE(r,e){if(r&1&&$(0,$E,16,0,"table",0)(1,WE,3,0,"div",1)(2,GE,3,0,"div",2),r&2){let t=b();hn(t.viewMode()==="Table"&&t.cards().length>0?0:t.viewMode()==="Cards"&&t.cards().length>0?1:2)}}function QE(r,e){r&1&&(C(0,"div",9),G(1,"span",10),w())}var my=(()=>{class r{eventFiltersService=V(Ar);eventListService=V(Sr);destroyRef=V(vr);cards=pn(()=>this.eventFiltersService.loadedEvents());viewMode=pn(()=>vo[this.eventListService.readonlyViewMode()]);isFetching=Dt(!1);error=Dt("");ngOnInit(){this.isFetching.set(!0);let t=this.eventFiltersService.loadFilteredEvents().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-event-list"]],standalone:!0,features:[Ne],decls:5,vars:0,consts:[[1,"table","container"],[1,"container","mt-5","d-flex","justify-content-start","flex-wrap"],[1,"row","text-center"],[1,"row"],[1,"row","ps-0","pe-4"],["scope","col",1,"col-2","ps-0","pe-0"],["scope","col",1,"col-4","ps-0","pe-0"],[1,"row",3,"card"],[3,"card"],[1,"d-flex","justify-content-center","align-items-center"],[1,"loader","align-self-center"]],template:function(n,i){n&1&&(G(0,"app-event-list-header"),$(1,YE,3,1)(2,QE,2,0),Df(3,1,KE,null,2),Mf())},dependencies:[hy],styles:[".loader[_ngcontent-%COMP%]{width:48px;height:48px;border:5px solid #fff;border-bottom-color:#ff3d00;border-radius:50%;display:inline-block;box-sizing:border-box;animation:_ngcontent-%COMP%_rotation 1s linear infinite}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],changeDetection:0})}return r})();var md={};cn(md,{blockAPICallsBeforeInitialize:()=>hd,blockAcquireTokenInPopups:()=>Jy,blockNonBrowserEnvironment:()=>Zy,blockRedirectInIframe:()=>Xy,blockReloadInHiddenIframes:()=>Qy,clearHash:()=>qp,createGuid:()=>zS,getCurrentUri:()=>Nt,getHomepage:()=>jp,invoke:()=>bt,invokeAsync:()=>A,isInIframe:()=>sc,isInPopup:()=>Yy,preconnect:()=>cc,preflightCheck:()=>ac,redirectPreflightCheck:()=>pd,replaceHash:()=>$p});var xr={};cn(xr,{checkMaxAge:()=>Fa,extractTokenClaims:()=>er,getJWSPayload:()=>yy});var y={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},Do={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},zt=[y.OPENID_SCOPE,y.PROFILE_SCOPE,y.OFFLINE_ACCESS_SCOPE],Ph=[...zt,y.EMAIL_SCOPE],_t={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},We={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},gn={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},Mo={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Le={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},kl={PLAIN:"plain",S256:"S256"},vn={QUERY:"query",FRAGMENT:"fragment"},Nh=U(g({},vn),{FORM_POST:"form_post"}),va={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},Oo={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},$e={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},J={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var ya="appmetadata",fy="client_info",Rr="1",Po={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},St={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},nt={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ge={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},Qn={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},Rl={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},Dl={username:"username",password:"password"},Ca={httpSuccess:200,httpBadRequest:400},pi={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Ml={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},yn={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},Ol={Jwt:"JWT",Jwk:"JWK",Pop:"pop"};var xh=300;var mi={};cn(mi,{postRequestFailed:()=>Ta,unexpectedError:()=>wa});var wa="unexpected_error",Ta="post_request_failed";var Pl={[wa]:"Unexpected error in authentication.",[Ta]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},gy={unexpectedError:{code:wa,desc:Pl[wa]},postRequestFailed:{code:Ta,desc:Pl[Ta]}},ve=class r extends Error{constructor(e,t,n){let i=t?`${e}: ${t}`:e;super(i),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||y.EMPTY_STRING,this.errorMessage=t||y.EMPTY_STRING,this.subError=n||y.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function _a(r,e){return new ve(r,e?`${Pl[r]} ${e}`:Pl[r])}var rt={};cn(rt,{authTimeNotFound:()=>Xn,authorizationCodeMissingFromServerResponse:()=>Ri,bindingKeyNotRemoved:()=>Di,cannotAppendScopeSet:()=>Ii,cannotRemoveEmptyScope:()=>Ai,clientInfoDecodingError:()=>Dr,clientInfoEmptyError:()=>fi,deviceCodeExpired:()=>Ia,deviceCodePollingCancelled:()=>Aa,deviceCodeUnknownError:()=>ba,emptyInputScopeSet:()=>Pr,endSessionEndpointNotSupported:()=>Mi,endpointResolutionError:()=>At,hashNotDeserialized:()=>Ci,invalidAssertion:()=>Da,invalidCacheEnvironment:()=>Zn,invalidCacheRecord:()=>bi,invalidClientCredential:()=>Ma,invalidState:()=>Cn,keyIdMissing:()=>Oi,maxAgeTranspired:()=>_i,methodNotImplemented:()=>ae,missingTenantIdError:()=>xa,multipleMatchingAccounts:()=>Sa,multipleMatchingAppMetadata:()=>Ei,multipleMatchingTokens:()=>Ea,nestedAppAuthBridgeDisabled:()=>La,networkError:()=>vi,noAccountFound:()=>ka,noAccountInSilentRequest:()=>Jn,noCryptoObject:()=>Nr,noNetworkConnectivity:()=>Pa,nonceMismatch:()=>Ti,nullOrEmptyToken:()=>gi,openIdConfigError:()=>yi,requestCannotBeMade:()=>Si,stateMismatch:()=>wi,stateNotFound:()=>Or,tokenClaimsCnfRequiredForSignedJwt:()=>ki,tokenParsingError:()=>Mr,tokenRefreshRequired:()=>Rn,unexpectedCredentialType:()=>Ra,userCanceled:()=>Na,userTimeoutReached:()=>Oa});var Dr="client_info_decoding_error",fi="client_info_empty_error",Mr="token_parsing_error",gi="null_or_empty_token",At="endpoints_resolution_error",vi="network_error",yi="openid_config_error",Ci="hash_not_deserialized",Cn="invalid_state",wi="state_mismatch",Or="state_not_found",Ti="nonce_mismatch",Xn="auth_time_not_found",_i="max_age_transpired",Ea="multiple_matching_tokens",Sa="multiple_matching_accounts",Ei="multiple_matching_appMetadata",Si="request_cannot_be_made",Ai="cannot_remove_empty_scope",Ii="cannot_append_scopeset",Pr="empty_input_scopeset",Aa="device_code_polling_cancelled",Ia="device_code_expired",ba="device_code_unknown_error",Jn="no_account_in_silent_request",bi="invalid_cache_record",Zn="invalid_cache_environment",ka="no_account_found",Nr="no_crypto_object",Ra="unexpected_credential_type",Da="invalid_assertion",Ma="invalid_client_credential",Rn="token_refresh_required",Oa="user_timeout_reached",ki="token_claims_cnf_required_for_signedjwt",Ri="authorization_code_missing_from_server_response",Di="binding_key_not_removed",Mi="end_session_endpoint_not_supported",Oi="key_id_missing",Pa="no_network_connectivity",Na="user_canceled",xa="missing_tenant_id_error",ae="method_not_implemented",La="nested_app_auth_bridge_disabled";var ce={[Dr]:"The client info could not be parsed/decoded correctly",[fi]:"The client info was empty",[Mr]:"Token cannot be parsed",[gi]:"The token is null or empty",[At]:"Endpoints cannot be resolved",[vi]:"Network request failed",[yi]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Ci]:"The hash parameters could not be deserialized",[Cn]:"State was not the expected format",[wi]:"State mismatch error",[Or]:"State not found",[Ti]:"Nonce mismatch error",[Xn]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[_i]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Ea]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Sa]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Ei]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Si]:"Token request cannot be made without authorization code or refresh token.",[Ai]:"Cannot remove null or empty scope from ScopeSet",[Ii]:"Cannot append ScopeSet",[Pr]:"Empty input ScopeSet cannot be processed",[Aa]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[Ia]:"Device code is expired.",[ba]:"Device code stopped polling for unknown reasons.",[Jn]:"Please pass an account object, silent flow is not supported without account information",[bi]:"Cache record object was null or undefined.",[Zn]:"Invalid environment when attempting to create cache entry",[ka]:"No account found in cache for given key.",[Nr]:"No crypto object detected.",[Ra]:"Unexpected credential type.",[Da]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Ma]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Rn]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[Oa]:"User defined timeout for device code polling reached",[ki]:"Cannot generate a POP jwt if the token_claims are not populated",[Ri]:"Server response does not contain an authorization code to proceed",[Di]:"Could not remove the credential's binding key from storage.",[Mi]:"The provided authority does not support logout",[Oi]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Pa]:"No network connectivity. Check your internet connection.",[Na]:"User cancelled the flow.",[xa]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[ae]:"This method has not been implemented",[La]:"The nested app auth bridge is disabled"},vy={clientInfoDecodingError:{code:Dr,desc:ce[Dr]},clientInfoEmptyError:{code:fi,desc:ce[fi]},tokenParsingError:{code:Mr,desc:ce[Mr]},nullOrEmptyToken:{code:gi,desc:ce[gi]},endpointResolutionError:{code:At,desc:ce[At]},networkError:{code:vi,desc:ce[vi]},unableToGetOpenidConfigError:{code:yi,desc:ce[yi]},hashNotDeserialized:{code:Ci,desc:ce[Ci]},invalidStateError:{code:Cn,desc:ce[Cn]},stateMismatchError:{code:wi,desc:ce[wi]},stateNotFoundError:{code:Or,desc:ce[Or]},nonceMismatchError:{code:Ti,desc:ce[Ti]},authTimeNotFoundError:{code:Xn,desc:ce[Xn]},maxAgeTranspired:{code:_i,desc:ce[_i]},multipleMatchingTokens:{code:Ea,desc:ce[Ea]},multipleMatchingAccounts:{code:Sa,desc:ce[Sa]},multipleMatchingAppMetadata:{code:Ei,desc:ce[Ei]},tokenRequestCannotBeMade:{code:Si,desc:ce[Si]},removeEmptyScopeError:{code:Ai,desc:ce[Ai]},appendScopeSetError:{code:Ii,desc:ce[Ii]},emptyInputScopeSetError:{code:Pr,desc:ce[Pr]},DeviceCodePollingCancelled:{code:Aa,desc:ce[Aa]},DeviceCodeExpired:{code:Ia,desc:ce[Ia]},DeviceCodeUnknownError:{code:ba,desc:ce[ba]},NoAccountInSilentRequest:{code:Jn,desc:ce[Jn]},invalidCacheRecord:{code:bi,desc:ce[bi]},invalidCacheEnvironment:{code:Zn,desc:ce[Zn]},noAccountFound:{code:ka,desc:ce[ka]},noCryptoObj:{code:Nr,desc:ce[Nr]},unexpectedCredentialType:{code:Ra,desc:ce[Ra]},invalidAssertion:{code:Da,desc:ce[Da]},invalidClientCredential:{code:Ma,desc:ce[Ma]},tokenRefreshRequired:{code:Rn,desc:ce[Rn]},userTimeoutReached:{code:Oa,desc:ce[Oa]},tokenClaimsRequired:{code:ki,desc:ce[ki]},noAuthorizationCodeFromServer:{code:Ri,desc:ce[Ri]},bindingKeyNotRemovedError:{code:Di,desc:ce[Di]},logoutNotSupported:{code:Mi,desc:ce[Mi]},keyIdMissing:{code:Oi,desc:ce[Oi]},noNetworkConnectivity:{code:Pa,desc:ce[Pa]},userCanceledError:{code:Na,desc:ce[Na]},missingTenantIdError:{code:xa,desc:ce[xa]},nestedAppAuthBridgeDisabled:{code:La,desc:ce[La]}},Pi=class r extends ve{constructor(e,t){super(e,t?`${ce[e]}: ${t}`:ce[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function E(r,e){return new Pi(r,e)}function er(r,e){let t=yy(r);try{let n=e(t);return JSON.parse(n)}catch{throw E(Mr)}}function yy(r){if(!r)throw E(gi);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw E(Mr);return t[2]}function Fa(r,e){if(e===0||Date.now()-3e5>r+e)throw E(_i)}var Hl={};cn(Hl,{createDiscoveredInstance:()=>jh});var It={Default:0,Adfs:1,Dsts:2,Ciam:3};function Cy(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}var wn={};cn(wn,{authorityMismatch:()=>qa,authorityUriInsecure:()=>xi,cannotAllowNativeBroker:()=>Ka,cannotSetOIDCOptions:()=>za,claimsRequestParsingError:()=>Ha,emptyInputScopesError:()=>Fi,invalidAuthenticationHeader:()=>Va,invalidAuthorityMetadata:()=>zi,invalidClaims:()=>tr,invalidCloudDiscoveryMetadata:()=>Lr,invalidCodeChallengeMethod:()=>Vi,invalidPromptValue:()=>Hi,logoutRequestEmpty:()=>Bi,missingNonceAuthenticationHeader:()=>Ba,missingSshJwk:()=>rr,missingSshKid:()=>Ua,pkceParamsMissing:()=>nr,redirectUriEmpty:()=>Ni,tokenRequestEmpty:()=>Ui,untrustedAuthority:()=>Ki,urlEmptyError:()=>Li,urlParseError:()=>Dn});var Ni="redirect_uri_empty",Ha="claims_request_parsing_error",xi="authority_uri_insecure",Dn="url_parse_error",Li="empty_url_error",Fi="empty_input_scopes_error",Hi="invalid_prompt_value",tr="invalid_claims",Ui="token_request_empty",Bi="logout_request_empty",Vi="invalid_code_challenge_method",nr="pkce_params_missing",Lr="invalid_cloud_discovery_metadata",zi="invalid_authority_metadata",Ki="untrusted_authority",rr="missing_ssh_jwk",Ua="missing_ssh_kid",Ba="missing_nonce_authentication_header",Va="invalid_authentication_header",za="cannot_set_OIDCOptions",Ka="cannot_allow_native_broker",qa="authority_mismatch";var ze={[Ni]:"A redirect URI is required for all calls, and none has been set.",[Ha]:"Could not parse the given claims request object.",[xi]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Dn]:"URL could not be parsed into appropriate segments.",[Li]:"URL was empty or null.",[Fi]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Hi]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[tr]:"Given claims parameter must be a stringified JSON object.",[Ui]:"Token request was empty and not found in cache.",[Bi]:"The logout request was null or undefined.",[Vi]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[nr]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Lr]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[zi]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Ki]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[rr]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[Ua]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[Ba]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[Va]:"Invalid authentication header provided",[za]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[Ka]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[qa]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},wy={redirectUriNotSet:{code:Ni,desc:ze[Ni]},claimsRequestParsingError:{code:Ha,desc:ze[Ha]},authorityUriInsecure:{code:xi,desc:ze[xi]},urlParseError:{code:Dn,desc:ze[Dn]},urlEmptyError:{code:Li,desc:ze[Li]},emptyScopesError:{code:Fi,desc:ze[Fi]},invalidPrompt:{code:Hi,desc:ze[Hi]},invalidClaimsRequest:{code:tr,desc:ze[tr]},tokenRequestEmptyError:{code:Ui,desc:ze[Ui]},logoutRequestEmptyError:{code:Bi,desc:ze[Bi]},invalidCodeChallengeMethod:{code:Vi,desc:ze[Vi]},invalidCodeChallengeParams:{code:nr,desc:ze[nr]},invalidCloudDiscoveryMetadata:{code:Lr,desc:ze[Lr]},invalidAuthorityMetadata:{code:zi,desc:ze[zi]},untrustedAuthority:{code:Ki,desc:ze[Ki]},missingSshJwk:{code:rr,desc:ze[rr]},missingSshKid:{code:Ua,desc:ze[Ua]},missingNonceAuthenticationHeader:{code:Ba,desc:ze[Ba]},invalidAuthenticationHeader:{code:Va,desc:ze[Va]},cannotSetOIDCOptions:{code:za,desc:ze[za]},cannotAllowNativeBroker:{code:Ka,desc:ze[Ka]},authorityMismatch:{code:qa,desc:ze[qa]}},$a=class r extends ve{constructor(e){super(e,ze[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function ye(r){return new $a(r)}var He=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),i=o=>decodeURIComponent(o.replace(/\+/g," "));return n.forEach(o=>{if(o.trim()){let[s,a]=o.split(/=(.+)/g,2);s&&a&&(t[i(s)]=i(a))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var Fr={};cn(Fr,{getDeserializedResponse:()=>Lh,stripLeadingHashOrQuery:()=>Ty});function Ty(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function Lh(r){if(!r||r.indexOf("=")<0)return null;try{let e=Ty(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw E(Ci)}return null}var de=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw ye(Li);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return He.endsWith(t,"?")?t=t.slice(0,-1):He.endsWith(t,"?/")&&(t=t.slice(0,-2)),He.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw ye(Dn)}if(!e.HostNameAndPort||!e.PathSegments)throw ye(Dn);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw ye(xi)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===gn.COMMON||n[0]===gn.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ye(Dn);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},i=n.AbsolutePath.split("/");return i=i.filter(o=>o&&o.length>0),n.PathSegments=i,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw ye(Dn);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===y.FORWARD_SLASH){let i=new r(t).getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Lh(e)}};var Ey={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Fh=Ey.endpointMetadata,Hh=Ey.instanceDiscoveryMetadata,Uh=new Set;Hh.metadata.forEach(r=>{r.aliases.forEach(e=>{Uh.add(e)})});function Sy(r,e){let t,n=r.canonicalAuthority;if(n){let i=new de(n).getUrlComponents().HostNameAndPort;t=_y(i,r.cloudDiscoveryMetadata?.metadata,St.CONFIG,e)||_y(i,Hh.metadata,St.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function _y(r,e,t,n){if(n?.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let i=ja(e,r);if(i)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),i.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function Ay(r){return ja(Hh.metadata,r)}function ja(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var ft={AAD:"AAD",OIDC:"OIDC"};var Hr={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};function Iy(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function by(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var h={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",PopupClientTokenHelper:"popupClientTokenHelper",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},CP=new Map([[h.AcquireTokenByCode,"ATByCode"],[h.AcquireTokenByRefreshToken,"ATByRT"],[h.AcquireTokenSilent,"ATS"],[h.AcquireTokenSilentAsync,"ATSAsync"],[h.AcquireTokenPopup,"ATPopup"],[h.AcquireTokenRedirect,"ATRedirect"],[h.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[h.CryptoOptsSignJwt,"CryptoSignJwt"],[h.SilentCacheClientAcquireToken,"SltCacheClientAT"],[h.SilentIframeClientAcquireToken,"SltIframeClientAT"],[h.SilentRefreshClientAcquireToken,"SltRClientAT"],[h.SsoSilent,"SsoSlt"],[h.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[h.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[h.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[h.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[h.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[h.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[h.BrokerHandhshake,"BrokerHandshake"],[h.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[h.AcquireTokenByBroker,"ATByBroker"],[h.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[h.RefreshTokenClientAcquireToken,"RTClientAT"],[h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[h.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[h.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[h.AcquireTokenFromCache,"ATFromCache"],[h.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[h.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[h.AcquireTokenBySilentIframe,"ATBySltIframe"],[h.InitializeBaseRequest,"InitBaseReq"],[h.InitializeSilentRequest,"InitSltReq"],[h.InitializeClientApplication,"InitClientApplication"],[h.SilentIframeClientTokenHelper,"SIClientTHelper"],[h.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[h.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[h.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[h.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[h.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[h.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[h.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[h.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[h.GetAuthCodeUrl,"GetAuthCodeUrl"],[h.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[h.HandleCodeResponse,"HandleCodeResp"],[h.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[h.AuthClientAcquireToken,"AuthClientAT"],[h.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[h.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[h.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[h.PopTokenGenerateCnf,"PopTGenCnf"],[h.PopTokenGenerateKid,"PopTGenKid"],[h.HandleServerTokenResponse,"HandleServerTRes"],[h.DeserializeResponse,"DeserializeRes"],[h.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[h.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[h.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[h.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[h.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[h.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[h.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[h.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[h.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[h.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[h.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[h.AcquireTokenByCodeAsync,"ATByCodeAsync"],[h.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[h.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[h.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[h.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[h.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[h.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[h.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[h.NativeGenerateAuthResult,"NtvGenAuthRes"],[h.RemoveHiddenIframe,"RemoveHiddenIframe"],[h.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[h.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[h.GeneratePkceCodes,"GenPkceCodes"],[h.GenerateCodeVerifier,"GenCodeVerifier"],[h.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[h.Sha256Digest,"Sha256Digest"],[h.GetRandomValues,"GetRandomValues"]]),Bh={NotStarted:0,InProgress:1,Completed:2};var bt=(r,e,t,n,i)=>(...o)=>{t.trace(`Executing function ${e}`);let s=n?.startMeasurement(e,i);if(i){let a=e+"CallCount";n?.incrementFields({[a]:1},i)}try{let a=r(...o);return s?.end({success:!0}),t.trace(`Returning result from ${e}`),a}catch(a){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw s?.end({success:!1},a),a}},A=(r,e,t,n,i)=>(...o)=>{t.trace(`Executing function ${e}`);let s=n?.startMeasurement(e,i);if(i){let a=e+"CallCount";n?.incrementFields({[a]:1},i)}return n?.setPreQueueTime(e,i),r(...o).then(a=>(t.trace(`Returning result from ${e}`),s?.end({success:!0}),a)).catch(a=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(a))}catch{t.trace("Unable to print error message.")}throw s?.end({success:!1},a),a})};var ky=(()=>{class r{constructor(t,n,i,o){this.networkInterface=t,this.logger=n,this.performanceClient=i,this.correlationId=o}detectRegion(t,n){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.RegionDiscoveryDetectRegion,this.correlationId);let i=t;if(i)n.region_source=pi.ENVIRONMENT_VARIABLE;else{let o=r.IMDS_OPTIONS;try{let s=yield A(this.getRegionFromIMDS.bind(this),h.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(y.IMDS_VERSION,o);if(s.status===Ca.httpSuccess&&(i=s.body,n.region_source=pi.IMDS),s.status===Ca.httpBadRequest){let a=yield A(this.getCurrentVersion.bind(this),h.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!a)return n.region_source=pi.FAILED_AUTO_DETECTION,null;let c=yield A(this.getRegionFromIMDS.bind(this),h.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(a,o);c.status===Ca.httpSuccess&&(i=c.body,n.region_source=pi.IMDS)}}catch{return n.region_source=pi.FAILED_AUTO_DETECTION,null}}return i||(n.region_source=pi.FAILED_AUTO_DETECTION),i||null})}getRegionFromIMDS(t,n){return f(this,null,function*(){return this.performanceClient?.addQueueMeasurement(h.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${y.IMDS_ENDPOINT}?api-version=${t}&format=text`,n,y.IMDS_TIMEOUT)})}getCurrentVersion(t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let n=yield this.networkInterface.sendGetRequestAsync(`${y.IMDS_ENDPOINT}?format=json`,t);return n.status===Ca.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch{return null}})}}return r.IMDS_OPTIONS={headers:{Metadata:"true"}},r})();var Me={};cn(Me,{createAccessTokenEntity:()=>Kh,createIdTokenEntity:()=>zh,createRefreshTokenEntity:()=>qh,generateAppMetadataKey:()=>cS,generateAuthorityMetadataExpiresAt:()=>xl,generateCredentialKey:()=>Ga,isAccessTokenEntity:()=>JE,isAppMetadataEntity:()=>lS,isAuthorityMetadataEntity:()=>dS,isAuthorityMetadataExpired:()=>Ll,isCredentialEntity:()=>Nl,isIdTokenEntity:()=>ZE,isRefreshTokenEntity:()=>eS,isServerTelemetryEntity:()=>sS,isThrottlingEntity:()=>aS,updateAuthorityEndpointMetadata:()=>xo,updateCloudDiscoveryMetadata:()=>Ya});var Wa={};cn(Wa,{delay:()=>XE,isTokenExpired:()=>No,nowSeconds:()=>Kt,wasClockTurnedBack:()=>Vh});function Kt(){return Math.round(new Date().getTime()/1e3)}function No(r,e){let t=Number(r)||0;return Kt()+e>t}function Vh(r){return Number(r)>Kt()}function XE(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function Ga(r){return[tS(r),nS(r),rS(r),iS(r),oS(r)].join($e.CACHE_KEY_SEPARATOR).toLowerCase()}function zh(r,e,t,n,i){return{credentialType:J.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:i}}function Kh(r,e,t,n,i,o,s,a,c,l,d,u,m,p,v){let T={homeAccountId:r,credentialType:J.ACCESS_TOKEN,secret:t,cachedAt:Kt().toString(),expiresOn:s.toString(),extendedExpiresOn:a.toString(),environment:e,clientId:n,realm:i,target:o,tokenType:d||ge.BEARER};if(u&&(T.userAssertionHash=u),l&&(T.refreshOn=l.toString()),p&&(T.requestedClaims=p,T.requestedClaimsHash=v),T.tokenType?.toLowerCase()!==ge.BEARER.toLowerCase())switch(T.credentialType=J.ACCESS_TOKEN_WITH_AUTH_SCHEME,T.tokenType){case ge.POP:let I=er(t,c);if(!I?.cnf?.kid)throw E(ki);T.keyId=I.cnf.kid;break;case ge.SSH:T.keyId=m}return T}function qh(r,e,t,n,i,o,s){let a={credentialType:J.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return o&&(a.userAssertionHash=o),i&&(a.familyId=i),s&&(a.expiresOn=s.toString()),a}function Nl(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function JE(r){return r?Nl(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===J.ACCESS_TOKEN||r.credentialType===J.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function ZE(r){return r?Nl(r)&&r.hasOwnProperty("realm")&&r.credentialType===J.ID_TOKEN:!1}function eS(r){return r?Nl(r)&&r.credentialType===J.REFRESH_TOKEN:!1}function tS(r){return[r.homeAccountId,r.environment].join($e.CACHE_KEY_SEPARATOR).toLowerCase()}function nS(r){let e=r.credentialType===J.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join($e.CACHE_KEY_SEPARATOR).toLowerCase()}function rS(r){return(r.target||"").toLowerCase()}function iS(r){return(r.requestedClaimsHash||"").toLowerCase()}function oS(r){return r.tokenType&&r.tokenType.toLowerCase()!==ge.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function sS(r,e){let t=r.indexOf(nt.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function aS(r,e){let t=!1;r&&(t=r.indexOf(Qn.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function cS({environment:r,clientId:e}){return[ya,r,e].join($e.CACHE_KEY_SEPARATOR).toLowerCase()}function lS(r,e){return e?r.indexOf(ya)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function dS(r,e){return e?r.indexOf(Po.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function xl(){return Kt()+Po.REFRESH_TIME_SECONDS}function xo(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function Ya(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function Ll(r){return r.expiresAt<=Kt()}var en=class r{constructor(e,t,n,i,o,s,a,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=a,this.correlationId=s,this.managedIdentity=c||!1,this.regionDiscovery=new ky(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(y.CIAM_AUTH_URL))return It.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case y.ADFS:return It.Adfs;case y.DSTS:return It.Dsts}return It.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new de(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw E(At)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw E(At)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw E(At)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw E(Mi);return this.replacePath(this.metadata.end_session_endpoint)}else throw E(At)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw E(At)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw E(At)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===It.Default&&this.protocolMode===ft.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,i=new de(this.metadata.canonical_authority).getUrlComponents(),o=i.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((a,c)=>{let l=o[c];if(c===0&&this.canReplaceTenant(i)){let d=new de(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];l!==d&&(this.logger.verbose(`Replacing tenant domain name ${l} with id ${d}`),l=d)}a!==l&&(t=t.replace(`/${l}/`,`/${a}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===It.Adfs||this.protocolMode!==ft.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=yield A(this.updateCloudDiscoveryMetadata.bind(this),h.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=yield A(this.updateEndpointMetadata.bind(this),h.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)})}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:xl(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==St.CACHE&&n?.source!==St.CACHE&&(e.expiresAt=xl(),e.canonical_authority=this.canonicalAuthority);let i=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(i,e),this.metadata=e}updateEndpointMetadata(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===St.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){let i=yield A(this.updateMetadataWithRegionalInformation.bind(this),h.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);xo(e,i,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=yield A(this.getEndpointMetadataFromNetwork.bind(this),h.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=yield A(this.updateMetadataWithRegionalInformation.bind(this),h.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),xo(e,n,!0),St.NETWORK;throw E(yi,this.defaultOpenIdConfigurationEndpoint)})}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),xo(e,t,!1),{source:St.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let i=this.getEndpointMetadataFromHardcodedValues();if(i)return xo(e,i,!1),{source:St.HARDCODED_VALUES,metadata:i};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=Ll(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:St.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new de(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw ye(zi)}return null}getEndpointMetadataFromNetwork(){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let n=yield this.networkInterface.sendGetRequestAsync(t,e);return Cy(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}})}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Fh?Fh[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==y.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Ml.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let n=yield A(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),h.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=Ml.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,r.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Ml.AUTO_DETECTION_REQUESTED_FAILED}return e})}updateCloudDiscoveryMetadata(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=yield A(this.getCloudDiscoveryMetadataFromNetwork.bind(this),h.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return Ya(e,n,!0),St.NETWORK;throw ye(Ki)})}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||y.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||y.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||y.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),Ya(e,t,!1),St.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let i=Ay(this.hostnameAndPort);if(i)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),Ya(e,i,!1),St.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=Ll(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),St.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===It.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=ja(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),ye(Lr)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${y.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let i=yield this.networkInterface.sendGetRequestAsync(e,t),o,s;if(Iy(i.body))o=i.body,s=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else if(by(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),o=i.body,o.error===y.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),s=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=ja(s,this.hostnameAndPort)}catch(i){if(i instanceof ve)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{let o=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${o.name}
Error Description: ${o.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n})}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&de.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Hr.None){let i=t.tenant?t.tenant:y.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${i}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return y.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw E(At)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return Uh.has(e)}static isPublicCloudAuthority(e){return y.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let i=new de(e);i.validateAsUri();let o=i.getUrlComponents(),s=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(s=`${t}.${y.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let a=de.constructAuthorityUriFromObject(U(g({},i.getUrlComponents()),{HostNameAndPort:s})).urlString;return n?`${a}?${n}`:a}static replaceWithRegionalInformation(e,t){let n=g({},e);return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,i=new de(e).getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(y.CIAM_AUTH_URL)){let o=i.HostNameAndPort.split(".")[0];t=`${t}${o}${y.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};en.reservedTenantDomains=new Set(["{tenant}","{tenantid}",gn.COMMON,gn.CONSUMERS,gn.ORGANIZATIONS]);function Ry(r){let n=new de(r).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case gn.COMMON:case gn.ORGANIZATIONS:case gn.CONSUMERS:return;default:return n}}function Fl(r){return r.endsWith(y.FORWARD_SLASH)?r:`${r}${y.FORWARD_SLASH}`}function $h(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch{throw ye(Lr)}return{canonicalAuthority:r.authority?Fl(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}function jh(r,e,t,n,i,o,s){return f(this,null,function*(){s?.addQueueMeasurement(h.AuthorityFactoryCreateDiscoveredInstance,o);let a=en.transformCIAMAuthority(Fl(r)),c=new en(a,e,t,n,i,o,s);try{return yield A(c.resolveEndpointsAsync.bind(c),h.AuthorityResolveEndpointsAsync,i,s,o)(),c}catch{throw E(At)}})}function Ul(r,e,t){return f(this,null,function*(){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})})}var Lo={};cn(Lo,{ACCESS_TOKEN:()=>pS,CCS_HEADER:()=>TS,CLAIMS:()=>Qh,CLIENT_ASSERTION:()=>wp,CLIENT_ASSERTION_TYPE:()=>Tp,CLIENT_ID:()=>Ur,CLIENT_INFO:()=>yS,CLIENT_REQUEST_ID:()=>sp,CLIENT_SECRET:()=>Cp,CODE:()=>np,CODE_CHALLENGE:()=>rp,CODE_CHALLENGE_METHOD:()=>ip,CODE_VERIFIER:()=>op,DEVICE_CODE:()=>yp,DOMAIN_HINT:()=>kp,ERROR:()=>uS,ERROR_DESCRIPTION:()=>hS,EXPIRES_IN:()=>fS,FOCI:()=>wS,GRANT_TYPE:()=>Yh,ID_TOKEN:()=>mS,ID_TOKEN_HINT:()=>vp,LOGIN_HINT:()=>bp,LOGOUT_HINT:()=>Ap,NATIVE_BROKER:()=>Sp,NONCE:()=>ep,OBO_ASSERTION:()=>_p,ON_BEHALF_OF:()=>CS,POST_LOGOUT_URI:()=>gp,PROMPT:()=>tp,REDIRECT_URI:()=>Wh,REFRESH_TOKEN:()=>Jh,REFRESH_TOKEN_EXPIRES_IN:()=>gS,REQUESTED_TOKEN_USE:()=>Ep,REQ_CNF:()=>zl,RESPONSE_MODE:()=>Gh,RESPONSE_TYPE:()=>Bl,RETURN_SPA_CODE:()=>Kl,SCOPE:()=>Xh,SESSION_STATE:()=>vS,SID:()=>Ip,STATE:()=>Zh,TOKEN_TYPE:()=>Vl,X_APP_NAME:()=>mp,X_APP_VER:()=>fp,X_CLIENT_CPU:()=>dp,X_CLIENT_CURR_TELEM:()=>up,X_CLIENT_EXTRA_SKU:()=>_S,X_CLIENT_LAST_TELEM:()=>hp,X_CLIENT_OS:()=>lp,X_CLIENT_SKU:()=>ap,X_CLIENT_VER:()=>cp,X_MS_LIB_CAPABILITY:()=>pp});var Ur="client_id",Wh="redirect_uri",Bl="response_type",Gh="response_mode",Yh="grant_type",Qh="claims",Xh="scope",uS="error",hS="error_description",pS="access_token",mS="id_token",Jh="refresh_token",fS="expires_in",gS="refresh_token_expires_in",Zh="state",ep="nonce",tp="prompt",vS="session_state",yS="client_info",np="code",rp="code_challenge",ip="code_challenge_method",op="code_verifier",sp="client-request-id",ap="x-client-SKU",cp="x-client-VER",lp="x-client-OS",dp="x-client-CPU",up="x-client-current-telemetry",hp="x-client-last-telemetry",pp="x-ms-lib-capability",mp="x-app-name",fp="x-app-ver",gp="post_logout_redirect_uri",vp="id_token_hint",yp="device_code",Cp="client_secret",wp="client_assertion",Tp="client_assertion_type",Vl="token_type",zl="req_cnf",_p="assertion",Ep="requested_token_use",CS="on_behalf_of",wS="foci",TS="X-AnchorMailbox",Kl="return_spa_code",Sp="nativebroker",Ap="logout_hint",Ip="sid",bp="login_hint",kp="domain_hint",_S="x-client-xtra-sku";var Br={createNewGuid:()=>{throw E(ae)},base64Decode:()=>{throw E(ae)},base64Encode:()=>{throw E(ae)},base64UrlEncode:()=>{throw E(ae)},encodeKid:()=>{throw E(ae)},getPublicKeyThumbprint(){return f(this,null,function*(){throw E(ae)})},removeTokenBindingKey(){return f(this,null,function*(){throw E(ae)})},clearKeystore(){return f(this,null,function*(){throw E(ae)})},signJwt(){return f(this,null,function*(){throw E(ae)})},hashString(){return f(this,null,function*(){throw E(ae)})}};var Se=function(r){return r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace",r}(Se||{}),tn=class r{constructor(e,t,n){this.level=Se.Info;let i=()=>{},o=e||r.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||i,this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level=typeof o.logLevel=="number"?o.logLevel:Se.Info,this.correlationId=o.correlationId||y.EMPTY_STRING,this.packageName=t||y.EMPTY_STRING,this.packageVersion=n||y.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Se.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let o=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${Se[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,o,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:Se.Error,containsPii:!1,correlationId:t||y.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:Se.Error,containsPii:!0,correlationId:t||y.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:Se.Warning,containsPii:!1,correlationId:t||y.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:Se.Warning,containsPii:!0,correlationId:t||y.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:Se.Info,containsPii:!1,correlationId:t||y.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:Se.Info,containsPii:!0,correlationId:t||y.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:Se.Verbose,containsPii:!1,correlationId:t||y.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:Se.Verbose,containsPii:!0,correlationId:t||y.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:Se.Trace,containsPii:!1,correlationId:t||y.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:Se.Trace,containsPii:!0,correlationId:t||y.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var ql="@azure/msal-common",Fo="14.14.1";var Fe=class r{constructor(e){let t=e?He.trimArrayEntries([...e]):[],n=t?He.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(i=>this.scopes.add(i))}static fromString(e){let n=(e||y.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(y.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw ye(Fi)}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return Ph.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw E(Ii)}}removeScope(e){if(!e)throw E(Ai);this.scopes.delete(e.trim())}removeOIDCScopes(){Ph.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw E(Pr);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw E(Pr);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),i=this.getScopeCount();return t.size<i+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):y.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function Ho(r,e){if(!r)throw E(fi);try{let t=e(r);return JSON.parse(t)}catch{throw E(Dr)}}function ir(r){if(!r)throw E(Dr);let e=r.split($e.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?y.EMPTY_STRING:e[1]}}function Uo(r,e){return!!r&&!!e&&r===e.split(".")[1]}function Bo(r,e,t,n){if(n){let{oid:i,sub:o,tid:s,name:a,tfp:c,acr:l}=n,d=s||c||l||"";return{tenantId:d,localAccountId:i||o||"",name:a,isHomeTenant:Uo(d,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:Uo(t,r)}}function qi(r,e,t,n){let i=r;if(e){let o=e,{isHomeTenant:a}=o,c=Rt(o,["isHomeTenant"]);i=g(g({},r),c)}if(t){let s=Bo(r.homeAccountId,r.localAccountId,r.tenantId,t),{isHomeTenant:a}=s,c=Rt(s,["isHomeTenant"]);return i=U(g(g({},i),c),{idTokenClaims:t,idToken:n}),i}return i}function $l(r){return r&&(r.tid||r.tfp||r.acr)||null}var Oe=class r{generateAccountId(){return[this.homeAccountId,this.environment].join($e.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join($e.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){let i=new r;t.authorityType===It.Adfs?i.authorityType=Oo.ADFS_ACCOUNT_TYPE:t.protocolMode===ft.AAD?i.authorityType=Oo.MSSTS_ACCOUNT_TYPE:i.authorityType=Oo.GENERIC_ACCOUNT_TYPE;let o;e.clientInfo&&n&&(o=Ho(e.clientInfo,n)),i.clientInfo=e.clientInfo,i.homeAccountId=e.homeAccountId,i.nativeAccountId=e.nativeAccountId;let s=e.environment||t&&t.getPreferredCache();if(!s)throw E(Zn);i.environment=s,i.realm=o?.utid||$l(e.idTokenClaims)||"",i.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let a=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,c=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(i.username=a||c||"",i.name=e.idTokenClaims?.name||"",i.cloudGraphHostName=e.cloudGraphHostName,i.msGraphHost=e.msGraphHost,e.tenantProfiles)i.tenantProfiles=e.tenantProfiles;else{let l=Bo(e.homeAccountId,i.localAccountId,i.realm,e.idTokenClaims);i.tenantProfiles=[l]}return i}static createFromAccountInfo(e,t,n){let i=new r;return i.authorityType=e.authorityType||Oo.GENERIC_ACCOUNT_TYPE,i.homeAccountId=e.homeAccountId,i.localAccountId=e.localAccountId,i.nativeAccountId=e.nativeAccountId,i.realm=e.tenantId,i.environment=e.environment,i.username=e.username,i.name=e.name,i.cloudGraphHostName=t,i.msGraphHost=n,i.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),i}static generateHomeAccountId(e,t,n,i,o){if(!(t===It.Adfs||t===It.Dsts)){if(e)try{let s=Ho(e,i.base64Decode);if(s.uid&&s.utid)return`${s.uid}.${s.utid}`}catch{}n.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let i=!0;if(n){let o=e.idTokenClaims||{},s=t.idTokenClaims||{};i=o.iat===s.iat&&o.nonce===s.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i}};var jl="cache_quota_exceeded",Qa="cache_error_unknown";var Rp={[jl]:"Exceeded cache storage capacity.",[Qa]:"Unexpected error occurred when using cache storage."},or=class r extends Error{constructor(e,t){let n=t||(Rp[e]?Rp[e]:Rp[Qa]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};var sr=class r{constructor(e,t,n,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(ql,Fo),this.staticAuthorityOptions=i}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let t=this.getAllAccounts(e);return t.length>1?t.sort(i=>i.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){let t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(n=>this.getTenantProfilesFromAccountEntity(n,t?.tenantId,t))}getTenantedAccountInfoByFilter(e,t,n,i){let o=null,s;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;let a=this.getIdToken(e,t,n.tenantId);return a&&(s=er(a.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(s,i))?null:(o=qi(e,n,s,a?.secret),o)}getTenantProfilesFromAccountEntity(e,t,n){let i=e.getAccountInfo(),o=i.tenantProfiles||new Map,s=this.getTokenKeys();if(t){let c=o.get(t);if(c)o=new Map([[t,c]]);else return[]}let a=[];return o.forEach(c=>{let l=this.getTenantedAccountInfoByFilter(i,s,c,n);l&&a.push(l)}),a}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}saveCacheRecord(e,t,n){return f(this,null,function*(){if(!e)throw E(bi);try{e.account&&this.setAccount(e.account),e.idToken&&t?.idToken!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&t?.accessToken!==!1&&(yield this.saveAccessToken(e.accessToken)),e.refreshToken&&t?.refreshToken!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(i){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),i instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${i.message}`,n),i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED"||i.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",n),new or(jl)):new or(i.name,i.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${i}`,n),new or(Qa))}})}saveAccessToken(e){return f(this,null,function*(){let t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),i=Fe.fromString(e.target),o=[];n.accessToken.forEach(s=>{if(!this.accessTokenKeyMatchesFilter(s,t,!1))return;let a=this.getAccessTokenCredential(s);a&&this.credentialMatchesFilter(a,t)&&Fe.fromString(a.target).intersectingScopeSets(i)&&o.push(this.removeAccessToken(s))}),yield Promise.all(o),this.setAccessTokenCredential(e)})}getAccountsFilteredBy(e){let t=this.getAccountKeys(),n=[];return t.forEach(i=>{if(!this.isAccountKey(i,e.homeAccountId))return;let o=this.getAccount(i,this.commonLogger);if(!o||e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId)||e.username&&!this.matchUsername(o.username,e.username)||e.environment&&!this.matchEnvironment(o,e.environment)||e.realm&&!this.matchRealm(o,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;let s={localAccountId:e?.localAccountId,name:e?.name},a=o.tenantProfiles?.filter(c=>this.tenantProfileMatchesFilter(c,s));a&&a.length===0||n.push(o)}),n}isAccountKey(e,t,n){return!(e.split($e.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split($e.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(J.ID_TOKEN.toLowerCase())===-1&&t.indexOf(J.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(J.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(J.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(J.REFRESH_TOKEN.toLowerCase())>-1){let n=`${J.REFRESH_TOKEN}${$e.CACHE_KEY_SEPARATOR}${this.clientId}${$e.CACHE_KEY_SEPARATOR}`,i=`${J.REFRESH_TOKEN}${$e.CACHE_KEY_SEPARATOR}${Rr}${$e.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===J.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ge.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(i=>{if(!this.isAppMetadata(i))return;let o=this.getAppMetadata(i);o&&(e.environment&&!this.matchEnvironment(o,e.environment)||e.clientId&&!this.matchClientId(o,e.clientId)||(n[i]=o))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(i=>{if(!this.isAuthorityMetadata(i)||i.indexOf(this.clientId)===-1)return;let o=this.getAuthorityMetadata(i);o&&o.aliases.indexOf(e)!==-1&&(n=o)}),n}removeAllAccounts(){return f(this,null,function*(){let e=this.getAccountKeys(),t=[];e.forEach(n=>{t.push(this.removeAccount(n))}),yield Promise.all(t)})}removeAccount(e){return f(this,null,function*(){let t=this.getAccount(e,this.commonLogger);t&&(yield this.removeAccountContext(t),this.removeItem(e))})}removeAccountContext(e){return f(this,null,function*(){let t=this.getTokenKeys(),n=e.generateAccountId(),i=[];t.idToken.forEach(o=>{o.indexOf(n)===0&&this.removeIdToken(o)}),t.accessToken.forEach(o=>{o.indexOf(n)===0&&i.push(this.removeAccessToken(o))}),t.refreshToken.forEach(o=>{o.indexOf(n)===0&&this.removeRefreshToken(o)}),yield Promise.all(i)})}updateOutdatedCachedAccount(e,t,n){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");let i=this.getAccountKeys().filter(l=>l.startsWith(t.homeAccountId)),o=[];i.forEach(l=>{let d=this.getCachedAccountEntity(l);d&&o.push(d)});let s=o.find(l=>Uo(l.realm,l.homeAccountId))||o[0];s.tenantProfiles=o.map(l=>({tenantId:l.realm,localAccountId:l.localAccountId,name:l.name,isHomeTenant:Uo(l.realm,l.homeAccountId)}));let a=r.toObject(new Oe,g({},s)),c=a.generateAccountKey();return i.forEach(l=>{l!==c&&this.removeOutdatedAccount(e)}),this.setAccount(a),n?.verbose("Updated an outdated account entity in the cache"),a}return t}removeAccessToken(e){return f(this,null,function*(){let t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===J.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===ge.POP){let i=t.keyId;if(i)try{yield this.cryptoImpl.removeTokenBindingKey(i)}catch{throw E(Di)}}return this.removeItem(e)}})}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){let t=Oe.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,n,i,o){this.commonLogger.trace("CacheManager - getIdToken called");let s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:J.ID_TOKEN,clientId:this.clientId,realm:n},a=this.getIdTokensByFilter(s,t),c=a.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let l=a;if(!n){let d=new Map;a.forEach((m,p)=>{m.realm===e.tenantId&&d.set(p,m)});let u=d.size;if(u<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),a.values().next().value;if(u===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),d.values().next().value;l=d}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((d,u)=>{this.removeIdToken(u)}),i&&o&&i.addFields({multiMatchedID:a.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),a.values().next().value}getIdTokensByFilter(e,t){let n=t&&t.idToken||this.getTokenKeys().idToken,i=new Map;return n.forEach(o=>{if(!this.idTokenKeyMatchesFilter(o,g({clientId:this.clientId},e)))return;let s=this.getIdTokenCredential(o);s&&this.credentialMatchesFilter(s,e)&&i.set(o,s)}),i}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n,i,o,s){this.commonLogger.trace("CacheManager - getAccessToken called");let a=Fe.createSearchScopes(t.scopes),c=t.authenticationScheme||ge.BEARER,l=c&&c.toLowerCase()!==ge.BEARER.toLowerCase()?J.ACCESS_TOKEN_WITH_AUTH_SCHEME:J.ACCESS_TOKEN,d={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:i||e.tenantId,target:a,tokenType:c,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},u=n&&n.accessToken||this.getTokenKeys().accessToken,m=[];u.forEach(v=>{if(this.accessTokenKeyMatchesFilter(v,d,!0)){let T=this.getAccessTokenCredential(v);T&&this.credentialMatchesFilter(T,d)&&m.push(T)}});let p=m.length;return p<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):p>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),m.forEach(v=>{this.removeAccessToken(Ga(v))}),o&&s&&o.addFields({multiMatchedAT:m.length},s),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),m[0])}accessTokenKeyMatchesFilter(e,t,n){let i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let o=t.target.asArray();for(let s=0;s<o.length;s++){if(n&&!i.includes(o[s].toLowerCase()))return!1;if(!n&&i.includes(o[s].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){let t=this.getTokenKeys(),n=[];return t.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;let o=this.getAccessTokenCredential(i);o&&this.credentialMatchesFilter(o,e)&&n.push(o)}),n}getRefreshToken(e,t,n,i,o){this.commonLogger.trace("CacheManager - getRefreshToken called");let s=t?Rr:void 0,a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:J.REFRESH_TOKEN,clientId:this.clientId,familyId:s},c=n&&n.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(u=>{if(this.refreshTokenKeyMatchesFilter(u,a)){let m=this.getRefreshTokenCredential(u);m&&this.credentialMatchesFilter(m,a)&&l.push(m)}});let d=l.length;return d<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(d>1&&i&&o&&i.addFields({multiMatchedRT:d},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),i=Object.keys(n).map(s=>n[s]),o=i.length;if(o<1)return null;if(o>1)throw E(Ei);return i[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Rr)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let i=Sy(this.staticAuthorityOptions,this.commonLogger);if(i.includes(t)&&i.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==J.ACCESS_TOKEN&&e.credentialType!==J.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:Fe.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(ya)!==-1}isAuthorityMetadata(e){return e.indexOf(Po.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${Po.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},Xa=class extends sr{setAccount(){throw E(ae)}getAccount(){throw E(ae)}getCachedAccountEntity(){throw E(ae)}setIdTokenCredential(){throw E(ae)}getIdTokenCredential(){throw E(ae)}setAccessTokenCredential(){throw E(ae)}getAccessTokenCredential(){throw E(ae)}setRefreshTokenCredential(){throw E(ae)}getRefreshTokenCredential(){throw E(ae)}setAppMetadata(){throw E(ae)}getAppMetadata(){throw E(ae)}setServerTelemetry(){throw E(ae)}getServerTelemetry(){throw E(ae)}setAuthorityMetadata(){throw E(ae)}getAuthorityMetadata(){throw E(ae)}getAuthorityMetadataKeys(){throw E(ae)}setThrottlingCache(){throw E(ae)}getThrottlingCache(){throw E(ae)}removeItem(){throw E(ae)}getKeys(){throw E(ae)}getAccountKeys(){throw E(ae)}getTokenKeys(){throw E(ae)}clear(){return f(this,null,function*(){throw E(ae)})}updateCredentialCacheKey(){throw E(ae)}removeOutdatedAccount(){throw E(ae)}};var Wl={tokenRenewalOffsetSeconds:xh,preventCorsPreflight:!1},ES={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:Se.Info,correlationId:y.EMPTY_STRING},SS={claimsBasedCachingEnabled:!1},AS={sendGetRequestAsync(){return f(this,null,function*(){throw E(ae)})},sendPostRequestAsync(){return f(this,null,function*(){throw E(ae)})}},IS={sku:y.SKU,version:Fo,cpu:y.EMPTY_STRING,os:y.EMPTY_STRING},bS={clientSecret:y.EMPTY_STRING,clientAssertion:void 0},kS={azureCloudInstance:Hr.None,tenant:`${y.DEFAULT_COMMON_TENANT}`},RS={application:{appName:"",appVersion:""}};function Dy({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:i,networkInterface:o,cryptoInterface:s,clientCredentials:a,libraryInfo:c,telemetry:l,serverTelemetryManager:d,persistencePlugin:u,serializableCache:m}){let p=g(g({},ES),t);return{authOptions:DS(r),systemOptions:g(g({},Wl),e),loggerOptions:p,cacheOptions:g(g({},SS),n),storageInterface:i||new Xa(r.clientId,Br,new tn(p)),networkInterface:o||AS,cryptoInterface:s||Br,clientCredentials:a||bS,libraryInfo:g(g({},IS),c),telemetry:g(g({},RS),l),serverTelemetryManager:d||null,persistencePlugin:u||null,serializableCache:m||null}}function DS(r){return g({clientCapabilities:[],azureCloudOptions:kS,skipAuthorityMetadataCache:!1},r)}function Ja(r){return r.authOptions.authority.options.protocolMode===ft.OIDC}var Ge=class r extends ve{constructor(e,t,n,i,o){super(e,t,n),this.name="ServerError",this.errorNo=i,this.status=o,Object.setPrototypeOf(this,r.prototype)}};var Mn=class r{static generateThrottlingStorageKey(e){return`${Qn.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){let n=r.generateThrottlingStorageKey(t),i=e.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now()){e.removeItem(n);return}throw new Ge(i.errorCodes?.join(" ")||y.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let i={throttleTime:r.calculateThrottleTime(parseInt(n.headers[_t.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(_t.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||Qn.DEFAULT_THROTTLE_TIME_SECONDS),n+Qn.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,i){let o={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:i,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},s=this.generateThrottlingStorageKey(o);e.removeItem(s)}};var Gl=class{constructor(e,t){this.networkClient=e,this.cacheManager=t}sendPostRequest(e,t,n){return f(this,null,function*(){Mn.preProcess(this.cacheManager,e);let i;try{i=yield this.networkClient.sendPostRequestAsync(t,n)}catch(o){throw o instanceof ve?o:E(vi)}return Mn.postProcess(this.cacheManager,e,i),i})}};var it={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var On=class{static validateRedirectUri(e){if(!e)throw ye(Ni)}static validatePrompt(e){let t=[];for(let n in Le)t.push(Le[n]);if(t.indexOf(e)<0)throw ye(Hi)}static validateClaims(e){try{JSON.parse(e)}catch{throw ye(tr)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw ye(nr);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([kl.PLAIN,kl.S256].indexOf(e)<0)throw ye(Vi)}};var Pn=class{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(Bl,encodeURIComponent(y.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Bl,encodeURIComponent(`${y.TOKEN_RESPONSE_TYPE} ${y.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(Gh,encodeURIComponent(e||Nh.QUERY))}addNativeBroker(){this.parameters.set(Sp,encodeURIComponent("1"))}addScopes(e,t=!0,n=zt){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let i=t?[...e||[],...n]:e||[],o=new Fe(i);this.parameters.set(Xh,encodeURIComponent(o.printScopes()))}addClientId(e){this.parameters.set(Ur,encodeURIComponent(e))}addRedirectUri(e){On.validateRedirectUri(e),this.parameters.set(Wh,encodeURIComponent(e))}addPostLogoutRedirectUri(e){On.validateRedirectUri(e),this.parameters.set(gp,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(vp,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(kp,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(bp,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(_t.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(_t.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(Ip,encodeURIComponent(e))}addClaims(e,t){let n=this.addClientCapabilitiesToClaims(e,t);On.validateClaims(n),this.parameters.set(Qh,encodeURIComponent(n))}addCorrelationId(e){this.parameters.set(sp,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(ap,e.sku),this.parameters.set(cp,e.version),e.os&&this.parameters.set(lp,e.os),e.cpu&&this.parameters.set(dp,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(mp,e.appName),e?.appVersion&&this.parameters.set(fp,e.appVersion)}addPrompt(e){On.validatePrompt(e),this.parameters.set(`${tp}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(Zh,encodeURIComponent(e))}addNonce(e){this.parameters.set(ep,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(On.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(rp,encodeURIComponent(e)),this.parameters.set(ip,encodeURIComponent(t));else throw ye(nr)}addAuthorizationCode(e){this.parameters.set(np,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(yp,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(Jh,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set(op,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(Cp,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(wp,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(Tp,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(_p,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(Ep,encodeURIComponent(e))}addGrantType(e){this.parameters.set(Yh,encodeURIComponent(e))}addClientInfo(){this.parameters.set(fy,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,n])=>{!this.parameters.has(t)&&n&&this.parameters.set(t,n)})}addClientCapabilitiesToClaims(e,t){let n;if(!e)n={};else try{n=JSON.parse(e)}catch{throw ye(tr)}return t&&t.length>0&&(n.hasOwnProperty(Mo.ACCESS_TOKEN)||(n[Mo.ACCESS_TOKEN]={}),n[Mo.ACCESS_TOKEN][Mo.XMS_CC]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(Dl.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(Dl.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Vl,ge.POP),this.parameters.set(zl,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Vl,ge.SSH),this.parameters.set(zl,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(up,e.generateCurrentRequestHeaderValue()),this.parameters.set(hp,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(pp,Qn.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(Ap,encodeURIComponent(e))}createQueryString(){let e=new Array;return this.parameters.forEach((t,n)=>{e.push(`${n}=${t}`)}),e.join("&")}};var Vr=class{constructor(e,t){this.config=Dy(e),this.logger=new tn(this.config.loggerOptions,ql,Fo),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Gl(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[_t.CONTENT_TYPE]=y.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case it.HOME_ACCOUNT_ID:try{let n=ir(e.credential);t[_t.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case it.UPN:t[_t.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}executePostToTokenEndpoint(e,t,n,i,o,s){return f(this,null,function*(){s&&this.performanceClient?.addQueueMeasurement(s,o);let a=yield this.networkManager.sendPostRequest(i,e,{body:t,headers:n});return this.performanceClient?.addFields({refreshTokenSize:a.body.refresh_token?.length||0,httpVerToken:a.headers?.[_t.X_MS_HTTP_VERSION]||""},o),this.config.serverTelemetryManager&&a.status<500&&a.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),a})}updateAuthority(e,t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,i=yield jh(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=i})}createTokenQueryParameters(e){let t=new Pn;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}};var ar={};cn(ar,{badToken:()=>Kr,consentRequired:()=>Mp,interactionRequired:()=>Dp,loginRequired:()=>Op,nativeAccountUnavailable:()=>Za,noTokensFound:()=>zr,refreshTokenExpired:()=>ec});var zr="no_tokens_found",Za="native_account_unavailable",ec="refresh_token_expired",Dp="interaction_required",Mp="consent_required",Op="login_required",Kr="bad_token";var My=[Dp,Mp,Op,Kr],MS=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Yl={[zr]:"No refresh token found in the cache. Please sign-in.",[Za]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[ec]:"Refresh token has expired.",[Kr]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},Oy={noTokensFoundError:{code:zr,desc:Yl[zr]},native_account_unavailable:{code:Za,desc:Yl[Za]},bad_token:{code:Kr,desc:Yl[Kr]}},gt=class r extends ve{constructor(e,t,n,i,o,s,a,c){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=i||y.EMPTY_STRING,this.traceId=o||y.EMPTY_STRING,this.correlationId=s||y.EMPTY_STRING,this.claims=a||y.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function Pp(r,e,t){let n=!!r&&My.indexOf(r)>-1,i=!!t&&MS.indexOf(t)>-1,o=!!e&&My.some(s=>e.indexOf(s)>-1);return n||o||i}function Vo(r){return new gt(r,Yl[r])}var ot=class r{static setRequestState(e,t,n){let i=r.generateLibraryState(e,n);return t?`${i}${y.RESOURCE_DELIM}${t}`:i}static generateLibraryState(e,t){if(!e)throw E(Nr);let n={id:e.createNewGuid()};t&&(n.meta=t);let i=JSON.stringify(n);return e.base64Encode(i)}static parseRequestState(e,t){if(!e)throw E(Nr);if(!t)throw E(Cn);try{let n=t.split(y.RESOURCE_DELIM),i=n[0],o=n.length>1?n.slice(1).join(y.RESOURCE_DELIM):y.EMPTY_STRING,s=e.base64Decode(i),a=JSON.parse(s);return{userRequestState:o||y.EMPTY_STRING,libraryState:a}}catch{throw E(Cn)}}};var OS={SW:"sw",UHW:"uhw"},qt=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}generateCnf(e,t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.PopTokenGenerateCnf,e.correlationId);let n=yield A(this.generateKid.bind(this),h.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),i=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:i}})}generateKid(e){return f(this,null,function*(){return this.performanceClient?.addQueueMeasurement(h.PopTokenGenerateKid,e.correlationId),{kid:yield this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:OS.SW}})}signPopToken(e,t,n){return f(this,null,function*(){return this.signPayload(e,t,n)})}signPayload(e,t,n,i){return f(this,null,function*(){let{resourceRequestMethod:o,resourceRequestUri:s,shrClaims:a,shrNonce:c,shrOptions:l}=n,u=(s?new de(s):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt(g({at:e,ts:Kt(),m:o?.toUpperCase(),u:u?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:u?.AbsolutePath,q:u?.QueryString?[[],u.QueryString]:void 0,client_claims:a||void 0},i),t,l,n.correlationId)})}};var Ql=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};function PS(r){let e="code=",t=r.error_uri?.lastIndexOf(e);return t&&t>=0?r.error_uri?.substring(t+e.length):void 0}var Nn=class r{constructor(e,t,n,i,o,s,a){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=i,this.serializableCache=o,this.persistencePlugin=s,this.performanceClient=a}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?E(Or,"Cached State"):E(Or,"Server State");let n,i;try{n=decodeURIComponent(e.state)}catch{throw E(Cn,e.state)}try{i=decodeURIComponent(t)}catch{throw E(Cn,e.state)}if(n!==i)throw E(wi);if(e.error||e.error_description||e.suberror){let o=PS(e);throw Pp(e.error,e.error_description,e.suberror)?new gt(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",o):new Ge(e.error||"",e.error_description,e.suberror,o)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||y.NOT_AVAILABLE} - Timestamp: ${e.timestamp||y.NOT_AVAILABLE} - Description: ${e.error_description||y.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||y.NOT_AVAILABLE} - Trace ID: ${e.trace_id||y.NOT_AVAILABLE}`,i=e.error_codes?.length?e.error_codes[0]:void 0,o=new Ge(e.error,n,e.suberror,i,e.status);if(t&&e.status&&e.status>=Do.SERVER_ERROR_RANGE_START&&e.status<=Do.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${o}`);return}else if(t&&e.status&&e.status>=Do.CLIENT_ERROR_RANGE_START&&e.status<=Do.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${o}`);return}throw Pp(e.error,e.error_description,e.suberror)?new gt(e.error,e.error_description,e.suberror,e.timestamp||y.EMPTY_STRING,e.trace_id||y.EMPTY_STRING,e.correlation_id||y.EMPTY_STRING,e.claims||y.EMPTY_STRING,i):o}}handleServerTokenResponse(e,t,n,i,o,s,a,c,l){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.HandleServerTokenResponse,e.correlation_id);let d;if(e.id_token){if(d=er(e.id_token||y.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&d.nonce!==o.nonce)throw E(Ti);if(i.maxAge||i.maxAge===0){let v=d.auth_time;if(!v)throw E(Xn);Fa(v,i.maxAge)}}this.homeAccountIdentifier=Oe.generateHomeAccountId(e.client_info||y.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,d);let u;o&&o.state&&(u=ot.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||i.sshKid||void 0;let m=this.generateCacheRecord(e,t,n,i,d,s,o),p;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),p=new Ql(this.serializableCache,!0),yield this.persistencePlugin.beforeCacheAccess(p)),a&&!c&&m.account){let v=m.account.generateAccountKey();if(!this.cacheStorage.getAccount(v,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield r.generateAuthenticationResult(this.cryptoObj,t,m,!1,i,d,u,void 0,l)}yield this.cacheStorage.saveCacheRecord(m,i.storeInCache,i.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&p&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield this.persistencePlugin.afterCacheAccess(p))}return r.generateAuthenticationResult(this.cryptoObj,t,m,!1,i,d,u,e,l)})}generateCacheRecord(e,t,n,i,o,s,a){let c=t.getPreferredCache();if(!c)throw E(Zn);let l=$l(o),d,u;e.id_token&&o&&(d=zh(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),u=zo(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,c,l,a,void 0,this.logger));let m=null;if(e.access_token){let T=e.scope?Fe.fromString(e.scope):new Fe(i.scopes||[]),I=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,k=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,O=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,D=n+I,j=D+k,oe=O&&O>0?n+O:void 0;m=Kh(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||t.tenant||"",T.printScopes(),D,j,this.cryptoObj.base64Decode,oe,e.token_type,s,e.key_id,i.claims,i.requestedClaimsHash)}let p=null;if(e.refresh_token){let T;if(e.refresh_token_expires_in){let I=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;T=n+I}p=qh(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,s,T)}let v=null;return e.foci&&(v={clientId:this.clientId,environment:c,familyId:e.foci}),{account:u,idToken:d,accessToken:m,refreshToken:p,appMetadata:v}}static generateAuthenticationResult(e,t,n,i,o,s,a,c,l){return f(this,null,function*(){let d=y.EMPTY_STRING,u=[],m=null,p,v,T=y.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===ge.POP&&!o.popKid){let D=new qt(e),{secret:j,keyId:oe}=n.accessToken;if(!oe)throw E(Oi);d=yield D.signPopToken(j,oe,o)}else d=n.accessToken.secret;u=Fe.fromString(n.accessToken.target).asArray(),m=new Date(Number(n.accessToken.expiresOn)*1e3),p=new Date(Number(n.accessToken.extendedExpiresOn)*1e3),n.accessToken.refreshOn&&(v=new Date(Number(n.accessToken.refreshOn)*1e3))}n.appMetadata&&(T=n.appMetadata.familyId===Rr?Rr:"");let I=s?.oid||s?.sub||"",k=s?.tid||"";c?.spa_accountid&&n.account&&(n.account.nativeAccountId=c?.spa_accountid);let O=n.account?qi(n.account.getAccountInfo(),void 0,s,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:I,tenantId:k,scopes:u,account:O,idToken:n?.idToken?.secret||"",idTokenClaims:s||{},accessToken:d,fromCache:i,expiresOn:m,extExpiresOn:p,refreshOn:v,correlationId:o.correlationId,requestId:l||y.EMPTY_STRING,familyId:T,tokenType:n.accessToken?.tokenType||y.EMPTY_STRING,state:a?a.userRequestState:y.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||y.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||y.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}})}};function zo(r,e,t,n,i,o,s,a,c,l,d){d?.verbose("setCachedAccount called");let m=r.getAccountKeys().find(k=>k.startsWith(t)),p=null;m&&(p=r.getAccount(m,d));let v=p||Oe.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:o,environment:s,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},e,n),T=v.tenantProfiles||[],I=a||v.realm;if(I&&!T.find(k=>k.tenantId===I)){let k=Bo(t,v.localAccountId,I,i);T.push(k)}return v.tenantProfiles=T,v}var $i=class extends Vr{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}getAuthCodeUrl(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.GetAuthCodeUrl,e.correlationId);let t=yield A(this.createAuthCodeUrlQueryString.bind(this),h.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return de.appendQueryString(this.authority.authorizationEndpoint,t)})}acquireToken(e,t){return f(this,null,function*(){if(this.performanceClient?.addQueueMeasurement(h.AuthClientAcquireToken,e.correlationId),!e.code)throw E(Si);let n=Kt(),i=yield A(this.executeTokenRequest.bind(this),h.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=i.headers?.[_t.X_MS_REQUEST_ID],s=new Nn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return s.validateTokenResponse(i.body),A(s.handleServerTokenResponse.bind(s),h.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,n,e,t,void 0,void 0,void 0,o)})}handleFragmentResponse(e,t){if(new Nn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw E(Ri);return e}getLogoutUri(e){if(!e)throw ye(Bi);let t=this.createLogoutUrlQueryString(e);return de.appendQueryString(this.authority.endSessionEndpoint,t)}executeTokenRequest(e,t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),i=de.appendQueryString(e.tokenEndpoint,n),o=yield A(this.createTokenRequestBody.bind(this),h.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),s;if(t.clientInfo)try{let l=Ho(t.clientInfo,this.cryptoUtils.base64Decode);s={credential:`${l.uid}${$e.CLIENT_INFO_SEPARATOR}${l.utid}`,type:it.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let a=this.createTokenRequestHeaders(s||t.ccsCredential),c={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return A(this.executePostToTokenEndpoint.bind(this),h.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(i,o,a,c,t.correlationId,h.AuthorizationCodeClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthClientCreateTokenRequestBody,e.correlationId);let t=new Pn;if(t.addClientId(e.tokenBodyParameters?.[Ur]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):On.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!Ja(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;t.addClientAssertion(yield Ul(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(o.assertionType)}if(t.addGrantType(va.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===ge.POP){let o=new qt(this.cryptoUtils,this.performanceClient),s;e.popKid?s=this.cryptoUtils.encodeKid(e.popKid):s=(yield A(o.generateCnf.bind(o),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(s)}else if(e.authenticationScheme===ge.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw ye(rr);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(n),(!He.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let i;if(e.clientInfo)try{let o=Ho(e.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${o.uid}${$e.CLIENT_INFO_SEPARATOR}${o.utid}`,type:it.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case it.HOME_ACCOUNT_ID:try{let o=ir(i.credential);t.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case it.UPN:t.addCcsUpn(i.credential);break}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Kl])&&t.addExtraQueryParameters({[Kl]:"1"}),t.createQueryString()})}createAuthCodeUrlQueryString(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.AuthClientCreateQueryString,e.correlationId);let t=new Pn;t.addClientId(e.extraQueryParameters?.[Ur]||this.config.authOptions.clientId);let n=[...e.scopes||[],...e.extraScopesToConsent||[]];t.addScopes(n,!0,this.oidcDefaultScopes),t.addRedirectUri(e.redirectUri);let i=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(i),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),Ja(this.config)||t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==Le.SELECT_ACCOUNT)if(e.sid&&e.prompt===Le.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){let o=this.extractAccountSid(e.account),s=this.extractLoginHint(e.account);if(s&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),s=null),s){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),t.addLoginHint(s);try{let a=ir(e.account.homeAccountId);t.addCcsOid(a)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(o&&e.prompt===Le.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{let a=ir(e.account.homeAccountId);t.addCcsOid(a)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{let a=ir(e.account.homeAccountId);t.addCcsOid(a)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(t.addNativeBroker(),e.authenticationScheme===ge.POP)){let o=new qt(this.cryptoUtils),s;e.popKid?s=this.cryptoUtils.encodeKid(e.popKid):s=(yield A(o.generateCnf.bind(o),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(s)}return t.createQueryString()})}createLogoutUrlQueryString(e){let t=new Pn;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}};var NS=300,qr=class extends Vr{constructor(e,t){super(e,t)}acquireToken(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.RefreshTokenClientAcquireToken,e.correlationId);let t=Kt(),n=yield A(this.executeTokenRequest.bind(this),h.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=n.headers?.[_t.X_MS_REQUEST_ID],o=new Nn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),A(o.handleServerTokenResponse.bind(o),h.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,i)})}acquireTokenByRefreshToken(e){return f(this,null,function*(){if(!e)throw ye(Ui);if(this.performanceClient?.addQueueMeasurement(h.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw E(Jn);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield A(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let i=n instanceof gt&&n.errorCode===zr,o=n instanceof Ge&&n.errorCode===Rl.INVALID_GRANT_ERROR&&n.subError===Rl.CLIENT_MISMATCH_ERROR;if(i||o)return A(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return A(this.acquireTokenWithCachedRefreshToken.bind(this),h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)})}acquireTokenWithCachedRefreshToken(e,t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=bt(this.cacheManager.getRefreshToken.bind(this.cacheManager),h.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw Vo(zr);if(n.expiresOn&&No(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||NS))throw Vo(ec);let i=U(g({},e),{refreshToken:n.secret,authenticationScheme:e.authenticationScheme||ge.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:it.HOME_ACCOUNT_ID}});try{return yield A(this.acquireToken.bind(this),h.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(i)}catch(o){if(o instanceof gt&&o.subError===Kr){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let s=Ga(n);this.cacheManager.removeRefreshToken(s)}throw o}})}executeTokenRequest(e,t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),i=de.appendQueryString(t.tokenEndpoint,n),o=yield A(this.createTokenRequestBody.bind(this),h.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),s=this.createTokenRequestHeaders(e.ccsCredential),a={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return A(this.executePostToTokenEndpoint.bind(this),h.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(i,o,s,a,e.correlationId,h.RefreshTokenClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=e.correlationId,n=new Pn;if(n.addClientId(e.tokenBodyParameters?.[Ur]||this.config.authOptions.clientId),e.redirectUri&&n.addRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),n.addGrantType(va.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!Ja(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),n.addCorrelationId(t),n.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let i=this.config.clientCredentials.clientAssertion;n.addClientAssertion(yield Ul(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(i.assertionType)}if(e.authenticationScheme===ge.POP){let i=new qt(this.cryptoUtils,this.performanceClient),o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(yield A(i.generateCnf.bind(i),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(o)}else if(e.authenticationScheme===ge.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw ye(rr);if((!He.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case it.HOME_ACCOUNT_ID:try{let i=ir(e.ccsCredential.credential);n.addCcsOid(i)}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case it.UPN:n.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),n.createQueryString()})}};var tc=class extends Vr{constructor(e,t){super(e,t)}acquireToken(e){return f(this,null,function*(){try{let[t,n]=yield this.acquireCachedToken(U(g({},e),{scopes:e.scopes?.length?e.scopes:[...zt]}));return n===yn.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new qr(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),t}catch(t){if(t instanceof Pi&&t.errorCode===Rn)return new qr(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw t}})}acquireCachedToken(e){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.SilentFlowClientAcquireCachedToken,e.correlationId);let t=yn.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!He.isEmptyObj(e.claims))throw this.setCacheOutcome(yn.FORCE_REFRESH_OR_CLAIMS,e.correlationId),E(Rn);if(!e.account)throw E(Jn);let n=e.account.tenantId||Ry(e.authority),i=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,i,n,this.performanceClient,e.correlationId);if(o){if(Vh(o.cachedAt)||No(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(yn.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),E(Rn);o.refreshOn&&No(o.refreshOn,0)&&(t=yn.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(yn.NO_CACHED_ACCESS_TOKEN,e.correlationId),E(Rn);let s=e.authority||this.authority.getPreferredCache(),a={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,i,n,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(s)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[yield A(this.generateResultFromCacheRecord.bind(this),h.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(a,e),t]})}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==yn.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}generateResultFromCacheRecord(e,t){return f(this,null,function*(){this.performanceClient?.addQueueMeasurement(h.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=er(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let i=n?.auth_time;if(!i)throw E(Xn);Fa(i,t.maxAge)}return Nn.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)})}};var Np={sendGetRequestAsync:()=>Promise.reject(E(ae)),sendPostRequestAsync:()=>Promise.reject(E(ae))};var Xl="missing_kid_error",Jl="missing_alg_error";var xS={[Xl]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Jl]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},xp=class r extends ve{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,r.prototype)}};function Lp(r){return new xp(r,xS[r])}var nc=class r{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Lp(Xl);if(!e.alg)throw Lp(Jl);let t=new r({typ:e.typ||Ol.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}};var Py=",",Ny="|";function LS(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:i,extensionVersion:o}=r,s=new Map([[0,[t,n]],[2,[i,o]]]),a=[];if(e?.length){if(a=e.split(Py),a.length<4)return e}else a=Array.from({length:4},()=>Ny);return s.forEach((c,l)=>{c.length===2&&c[0]?.length&&c[1]?.length&&FS({skuArr:a,index:l,skuName:c[0],skuVersion:c[1]})}),a.join(Py)}function FS(r){let{skuArr:e,index:t,skuName:n,skuVersion:i}=r;t>=e.length||(e[t]=[n,i].join(Ny))}var ji=class r{constructor(e,t){this.cacheOutcome=yn.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||y.EMPTY_STRING,this.wrapperVer=e.wrapperVer||y.EMPTY_STRING,this.telemetryCacheKey=nt.CACHE_KEY+$e.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${nt.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);let i=t.join(nt.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),s=[e,o].join(nt.VALUE_SEPARATOR);return[nt.SCHEMA_VERSION,s,i].join(nt.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(nt.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(nt.VALUE_SEPARATOR),o=e.errors.length,s=t<o?nt.OVERFLOW_TRUE:nt.OVERFLOW_FALSE,a=[o,s].join(nt.VALUE_SEPARATOR);return[nt.SCHEMA_VERSION,e.cacheHits,n,i,a].join(nt.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=nt.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof ve?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(nt.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{let i={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}}static maxErrorsToSend(e){let t,n=0,i=0,o=e.errors.length;for(t=0;t<o;t++){let s=e.failedRequests[2*t]||y.EMPTY_STRING,a=e.failedRequests[2*t+1]||y.EMPTY_STRING,c=e.errors[t]||y.EMPTY_STRING;if(i+=s.toString().length+a.toString().length+c.length+3,i<nt.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||y.EMPTY_STRING),e.push(this.regionSource||y.EMPTY_STRING),e.push(this.regionOutcome||y.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return LS(e)}};var Zl=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},Ko=class{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:Bh.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Zl}}startPerformanceMeasurement(){return new Zl}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var Wi="pkce_not_created",qo="crypto_nonexistent",xn="empty_navigate_uri",$o="hash_empty_error",$r="no_state_in_hash",jo="hash_does_not_contain_known_properties",Wo="unable_to_parse_state",Go="state_interaction_type_mismatch",Yo="interaction_in_progress",Qo="popup_window_error",Xo="empty_window_error",Pt="user_cancelled",ed="monitor_popup_timeout",Jo="monitor_window_timeout",Zo="redirect_in_iframe",es="block_iframe_reload",ts="block_nested_popups",td="iframe_closed_prematurely",Ln="silent_logout_unsupported",ns="no_account_error",nd="silent_prompt_value_error",rs="no_token_request_cache_error",is="unable_to_parse_token_request_cache_error",jr="no_cached_authority_error",rd="auth_request_not_set_error",id="invalid_cache_type",Wr="non_browser_environment",Fn="database_not_open",cr="no_network_connectivity",os="post_request_failed",ss="get_request_failed",Gi="failed_to_parse_response",as="unable_to_load_token",Gr="crypto_key_not_found",cs="auth_code_required",ls="auth_code_or_nativeAccountId_required",ds="spa_code_and_nativeAccountId_present",Yr="database_unavailable",us="unable_to_acquire_token_from_native_platform",hs="native_handshake_timeout",ps="native_extension_not_installed",nn="native_connection_not_established",ms="uninitialized_public_client_application",fs="native_prompt_not_supported",gs="invalid_base64_string",vs="invalid_pop_token_request",od="failed_to_retry";var lr="For more visit: aka.ms/msaljs/browser-errors",ie={[Wi]:"The PKCE code challenge and verifier could not be generated.",[qo]:"The crypto object or function is not available.",[xn]:"Navigation URI is empty. Please check stack trace for more info.",[$o]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${lr}`,[$r]:"Hash does not contain state. Please verify that the request originated from msal.",[jo]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${lr}`,[Wo]:"Unable to parse state. Please verify that the request originated from msal.",[Go]:"Hash contains state but the interaction type does not match the caller.",[Yo]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${lr}`,[Qo]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Xo]:"window.open returned null or undefined window object.",[Pt]:"User cancelled the flow.",[ed]:`Token acquisition in popup failed due to timeout.  ${lr}`,[Jo]:`Token acquisition in iframe failed due to timeout.  ${lr}`,[Zo]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[es]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${lr}`,[ts]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[td]:"The iframe being monitored was closed prematurely.",[Ln]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[ns]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[nd]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[rs]:"No token request found in cache.",[is]:"The cached token request could not be parsed.",[jr]:"No cached authority found.",[rd]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[id]:"Invalid cache type",[Wr]:"Login and token requests are not supported in non-browser environments.",[Fn]:"Database is not open!",[cr]:"No network connectivity. Check your internet connection.",[os]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[ss]:"Network request failed. Please check the network trace to determine root cause.",[Gi]:"Failed to parse network response. Check network trace.",[as]:"Error loading token to cache.",[Gr]:"Cryptographic Key or Keypair not found in browser storage.",[cs]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[ls]:"An authorization code or nativeAccountId must be provided to this flow.",[ds]:"Request cannot contain both spa code and native account id.",[Yr]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[us]:`Unable to acquire token from native platform.  ${lr}`,[hs]:"Timed out while attempting to establish connection to browser extension",[ps]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[nn]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${lr}`,[ms]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${lr}`,[fs]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[gs]:"Invalid base64 encoded string.",[vs]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[od]:"Unable to retry failed auth code redemption due to usage of the onRedirectNavigate request parameter. Please set onRedirectNavigate on the PublicClientApplication configuration instead or call loginRedirect again."},PF={pkceNotGenerated:{code:Wi,desc:ie[Wi]},cryptoDoesNotExist:{code:qo,desc:ie[qo]},emptyNavigateUriError:{code:xn,desc:ie[xn]},hashEmptyError:{code:$o,desc:ie[$o]},hashDoesNotContainStateError:{code:$r,desc:ie[$r]},hashDoesNotContainKnownPropertiesError:{code:jo,desc:ie[jo]},unableToParseStateError:{code:Wo,desc:ie[Wo]},stateInteractionTypeMismatchError:{code:Go,desc:ie[Go]},interactionInProgress:{code:Yo,desc:ie[Yo]},popupWindowError:{code:Qo,desc:ie[Qo]},emptyWindowError:{code:Xo,desc:ie[Xo]},userCancelledError:{code:Pt,desc:ie[Pt]},monitorPopupTimeoutError:{code:ed,desc:ie[ed]},monitorIframeTimeoutError:{code:Jo,desc:ie[Jo]},redirectInIframeError:{code:Zo,desc:ie[Zo]},blockTokenRequestsInHiddenIframeError:{code:es,desc:ie[es]},blockAcquireTokenInPopupsError:{code:ts,desc:ie[ts]},iframeClosedPrematurelyError:{code:td,desc:ie[td]},silentLogoutUnsupportedError:{code:Ln,desc:ie[Ln]},noAccountError:{code:ns,desc:ie[ns]},silentPromptValueError:{code:nd,desc:ie[nd]},noTokenRequestCacheError:{code:rs,desc:ie[rs]},unableToParseTokenRequestCacheError:{code:is,desc:ie[is]},noCachedAuthorityError:{code:jr,desc:ie[jr]},authRequestNotSet:{code:rd,desc:ie[rd]},invalidCacheType:{code:id,desc:ie[id]},notInBrowserEnvironment:{code:Wr,desc:ie[Wr]},databaseNotOpen:{code:Fn,desc:ie[Fn]},noNetworkConnectivity:{code:cr,desc:ie[cr]},postRequestFailed:{code:os,desc:ie[os]},getRequestFailed:{code:ss,desc:ie[ss]},failedToParseNetworkResponse:{code:Gi,desc:ie[Gi]},unableToLoadTokenError:{code:as,desc:ie[as]},signingKeyNotFoundInStorage:{code:Gr,desc:ie[Gr]},authCodeRequired:{code:cs,desc:ie[cs]},authCodeOrNativeAccountRequired:{code:ls,desc:ie[ls]},spaCodeAndNativeAccountPresent:{code:ds,desc:ie[ds]},databaseUnavailable:{code:Yr,desc:ie[Yr]},unableToAcquireTokenFromNativePlatform:{code:us,desc:ie[us]},nativeHandshakeTimeout:{code:hs,desc:ie[hs]},nativeExtensionNotInstalled:{code:ps,desc:ie[ps]},nativeConnectionNotEstablished:{code:nn,desc:ie[nn]},uninitializedPublicClientApplication:{code:ms,desc:ie[ms]},nativePromptNotSupported:{code:fs,desc:ie[fs]},invalidBase64StringError:{code:gs,desc:ie[gs]},invalidPopTokenRequest:{code:vs,desc:ie[vs]}},Yi=class r extends ve{constructor(e){super(e,ie[e]),Object.setPrototypeOf(this,r.prototype),this.name="BrowserAuthError"}};function R(r){return new Yi(r)}var Ue={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},Qr={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},dr={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},ke={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Fp={GET:"GET",POST:"POST"},fe={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context",REDIRECT_REQUEST:"request.redirect",REQUEST_RETRY:"request.retry"},ur={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},rc={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},_e={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962},F=function(r){return r.Redirect="redirect",r.Popup="popup",r.Silent="silent",r.None="none",r}(F||{}),Ye={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},Hp={scopes:zt},Up="jwk",Bp={React:"@azure/msal-react",Angular:"@azure/msal-angular"},sd="msal.db",xy=1,Ly=`${sd}.keys`,kt={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},Fy=[kt.Default,kt.Skip,kt.RefreshTokenAndNetwork],Hy="msal.browser.log.level",Uy="msal.browser.log.pii";function ic(r){return encodeURIComponent(oc(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function Qi(r){return By(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function oc(r){return By(new TextEncoder().encode(r))}function By(r){let e=Array.from(r,t=>String.fromCodePoint(t)).join("");return btoa(e)}var HS="RSASSA-PKCS1-v1_5",Ky="SHA-256",US=2048,BS=new Uint8Array([1,0,1]),Vy="0123456789abcdef",zy=new Uint32Array(1),zp={name:HS,hash:Ky,modulusLength:US,publicExponent:BS};function qy(r){if("crypto"in window)r.verbose("BrowserCrypto: modern crypto interface available");else throw r.error("BrowserCrypto: crypto interface is unavailable"),R(qo)}function Kp(r,e,t){return f(this,null,function*(){e?.addQueueMeasurement(h.Sha256Digest,t);let i=new TextEncoder().encode(r);return window.crypto.subtle.digest(Ky,i)})}function $y(r){return window.crypto.getRandomValues(r)}function Vp(){return window.crypto.getRandomValues(zy),zy[0]}function ct(){let r=Date.now(),e=Vp()*1024+(Vp()&1023),t=new Uint8Array(16),n=Math.trunc(e/2**30),i=e&2**30-1,o=Vp();t[0]=r/2**40,t[1]=r/2**32,t[2]=r/2**24,t[3]=r/2**16,t[4]=r/2**8,t[5]=r,t[6]=112|n>>>8,t[7]=n,t[8]=128|i>>>24,t[9]=i>>>16,t[10]=i>>>8,t[11]=i,t[12]=o>>>24,t[13]=o>>>16,t[14]=o>>>8,t[15]=o;let s="";for(let a=0;a<t.length;a++)s+=Vy.charAt(t[a]>>>4),s+=Vy.charAt(t[a]&15),(a===3||a===5||a===7||a===9)&&(s+="-");return s}function jy(r,e){return f(this,null,function*(){return window.crypto.subtle.generateKey(zp,r,e)})}function ad(r){return f(this,null,function*(){return window.crypto.subtle.exportKey(Up,r)})}function Wy(r,e,t){return f(this,null,function*(){return window.crypto.subtle.importKey(Up,r,zp,e,t)})}function Gy(r,e){return f(this,null,function*(){return window.crypto.subtle.sign(zp,r,e)})}function cd(r){return f(this,null,function*(){let e=yield Kp(r),t=new Uint8Array(e);return Qi(t)})}var ys="storage_not_supported",ld="stubbed_public_client_application_called",Cs="in_mem_redirect_unavailable";var dd={[ys]:"Given storage configuration option was not supported.",[ld]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[Cs]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},VS={storageNotSupportedError:{code:ys,desc:dd[ys]},stubPcaInstanceCalled:{code:ld,desc:dd[ld]},inMemRedirectUnavailable:{code:Cs,desc:dd[Cs]}},Xi=class r extends ve{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,r.prototype)}};function ud(r){return new Xi(r,dd[r])}function qp(r){r.location.hash="",typeof r.history.replaceState=="function"&&r.history.replaceState(null,"",`${r.location.origin}${r.location.pathname}${r.location.search}`)}function $p(r){let e=r.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function sc(){return window.parent!==window}function Yy(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Ue.POPUP_NAME_PREFIX}.`)===0}function Nt(){return window.location.href.split("?")[0].split("#")[0]}function jp(){let e=new de(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function Qy(){if(de.hashContainsKnownProperties(window.location.hash)&&sc())throw R(es)}function Xy(r){if(sc()&&!r)throw R(Zo)}function Jy(){if(Yy())throw R(ts)}function Zy(){if(typeof window>"u")throw R(Wr)}function hd(r){if(!r)throw R(ms)}function ac(r){Zy(),Qy(),Jy(),hd(r)}function pd(r,e){if(ac(r),Xy(e.system.allowRedirectInIframe),e.cache.cacheLocation===ke.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw ud(Cs)}function cc(r){let e=document.createElement("link");e.rel="preconnect",e.href=new URL(r).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function zS(){return ct()}var lc=class r{navigateInternal(e,t){return r.defaultNavigateWindow(e,t)}navigateExternal(e,t){return r.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(n=>{setTimeout(()=>{n(!0)},t.timeout)})}};var fd=class{sendGetRequestAsync(e,t){return f(this,null,function*(){let n;try{n=yield fetch(e,{method:Fp.GET,headers:this.getFetchHeaders(t)})}catch{throw window.navigator.onLine?R(ss):R(cr)}try{return{headers:this.getHeaderDict(n.headers),body:yield n.json(),status:n.status}}catch{throw R(Gi)}})}sendPostRequestAsync(e,t){return f(this,null,function*(){let n=t&&t.body||y.EMPTY_STRING,i;try{i=yield fetch(e,{method:Fp.POST,headers:this.getFetchHeaders(t),body:n})}catch{throw window.navigator.onLine?R(os):R(cr)}try{return{headers:this.getHeaderDict(i.headers),body:yield i.json(),status:i.status}}catch{throw R(Gi)}})}getFetchHeaders(e){let t=new Headers;if(!(e&&e.headers))return t;let n=e.headers;return Object.keys(n).forEach(i=>{t.append(i,n[i])}),t}getHeaderDict(e){let t={};return e.forEach((n,i)=>{t[i]=n}),t}};var KS=6e4,gd=1e4,qS=3e4,$S=2e3;function eC({auth:r,cache:e,system:t,telemetry:n},i){let o={clientId:y.EMPTY_STRING,authority:`${y.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:y.EMPTY_STRING,authorityMetadata:y.EMPTY_STRING,redirectUri:y.EMPTY_STRING,postLogoutRedirectUri:y.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:ft.AAD,OIDCOptions:{serverResponseType:vn.FRAGMENT,defaultScopes:[y.OPENID_SCOPE,y.PROFILE_SCOPE,y.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Hr.None,tenant:y.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},s={cacheLocation:ke.SessionStorage,temporaryCacheLocation:ke.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===ke.LocalStorage),claimsBasedCachingEnabled:!1},a={loggerCallback:()=>{},logLevel:Se.Info,piiLoggingEnabled:!1},c=U(g({},Wl),{loggerOptions:a,networkClient:i?new fd:Np,navigationClient:new lc,loadFrameTimeout:0,windowHashTimeout:t?.loadFrameTimeout||KS,iframeHashTimeout:t?.loadFrameTimeout||gd,navigateFrameWait:0,redirectNavigationTimeout:qS,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:t?.nativeBrokerHandshakeTimeout||$S,pollIntervalMilliseconds:Ue.DEFAULT_POLL_INTERVAL_MS}),l=U(g(g({},c),t),{loggerOptions:t?.loggerOptions||a}),d={application:{appName:y.EMPTY_STRING,appVersion:y.EMPTY_STRING},client:new Ko};if(r?.protocolMode!==ft.OIDC&&r?.OIDCOptions&&new tn(l.loggerOptions).warning(JSON.stringify(ye(wn.cannotSetOIDCOptions))),r?.protocolMode&&r.protocolMode!==ft.AAD&&l?.allowNativeBroker)throw ye(wn.cannotAllowNativeBroker);return{auth:U(g(g({},o),r),{OIDCOptions:g(g({},o.OIDCOptions),r?.OIDCOptions)}),cache:g(g({},s),e),system:l,telemetry:g(g({},d),n)}}var tC="@azure/msal-browser",Xr="3.21.0";var vd=class r{static loggerCallback(e,t){switch(e){case Se.Error:console.error(t);return;case Se.Info:console.info(t);return;case Se.Verbose:console.debug(t);return;case Se.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=eC(e,this.browserEnvironment);let t;try{t=window[ke.SessionStorage]}catch{}let n=t?.getItem(Hy),i=t?.getItem(Uy)?.toLowerCase(),o=i==="true"?!0:i==="false"?!1:void 0,s=g({},this.config.system.loggerOptions),a=n&&Object.keys(Se).includes(n)?Se[n]:void 0;a&&(s.loggerCallback=r.loggerCallback,s.logLevel=a),o!==void 0&&(s.piiLoggingEnabled=o),this.logger=new tn(s,tC,Xr),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}};var yd=(()=>{class r extends vd{getModuleName(){return r.MODULE_NAME}getId(){return r.ID}initialize(){return f(this,null,function*(){return this.available=typeof window<"u",this.available})}}return r.MODULE_NAME="",r.ID="StandardOperatingContext",r})();function xt(r){return new TextDecoder().decode(jS(r))}function jS(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw R(gs)}let t=atob(e);return Uint8Array.from(t,n=>n.codePointAt(0)||0)}var Cd=class{constructor(){this.dbName=sd,this.version=xy,this.tableName=Ly,this.dbOpen=!1}open(){return f(this,null,function*(){return new Promise((e,t)=>{let n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",i=>{i.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",i=>{let o=i;this.db=o.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(R(Yr)))})})}closeConnection(){let e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}validateDbIsOpen(){return f(this,null,function*(){if(!this.dbOpen)return this.open()})}getItem(e){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(R(Fn));let s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);s.addEventListener("success",a=>{let c=a;this.closeConnection(),t(c.target.result)}),s.addEventListener("error",a=>{this.closeConnection(),n(a)})})})}setItem(e,t){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((n,i)=>{if(!this.db)return i(R(Fn));let a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);a.addEventListener("success",()=>{this.closeConnection(),n()}),a.addEventListener("error",c=>{this.closeConnection(),i(c)})})})}removeItem(e){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(R(Fn));let s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);s.addEventListener("success",()=>{this.closeConnection(),t()}),s.addEventListener("error",a=>{this.closeConnection(),n(a)})})})}getKeys(){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(R(Fn));let o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();o.addEventListener("success",s=>{let a=s;this.closeConnection(),e(a.target.result)}),o.addEventListener("error",s=>{this.closeConnection(),t(s)})})})}containsKey(e){return f(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(R(Fn));let s=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);s.addEventListener("success",a=>{let c=a;this.closeConnection(),t(c.target.result===1)}),s.addEventListener("error",a=>{this.closeConnection(),n(a)})})})}deleteDatabase(){return f(this,null,function*(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{let n=window.indexedDB.deleteDatabase(sd),i=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(i),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(i),e(!0))),n.addEventListener("error",()=>(clearTimeout(i),t(!1)))})})}};var Ji=class{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){let e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}};var wd=class{constructor(e){this.inMemoryCache=new Ji,this.indexedDBCache=new Cd,this.logger=e}handleDatabaseAccessError(e){if(e instanceof Yi&&e.errorCode===Yr)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}getItem(e){return f(this,null,function*(){let t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t})}setItem(e,t){return f(this,null,function*(){this.inMemoryCache.setItem(e,t);try{yield this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}})}removeItem(e){return f(this,null,function*(){this.inMemoryCache.removeItem(e);try{yield this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}})}getKeys(){return f(this,null,function*(){let e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e})}containsKey(e){return f(this,null,function*(){let t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t})}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){return f(this,null,function*(){try{this.logger.verbose("Deleting persistent keystore");let e=yield this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}})}};var rC=(()=>{class r{constructor(t,n){this.logger=t,qy(t),this.cache=new wd(this.logger),this.performanceClient=n}createNewGuid(){return ct()}base64Encode(t){return oc(t)}base64Decode(t){return xt(t)}base64UrlEncode(t){return ic(t)}encodeKid(t){return this.base64UrlEncode(JSON.stringify({kid:t}))}getPublicKeyThumbprint(t){return f(this,null,function*(){let n=this.performanceClient?.startMeasurement(h.CryptoOptsGetPublicKeyThumbprint,t.correlationId),i=yield jy(r.EXTRACTABLE,r.POP_KEY_USAGES),o=yield ad(i.publicKey),s={e:o.e,kty:o.kty,n:o.n},a=nC(s),c=yield this.hashString(a),l=yield ad(i.privateKey),d=yield Wy(l,!1,["sign"]);return yield this.cache.setItem(c,{privateKey:d,publicKey:i.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),n&&n.end({success:!0}),c})}removeTokenBindingKey(t){return f(this,null,function*(){return yield this.cache.removeItem(t),!(yield this.cache.containsKey(t))})}clearKeystore(){return f(this,null,function*(){this.cache.clearInMemory();try{return yield this.cache.clearPersistent(),!0}catch(t){return t instanceof Error?this.logger.error(`Clearing keystore failed with error: ${t.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}})}signJwt(t,n,i,o){return f(this,null,function*(){let s=this.performanceClient?.startMeasurement(h.CryptoOptsSignJwt,o),a=yield this.cache.getItem(n);if(!a)throw R(Gr);let c=yield ad(a.publicKey),l=nC(c),d=ic(JSON.stringify({kid:n})),u=nc.getShrHeaderString(U(g({},i?.header),{alg:c.alg,kid:d})),m=ic(u);t.cnf={jwk:JSON.parse(l)};let p=ic(JSON.stringify(t)),v=`${m}.${p}`,I=new TextEncoder().encode(v),k=yield Gy(a.privateKey,I),O=Qi(new Uint8Array(k)),D=`${v}.${O}`;return s&&s.end({success:!0}),D})}hashString(t){return f(this,null,function*(){return cd(t)})}}return r.POP_KEY_USAGES=["sign","verify"],r.EXTRACTABLE=!0,r})();function nC(r){return JSON.stringify(r,Object.keys(r).sort())}var dc=class{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==ke.LocalStorage&&e!==ke.SessionStorage||!window[e])throw ud(ys)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}};function Td(r,e){if(!e)return null;try{return ot.parseRequestState(r,e).libraryState.meta}catch{throw E(rt.invalidState)}}var ws=class r extends sr{constructor(e,t,n,i,o,s){super(e,n,i,o),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=t,this.logger=i,this.internalStorage=new Ji,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=s}setupBrowserStorage(e){switch(e){case ke.LocalStorage:case ke.SessionStorage:try{return new dc(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=ke.MemoryStorage,new Ji}setupTemporaryCacheStorage(e,t){switch(t){case ke.LocalStorage:case ke.SessionStorage:try{return new dc(e||ke.SessionStorage)}catch(n){return this.logger.verbose(n),this.internalStorage}case ke.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){let e=`${y.CACHE_PREFIX}.${We.ID_TOKEN}`,t=`${y.CACHE_PREFIX}.${We.CLIENT_INFO}`,n=`${y.CACHE_PREFIX}.${We.ERROR}`,i=`${y.CACHE_PREFIX}.${We.ERROR_DESC}`,o=this.browserStorage.getItem(e),s=this.browserStorage.getItem(t),a=this.browserStorage.getItem(n),c=this.browserStorage.getItem(i),l=[o,s,a,c];[We.ID_TOKEN,We.CLIENT_INFO,We.ERROR,We.ERROR_DESC].forEach((u,m)=>{let p=l[m];p&&this.setTemporaryCache(u,p,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");let e=this.getItem(ur.ACCOUNT_KEYS),t=this.getItem(`${ur.TOKEN_KEYS}.${this.clientId}`);if(e&&t){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(i=>{if(this.isCredentialKey(i)){let o=this.getItem(i);if(o){let s=this.validateAndParseJson(o);if(s&&s.hasOwnProperty("credentialType"))switch(s.credentialType){case J.ID_TOKEN:if(Me.isIdTokenEntity(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${i} found, saving key to token key map`);let a=s,c=this.updateCredentialCacheKey(i,a);this.addTokenKey(c,J.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${i}`);break;case J.ACCESS_TOKEN:case J.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(Me.isAccessTokenEntity(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${i} found, saving key to token key map`);let a=s,c=this.updateCredentialCacheKey(i,a);this.addTokenKey(c,J.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${i}`);break;case J.REFRESH_TOKEN:if(Me.isRefreshTokenEntity(s)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${i} found, saving key to token key map`);let a=s,c=this.updateCredentialCacheKey(i,a);this.addTokenKey(c,J.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${i}`);break}}}if(this.isAccountKey(i)){let o=this.getItem(i);if(o){let s=this.validateAndParseJson(o);s&&Oe.isAccountEntity(s)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${i} found, saving key to account key map`),this.addAccountKeyToMap(i))}}})}validateAndParseJson(e){try{let t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");let n=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,n,t)}getCachedAccountEntity(e){let t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;let n=this.validateAndParseJson(t);return!n||!Oe.isAccountEntity(n)?(this.removeAccountKeyFromMap(e),null):sr.toObject(new Oe,n)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");let t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");let e=this.getItem(ur.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);let t=this.getAccountKeys();t.indexOf(e)===-1?(t.push(e),this.setItem(ur.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);let t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(ur.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e){return f(this,null,function*(){Ls(r.prototype,this,"removeAccount").call(this,e),this.removeAccountKeyFromMap(e)})}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,J.ID_TOKEN)}removeAccessToken(e){return f(this,null,function*(){Ls(r.prototype,this,"removeAccessToken").call(this,e),this.removeTokenKey(e,J.ACCESS_TOKEN)})}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,J.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");let e=this.getItem(`${ur.TOKEN_KEYS}.${this.clientId}`);if(e){let t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");let n=this.getTokenKeys();switch(t){case J.ID_TOKEN:n.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case J.ACCESS_TOKEN:n.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case J.REFRESH_TOKEN:n.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),E(rt.unexpectedCredentialType)}this.setItem(`${ur.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");let n=this.getTokenKeys();switch(t){case J.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);let i=n.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case J.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);let o=n.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case J.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);let s=n.refreshToken.indexOf(e);s>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(s,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),E(rt.unexpectedCredentialType)}this.setItem(`${ur.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,J.ID_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!Me.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,J.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");let t=Me.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,J.ID_TOKEN)}getAccessTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,J.ACCESS_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!Me.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,J.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");let t=Me.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,J.ACCESS_TOKEN)}getRefreshTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,J.REFRESH_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!Me.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,J.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");let t=Me.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,J.REFRESH_TOKEN)}getAppMetadata(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!Me.isAppMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");let t=Me.generateAppMetadataKey(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!Me.isServerTelemetryEntity(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){let t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;let n=this.validateAndParseJson(t);return n&&Me.isAuthorityMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(rc.WRAPPER_SKU,e),this.internalStorage.setItem(rc.WRAPPER_VER,t)}getWrapperMetadata(){let e=this.internalStorage.getItem(rc.WRAPPER_SKU)||y.EMPTY_STRING,t=this.internalStorage.getItem(rc.WRAPPER_VER)||y.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){let e=this.generateCacheKey(We.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");let i=this.generateCacheKey(We.ACTIVE_ACCOUNT),o=this.getItem(i);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;let s=this.getAccountInfoFilteredBy({localAccountId:o});return s?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(s),s):null}let n=this.validateAndParseJson(t);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){let t=this.generateCacheKey(We.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(We.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");let i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(i)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)}getThrottlingCache(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!Me.isThrottlingEntity(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){let n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){let o=this.getItemCookie(n);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}let i=this.temporaryCacheStorage.getItem(n);if(!i){if(this.cacheConfig.cacheLocation===ke.LocalStorage){let o=this.browserStorage.getItem(n);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),o}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i}setTemporaryCache(e,t,n){let i=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(i,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,t))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}clear(){return f(this,null,function*(){yield this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(y.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(y.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()})}clearTokensAndKeysWithClaims(e,t){return f(this,null,function*(){e.addQueueMeasurement(h.ClearTokensAndKeysWithClaims,t);let n=this.getTokenKeys(),i=[];n.accessToken.forEach(o=>{let s=this.getAccessTokenCredential(o);s?.requestedClaimsHash&&o.includes(s.requestedClaimsHash.toLowerCase())&&i.push(this.removeAccessToken(o))}),yield Promise.all(i),i.length>0&&this.logger.warning(`${i.length} access tokens with claims in the cache keys have been removed from the cache.`)})}setItemCookie(e,t,n){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(n){let o=this.getCookieExpirationTime(n);i+=`expires=${o};`}this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i}getItemCookie(e){let t=`${encodeURIComponent(e)}=`,n=document.cookie.split(";");for(let i=0;i<n.length;i++){let o=n[i];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(t)===0)return decodeURIComponent(o.substring(t.length,o.length))}return y.EMPTY_STRING}clearMsalCookies(){let e=`${y.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(n=>{for(;n.charAt(0)===" ";)n=n.substring(1);if(n.indexOf(e)===0){let i=n.split("=")[0];this.clearItemCookie(i)}})}clearItemCookie(e){this.setItemCookie(e,y.EMPTY_STRING,-1)}getCookieExpirationTime(e){let t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):He.startsWith(e,y.CACHE_PREFIX)||He.startsWith(e,We.ADAL_ID_TOKEN)?e:`${y.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){let{libraryState:{id:t}}=ot.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${fe.AUTHORITY}.${t}`)}generateNonceKey(e){let{libraryState:{id:t}}=ot.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${fe.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){let{libraryState:{id:t}}=ot.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${fe.REQUEST_STATE}.${t}`)}getCachedAuthority(e){let t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;let i=this.generateAuthorityKey(n);return this.getTemporaryCache(i)}updateCacheEntries(e,t,n,i,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");let s=this.generateStateKey(e);this.setTemporaryCache(s,e,!1);let a=this.generateNonceKey(e);this.setTemporaryCache(a,t,!1);let c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,n,!1),o){let l={credential:o.homeAccountId,type:it.HOME_ACCOUNT_ID};this.setTemporaryCache(fe.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(i){let l={credential:i,type:it.UPN};this.setTemporaryCache(fe.CCS_CREDENTIAL,JSON.stringify(l),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(fe.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(fe.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(fe.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(fe.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(fe.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(fe.NATIVE_REQUEST)),this.removeTemporaryItem(this.generateCacheKey(fe.REDIRECT_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){let t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||y.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(fe.REQUEST_STATE)===-1)return;let n=this.temporaryCacheStorage.getItem(t);if(!n)return;let i=Td(this.cryptoImpl,n);i&&i.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}generateRequestRetriedKey(){return`${y.CACHE_PREFIX}.${fe.REQUEST_RETRY}.${this.clientId}`}getRequestRetried(){let e=this.generateRequestRetriedKey(),t=this.getTemporaryCache(e);return t?parseInt(t):null}setRequestRetried(){this.logger.trace("BrowserCacheManager.setRequestRetried called");let e=this.generateRequestRetriedKey();this.setTemporaryCache(e,"1",!1)}removeRequestRetried(){let e=this.generateRequestRetriedKey();this.removeTemporaryItem(e)}cacheRedirectRequest(e){this.logger.trace("BrowserCacheManager.cacheRedirectRequest called");let t=Rt(e,[]);delete t.onRedirectNavigate;let n=JSON.stringify(t);this.setTemporaryCache(fe.REDIRECT_REQUEST,n,!0)}getCachedRedirectRequest(){this.logger.trace("BrowserCacheManager.getCachedRedirectRequest called");let e=this.getTemporaryCache(fe.REDIRECT_REQUEST,!0);if(!e)this.logger.error("No cached redirect request found.");else{this.removeTemporaryItem(this.generateCacheKey(fe.REDIRECT_REQUEST));let t;try{t=JSON.parse(e)}catch(n){this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached redirect request threw with error: ${n}`);return}if(t)return t}}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");let t=oc(JSON.stringify(e));this.setTemporaryCache(fe.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");let t=this.getTemporaryCache(fe.REQUEST_PARAMS,!0);if(!t)throw R(rs);let n;try{n=JSON.parse(xt(t))}catch(i){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${i}`),R(is)}if(this.removeTemporaryItem(this.generateCacheKey(fe.REQUEST_PARAMS)),!n.authority){let i=this.generateAuthorityKey(e),o=this.getTemporaryCache(i);if(!o)throw R(jr);n.authority=o}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");let e=this.getTemporaryCache(fe.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;let t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){let t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){let e=`${y.CACHE_PREFIX}.${fe.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){let t=`${y.CACHE_PREFIX}.${fe.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw R(Yo);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){let e=this.getTemporaryCache(We.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(We.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));let t=this.getTemporaryCache(We.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(We.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));let n=t||e;if(n){let i=xr.extractTokenClaims(n,xt);if(i.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.preferred_username;if(i.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){let n=Me.generateCredentialKey(t);if(e!==n){let i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(n,i),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}hydrateCache(e,t){return f(this,null,function*(){let n=Me.createIdTokenEntity(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId),i;t.claims&&(i=yield this.cryptoImpl.hashString(t.claims));let o=Me.createAccessTokenEntity(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,xt,void 0,e.tokenType,void 0,t.sshKid,t.claims,i),s={idToken:n,accessToken:o};return this.saveCacheRecord(s)})}saveCacheRecord(e,t,n){return f(this,null,function*(){try{yield Ls(r.prototype,this,"saveCacheRecord").call(this,e,t,n)}catch(i){if(i instanceof or&&this.performanceClient&&n)try{let o=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:o.refreshToken.length,cacheIdCount:o.idToken.length,cacheAtCount:o.accessToken.length},n)}catch{}throw i}})}},iC=(r,e)=>{let t={cacheLocation:ke.MemoryStorage,temporaryCacheLocation:ke.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new ws(r,t,Br,e)};function oC(r,e,t,n){return r.verbose("getAllAccounts called"),t?e.getAllAccounts(n):[]}function sC(r,e,t){if(e.trace("getAccount called"),Object.keys(r).length===0)return e.warning("getAccount: No accountFilter provided"),null;let n=t.getAccountInfoFilteredBy(r);return n?(e.verbose("getAccount: Account matching provided filter found, returning"),n):(e.verbose("getAccount: No matching account found, returning null"),null)}function aC(r,e,t){if(e.trace("getAccountByUsername called"),!r)return e.warning("getAccountByUsername: No username provided"),null;let n=t.getAccountInfoFilteredBy({username:r});return n?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${r}`),n):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function cC(r,e,t){if(e.trace("getAccountByHomeId called"),!r)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;let n=t.getAccountInfoFilteredBy({homeAccountId:r});return n?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${r}`),n):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function lC(r,e,t){if(e.trace("getAccountByLocalId called"),!r)return e.warning("getAccountByLocalId: No localAccountId provided"),null;let n=t.getAccountInfoFilteredBy({localAccountId:r});return n?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${r}`),n):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function dC(r,e){e.setActiveAccount(r)}function uC(r){return r.getActiveAccount()}var z={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};var _d=class{constructor(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if(typeof window<"u"){let t=ct();return this.eventCallbacks.set(t,e),this.logger.verbose(`Event callback registered with id: ${t}`),t}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,t,n,i){if(typeof window<"u"){let o={eventType:e,interactionType:t||null,payload:n||null,error:i||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${e}`),this.eventCallbacks.forEach((s,a)=>{this.logger.verbose(`Emitting event to callback ${a}: ${e}`),s.apply(null,[o])})}}handleAccountCacheChange(e){try{e.key?.includes(We.ACTIVE_ACCOUNT_FILTERS)&&this.emitEvent(z.ACTIVE_ACCOUNT_CHANGED);let t=e.newValue||e.oldValue;if(!t)return;let n=JSON.parse(t);if(typeof n!="object"||!Oe.isAccountEntity(n))return;let o=sr.toObject(new Oe,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(z.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(z.ACCOUNT_REMOVED,void 0,o))}catch{return}}};var Ts=class{constructor(e,t,n,i,o,s,a,c,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=s,this.nativeMessageHandler=c,this.correlationId=l||ct(),this.logger=i.clone(Ue.MSAL_SKU,Xr,this.correlationId),this.performanceClient=a}clearCacheOnLogout(e){return f(this,null,function*(){if(e){Oe.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{yield this.browserStorage.removeAccount(Oe.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),yield this.browserStorage.clear(),yield this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})}getRedirectUri(e){this.logger.verbose("getRedirectUri called");let t=e||this.config.auth.redirectUri||Nt();return de.getAbsoluteUrl(t,Nt())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");let n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new ji(n,this.browserStorage)}getDiscoveredAuthority(e,t,n){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);let i={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e||this.config.auth.authority,s=en.generateAuthority(o,t||this.config.auth.azureCloudOptions),a=yield A(Hl.createDiscoveredInstance,h.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(s,this.config.system.networkClient,this.browserStorage,i,this.logger,this.correlationId,this.performanceClient);if(n&&!a.isAlias(n.environment))throw ye(wn.authorityMismatch);return a})}};var WS=32;function hC(r,e,t){return f(this,null,function*(){r.addQueueMeasurement(h.GeneratePkceCodes,t);let n=bt(GS,h.GenerateCodeVerifier,e,r,t)(r,e,t),i=yield A(YS,h.GenerateCodeChallengeFromVerifier,e,r,t)(n,r,e,t);return{verifier:n,challenge:i}})}function GS(r,e,t){try{let n=new Uint8Array(WS);return bt($y,h.GetRandomValues,e,r,t)(n),Qi(n)}catch{throw R(Wi)}}function YS(r,e,t,n){return f(this,null,function*(){e.addQueueMeasurement(h.GenerateCodeChallengeFromVerifier,n);try{let i=yield A(Kp,h.Sha256Digest,t,e,n)(r,e,n);return Qi(new Uint8Array(i))}catch{throw R(Wi)}})}function uc(r,e,t,n){return f(this,null,function*(){t.addQueueMeasurement(h.InitializeBaseRequest,r.correlationId);let i=r.authority||e.auth.authority,o=[...r&&r.scopes||[]],s=U(g({},r),{correlationId:r.correlationId,authority:i,scopes:o});if(!s.authenticationScheme)s.authenticationScheme=ge.BEARER,n.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(s.authenticationScheme===ge.SSH){if(!r.sshJwk)throw ye(wn.missingSshJwk);if(!r.sshKid)throw ye(wn.missingSshKid)}n.verbose(`Authentication Scheme set to "${s.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&r.claims&&!He.isEmptyObj(r.claims)&&(s.requestedClaimsHash=yield cd(r.claims)),s})}function pC(r,e,t,n,i){return f(this,null,function*(){n.addQueueMeasurement(h.InitializeSilentRequest,r.correlationId);let o=yield A(uc,h.InitializeBaseRequest,i,n,r.correlationId)(r,t,n,i);return U(g(g({},r),o),{account:e,forceRefresh:r.forceRefresh||!1})})}var Lt=class extends Ts{initializeAuthorizationCodeRequest(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);let t=yield A(hC,h.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n=U(g({},e),{redirectUri:e.redirectUri,code:y.EMPTY_STRING,codeVerifier:t.verifier});return e.codeChallenge=t.challenge,e.codeChallengeMethod=y.S256_CODE_CHALLENGE_METHOD,n})}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);let t=g({correlationId:this.correlationId||ct()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){let n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=de.getAbsoluteUrl(e.postLogoutRedirectUri,Nt())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=de.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,Nt())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=de.getAbsoluteUrl(Nt(),Nt())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){let t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e,t,n,i){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientCreateAuthCodeClient,this.correlationId);let o=yield A(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,n,i);return new $i(o,this.performanceClient)})}getClientConfiguration(e,t,n,i){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientGetClientConfiguration,this.correlationId);let o=yield A(this.getDiscoveredAuthority.bind(this),h.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)(t,n,i),s=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:s.loggerCallback,piiLoggingEnabled:s.piiLoggingEnabled,logLevel:s.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Ue.MSAL_SKU,version:Xr,cpu:y.EMPTY_STRING,os:y.EMPTY_STRING},telemetry:this.config.telemetry}})}initializeAuthorizationRequest(e,t){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);let n=this.getRedirectUri(e.redirectUri),i={interactionType:t},o=ot.setRequestState(this.browserCrypto,e&&e.state||y.EMPTY_STRING,i),s=yield A(uc,h.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(U(g({},e),{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),a=U(g({},s),{redirectUri:n,state:o,nonce:e.nonce||ct(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),c=e.account||this.browserStorage.getActiveAccount();if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),a.account=c),!a.loginHint&&!c){let l=this.browserStorage.getLegacyLoginHint();l&&(a.loginHint=l)}return a})}};var mC="ContentError",Ed="user_switch";var fC="USER_INTERACTION_REQUIRED",gC="USER_CANCEL",vC="NO_NETWORK",yC="PERSISTENT_ERROR",CC="DISABLED",wC="ACCOUNT_UNAVAILABLE";var QS=-2147186943,XS={[Ed]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},rn=class r extends ve{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,r.prototype),this.name="NativeAuthError",this.ext=n}};function Jr(r){if(r.ext&&r.ext.status&&(r.ext.status===yC||r.ext.status===CC)||r.ext&&r.ext.error&&r.ext.error===QS)return!0;switch(r.errorCode){case mC:return!0;default:return!1}}function hc(r,e,t){if(t&&t.status)switch(t.status){case wC:return Vo(ar.nativeAccountUnavailable);case fC:return new gt(r,e);case gC:return R(Pt);case vC:return R(cr)}return new rn(r,XS[r]||e,t)}var _s=class extends Lt{acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.SilentCacheClientAcquireToken,e.correlationId);let t=this.initializeServerTelemetryManager(_e.acquireTokenSilent_silentFlow),n=yield A(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t,e.authority,e.azureCloudOptions,e.account),i=new tc(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{let s=(yield A(i.acquireCachedToken.bind(i),h.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),s}catch(o){throw o instanceof Yi&&o.errorCode===Gr&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o}})}logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}};var Wp={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"},on=class extends Ts{constructor(e,t,n,i,o,s,a,c,l,d,u,m){super(e,t,n,i,o,s,c,l,m),this.apiId=a,this.accountId=d,this.nativeMessageHandler=l,this.nativeStorageManager=u,this.silentCacheClient=new _s(e,this.nativeStorageManager,n,i,o,s,c,l,m),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);let p=this.nativeMessageHandler.getExtensionId()===Qr.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=ji.makeExtraSkuString({libraryName:Ue.MSAL_SKU,libraryVersion:Xr,extensionName:p,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=U(g({},e.extraParameters),{[Lo.X_CLIENT_EXTRA_SKU]:this.skus})}acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");let t=this.performanceClient.startMeasurement(h.NativeInteractionClientAcquireToken,e.correlationId),n=Wa.nowSeconds();try{let i=yield this.initializeNativeRequest(e);try{let l=yield this.acquireTokensFromCache(this.accountId,i);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),l}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}let o=Rt(i,[]),s={method:dr.GetToken,request:o},a=yield this.nativeMessageHandler.sendMessage(s),c=this.validateNativeResponse(a);return yield this.handleNativeResponse(c,i,n).then(l=>(t.end({success:!0,isNativeBroker:!0,requestId:l.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),l)).catch(l=>{throw t.end({success:!1,errorCode:l.errorCode,subErrorCode:l.subError,isNativeBroker:!0}),l})}catch(i){throw i instanceof rn&&this.serverTelemetryManager.setNativeBrokerErrorCode(i.errorCode),i}})}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:Fe.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}acquireTokensFromCache(e,t){return f(this,null,function*(){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),E(rt.noAccountFound);let n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!n)throw E(rt.noAccountFound);try{let i=this.createSilentCacheRequest(t,n),o=yield this.silentCacheClient.acquireToken(i),s=U(g({},n),{idTokenClaims:o?.idTokenClaims,idToken:o?.idToken});return U(g({},o),{account:s})}catch(i){throw i}})}acquireTokenRedirect(e,t){return f(this,null,function*(){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");let n=Rt(e,[]);delete n.onRedirectNavigate;let i=yield this.initializeNativeRequest(n),o={method:dr.GetToken,request:i};try{let c=yield this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(c)}catch(c){if(c instanceof rn&&(this.serverTelemetryManager.setNativeBrokerErrorCode(c.errorCode),Jr(c)))throw c}this.browserStorage.setTemporaryCache(fe.NATIVE_REQUEST,JSON.stringify(i),!0);let s={apiId:_e.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},a=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),yield this.navigationClient.navigateExternal(a,s)})}handleRedirectPromise(e,t){return f(this,null,function*(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;let c=n,{prompt:i}=c,o=Rt(c,["prompt"]);i&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(fe.NATIVE_REQUEST));let s={method:dr.GetToken,request:o},a=Wa.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");let l=yield this.nativeMessageHandler.sendMessage(s);this.validateNativeResponse(l);let d=this.handleNativeResponse(l,o,a);this.browserStorage.setInteractionInProgress(!1);let u=yield d;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),u}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}})}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,t,n){return f(this,null,function*(){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");let i=xr.extractTokenClaims(e.id_token,xt),o=this.createHomeAccountIdentifier(e,i),s=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(o!==s&&e.account.id!==t.accountId)throw hc(Ed);let a=yield this.getDiscoveredAuthority(t.authority),c=zo(this.browserStorage,a,o,xt,i,e.client_info,void 0,i.tid,void 0,e.account.id,this.logger),l=yield this.generateAuthenticationResult(e,t,i,c,a.canonicalAuthority,n);return this.cacheAccount(c),this.cacheNativeTokens(e,t,o,i,e.access_token,l.tenantId,n),l})}createHomeAccountIdentifier(e,t){return Oe.generateHomeAccountId(e.client_info||y.EMPTY_STRING,It.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?Fe.fromString(e.scope):Fe.fromString(t.scope)}generatePopAccessToken(e,t){return f(this,null,function*(){if(t.tokenType===ge.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;let n=new qt(this.browserCrypto),i={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw E(rt.keyIdMissing);return n.signPopToken(e.access_token,t.keyId,i)}else return e.access_token})}generateAuthenticationResult(e,t,n,i,o,s){return f(this,null,function*(){let a=this.addTelemetryFromNativeResponse(e),c=e.scope?Fe.fromString(e.scope):Fe.fromString(t.scope),l=e.account.properties||{},d=l.UID||n.oid||n.sub||y.EMPTY_STRING,u=l.TenantId||n.tid||y.EMPTY_STRING,m=qi(i.getAccountInfo(),void 0,n,e.id_token);m.nativeAccountId!==e.account.id&&(m.nativeAccountId=e.account.id);let p=yield this.generatePopAccessToken(e,t),v=t.tokenType===ge.POP?ge.POP:ge.BEARER;return{authority:o,uniqueId:d,tenantId:u,scopes:c.asArray(),account:m,idToken:e.id_token,idTokenClaims:n,accessToken:p,fromCache:a?this.isResponseFromCache(a):!1,expiresOn:new Date(Number(s+e.expires_in)*1e3),tokenType:v,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}})}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,n,i,o,s,a){let c=Me.createIdTokenEntity(n,t.authority,e.id_token||"",t.clientId,i.tid||""),l=t.tokenType===ge.POP?y.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,d=a+l,u=this.generateScopes(e,t),m=Me.createAccessTokenEntity(n,t.authority,o,t.clientId,i.tid||s,u.printScopes(),d,0,xt,void 0,t.tokenType,void 0,t.keyId),p={idToken:c,accessToken:m};this.nativeStorageManager.saveCacheRecord(p,t.storeInCache)}addTelemetryFromNativeResponse(e){let t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw _a(mi.unexpectedError,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){return f(this,null,function*(){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");let t=e.authority||this.config.auth.authority;e.account&&(yield this.getDiscoveredAuthority(t,e.azureCloudOptions,e.account));let n=new de(t);n.validateAsUri();let l=e,{scopes:i}=l,o=Rt(l,["scopes"]),s=new Fe(i||[]);s.appendScopes(zt);let a=()=>{switch(this.apiId){case _e.ssoSilent:case _e.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Le.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Le.NONE:case Le.CONSENT:case Le.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),R(fs)}},c=U(g({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:s.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:a(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:g(g({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(c.signPopToken&&e.popKid)throw R(vs);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=Qr.MATS_TELEMETRY,e.authenticationScheme===ge.POP){let d={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},u=new qt(this.browserCrypto),m;if(c.keyId)m=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{let p=yield A(u.generateCnf.bind(u),h.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(d,this.logger);m=p.reqCnfString,c.keyId=p.kid,c.signPopToken=!0}c.reqCnf=m}return this.addRequestSKUs(c),c})}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(Wp.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(Wp.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(Lo.CLIENT_ID)){let t=e.extraParameters[Lo.CLIENT_ID],n=e.redirectUri,i=e.extraParameters[Wp.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:t,child_redirect_uri:n},e.redirectUri=i}}};var $t=class r{constructor(e,t,n,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(h.NativeMessageHandlerHandshake)}sendMessage(e){return f(this,null,function*(){this.logger.trace("NativeMessageHandler - sendMessage called.");let t={channel:Qr.CHANNEL_ID,extensionId:this.extensionId,responseId:ct(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((n,i)=>{this.resolvers.set(t.responseId,{resolve:n,reject:i})})})}static createProvider(e,t,n){return f(this,null,function*(){e.trace("NativeMessageHandler - createProvider called.");try{let i=new r(e,t,n,Qr.PREFERRED_EXTENSION_ID);return yield i.sendHandshakeRequest(),i}catch{let o=new r(e,t,n);return yield o.sendHandshakeRequest(),o}})}sendHandshakeRequest(){return f(this,null,function*(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);let e={channel:Qr.CHANNEL_ID,extensionId:this.extensionId,responseId:ct(),body:{method:dr.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(R(hs)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;let t=e.data;if(!(!t.channel||t.channel!==Qr.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===dr.HandshakeRequest){let n=this.handshakeResolvers.get(t.responseId);if(!n){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject(R(ps))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");let t=e.data,n=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{let o=t.body.method;if(o===dr.Response){if(!n)return;let s=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(s)}`),s.status!=="Success")n.reject(hc(s.code,s.description,s.ext));else if(s.result)s.result.code&&s.result.description?n.reject(hc(s.result.code,s.result.description,s.result.ext)):n.resolve(s.result);else throw _a(mi.unexpectedError,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(o===dr.HandshakeResponse){if(!i){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${o}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(o):i&&i.reject(o)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case ge.BEARER:case ge.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}};var Zr=class{constructor(e,t,n,i,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=i,this.performanceClient=o}handleCodeResponse(e,t){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.HandleCodeResponse,t.correlationId);let n;try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(i){throw i instanceof Ge&&i.subError===Pt?R(Pt):i}return A(this.handleCodeResponseFromServer.bind(this),h.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(n,t)})}handleCodeResponseFromServer(e,t,n=!0){return f(this,null,function*(){if(this.performanceClient.addQueueMeasurement(h.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(yield A(this.authModule.updateAuthority.bind(this.authModule),h.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId)),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{let o=this.createCcsCredentials(t);o&&(this.authCodeRequest.ccsCredential=o)}return yield A(this.authModule.acquireToken.bind(this.authModule),h.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)})}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:it.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:it.UPN}:null}};function Sd(r,e,t){let n=Fr.getDeserializedResponse(r);if(!n)throw Fr.stripLeadingHashOrQuery(r)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${r}`),R(jo)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),R($o));return n}function TC(r,e,t){if(!r.state)throw R($r);let n=Td(e,r.state);if(!n)throw R(Wo);if(n.interactionType!==t)throw R(Go)}var Ad=class extends Lt{constructor(e,t,n,i,o,s,a,c,l,d){super(e,t,n,i,o,s,a,l,d),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c}acquireToken(e){try{let t=this.generatePopupName(e.scopes||zt,e.authority||this.config.auth.authority),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,n);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");let i=this.openSizedPopup("about:blank",t,n);return this.acquireTokenPopupAsync(e,t,n,i)}}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");let t=this.initializeLogoutRequest(e),n=this.generateLogoutPopupName(t),i=e&&e.authority,o=e&&e.mainWindowRedirectUri,s=e?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,s,i,void 0,o);{this.logger.verbose("asyncPopup set to false, opening popup");let a=this.openSizedPopup("about:blank",n,s);return this.logoutPopupAsync(t,n,s,i,a,o)}}catch(t){return Promise.reject(t)}}acquireTokenPopupAsync(e,t,n,i){return f(this,null,function*(){this.logger.verbose("acquireTokenPopupAsync called");let o=this.initializeServerTelemetryManager(_e.acquireTokenPopup),s=yield A(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,F.Popup);cc(s.authority);let a;try{let c=yield A(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(s);return a=yield A(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(o,s.authority,s.azureCloudOptions,s.account),yield A(this.acquireTokenPopupAsyncHelper.bind(this),h.PopupClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(a,c,s,e,t,n,i)}catch(c){if(i&&i.close(),c instanceof ve&&(c.setCorrelationId(this.correlationId),o.cacheFailedRequest(c)),!a||!(c instanceof Ge)||c.errorCode!==Ue.INVALID_GRANT_ERROR)throw c;this.performanceClient.addFields({retryError:c.errorCode},this.correlationId);let l=yield A(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(s);return yield A(this.acquireTokenPopupAsyncHelper.bind(this),h.PopupClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(a,l,s,e,t,n,i)}})}acquireTokenPopupAsyncHelper(e,t,n,i,o,s,a){return f(this,null,function*(){let c=n.correlationId;this.performanceClient.addQueueMeasurement(h.PopupClientTokenHelper,c);let l=$t.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,i.authenticationScheme),d;l&&(d=this.performanceClient.startMeasurement(h.FetchAccountIdWithNativeBroker,i.correlationId));let u=yield e.getAuthCodeUrl(U(g({},n),{nativeBroker:l})),m=new Zr(e,this.browserStorage,t,this.logger,this.performanceClient),p={popup:a,popupName:o,popupWindowAttributes:s},v=this.initiateAuthRequest(u,p);this.eventHandler.emitEvent(z.POPUP_OPENED,F.Popup,{popupWindow:v},null);let T=yield this.monitorPopupForHash(v),I=bt(Sd,h.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(T,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Mn.removeThrottle(this.browserStorage,this.config.auth.clientId,t),I.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),d&&d.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw R(nn);let O=new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_e.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,I.accountId,this.nativeStorage,n.correlationId),{userRequestState:D}=ot.parseRequestState(this.browserCrypto,n.state);return O.acquireToken(U(g({},n),{state:D,prompt:void 0}))}return yield m.handleCodeResponse(I,n)})}logoutPopupAsync(e,t,n,i,o,s){return f(this,null,function*(){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(z.LOGOUT_START,F.Popup,e);let a=this.initializeServerTelemetryManager(_e.logoutPopup);try{yield this.clearCacheOnLogout(e.account);let c=yield A(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(a,i,void 0,e.account||void 0);try{c.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&c.authority.protocolMode===ft.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,F.Popup,e),s){let u={apiId:_e.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},m=de.getAbsoluteUrl(s,Nt());yield this.navigationClient.navigateInternal(m,u)}o&&o.close();return}}let l=c.getLogoutUri(e);this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,F.Popup,e);let d=this.openPopup(l,{popupName:t,popupWindowAttributes:n,popup:o});if(this.eventHandler.emitEvent(z.POPUP_OPENED,F.Popup,{popupWindow:d},null),yield this.monitorPopupForHash(d).catch(()=>{}),s){let u={apiId:_e.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},m=de.getAbsoluteUrl(s,Nt());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${m}`),yield this.navigationClient.navigateInternal(m,u)}else this.logger.verbose("No main window navigation requested")}catch(c){throw o&&o.close(),c instanceof ve&&(c.setCorrelationId(this.correlationId),a.cacheFailedRequest(c)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(z.LOGOUT_FAILURE,F.Popup,null,c),this.eventHandler.emitEvent(z.LOGOUT_END,F.Popup),c}this.eventHandler.emitEvent(z.LOGOUT_END,F.Popup)})}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),R(xn)}monitorPopupForHash(e){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");let i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),n(R(Pt));return}let o="";try{o=e.location.href}catch{}if(!o||o==="about:blank")return;clearInterval(i);let s="",a=this.config.auth.OIDCOptions.serverResponseType;e&&(a===vn.QUERY?s=e.location.search:s=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(s)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!n)throw R(Xo);return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),R(Qo)}}openSizedPopup(e,t,n){let i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,s=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,a=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=n.popupSize?.width,l=n.popupSize?.height,d=n.popupPosition?.top,u=n.popupPosition?.left;return(!c||c<0||c>s)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=Ue.POPUP_WIDTH),(!l||l<0||l>a)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=Ue.POPUP_HEIGHT),(!d||d<0||d>a)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),d=Math.max(0,a/2-Ue.POPUP_HEIGHT/2+o)),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),u=Math.max(0,s/2-Ue.POPUP_WIDTH/2+i)),window.open(e,t,`width=${c}, height=${l}, top=${d}, left=${u}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(F.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Ue.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){let t=e.account&&e.account.homeAccountId;return`${Ue.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}};var pc=class{constructor(e,t,n,i,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=i,this.performanceClient=o}initiateAuthRequest(e,t){return f(this,null,function*(){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(fe.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(fe.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);let n={apiId:_e.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),yield t.navigationClient.navigateExternal(e,n);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),yield t.navigationClient.navigateExternal(e,n);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),R(xn)})}handleCodeResponse(e,t){return f(this,null,function*(){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);let n=this.browserStorage.generateStateKey(t),i=this.browserStorage.getTemporaryCache(n);if(!i)throw E(rt.stateNotFound,"Cached State");let o;try{o=this.authModule.handleFragmentResponse(e,i)}catch(l){throw l instanceof Ge&&l.subError===Pt?R(Pt):l}let s=this.browserStorage.generateNonceKey(i),a=this.browserStorage.getTemporaryCache(s);if(this.authCodeRequest.code=o.code,o.cloud_instance_host_name&&(yield A(this.authModule.updateAuthority.bind(this.authModule),h.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(o.cloud_instance_host_name,this.authCodeRequest.correlationId)),o.nonce=a||void 0,o.state=i,o.client_info)this.authCodeRequest.clientInfo=o.client_info;else{let l=this.checkCcsCredentials();l&&(this.authCodeRequest.ccsCredential=l)}let c=yield this.authModule.acquireToken(this.authCodeRequest,o);return this.browserStorage.cleanRequestByState(t),this.browserStorage.removeRequestRetried(),c})}checkCcsCredentials(){let e=this.browserStorage.getTemporaryCache(fe.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}};var Id=class extends Lt{constructor(e,t,n,i,o,s,a,c,l,d){super(e,t,n,i,o,s,a,l,d),this.nativeStorage=c}acquireToken(e){return f(this,null,function*(){e.onRedirectNavigate?this.logger.warning("Unable to cache redirect request, onRedirectNavigate request option has been deprecated. Please set onRedirectNavigate on PublicClientApplication config instead."):this.browserStorage.cacheRedirectRequest(e);let t=yield A(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,F.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);let n=this.initializeServerTelemetryManager(_e.acquireTokenRedirect),i=o=>{o.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(z.RESTORE_FROM_BFCACHE,F.Redirect))};try{let o=yield A(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),s=yield A(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(n,t.authority,t.azureCloudOptions,t.account),a=new pc(s,this.browserStorage,o,this.logger,this.performanceClient),c=yield s.getAuthCodeUrl(U(g({},t),{nativeBroker:$t.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)})),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",i),yield a.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(o){throw o instanceof ve&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),window.removeEventListener("pageshow",i),this.browserStorage.cleanRequestByState(t.state),o}})}handleRedirectPromise(e="",t){return f(this,null,function*(){let n=this.initializeServerTelemetryManager(_e.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let[i,o]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(F.Redirect),t.event.errorCode="no_server_response",null;let s=this.browserStorage.getTemporaryCache(fe.ORIGIN_URI,!0)||y.EMPTY_STRING,a=de.removeHashFromUrl(s),c=de.removeHashFromUrl(window.location.href);if(a===c&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),s.indexOf("#")>-1&&$p(s),yield this.handleResponse(i,n);if(this.config.auth.navigateToLoginRequestUrl){if(!sc()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(fe.URL_HASH,o,!0);let l={apiId:_e.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},d=!0;if(!s||s==="null"){let u=jp();this.browserStorage.setTemporaryCache(fe.ORIGIN_URI,u,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),d=yield this.navigationClient.navigateInternal(u,l)}else this.logger.verbose(`Navigating to loginRequestUrl: ${s}`),d=yield this.navigationClient.navigateInternal(s,l);if(!d)return yield this.handleResponse(i,n)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield this.handleResponse(i,n);return null}catch(i){if(i instanceof ve&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i instanceof Ge&&i.errorCode===Ue.INVALID_GRANT_ERROR){if(this.performanceClient.addFields({retryError:i.errorCode},this.correlationId),this.browserStorage.getRequestRetried())throw this.logger.error("Retried request already detected. Throwing error."),this.browserStorage.removeRequestRetried(),i;let s=this.browserStorage.getCachedRedirectRequest();if(!s)throw this.logger.error("Unable to retry. Please retry with redirect request"),this.browserStorage.setRequestRetried(),R(od);return this.browserStorage.setRequestRetried(),yield this.acquireToken(s),null}throw this.browserStorage.removeTemporaryItem(this.browserStorage.generateCacheKey(fe.REDIRECT_REQUEST)),this.browserStorage.removeRequestRetried(),i}finally{this.browserStorage.cleanRequestByInteractionType(F.Redirect)}})}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===vn.QUERY?t=window.location.search:t=window.location.hash);let n=Fr.getDeserializedResponse(t);if(n){try{TC(n,this.browserCrypto,F.Redirect)}catch(o){return o instanceof ve&&this.logger.error(`Interaction type validation failed due to ${o.errorCode}: ${o.errorMessage}`),[null,""]}return qp(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}let i=this.browserStorage.getTemporaryCache(fe.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(fe.URL_HASH)),i&&(n=Fr.getDeserializedResponse(i),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,i]):[null,""]}handleResponse(e,t){return f(this,null,function*(){let n=e.state;if(!n)throw R($r);let i=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw R(nn);let c=new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_e.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,i.correlationId),{userRequestState:l}=ot.parseRequestState(this.browserCrypto,n);return c.acquireToken(U(g({},i),{state:l,prompt:void 0})).finally(()=>{this.browserStorage.cleanRequestByState(n)})}let o=this.browserStorage.getCachedAuthority(n);if(!o)throw R(jr);let s=yield A(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(t,o);return Mn.removeThrottle(this.browserStorage,this.config.auth.clientId,i),new pc(s,this.browserStorage,i,this.logger,this.performanceClient).handleCodeResponse(e,n)})}logout(e){return f(this,null,function*(){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(_e.logout);try{this.eventHandler.emitEvent(z.LOGOUT_START,F.Redirect,e),yield this.clearCacheOnLogout(t.account);let i={apiId:_e.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=yield A(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(n,e&&e.authority,void 0,e&&e.account||void 0);if(o.authority.protocolMode===ft.OIDC)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.browserStorage.removeAccount(t.account?.homeAccountId),this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,F.Redirect,t);return}}let s=o.getLogoutUri(t);if(this.eventHandler.emitEvent(z.LOGOUT_SUCCESS,F.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(s)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(s,i);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(s,i);return}}catch(i){throw i instanceof ve&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),this.eventHandler.emitEvent(z.LOGOUT_FAILURE,F.Redirect,null,i),this.eventHandler.emitEvent(z.LOGOUT_END,F.Redirect),i}this.eventHandler.emitEvent(z.LOGOUT_END,F.Redirect)})}getRedirectStartPage(e){let t=e||window.location.href;return de.getAbsoluteUrl(t,Nt())}};function _C(r,e,t,n,i){return f(this,null,function*(){if(e.addQueueMeasurement(h.SilentHandlerInitiateAuthRequest,n),!r)throw t.info("Navigate url is empty"),R(xn);return i?A(JS,h.SilentHandlerLoadFrame,t,e,n)(r,i,e,n):bt(ZS,h.SilentHandlerLoadFrameSync,t,e,n)(r)})}function EC(r,e,t,n,i,o,s){return f(this,null,function*(){return n.addQueueMeasurement(h.SilentHandlerMonitorIframeForHash,o),new Promise((a,c)=>{e<gd&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${gd}ms). This may result in timeouts.`);let l=window.setTimeout(()=>{window.clearInterval(d),c(R(Jo))},e),d=window.setInterval(()=>{let u="",m=r.contentWindow;try{u=m?m.location.href:""}catch{}if(!u||u==="about:blank")return;let p="";m&&(s===vn.QUERY?p=m.location.search:p=m.location.hash),window.clearTimeout(l),window.clearInterval(d),a(p)},t)}).finally(()=>{bt(eA,h.RemoveHiddenIframe,i,n,o)(r)})})}function JS(r,e,t,n){return t.addQueueMeasurement(h.SilentHandlerLoadFrame,n),new Promise((i,o)=>{let s=SC();window.setTimeout(()=>{if(!s){o("Unable to load iframe");return}s.src=r,i(s)},e)})}function ZS(r){let e=SC();return e.src=r,e}function SC(){let r=document.createElement("iframe");return r.className="msalSilentIframe",r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(r),r}function eA(r){document.body===r.parentNode&&document.body.removeChild(r)}var bd=class extends Lt{constructor(e,t,n,i,o,s,a,c,l,d,u){super(e,t,n,i,o,s,c,d,u),this.apiId=a,this.nativeStorage=l}acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");let t=g({},e);t.prompt?t.prompt!==Le.NONE&&t.prompt!==Le.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Le.NONE}`),t.prompt=Le.NONE):t.prompt=Le.NONE;let n=yield A(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,F.Silent);cc(n.authority);let i=this.initializeServerTelemetryManager(this.apiId),o;try{return o=yield A(this.createAuthCodeClient.bind(this),h.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)(i,n.authority,n.azureCloudOptions,n.account),yield A(this.silentTokenHelper.bind(this),h.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(o,n)}catch(s){if(s instanceof ve&&(s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s)),!o||!(s instanceof Ge)||s.errorCode!==Ue.INVALID_GRANT_ERROR)throw s;this.performanceClient.addFields({retryError:s.errorCode},this.correlationId);let a=yield A(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,F.Silent);return yield A(this.silentTokenHelper.bind(this),h.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(o,a)}})}logout(){return Promise.reject(R(Ln))}silentTokenHelper(e,t){return f(this,null,function*(){let n=t.correlationId;this.performanceClient.addQueueMeasurement(h.SilentIframeClientTokenHelper,n);let i=yield A(this.initializeAuthorizationCodeRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,n)(t),o=yield A(e.getAuthCodeUrl.bind(e),h.GetAuthCodeUrl,this.logger,this.performanceClient,n)(U(g({},t),{nativeBroker:$t.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)})),s=new Zr(e,this.browserStorage,i,this.logger,this.performanceClient),a=yield A(_C,h.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(o,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,l=yield A(EC,h.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(a,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,c),d=bt(Sd,h.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,c,this.logger);if(d.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw R(nn);let u=new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,d.accountId,this.browserStorage,n),{userRequestState:m}=ot.parseRequestState(this.browserCrypto,t.state);return A(u.acquireToken.bind(u),h.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,n)(U(g({},t),{state:m,prompt:t.prompt||Le.NONE}))}return A(s.handleCodeResponse.bind(s),h.HandleCodeResponse,this.logger,this.performanceClient,n)(d,t)})}};var kd=class extends Lt{acquireToken(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.SilentRefreshClientAcquireToken,e.correlationId);let t=yield A(uc,h.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=g(g({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));let i=this.initializeServerTelemetryManager(_e.acquireTokenSilent_silentFlow),o=yield this.createRefreshTokenClient(i,n.authority,n.azureCloudOptions,n.account);return A(o.acquireTokenByRefreshToken.bind(o),h.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(n).catch(s=>{throw s.setCorrelationId(this.correlationId),i.cacheFailedRequest(s),s})})}logout(){return Promise.reject(R(Ln))}createRefreshTokenClient(e,t,n,i){return f(this,null,function*(){let o=yield A(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,n,i);return new qr(o,this.performanceClient)})}};var Rd=class{constructor(e,t,n,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=n,this.cryptoObj=i}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw R(Wr);let i=t.id_token?xr.extractTokenClaims(t.id_token,xt):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},s=e.authority?new en(en.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||ct()):void 0,a=this.loadAccount(e,n.clientInfo||t.client_info||"",i,s),c=this.loadIdToken(t,a.homeAccountId,a.environment,a.realm),l=this.loadAccessToken(e,t,a.homeAccountId,a.environment,a.realm,n),d=this.loadRefreshToken(t,a.homeAccountId,a.environment);return this.generateAuthenticationResult(e,{account:a,idToken:c,accessToken:l,refreshToken:d},i,s)}loadAccount(e,t,n,i){if(this.logger.verbose("TokenCache - loading account"),e.account){let c=Oe.createFromAccountInfo(e.account);return this.storage.setAccount(c),c}else if(!i||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),R(as);let o=Oe.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,n),s=n?.tid,a=zo(this.storage,i,o,xt,n,t,i.hostnameAndPort,s,void 0,void 0,this.logger);return this.storage.setAccount(a),a}loadIdToken(e,t,n,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");let o=Me.createIdTokenEntity(t,n,e.id_token,this.config.auth.clientId,i);return this.storage.setIdTokenCredential(o),o}loadAccessToken(e,t,n,i,o,s){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");let a=t.scope?Fe.fromString(t.scope):new Fe(e.scopes),c=s.expiresOn||t.expires_in+new Date().getTime()/1e3,l=s.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,d=Me.createAccessTokenEntity(n,i,t.access_token,this.config.auth.clientId,o,a.printScopes(),c,l,xt);return this.storage.setAccessTokenCredential(d),d}loadRefreshToken(e,t,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");let i=Me.createRefreshTokenEntity(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i),i}generateAuthenticationResult(e,t,n,i){let o="",s=[],a=null,c;t?.accessToken&&(o=t.accessToken.secret,s=Fe.fromString(t.accessToken.target).asArray(),a=new Date(Number(t.accessToken.expiresOn)*1e3),c=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));let l=t.account;return{authority:i?i.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:s,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:o,fromCache:!0,expiresOn:a,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}};var Dd=class extends $i{constructor(e){super(e),this.includeRedirectUri=!1}};var Md=class extends Lt{constructor(e,t,n,i,o,s,a,c,l,d){super(e,t,n,i,o,s,c,l,d),this.apiId=a}acquireToken(e){return f(this,null,function*(){if(!e.code)throw R(cs);let t=yield A(this.initializeAuthorizationRequest.bind(this),h.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,F.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{let i=U(g({},t),{code:e.code}),o=yield A(this.getClientConfiguration.bind(this),h.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)(n,t.authority,t.azureCloudOptions,t.account),s=new Dd(o);this.logger.verbose("Auth code client created");let a=new Zr(s,this.browserStorage,i,this.logger,this.performanceClient);return yield A(a.handleCodeResponseFromServer.bind(a),h.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(i){throw i instanceof ve&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i}})}logout(){return Promise.reject(R(Ln))}};function Hn(r){let e=r?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function Od(r,e){try{ac(r)}catch(t){throw e.end({success:!1},t),t}}var Es=class r{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new rC(this.logger,this.performanceClient):Br,this.eventHandler=new _d(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new ws(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,$h(this.config.auth),this.performanceClient):iC(this.config.auth.clientId,this.logger);let t={cacheLocation:ke.MemoryStorage,temporaryCacheLocation:ke.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new ws(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new Rd(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e,t){return f(this,null,function*(){let n=new r(e);return yield n.initialize(t),n})}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(e){return f(this,null,function*(){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}let t=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,i=this.performanceClient.startMeasurement(h.InitializeClientApplication,t);if(this.eventHandler.emitEvent(z.INITIALIZE_START),n)try{this.nativeExtensionProvider=yield $t.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(o){this.logger.verbose(o)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),yield A(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),h.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(z.INITIALIZE_END),i.end({allowNativeBroker:n,success:!0})})}handleRedirectPromise(e){return f(this,null,function*(){if(this.logger.verbose("handleRedirectPromise called"),hd(this.initialized),this.isBrowserEnvironment){let t=e||"",n=this.redirectResponse.get(t);return typeof n>"u"?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})}handleRedirectPromiseInternal(e){return f(this,null,function*(){let t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),i=n&&$t.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,o=i?n?.correlationId:this.browserStorage.getTemporaryCache(fe.CORRELATION_ID,!0)||"",s=this.performanceClient.startMeasurement(h.AcquireTokenRedirect,o);this.eventHandler.emitEvent(z.HANDLE_REDIRECT_START,F.Redirect);let a;if(i&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");let c=new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_e.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);a=A(c.handleRedirectPromise.bind(c),h.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(this.performanceClient,s.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");let c=this.createRedirectClient(o);a=A(c.handleRedirectPromise.bind(c),h.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,s.event.correlationId)(e,s)}return a.then(c=>(c?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(z.LOGIN_SUCCESS,F.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,F.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),s.end({success:!0,accountType:Hn(c.account)})):s.event.errorCode?s.end({success:!1}):s.discard(),this.eventHandler.emitEvent(z.HANDLE_REDIRECT_END,F.Redirect),c)).catch(c=>{let l=c;throw t.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,F.Redirect,null,l):this.eventHandler.emitEvent(z.LOGIN_FAILURE,F.Redirect,null,l),this.eventHandler.emitEvent(z.HANDLE_REDIRECT_END,F.Redirect),s.end({success:!1},l),c})})}acquireTokenRedirect(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);let n=this.performanceClient.startMeasurement(h.AcquireTokenPreRedirect,t);n.add({accountType:Hn(e.account),scenarioId:e.scenarioId});let i=e.onRedirectNavigate;if(i)e.onRedirectNavigate=s=>{let a=typeof i=="function"?i(s):void 0;return a!==!1?n.end({success:!0}):n.discard(),a};else{let s=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=a=>{let c=typeof s=="function"?s(a):void 0;return c!==!1?n.end({success:!0}):n.discard(),c}}let o=this.getAllAccounts().length>0;try{pd(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),o?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,F.Redirect,e):this.eventHandler.emitEvent(z.LOGIN_START,F.Redirect,e);let s;return this.nativeExtensionProvider&&this.canUseNative(e)?s=new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_e.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(c=>{if(c instanceof rn&&Jr(c))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(c instanceof gt)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):s=this.createRedirectClient(t).acquireToken(e),yield s}catch(s){throw n.end({success:!1},s),o?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,F.Redirect,null,s):this.eventHandler.emitEvent(z.LOGIN_FAILURE,F.Redirect,null,s),s}})}acquireTokenPopup(e){let t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(h.AcquireTokenPopup,t);n.add({scenarioId:e.scenarioId,accountType:Hn(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),Od(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(s){return Promise.reject(s)}let i=this.getAllAccounts();i.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,F.Popup,e):this.eventHandler.emitEvent(z.LOGIN_START,F.Popup,e);let o;return this.canUseNative(e)?o=this.acquireTokenNative(U(g({},e),{correlationId:t}),_e.acquireTokenPopup).then(s=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:s.requestId,accountType:Hn(s.account)}),s)).catch(s=>{if(s instanceof rn&&Jr(s))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(s instanceof gt)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),s}):o=this.createPopupClient(t).acquireToken(e),o.then(s=>(i.length<this.getAllAccounts().length?this.eventHandler.emitEvent(z.LOGIN_SUCCESS,F.Popup,s):this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,F.Popup,s),n.end({success:!0,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Hn(s.account)}),s)).catch(s=>(i.length>0?this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,F.Popup,null,s):this.eventHandler.emitEvent(z.LOGIN_FAILURE,F.Popup,null,s),n.end({success:!1},s),Promise.reject(s)))}trackPageVisibilityWithMeasurement(){let e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e),n=U(g({},e),{prompt:e.prompt,correlationId:t});this.ssoSilentMeasurement=this.performanceClient.startMeasurement(h.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:Hn(e.account)}),Od(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(z.SSO_SILENT_START,F.Silent,n);let i;return this.canUseNative(n)?i=this.acquireTokenNative(n,_e.ssoSilent).catch(o=>{if(o instanceof rn&&Jr(o))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw o}):i=this.createSilentIframeClient(n.correlationId).acquireToken(n),i.then(o=>(this.eventHandler.emitEvent(z.SSO_SILENT_SUCCESS,F.Silent,o),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:o.fromNativeBroker,requestId:o.requestId,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:Hn(o.account)}),o)).catch(o=>{throw this.eventHandler.emitEvent(z.SSO_SILENT_FAILURE,F.Silent,null,o),this.ssoSilentMeasurement?.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenByCode(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);let n=this.performanceClient.startMeasurement(h.AcquireTokenByCode,t);Od(this.initialized,n),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_START,F.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw R(ds);if(e.code){let i=e.code,o=this.hybridAuthCodeResponses.get(i);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(U(g({},e),{correlationId:t})).then(s=>(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_SUCCESS,F.Silent,s),this.hybridAuthCodeResponses.delete(i),n.end({success:!0,isNativeBroker:s.fromNativeBroker,requestId:s.requestId,accessTokenSize:s.accessToken.length,idTokenSize:s.idToken.length,accountType:Hn(s.account)}),s)).catch(s=>{throw this.hybridAuthCodeResponses.delete(i),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_FAILURE,F.Silent,null,s),n.end({success:!1},s),s}),this.hybridAuthCodeResponses.set(i,o)),yield o}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){let i=yield this.acquireTokenNative(U(g({},e),{correlationId:t}),_e.acquireTokenByCode,e.nativeAccountId).catch(o=>{throw o instanceof rn&&Jr(o)&&(this.nativeExtensionProvider=void 0),o});return n.end({accountType:Hn(i.account),success:!0}),i}else throw R(us);else throw R(ls)}catch(i){throw this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_BY_CODE_FAILURE,F.Silent,null,i),n.end({success:!1},i),i}})}acquireTokenByCodeAsync(e){return f(this,null,function*(){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(h.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),yield this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker,requestId:i.requestId}),i)).catch(i=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenFromCache(e,t){return f(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(h.AcquireTokenFromCache,e.correlationId),t){case kt.Default:case kt.AccessToken:case kt.AccessTokenAndRefreshToken:let n=this.createSilentCacheClient(e.correlationId);return A(n.acquireToken.bind(n),h.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw E(rt.tokenRefreshRequired)}})}acquireTokenByRefreshToken(e,t){return f(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(h.AcquireTokenByRefreshToken,e.correlationId),t){case kt.Default:case kt.AccessTokenAndRefreshToken:case kt.RefreshToken:case kt.RefreshTokenAndNetwork:let n=this.createSilentRefreshClient(e.correlationId);return A(n.acquireToken.bind(n),h.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw E(rt.tokenRefreshRequired)}})}acquireTokenBySilentIframe(e){return f(this,null,function*(){this.performanceClient.addQueueMeasurement(h.AcquireTokenBySilentIframe,e.correlationId);let t=this.createSilentIframeClient(e.correlationId);return A(t.acquireToken.bind(t),h.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)})}logout(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect(g({correlationId:t},e))})}logoutRedirect(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e);return pd(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)})}logoutPopup(e){try{let t=this.getRequestCorrelationId(e);return ac(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}clearCache(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)})}getAllAccounts(e){return oC(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return sC(e,this.logger,this.browserStorage)}getAccountByUsername(e){return aC(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return cC(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return lC(e,this.logger,this.browserStorage)}setActiveAccount(e){dC(e,this.browserStorage)}getActiveAccount(){return uC(this.browserStorage)}hydrateCache(e,t){return f(this,null,function*(){this.logger.verbose("hydrateCache called");let n=Oe.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)})}acquireTokenNative(e,t,n){return f(this,null,function*(){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw R(nn);return new on(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)})}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!$t.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Le.NONE:case Le.CONSENT:case Le.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){let t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new Ad(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new Id(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new bd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_e.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new _s(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new kd(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Md(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,_e.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?ct():y.EMPTY_STRING}loginRedirect(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect(g({correlationId:t},e||Hp))})}loginPopup(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(g({correlationId:t},e||Hp))}acquireTokenSilent(e){return f(this,null,function*(){let t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(h.AcquireTokenSilent,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),Od(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);let i=e.account||this.getActiveAccount();if(!i)throw R(ns);n.add({accountType:Hn(i)});let o={clientId:this.config.auth.clientId,authority:e.authority||y.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:i.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},s=JSON.stringify(o),a=this.activeSilentTokenRequests.get(s);if(typeof a>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);let c=A(this.acquireTokenSilentAsync.bind(this),h.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)(U(g({},e),{correlationId:t}),i).then(l=>(this.activeSilentTokenRequests.delete(s),n.end({success:!0,fromCache:l.fromCache,isNativeBroker:l.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:l.requestId,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),l)).catch(l=>{throw this.activeSilentTokenRequests.delete(s),n.end({success:!1},l),l});return this.activeSilentTokenRequests.set(s,c),U(g({},yield c),{state:e.state})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),U(g({},yield a),{state:e.state})})}acquireTokenSilentAsync(e,t){return f(this,null,function*(){let n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(h.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_START,F.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);let i=yield A(pC,h.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||kt.Default;return this.acquireTokenSilentNoIframe(i,o).catch(a=>f(this,null,function*(){if(tA(a,o))if(this.activeIframeRequest)if(o!==kt.Skip){let[l,d]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${d}`,i.correlationId);let u=this.performanceClient.startMeasurement(h.AwaitConcurrentIframe,i.correlationId);u.add({awaitIframeCorrelationId:d});let m=yield l;if(u.end({success:m}),m)return this.logger.verbose(`Parallel iframe request with correlationId: ${d} succeeded. Retrying cache and/or RT redemption`,i.correlationId),this.acquireTokenSilentNoIframe(i,o);throw this.logger.info(`Iframe request with correlationId: ${d} failed. Interaction is required.`),a}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",i.correlationId),A(this.acquireTokenBySilentIframe.bind(this),h.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i);else{let l;return this.activeIframeRequest=[new Promise(d=>{l=d}),i.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",i.correlationId),A(this.acquireTokenBySilentIframe.bind(this),h.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i).then(d=>(l(!0),d)).catch(d=>{throw l(!1),d}).finally(()=>{this.activeIframeRequest=void 0})}else throw a})).then(a=>(this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_SUCCESS,F.Silent,a),e.correlationId&&this.performanceClient.addFields({fromCache:a.fromCache,isNativeBroker:a.fromNativeBroker,requestId:a.requestId},e.correlationId),a)).catch(a=>{throw this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_FAILURE,F.Silent,null,a),a}).finally(()=>{document.removeEventListener("visibilitychange",n)})})}acquireTokenSilentNoIframe(e,t){return f(this,null,function*(){return $t.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,_e.acquireTokenSilent_silentFlow).catch(n=>f(this,null,function*(){throw n instanceof rn&&Jr(n)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,E(rt.tokenRefreshRequired)):n}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),A(this.acquireTokenFromCache.bind(this),h.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===kt.AccessToken)throw n;return this.eventHandler.emitEvent(z.ACQUIRE_TOKEN_NETWORK_START,F.Silent,e),A(this.acquireTokenByRefreshToken.bind(this),h.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))})}};function tA(r,e){let t=!(r instanceof gt&&r.subError!==ar.badToken),n=r.errorCode===Ue.INVALID_GRANT_ERROR||r.errorCode===rt.tokenRefreshRequired,i=t&&n||r.errorCode===ar.noTokensFound||r.errorCode===ar.refreshTokenExpired,o=Fy.includes(e);return i&&o}function AC(r,e){return f(this,null,function*(){let t=new yd(r);return yield t.initialize(),Es.createController(t,e)})}var mc=class r{static createPublicClientApplication(e){return f(this,null,function*(){let t=yield AC(e);return new r(e,t)})}constructor(e,t){this.controller=t||new Es(new yd(e))}initialize(e){return f(this,null,function*(){return this.controller.initialize(e)})}acquireTokenPopup(e){return f(this,null,function*(){return this.controller.acquireTokenPopup(e)})}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(e,t){return f(this,null,function*(){return this.controller.hydrateCache(e,t)})}clearCache(e){return this.controller.clearCache(e)}};var fc=class{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case z.LOGIN_START:return Ye.Login;case z.SSO_SILENT_START:return Ye.SsoSilent;case z.ACQUIRE_TOKEN_START:if(e.interactionType===F.Redirect||e.interactionType===F.Popup)return Ye.AcquireToken;break;case z.HANDLE_REDIRECT_START:return Ye.HandleRedirect;case z.LOGOUT_START:return Ye.Logout;case z.SSO_SILENT_SUCCESS:case z.SSO_SILENT_FAILURE:if(t&&t!==Ye.SsoSilent)break;return Ye.None;case z.LOGOUT_END:if(t&&t!==Ye.Logout)break;return Ye.None;case z.HANDLE_REDIRECT_END:if(t&&t!==Ye.HandleRedirect)break;return Ye.None;case z.LOGIN_SUCCESS:case z.LOGIN_FAILURE:case z.ACQUIRE_TOKEN_SUCCESS:case z.ACQUIRE_TOKEN_FAILURE:case z.RESTORE_FROM_BFCACHE:if(e.interactionType===F.Redirect||e.interactionType===F.Popup){if(t&&t!==Ye.Login&&t!==Ye.AcquireToken)break;return Ye.None}break}return null}};var IC="@azure/msal-angular",Gp="3.0.23",Pd=new Xe("MSAL_INSTANCE"),gc=new Xe("MSAL_GUARD_CONFIG"),Yp=new Xe("MSAL_INTERCEPTOR_CONFIG"),nA=new Xe("MSAL_BROADCAST_CONFIG"),hr=(()=>{class r{constructor(t,n){this.instance=t,this.location=n;let i=this.location.path(!0).split("#").pop();i&&(this.redirectHash=`#${i}`),this.instance.initializeWrapperLibrary(Bp.Angular,Gp)}initialize(){return Be(this.instance.initialize())}acquireTokenPopup(t){return Be(this.instance.acquireTokenPopup(t))}acquireTokenRedirect(t){return Be(this.instance.acquireTokenRedirect(t))}acquireTokenSilent(t){return Be(this.instance.acquireTokenSilent(t))}handleRedirectObservable(t){return Be(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(t||this.redirectHash)))}loginPopup(t){return Be(this.instance.loginPopup(t))}loginRedirect(t){return Be(this.instance.loginRedirect(t))}logout(t){return Be(this.instance.logout(t))}logoutRedirect(t){return Be(this.instance.logoutRedirect(t))}logoutPopup(t){return Be(this.instance.logoutPopup(t))}ssoSilent(t){return Be(this.instance.ssoSilent(t))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(IC,Gp)),this.logger}setLogger(t){this.logger=t.clone(IC,Gp),this.instance.setLogger(t)}}return r.\u0275fac=function(t){return new(t||r)(se(Pd),se(_r))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),Ss=(()=>{class r{constructor(t,n,i){this.msalInstance=t,this.authService=n,this.msalBroadcastConfig=i,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.authService.getLogger().verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new Oc(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new be,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new yt(Ye.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(o=>{this._msalSubject.next(o);let s=fc.getInteractionStatusFromEvent(o,this._inProgress.value);s!==null&&(this.authService.getLogger().verbose(`BroadcastService - ${o.eventType} results in setting inProgress from ${this._inProgress.value} to ${s}`),this._inProgress.next(s))})}}return r.\u0275fac=function(t){return new(t||r)(se(Pd),se(hr),se(nA,8))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),As=(()=>{class r{constructor(t,n,i,o,s){this.msalGuardConfig=t,this.msalBroadcastService=n,this.authService=i,this.location=o,this.router=s,this.msalBroadcastService.inProgress$.subscribe()}parseUrl(t){return this.router.parseUrl(t)}getDestinationUrl(t){this.authService.getLogger().verbose("Guard - getting destination url");let n=document.getElementsByTagName("base"),i=this.location.normalize(n.length?n[0].href:window.location.origin),o=this.location.prepareExternalUrl(t);return o.startsWith("#")?(this.authService.getLogger().verbose("Guard - destination by hash routing"),`${i}/${o}`):`${i}${t}`}loginInteractively(t){let n=typeof this.msalGuardConfig.authRequest=="function"?this.msalGuardConfig.authRequest(this.authService,t):g({},this.msalGuardConfig.authRequest);if(this.msalGuardConfig.interactionType===F.Popup)return this.authService.getLogger().verbose("Guard - logging in by popup"),this.authService.loginPopup(n).pipe(ne(o=>(this.authService.getLogger().verbose("Guard - login by popup successful, can activate, setting active account"),this.authService.instance.setActiveAccount(o.account),!0)));this.authService.getLogger().verbose("Guard - logging in by redirect");let i=this.getDestinationUrl(t.url);return this.authService.loginRedirect(g({redirectStartPage:i},n)).pipe(ne(()=>!1))}activateHelper(t){if(this.msalGuardConfig.interactionType!==F.Popup&&this.msalGuardConfig.interactionType!==F.Redirect)throw new Xi("invalid_interaction_type","Invalid interaction type provided to MSAL Guard. InteractionType.Popup or InteractionType.Redirect must be provided in the MsalGuardConfiguration");if(this.authService.getLogger().verbose("MSAL Guard activated"),typeof window<"u"){if(de.hashContainsKnownProperties(window.location.hash)&&md.isInIframe()&&!this.authService.instance.getConfiguration().system.allowRedirectInIframe)return this.authService.getLogger().warning("Guard - redirectUri set to page with MSAL Guard. It is recommended to not set redirectUri to a page that requires authentication."),Q(!1)}else return this.authService.getLogger().info("Guard - window is undefined, MSAL does not support server-side token acquisition"),Q(!0);this.msalGuardConfig.loginFailedRoute&&(this.loginFailedRoute=this.parseUrl(this.msalGuardConfig.loginFailedRoute));let n=this.location.path(!0);return this.authService.initialize().pipe(fr(()=>this.authService.handleRedirectObservable()),fr(()=>{if(!this.authService.instance.getAllAccounts().length)return t?(this.authService.getLogger().verbose("Guard - no accounts retrieved, log in required to activate"),this.loginInteractively(t)):(this.authService.getLogger().verbose("Guard - no accounts retrieved, no state, cannot load"),Q(!1));if(this.authService.getLogger().verbose("Guard - at least 1 account exists, can activate or load"),t){let i=this.includesCode(t.url),o=!!t.root&&!!t.root.fragment&&this.includesCode(`#${t.root.fragment}`),s=this.location.prepareExternalUrl(t.url).indexOf("#")===0;if(i&&(o||s))return this.authService.getLogger().info("Guard - Hash contains known code response, stopping navigation."),n.indexOf("#")>-1?Q(this.parseUrl(this.location.path())):Q(this.parseUrl(""))}return Q(!0)}),dn(i=>(this.authService.getLogger().error("Guard - error while logging in, unable to activate"),this.authService.getLogger().errorPii(`Guard - error: ${i.message}`),this.loginFailedRoute&&t?(this.authService.getLogger().verbose("Guard - loginFailedRoute set, redirecting"),Q(this.loginFailedRoute)):Q(!1))))}includesCode(t){return t.lastIndexOf("/code")>-1&&t.lastIndexOf("/code")===t.length-5||t.indexOf("#code=")>-1||t.indexOf("&code=")>-1}canActivate(t,n){return this.authService.getLogger().verbose("Guard - canActivate"),this.activateHelper(n)}canActivateChild(t,n){return this.authService.getLogger().verbose("Guard - canActivateChild"),this.activateHelper(n)}canMatch(){return this.authService.getLogger().verbose("Guard - canLoad"),this.activateHelper()}}return r.\u0275fac=function(t){return new(t||r)(se(gc),se(Ss),se(hr),se(_r),se(fa))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),bC=(()=>{class r{constructor(t,n,i,o,s){this.msalInterceptorConfig=t,this.authService=n,this.location=i,this.msalBroadcastService=o,this._document=s}intercept(t,n){if(this.msalInterceptorConfig.interactionType!==F.Popup&&this.msalInterceptorConfig.interactionType!==F.Redirect)throw new Xi("invalid_interaction_type","Invalid interaction type provided to MSAL Interceptor. InteractionType.Popup, InteractionType.Redirect must be provided in the msalInterceptorConfiguration");this.authService.getLogger().verbose("MSAL Interceptor activated");let i=this.getScopesForEndpoint(t.url,t.method);if(!i||i.length===0)return this.authService.getLogger().verbose("Interceptor - no scopes for endpoint"),n.handle(t);let o;this.authService.instance.getActiveAccount()?(this.authService.getLogger().verbose("Interceptor - active account selected"),o=this.authService.instance.getActiveAccount()):(this.authService.getLogger().verbose("Interceptor - no active account, fallback to first account"),o=this.authService.instance.getAllAccounts()[0]);let s=typeof this.msalInterceptorConfig.authRequest=="function"?this.msalInterceptorConfig.authRequest(this.authService,t,{account:o}):U(g({},this.msalInterceptorConfig.authRequest),{account:o});return this.authService.getLogger().info(`Interceptor - ${i.length} scopes found for endpoint`),this.authService.getLogger().infoPii(`Interceptor - [${i}] scopes found for ${t.url}`),this.acquireToken(s,i,o).pipe(Ze(a=>{this.authService.getLogger().verbose("Interceptor - setting authorization headers");let c=t.headers.set("Authorization",`Bearer ${a.accessToken}`),l=t.clone({headers:c});return n.handle(l)}))}acquireToken(t,n,i){return this.authService.acquireTokenSilent(U(g({},t),{scopes:n,account:i})).pipe(dn(()=>(this.authService.getLogger().error("Interceptor - acquireTokenSilent rejected with error. Invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(ut(1),Ze(o=>o===Ye.None?this.acquireTokenInteractively(t,n):this.msalBroadcastService.inProgress$.pipe(qe(s=>s===Ye.None),ut(1),Ze(()=>this.acquireToken(t,n,i))))))),Ze(o=>o.accessToken?Q(o):(this.authService.getLogger().error("Interceptor - acquireTokenSilent resolved with null access token. Known issue with B2C tenants, invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(qe(s=>s===Ye.None),ut(1),Ze(()=>this.acquireTokenInteractively(t,n))))))}acquireTokenInteractively(t,n){if(this.msalInterceptorConfig.interactionType===F.Popup)return this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by popup"),this.authService.acquireTokenPopup(U(g({},t),{scopes:n}));this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by redirect");let i=window.location.href;return this.authService.acquireTokenRedirect(U(g({},t),{scopes:n,redirectStartPage:i})),An}getScopesForEndpoint(t,n){this.authService.getLogger().verbose("Interceptor - getting scopes for endpoint");let i=this.location.normalize(t),o=Array.from(this.msalInterceptorConfig.protectedResourceMap.keys()),s=this.matchResourcesToEndpoint(o,i);return s.length>0?this.matchScopesToEndpoint(this.msalInterceptorConfig.protectedResourceMap,s,n):null}matchResourcesToEndpoint(t,n){let i=[];return t.forEach(o=>{let s=this.location.normalize(o),a=this.getAbsoluteUrl(s),c=new URL(a),l=this.getAbsoluteUrl(n),d=new URL(l);this.checkUrlComponents(c,d)&&i.push(o)}),i}checkUrlComponents(t,n){let i=["protocol","host","pathname","search","hash"];for(let o of i)if(t[o]){let s=decodeURIComponent(t[o]);if(!He.matchPattern(s,n[o]))return!1}return!0}getAbsoluteUrl(t){let n=this._document.createElement("a");return n.href=t,n.href}matchScopesToEndpoint(t,n,i){let o=[];return n.forEach(s=>{let a=[],c=t.get(s);if(c===null){o.push(null);return}c.forEach(l=>{if(typeof l=="string")a.push(l);else{let d=i.toLowerCase();l.httpMethod.toLowerCase()===d&&(l.scopes===null?o.push(null):l.scopes.forEach(m=>{a.push(m)}))}}),a.length>0&&o.push(a)}),o.length>0?(o.length>1&&this.authService.getLogger().warning("Interceptor - More than 1 matching scopes for endpoint found."),o[0]):null}}return r.\u0275fac=function(t){return new(t||r)(se(Yp),se(hr),se(_r),se(Ss),se(Je))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})();var RC=[{path:"event-list",component:my,runGuardsAndResolvers:"always",canActivate:[As]}];var rA=function(){function r(){}return r.prototype.getAllStyles=function(e){return window.getComputedStyle(e)},r.prototype.getStyle=function(e,t){return this.getAllStyles(e)[t]},r.prototype.isStaticPositioned=function(e){return(this.getStyle(e,"position")||"static")==="static"},r.prototype.offsetParent=function(e){for(var t=e.offsetParent||document.documentElement;t&&t!==document.documentElement&&this.isStaticPositioned(t);)t=t.offsetParent;return t||document.documentElement},r.prototype.position=function(e,t){t===void 0&&(t=!0);var n,i={width:0,height:0,top:0,bottom:0,left:0,right:0};if(this.getStyle(e,"position")==="fixed")n=e.getBoundingClientRect(),n={top:n.top,bottom:n.bottom,left:n.left,right:n.right,height:n.height,width:n.width};else{var o=this.offsetParent(e);n=this.offset(e,!1),o!==document.documentElement&&(i=this.offset(o,!1)),i.top+=o.clientTop,i.left+=o.clientLeft}return n.top-=i.top,n.bottom-=i.top,n.left-=i.left,n.right-=i.left,t&&(n.top=Math.round(n.top),n.bottom=Math.round(n.bottom),n.left=Math.round(n.left),n.right=Math.round(n.right)),n},r.prototype.offset=function(e,t){t===void 0&&(t=!0);var n=e.getBoundingClientRect(),i={top:window.pageYOffset-document.documentElement.clientTop,left:window.pageXOffset-document.documentElement.clientLeft},o={height:n.height||e.offsetHeight,width:n.width||e.offsetWidth,top:n.top+i.top,bottom:n.bottom+i.top,left:n.left+i.left,right:n.right+i.left};return t&&(o.height=Math.round(o.height),o.width=Math.round(o.width),o.top=Math.round(o.top),o.bottom=Math.round(o.bottom),o.left=Math.round(o.left),o.right=Math.round(o.right)),o},r.prototype.positionElements=function(e,t,n,i){var o=n.split("-"),s=o[0],a=s===void 0?"top":s,c=o[1],l=c===void 0?"center":c,d=i?this.offset(e,!1):this.position(e,!1),u=this.getAllStyles(t),m=parseFloat(u.marginTop),p=parseFloat(u.marginBottom),v=parseFloat(u.marginLeft),T=parseFloat(u.marginRight),I=0,k=0;switch(a){case"top":I=d.top-(t.offsetHeight+m+p);break;case"bottom":I=d.top+d.height;break;case"left":k=d.left-(t.offsetWidth+v+T);break;case"right":k=d.left+d.width;break}switch(l){case"top":I=d.top;break;case"bottom":I=d.top+d.height-t.offsetHeight;break;case"left":k=d.left;break;case"right":k=d.left+d.width-t.offsetWidth;break;case"center":a==="top"||a==="bottom"?k=d.left+d.width/2-t.offsetWidth/2:I=d.top+d.height/2-t.offsetHeight/2;break}t.style.transform="translate("+Math.round(k)+"px, "+Math.round(I)+"px)";var O=t.getBoundingClientRect(),D=document.documentElement,j=window.innerHeight||D.clientHeight,oe=window.innerWidth||D.clientWidth;return O.left>=0&&O.top>=0&&O.right<=oe&&O.bottom<=j},r}();var iA=/\s+/,DC=new rA;function Qp(r,e,t,n,i){var o=Array.isArray(t)?t:t.split(iA),s=["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right","left-top","left-bottom","right-top","right-bottom"],a=e.classList,c=function(I){var k=I.split("-"),O=k[0],D=k[1],j=[];return i&&(j.push(i+"-"+O),D&&j.push(i+"-"+O+"-"+D),j.forEach(function(oe){a.add(oe)})),j};i&&s.forEach(function(I){a.remove(i+"-"+I)});var l=o.findIndex(function(I){return I==="auto"});l>=0&&s.forEach(function(I){o.find(function(k){return k.search("^"+I)!==-1})==null&&o.splice(l++,1,I)});var d=e.style;d.position="absolute",d.top="0",d.left="0",d["will-change"]="transform";for(var u,m=!1,p=0,v=o;p<v.length;p++){u=v[p];var T=c(u);if(DC.positionElements(r,e,u,n)){m=!0;break}i&&T.forEach(function(I){a.remove(I)})}return m||(u=o[0],c(u),DC.positionElements(r,e,u,n)),u}var Tn=function(){return Tn=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Tn.apply(this,arguments)},Xp=function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))},Ld=function(r){return r[r.SUNDAY=0]="SUNDAY",r[r.MONDAY=1]="MONDAY",r[r.TUESDAY=2]="TUESDAY",r[r.WEDNESDAY=3]="WEDNESDAY",r[r.THURSDAY=4]="THURSDAY",r[r.FRIDAY=5]="FRIDAY",r[r.SATURDAY=6]="SATURDAY",r}(Ld||{}),oA=[Ld.SUNDAY,Ld.SATURDAY],Jp=7,Zp=24,Nd=60,ei=60*60*24;function MC(r,e){var t=e.startDate,n=e.seconds,i=e.excluded,o=e.precision;if(i.length<1)return 0;for(var s=r.addSeconds,a=r.getDay,c=r.addDays,l=s(t,n-1),d=a(t),u=a(l),m=0,p=t,v=function(){var T=a(p);i.some(function(I){return I===T})&&(m+=sA(r,{dayStart:d,dayEnd:u,day:T,precision:o,startDate:t,endDate:l})),p=c(p,1)};p<l;)v();return m}function sA(r,e){var t=e.precision,n=e.day,i=e.dayStart,o=e.dayEnd,s=e.startDate,a=e.endDate,c=r.differenceInSeconds,l=r.endOfDay,d=r.startOfDay;if(t==="minutes"){if(n===i)return c(l(s),s)+1;if(n===o)return c(a,d(a))+1}return ei}function aA(r,e){var t=e.event,n=e.offset,i=e.startOfWeekDate,o=e.excluded,s=e.precision,a=e.totalDaysInView,c=r.max,l=r.differenceInSeconds,d=r.addDays,u=r.endOfDay,m=r.differenceInDays,p=ei,v=c([t.start,i]);if(t.end)switch(s){case"minutes":p=l(t.end,v);break;default:p=m(d(u(t.end),1),v)*ei;break}var T=n*ei,I=T+p,k=a*ei;return I>k&&(p=k-T),p-=MC(r,{startDate:v,seconds:p,excluded:o,precision:s}),p/ei}function cA(r,e){var t=e.event,n=e.startOfWeek,i=e.excluded,o=e.precision,s=r.differenceInDays,a=r.startOfDay,c=r.differenceInSeconds;if(t.start<n)return 0;var l=0;switch(o){case"days":l=s(a(t.start),n)*ei;break;case"minutes":l=c(t.start,n);break}return l-=MC(r,{startDate:n,seconds:l,excluded:i,precision:o}),Math.abs(l/ei)}function lA(r,e){var t=e.event,n=e.periodStart,i=e.periodEnd,o=r.isSameSecond,s=t.start,a=t.end||t.start;return!!(s>n&&s<i||a>n&&a<i||s<n&&a>i||o(s,n)||o(s,i)||o(a,n)||o(a,i))}function vc(r,e){var t=e.events,n=e.periodStart,i=e.periodEnd;return t.filter(function(o){return lA(r,{event:o,periodStart:n,periodEnd:i})})}function OC(r,e){var t=e.date,n=e.weekendDays,i=n===void 0?oA:n,o=r.startOfDay,s=r.isSameDay,a=r.getDay,c=o(new Date),l=a(t);return{date:t,day:l,isPast:t<c,isToday:s(t,c),isFuture:t>c,isWeekend:i.indexOf(l)>-1}}function Ud(r,e){for(var t=e.viewDate,n=e.weekStartsOn,i=e.excluded,o=i===void 0?[]:i,s=e.weekendDays,a=e.viewStart,c=a===void 0?r.startOfWeek(t,{weekStartsOn:n}):a,l=e.viewEnd,d=l===void 0?r.addDays(c,Jp):l,u=r.addDays,m=r.getDay,p=[],v=c;v<d;)o.some(function(T){return m(v)===T})||p.push(OC(r,{date:v,weekendDays:s})),v=u(v,1);return p}function dA(r,e){for(var t=e.date1,n=e.date2,i=e.excluded,o=t,s=0;o<n;)i.indexOf(r.getDay(o))===-1&&s++,o=r.addDays(o,1);return s}function uA(r,e){var t=e.events,n=t===void 0?[]:t,i=e.excluded,o=i===void 0?[]:i,s=e.precision,a=s===void 0?"days":s,c=e.absolutePositionedEvents,l=c===void 0?!1:c,d=e.viewStart,u=e.viewEnd;d=r.startOfDay(d),u=r.endOfDay(u);var m=r.differenceInSeconds,p=r.differenceInDays,v=dA(r,{date1:d,date2:u,excluded:o}),T=p(u,d)+1,I=n.filter(function(D){return D.allDay}).map(function(D){var j=cA(r,{event:D,startOfWeek:d,excluded:o,precision:a}),oe=aA(r,{event:D,offset:j,startOfWeekDate:d,excluded:o,precision:a,totalDaysInView:T});return{event:D,offset:j,span:oe}}).filter(function(D){return D.offset<v}).filter(function(D){return D.span>0}).map(function(D){return{event:D.event,offset:D.offset,span:D.span,startsBeforeWeek:D.event.start<d,endsAfterWeek:(D.event.end||D.event.start)>u}}).sort(function(D,j){var oe=m(D.event.start,j.event.start);return oe===0?m(j.event.end||j.event.start,D.event.end||D.event.start):oe}),k=[],O=[];return I.forEach(function(D,j){if(O.indexOf(D)===-1){O.push(D);var oe=D.span+D.offset,we=I.slice(j+1).filter(function(re){if(re.offset>=oe&&oe+re.span<=T&&O.indexOf(re)===-1){var le=re.offset-oe;return l||(re.offset=le),oe+=re.span+le,O.push(re),!0}}),Te=Xp([D],we,!0),ee=Te.filter(function(re){return re.event.id}).map(function(re){return re.event.id}).join("-");k.push(Tn({row:Te},ee?{id:ee}:{}))}}),k}function hA(r,e){var t=e.events,n=e.viewDate,i=e.hourSegments,o=e.hourDuration,s=e.dayStart,a=e.dayEnd,c=e.weekStartsOn,l=e.excluded,d=e.weekendDays,u=e.segmentHeight,m=e.viewStart,p=e.viewEnd,v=e.minimumEventHeight,T=mA(r,{viewDate:n,hourSegments:i,hourDuration:o,dayStart:s,dayEnd:a}),I=Ud(r,{viewDate:n,weekStartsOn:c,excluded:l,weekendDays:d,viewStart:m,viewEnd:p}),k=r.setHours,O=r.setMinutes,D=r.getHours,j=r.getMinutes;return I.map(function(oe){var we=pA(r,{events:t,viewDate:oe.date,hourSegments:i,dayStart:s,dayEnd:a,segmentHeight:u,eventWidth:1,hourDuration:o,minimumEventHeight:v}),Te=T.map(function(le){var H=le.segments.map(function(M){var Ie=O(k(oe.date,D(M.date)),j(M.date));return Tn(Tn({},M),{date:Ie})});return Tn(Tn({},le),{segments:H})});function ee(le,H){var M=Math.max.apply(Math,H.map(function(Ae){return Ae.left+1})),Ie=le.filter(function(Ae){return Ae.left>=M}).filter(function(Ae){return xd(H,Ae.top,Ae.top+Ae.height).length>0});return Ie.length>0?ee(le,Ie):M}var re=we.events.map(function(le){var H=ee(we.events,xd(we.events,le.top,le.top+le.height)),M=100/H;return Tn(Tn({},le),{left:le.left*M,width:M})});return{hours:Te,date:oe.date,events:re.map(function(le){var H=xd(re.filter(function(M){return M.left>le.left}),le.top,le.top+le.height);return H.length>0?Tn(Tn({},le),{width:Math.min.apply(Math,H.map(function(M){return M.left}))-le.left}):le})}})}function PC(r,e){var t=e.events,n=t===void 0?[]:t,i=e.viewDate,o=e.weekStartsOn,s=e.excluded,a=s===void 0?[]:s,c=e.precision,l=c===void 0?"days":c,d=e.absolutePositionedEvents,u=d===void 0?!1:d,m=e.hourSegments,p=e.hourDuration,v=e.dayStart,T=e.dayEnd,I=e.weekendDays,k=e.segmentHeight,O=e.minimumEventHeight,D=e.viewStart,j=D===void 0?r.startOfWeek(i,{weekStartsOn:o}):D,oe=e.viewEnd,we=oe===void 0?r.endOfWeek(i,{weekStartsOn:o}):oe;n||(n=[]);var Te=r.startOfDay,ee=r.endOfDay;j=Te(j),we=ee(we);var re=vc(r,{events:n,periodStart:j,periodEnd:we}),le=Ud(r,{viewDate:i,weekStartsOn:o,excluded:a,weekendDays:I,viewStart:j,viewEnd:we});return{allDayEventRows:uA(r,{events:re,excluded:a,precision:l,absolutePositionedEvents:u,viewStart:j,viewEnd:we}),period:{events:re,start:le[0].date,end:ee(le[le.length-1].date)},hourColumns:hA(r,{events:n,viewDate:i,hourSegments:m,hourDuration:p,dayStart:v,dayEnd:T,weekStartsOn:o,excluded:a,weekendDays:I,segmentHeight:k,viewStart:j,viewEnd:we,minimumEventHeight:O})}}function NC(r,e){var t=e.events,n=t===void 0?[]:t,i=e.viewDate,o=e.weekStartsOn,s=e.excluded,a=s===void 0?[]:s,c=e.viewStart,l=c===void 0?r.startOfMonth(i):c,d=e.viewEnd,u=d===void 0?r.endOfMonth(i):d,m=e.weekendDays;n||(n=[]);for(var p=r.startOfWeek,v=r.endOfWeek,T=r.differenceInDays,I=r.startOfDay,k=r.addHours,O=r.endOfDay,D=r.isSameMonth,j=r.getDay,oe=p(l,{weekStartsOn:o}),we=v(u,{weekStartsOn:o}),Te=vc(r,{events:n,periodStart:oe,periodEnd:we}),ee=[],re,le=function(X){var te;if(re?(te=I(k(re,Zp)),re.getTime()===te.getTime()&&(te=I(k(re,Zp+1))),re=te):te=re=oe,!a.some(function(lt){return j(te)===lt})){var xe=OC(r,{date:te,weekendDays:m}),Ke=vc(r,{events:Te,periodStart:I(te),periodEnd:O(te)});xe.inMonth=D(te,i),xe.events=Ke,xe.badgeTotal=Ke.length,ee.push(xe)}},H=0;H<T(we,oe)+1;H++)le(H);var M=[],Ie=Jp-a.length;if(Ie<Jp)for(var H=0;H<ee.length;H+=Ie){var Ae=ee.slice(H,H+Ie),co=Ae.some(function(te){return l<=te.date&&te.date<u});co&&(M=Xp(Xp([],M,!0),Ae,!0))}else M=ee;for(var K=Math.floor(M.length/Ie),Y=[],H=0;H<K;H++)Y.push(H*Ie);return{rowOffsets:Y,totalDaysVisibleInWeek:Ie,days:M,period:{start:M[0].date,end:O(M[M.length-1].date),events:Te}}}function xd(r,e,t){return r.filter(function(n){var i=n.top,o=n.top+n.height;return e<o&&o<t||e<i&&i<t?!0:i<=e&&t<=o})}function pA(r,e){var t=e.events,n=e.viewDate,i=e.hourSegments,o=e.dayStart,s=e.dayEnd,a=e.eventWidth,c=e.segmentHeight,l=e.hourDuration,d=e.minimumEventHeight,u=r.setMinutes,m=r.setHours,p=r.startOfDay,v=r.startOfMinute,T=r.endOfDay,I=r.differenceInMinutes,k=u(m(p(n),Fd(o.hour)),Hd(o.minute)),O=u(m(v(T(n)),Fd(s.hour)),Hd(s.minute));O.setSeconds(59,999);var D=[],j=vc(r,{events:t.filter(function(ee){return!ee.allDay}),periodStart:k,periodEnd:O}),oe=j.sort(function(ee,re){return ee.start.valueOf()-re.start.valueOf()}).map(function(ee){var re=ee.start,le=ee.end||re,H=re<k,M=le>O,Ie=i*c/(l||Nd),Ae=0;if(re>k){var co=r.getTimezoneOffset(re),K=r.getTimezoneOffset(k),Y=K-co;Ae+=I(re,k)+Y}Ae*=Ie,Ae=Math.floor(Ae);var X=H?k:re,te=M?O:le,xe=r.getTimezoneOffset(X)-r.getTimezoneOffset(te),Ke=I(te,X)+xe;ee.end?Ke*=Ie:Ke=c,d&&Ke<d&&(Ke=d),Ke=Math.floor(Ke);for(var lt=Ae+Ke,Sn=xd(D,Ae,lt),Re=0;Sn.some(function(hu){return hu.left===Re});)Re+=a;var xs={event:ee,height:Ke,width:a,top:Ae,left:Re,startsBeforeDay:H,endsAfterDay:M};return D.push(xs),xs}),we=Math.max.apply(Math,oe.map(function(ee){return ee.left+ee.width})),Te=vc(r,{events:t.filter(function(ee){return ee.allDay}),periodStart:p(k),periodEnd:T(O)});return{events:oe,width:we,allDayEvents:Te,period:{events:j,start:k,end:O}}}function Fd(r){return Math.max(Math.min(23,r),0)}function Hd(r){return Math.max(Math.min(59,r),0)}function mA(r,e){var t=e.viewDate,n=e.hourSegments,i=e.hourDuration,o=e.dayStart,s=e.dayEnd,a=r.setMinutes,c=r.setHours,l=r.startOfDay,d=r.startOfMinute,u=r.endOfDay,m=r.addMinutes,p=r.addDays,v=[],T=a(c(l(t),Fd(o.hour)),Hd(o.minute)),I=a(c(d(u(t)),Fd(s.hour)),Hd(s.minute)),k=(i||Nd)/n,O=l(t),D=u(t),j=function(le){return le};r.getTimezoneOffset(O)!==r.getTimezoneOffset(D)&&(O=p(O,1),T=p(T,1),I=p(I,1),j=function(le){return p(le,-1)});for(var oe=i?Zp*60/i:Nd,we=0;we<oe;we++){for(var Te=[],ee=0;ee<n;ee++){var re=m(m(T,we*(i||Nd)),ee*k);re>=T&&re<I&&Te.push({date:j(re),displayDate:re,isStart:ee===0})}Te.length>0&&v.push({segments:Te})}return v}var Is=function(r){return r.NotArray="Events must be an array",r.StartPropertyMissing="Event is missing the `start` property",r.StartPropertyNotDate="Event `start` property should be a javascript date object. Do `new Date(event.start)` to fix it.",r.EndPropertyNotDate="Event `end` property should be a javascript date object. Do `new Date(event.end)` to fix it.",r.EndsBeforeStart="Event `start` property occurs after the `end`",r}(Is||{});function xC(r,e){var t=!0;function n(i,o){e(i,o),t=!1}return Array.isArray(r)?(r.forEach(function(i){i.start?i.start instanceof Date||n(Is.StartPropertyNotDate,i):n(Is.StartPropertyMissing,i),i.end&&(i.end instanceof Date||n(Is.EndPropertyNotDate,i),i.start>i.end&&n(Is.EndsBeforeStart,i))}),t):(e(Is.NotArray,r),!1)}function fA(r,e){return typeof r>"u"?typeof e>"u"?r:e:r}function rm(r,e){return r=fA(r,e),typeof r=="function"?function(){for(var n=arguments,i=arguments.length,o=Array(i),s=0;s<i;s++)o[s]=n[s];return!!r.apply(this,o)}:r?function(){return!0}:function(){return!1}}var em=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol?"symbol":typeof r},FC=function(r){return r!=null&&(typeof r>"u"?"undefined":em(r))==="object"&&r.nodeType===1&&em(r.style)==="object"&&em(r.ownerDocument)==="object"};function HC(r,e){if(e=sm(e,!0),!FC(e))return-1;for(var t=0;t<r.length;t++)if(r[t]===e)return t;return-1}function im(r,e){return HC(r,e)!==-1}function gA(r,e){for(var t=0;t<e.length;t++)im(r,e[t])||r.push(e[t]);return e}function vA(r){for(var e=arguments,t=[],n=arguments.length-1;n-- >0;)t[n]=e[n+1];return t=t.map(sm),gA(r,t)}function yA(r){for(var e=arguments,t=[],n=arguments.length-1;n-- >0;)t[n]=e[n+1];return t.map(sm).reduce(function(i,o){var s=HC(r,o);return s!==-1?i.concat(r.splice(s,1)):i},[])}function sm(r,e){if(typeof r=="string")try{return document.querySelector(r)}catch(t){throw t}if(!FC(r)&&!e)throw new TypeError(r+" is not a DOM element.");return r}function CA(r,e){e=e||{};var t=rm(e.allowUpdate,!0);return function(i){if(i=i||window.event,r.target=i.target||i.srcElement||i.originalTarget,r.element=this,r.type=i.type,!!t(i)){if(i.targetTouches)r.x=i.targetTouches[0].clientX,r.y=i.targetTouches[0].clientY,r.pageX=i.targetTouches[0].pageX,r.pageY=i.targetTouches[0].pageY,r.screenX=i.targetTouches[0].screenX,r.screenY=i.targetTouches[0].screenY;else{if(i.pageX===null&&i.clientX!==null){var o=i.target&&i.target.ownerDocument||document,s=o.documentElement,a=o.body;r.pageX=i.clientX+(s&&s.scrollLeft||a&&a.scrollLeft||0)-(s&&s.clientLeft||a&&a.clientLeft||0),r.pageY=i.clientY+(s&&s.scrollTop||a&&a.scrollTop||0)-(s&&s.clientTop||a&&a.clientTop||0)}else r.pageX=i.pageX,r.pageY=i.pageY;r.x=i.clientX,r.y=i.clientY,r.screenX=i.screenX,r.screenY=i.screenY}r.clientX=r.x,r.clientY=r.y}}}function wA(){var r={top:{value:0,enumerable:!0},left:{value:0,enumerable:!0},right:{value:window.innerWidth,enumerable:!0},bottom:{value:window.innerHeight,enumerable:!0},width:{value:window.innerWidth,enumerable:!0},height:{value:window.innerHeight,enumerable:!0},x:{value:0,enumerable:!0},y:{value:0,enumerable:!0}};if(Object.create)return Object.create({},r);var e={};return Object.defineProperties(e,r),e}function UC(r){if(r===window)return wA();try{var e=r.getBoundingClientRect();return e.x===void 0&&(e.x=e.left,e.y=e.top),e}catch{throw new TypeError("Can't call getBoundingClientRect on "+r)}}function TA(r,e){var t=UC(e);return r.y>t.top&&r.y<t.bottom&&r.x>t.left&&r.x<t.right}var om=void 0;typeof Object.create!="function"?om=function(r){var e=function(){};return function(t,n){if(t!==Object(t)&&t!==null)throw TypeError("Argument must be an object, or null");e.prototype=t||{};var i=new e;return e.prototype=null,n!==r&&Object.defineProperties(i,n),t===null&&(i.__proto__=null),i}}():om=Object.create;var _A=om,Zi=["altKey","button","buttons","clientX","clientY","ctrlKey","metaKey","movementX","movementY","offsetX","offsetY","pageX","pageY","region","relatedTarget","screenX","screenY","shiftKey","which","x","y"];function EA(r){var e={screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,button:0,buttons:1,relatedTarget:null,region:null};r!==void 0&&r.addEventListener("mousemove",t);function t(o){for(var s=0;s<Zi.length;s++)e[Zi[s]]=o[Zi[s]]}var n=function(){if(MouseEvent)return function(s,a,c){var l=new MouseEvent("mousemove",tm(e,a));return nm(l,c),s.dispatchEvent(l)};if(typeof document.createEvent=="function")return function(s,a,c){var l=tm(e,a),d=document.createEvent("MouseEvents");return d.initMouseEvent("mousemove",!0,!0,window,0,l.screenX,l.screenY,l.clientX,l.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget),nm(d,c),s.dispatchEvent(d)};if(typeof document.createEventObject=="function")return function(s,a,c){var l=document.createEventObject(),d=tm(e,a);for(var u in d)l[u]=d[u];return nm(l,c),s.dispatchEvent(l)}}();function i(){r&&r.removeEventListener("mousemove",t,!1),e=null}return{destroy:i,dispatch:n}}function tm(r,e){e=e||{};for(var t=_A(r),n=0;n<Zi.length;n++)e[Zi[n]]!==void 0&&(t[Zi[n]]=e[Zi[n]]);return t}function nm(r,e){console.log("data ",e),r.data=e||{},r.dispatched="mousemove"}var Cc=["webkit","moz","ms","o"],yc=function(){if(typeof window>"u")return function(){};for(var r=0,e=Cc.length;r<e&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[Cc[r]+"RequestAnimationFrame"];if(!window.requestAnimationFrame){var t=0;window.requestAnimationFrame=function(n){var i=new Date().getTime(),o=Math.max(0,16-i-t),s=window.setTimeout(function(){return n(i+o)},o);return t=i+o,s}}return window.requestAnimationFrame.bind(window)}(),bs=function(){if(typeof window>"u")return function(){};for(var r=0,e=Cc.length;r<e&&!window.cancelAnimationFrame;++r)window.cancelAnimationFrame=window[Cc[r]+"CancelAnimationFrame"]||window[Cc[r]+"CancelRequestAnimationFrame"];return window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){window.clearTimeout(t)}),window.cancelAnimationFrame.bind(window)}();function SA(r,e){e===void 0&&(e={});var t=this,n=4,i=!1;if(typeof e.margin!="object"){var o=e.margin||-1;this.margin={left:o,right:o,top:o,bottom:o}}else this.margin=e.margin;this.scrollWhenOutside=e.scrollWhenOutside||!1;var s={},a=CA(s),c=EA(),l=!1;window.addEventListener("mousemove",a,!1),window.addEventListener("touchmove",a,!1),isNaN(e.maxSpeed)||(n=e.maxSpeed),typeof n!="object"&&(n={left:n,right:n,top:n,bottom:n}),this.autoScroll=rm(e.autoScroll),this.syncMove=rm(e.syncMove,!1),this.destroy=function(H){window.removeEventListener("mousemove",a,!1),window.removeEventListener("touchmove",a,!1),window.removeEventListener("mousedown",T,!1),window.removeEventListener("touchstart",T,!1),window.removeEventListener("mouseup",I,!1),window.removeEventListener("touchend",I,!1),window.removeEventListener("pointerup",I,!1),window.removeEventListener("mouseleave",O,!1),window.removeEventListener("mousemove",oe,!1),window.removeEventListener("touchmove",oe,!1),window.removeEventListener("scroll",v,!0),r=[],H&&k()},this.add=function(){for(var H=[],M=arguments.length;M--;)H[M]=arguments[M];return vA.apply(void 0,[r].concat(H)),this},this.remove=function(){for(var H=[],M=arguments.length;M--;)H[M]=arguments[M];return yA.apply(void 0,[r].concat(H))};var d=null,u;Object.prototype.toString.call(r)!=="[object Array]"&&(r=[r]),function(H){r=[],H.forEach(function(M){M===window?d=window:t.add(M)})}(r),Object.defineProperties(this,{down:{get:function(){return l}},maxSpeed:{get:function(){return n}},point:{get:function(){return s}},scrolling:{get:function(){return i}}});var m=null,p;window.addEventListener("mousedown",T,!1),window.addEventListener("touchstart",T,!1),window.addEventListener("mouseup",I,!1),window.addEventListener("touchend",I,!1),window.addEventListener("pointerup",I,!1),window.addEventListener("mousemove",oe,!1),window.addEventListener("touchmove",oe,!1),window.addEventListener("mouseleave",O,!1),window.addEventListener("scroll",v,!0);function v(H){for(var M=0;M<r.length;M++)if(r[M]===H.target){i=!0;break}i&&yc(function(){return i=!1})}function T(){l=!0}function I(){l=!1,k()}function k(){bs(p),bs(u)}function O(){l=!1}function D(H){if(!H)return null;if(m===H||im(r,H))return H;for(;H=H.parentNode;)if(im(r,H))return H;return null}function j(){for(var H=null,M=0;M<r.length;M++)LC(s,r[M])&&(H=r[M]);return H}function oe(H){if(t.autoScroll()&&!H.dispatched){var M=H.target,Ie=document.body;m&&!LC(s,m)&&(t.scrollWhenOutside||(m=null)),M&&M.parentNode===Ie?M=j():(M=D(M),M||(M=j())),M&&M!==m&&(m=M),d&&(bs(u),u=yc(we)),m&&(bs(p),p=yc(Te))}}function we(){ee(d),bs(u),u=yc(we)}function Te(){m&&(ee(m),bs(p),p=yc(Te))}function ee(H){var M=UC(H),Ie,Ae;s.x<M.left+t.margin.left?Ie=Math.floor(Math.max(-1,(s.x-M.left)/t.margin.left-1)*t.maxSpeed.left):s.x>M.right-t.margin.right?Ie=Math.ceil(Math.min(1,(s.x-M.right)/t.margin.right+1)*t.maxSpeed.right):Ie=0,s.y<M.top+t.margin.top?Ae=Math.floor(Math.max(-1,(s.y-M.top)/t.margin.top-1)*t.maxSpeed.top):s.y>M.bottom-t.margin.bottom?Ae=Math.ceil(Math.min(1,(s.y-M.bottom)/t.margin.bottom+1)*t.maxSpeed.bottom):Ae=0,t.syncMove()&&c.dispatch(H,{pageX:s.pageX+Ie,pageY:s.pageY+Ae,clientX:s.x+Ie,clientY:s.y+Ae}),setTimeout(function(){Ae&&re(H,Ae),Ie&&le(H,Ie)})}function re(H,M){H===window?window.scrollTo(H.pageXOffset,H.pageYOffset+M):H.scrollTop+=M}function le(H,M){H===window?window.scrollTo(H.pageXOffset+M,H.pageYOffset):H.scrollLeft+=M}}function AA(r,e){return new SA(r,e)}function LC(r,e,t){return t?r.y>t.top&&r.y<t.bottom&&r.x>t.left&&r.x<t.right:TA(r,e)}var BC=AA;function am(r,e,t){t&&t.split(" ").forEach(n=>r.addClass(e.nativeElement,n))}function Bd(r,e,t){t&&t.split(" ").forEach(n=>r.removeClass(e.nativeElement,n))}var zC=(()=>{class r{constructor(){this.currentDrag=new be}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=he({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),KC=(()=>{class r{constructor(t){this.elementRef=t}}return r.\u0275fac=function(t){return new(t||r)(x(Tt))},r.\u0275dir=et({type:r,selectors:[["","mwlDraggableScrollContainer",""]]}),r})(),Vd=(()=>{class r{constructor(t,n,i,o,s,a,c){this.element=t,this.renderer=n,this.draggableHelper=i,this.zone=o,this.vcr=s,this.scrollContainer=a,this.document=c,this.dragAxis={x:!0,y:!0},this.dragSnapGrid={},this.ghostDragEnabled=!0,this.showOriginalElementWhileDragging=!1,this.dragCursor="",this.autoScroll={margin:20},this.dragPointerDown=new W,this.dragStart=new W,this.ghostElementCreated=new W,this.dragging=new W,this.dragEnd=new W,this.pointerDown$=new be,this.pointerMove$=new be,this.pointerUp$=new be,this.eventListenerSubscriptions={},this.destroy$=new be,this.timeLongPress={timerBegin:0,timerEnd:0}}ngOnInit(){this.checkEventListeners();let t=this.pointerDown$.pipe(qe(()=>this.canDrag()),dt(n=>{n.event.stopPropagation&&!this.scrollContainer&&n.event.stopPropagation();let i=this.renderer.createElement("style");this.renderer.setAttribute(i,"type","text/css"),this.renderer.appendChild(i,this.renderer.createText(`
          body * {
           -moz-user-select: none;
           -ms-user-select: none;
           -webkit-user-select: none;
           user-select: none;
          }
        `)),requestAnimationFrame(()=>{this.document.head.appendChild(i)});let o=this.getScrollPosition(),s=new mr(p=>{let v=this.scrollContainer?this.scrollContainer.elementRef.nativeElement:"window";return this.renderer.listen(v,"scroll",T=>p.next(T))}).pipe(uo(o),ne(()=>this.getScrollPosition())),a=new be,c=new Oc;this.dragPointerDown.observers.length>0&&this.zone.run(()=>{this.dragPointerDown.next({x:0,y:0})});let l=ln(this.pointerUp$,this.pointerDown$,c,this.destroy$).pipe(un()),d=lo([this.pointerMove$,s]).pipe(ne(([p,v])=>({currentDrag$:a,transformX:p.clientX-n.clientX,transformY:p.clientY-n.clientY,clientX:p.clientX,clientY:p.clientY,scrollLeft:v.left,scrollTop:v.top,target:p.event.target})),ne(p=>(this.dragSnapGrid.x&&(p.transformX=Math.round(p.transformX/this.dragSnapGrid.x)*this.dragSnapGrid.x),this.dragSnapGrid.y&&(p.transformY=Math.round(p.transformY/this.dragSnapGrid.y)*this.dragSnapGrid.y),p)),ne(p=>(this.dragAxis.x||(p.transformX=0),this.dragAxis.y||(p.transformY=0),p)),ne(p=>{let v=p.scrollLeft-o.left,T=p.scrollTop-o.top;return U(g({},p),{x:p.transformX+v,y:p.transformY+T})}),qe(({x:p,y:v,transformX:T,transformY:I})=>!this.validateDrag||this.validateDrag({x:p,y:v,transform:{x:T,y:I}})),Ft(l),un()),u=d.pipe(ut(1),un()),m=d.pipe(Hs(1),un());return u.subscribe(({clientX:p,clientY:v,x:T,y:I})=>{if(this.dragStart.observers.length>0&&this.zone.run(()=>{this.dragStart.next({cancelDrag$:c})}),this.scroller=BC([this.scrollContainer?this.scrollContainer.elementRef.nativeElement:this.document.defaultView],U(g({},this.autoScroll),{autoScroll(){return!0}})),am(this.renderer,this.element,this.dragActiveClass),this.ghostDragEnabled){let k=this.element.nativeElement.getBoundingClientRect(),O=this.element.nativeElement.cloneNode(!0);if(this.showOriginalElementWhileDragging||this.renderer.setStyle(this.element.nativeElement,"visibility","hidden"),this.ghostElementAppendTo?this.ghostElementAppendTo.appendChild(O):this.element.nativeElement.parentNode.insertBefore(O,this.element.nativeElement.nextSibling),this.ghostElement=O,this.document.body.style.cursor=this.dragCursor,this.setElementStyles(O,{position:"fixed",top:`${k.top}px`,left:`${k.left}px`,width:`${k.width}px`,height:`${k.height}px`,cursor:this.dragCursor,margin:"0",willChange:"transform",pointerEvents:"none"}),this.ghostElementTemplate){let D=this.vcr.createEmbeddedView(this.ghostElementTemplate);O.innerHTML="",D.rootNodes.filter(j=>j instanceof Node).forEach(j=>{O.appendChild(j)}),m.subscribe(()=>{this.vcr.remove(this.vcr.indexOf(D))})}this.ghostElementCreated.observers.length>0&&this.zone.run(()=>{this.ghostElementCreated.emit({clientX:p-T,clientY:v-I,element:O})}),m.subscribe(()=>{O.parentElement.removeChild(O),this.ghostElement=null,this.renderer.setStyle(this.element.nativeElement,"visibility","")})}this.draggableHelper.currentDrag.next(a)}),m.pipe(dt(p=>{let v=c.pipe(lf(),ut(1),ne(T=>U(g({},p),{dragCancelled:T>0})));return c.complete(),v})).subscribe(({x:p,y:v,dragCancelled:T})=>{this.scroller.destroy(),this.dragEnd.observers.length>0&&this.zone.run(()=>{this.dragEnd.next({x:p,y:v,dragCancelled:T})}),Bd(this.renderer,this.element,this.dragActiveClass),a.complete()}),ln(l,m).pipe(ut(1)).subscribe(()=>{requestAnimationFrame(()=>{this.document.head.removeChild(i)})}),d}),un());ln(t.pipe(ut(1),ne(n=>[,n])),t.pipe(Us())).pipe(qe(([n,i])=>n?n.x!==i.x||n.y!==i.y:!0),ne(([n,i])=>i)).subscribe(({x:n,y:i,currentDrag$:o,clientX:s,clientY:a,transformX:c,transformY:l,target:d})=>{this.dragging.observers.length>0&&this.zone.run(()=>{this.dragging.next({x:n,y:i})}),requestAnimationFrame(()=>{if(this.ghostElement){let u=`translate3d(${c}px, ${l}px, 0px)`;this.setElementStyles(this.ghostElement,{transform:u,"-webkit-transform":u,"-ms-transform":u,"-moz-transform":u,"-o-transform":u})}}),o.next({clientX:s,clientY:a,dropData:this.dropData,target:d})})}ngOnChanges(t){t.dragAxis&&this.checkEventListeners()}ngOnDestroy(){this.unsubscribeEventListeners(),this.pointerDown$.complete(),this.pointerMove$.complete(),this.pointerUp$.complete(),this.destroy$.next()}checkEventListeners(){let t=this.canDrag(),n=Object.keys(this.eventListenerSubscriptions).length>0;t&&!n?this.zone.runOutsideAngular(()=>{this.eventListenerSubscriptions.mousedown=this.renderer.listen(this.element.nativeElement,"mousedown",i=>{this.onMouseDown(i)}),this.eventListenerSubscriptions.mouseup=this.renderer.listen("document","mouseup",i=>{this.onMouseUp(i)}),this.eventListenerSubscriptions.touchstart=this.renderer.listen(this.element.nativeElement,"touchstart",i=>{this.onTouchStart(i)}),this.eventListenerSubscriptions.touchend=this.renderer.listen("document","touchend",i=>{this.onTouchEnd(i)}),this.eventListenerSubscriptions.touchcancel=this.renderer.listen("document","touchcancel",i=>{this.onTouchEnd(i)}),this.eventListenerSubscriptions.mouseenter=this.renderer.listen(this.element.nativeElement,"mouseenter",()=>{this.onMouseEnter()}),this.eventListenerSubscriptions.mouseleave=this.renderer.listen(this.element.nativeElement,"mouseleave",()=>{this.onMouseLeave()})}):!t&&n&&this.unsubscribeEventListeners()}onMouseDown(t){t.button===0&&(this.eventListenerSubscriptions.mousemove||(this.eventListenerSubscriptions.mousemove=this.renderer.listen("document","mousemove",n=>{this.pointerMove$.next({event:n,clientX:n.clientX,clientY:n.clientY})})),this.pointerDown$.next({event:t,clientX:t.clientX,clientY:t.clientY}))}onMouseUp(t){t.button===0&&(this.eventListenerSubscriptions.mousemove&&(this.eventListenerSubscriptions.mousemove(),delete this.eventListenerSubscriptions.mousemove),this.pointerUp$.next({event:t,clientX:t.clientX,clientY:t.clientY}))}onTouchStart(t){let n,i,o;if(this.touchStartLongPress&&(this.timeLongPress.timerBegin=Date.now(),i=!1,o=this.hasScrollbar(),n=this.getScrollPosition()),!this.eventListenerSubscriptions.touchmove){let s=Fs(this.document,"contextmenu").subscribe(c=>{c.preventDefault()}),a=Fs(this.document,"touchmove",{passive:!1}).subscribe(c=>{this.touchStartLongPress&&!i&&o&&(i=this.shouldBeginDrag(t,c,n)),(!this.touchStartLongPress||!o||i)&&(c.preventDefault(),this.pointerMove$.next({event:c,clientX:c.targetTouches[0].clientX,clientY:c.targetTouches[0].clientY}))});this.eventListenerSubscriptions.touchmove=()=>{s.unsubscribe(),a.unsubscribe()}}this.pointerDown$.next({event:t,clientX:t.touches[0].clientX,clientY:t.touches[0].clientY})}onTouchEnd(t){this.eventListenerSubscriptions.touchmove&&(this.eventListenerSubscriptions.touchmove(),delete this.eventListenerSubscriptions.touchmove,this.touchStartLongPress&&this.enableScroll()),this.pointerUp$.next({event:t,clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY})}onMouseEnter(){this.setCursor(this.dragCursor)}onMouseLeave(){this.setCursor("")}canDrag(){return this.dragAxis.x||this.dragAxis.y}setCursor(t){this.eventListenerSubscriptions.mousemove||this.renderer.setStyle(this.element.nativeElement,"cursor",t)}unsubscribeEventListeners(){Object.keys(this.eventListenerSubscriptions).forEach(t=>{this.eventListenerSubscriptions[t](),delete this.eventListenerSubscriptions[t]})}setElementStyles(t,n){Object.keys(n).forEach(i=>{this.renderer.setStyle(t,i,n[i])})}getScrollElement(){return this.scrollContainer?this.scrollContainer.elementRef.nativeElement:this.document.body}getScrollPosition(){return this.scrollContainer?{top:this.scrollContainer.elementRef.nativeElement.scrollTop,left:this.scrollContainer.elementRef.nativeElement.scrollLeft}:{top:window.pageYOffset||this.document.documentElement.scrollTop,left:window.pageXOffset||this.document.documentElement.scrollLeft}}shouldBeginDrag(t,n,i){let o=this.getScrollPosition(),s={top:Math.abs(o.top-i.top),left:Math.abs(o.left-i.left)},a=Math.abs(n.targetTouches[0].clientX-t.touches[0].clientX)-s.left,c=Math.abs(n.targetTouches[0].clientY-t.touches[0].clientY)-s.top,l=a+c,d=this.touchStartLongPress;return(l>d.delta||s.top>0||s.left>0)&&(this.timeLongPress.timerBegin=Date.now()),this.timeLongPress.timerEnd=Date.now(),this.timeLongPress.timerEnd-this.timeLongPress.timerBegin>=d.delay?(this.disableScroll(),!0):!1}enableScroll(){this.scrollContainer&&this.renderer.setStyle(this.scrollContainer.elementRef.nativeElement,"overflow",""),this.renderer.setStyle(this.document.body,"overflow","")}disableScroll(){this.scrollContainer&&this.renderer.setStyle(this.scrollContainer.elementRef.nativeElement,"overflow","hidden"),this.renderer.setStyle(this.document.body,"overflow","hidden")}hasScrollbar(){let t=this.getScrollElement(),n=t.scrollWidth>t.clientWidth,i=t.scrollHeight>t.clientHeight;return n||i}}return r.\u0275fac=function(t){return new(t||r)(x(Tt),x(Yt),x(zC),x(ht),x(po),x(KC,8),x(Je))},r.\u0275dir=et({type:r,selectors:[["","mwlDraggable",""]],inputs:{dropData:"dropData",dragAxis:"dragAxis",dragSnapGrid:"dragSnapGrid",ghostDragEnabled:"ghostDragEnabled",showOriginalElementWhileDragging:"showOriginalElementWhileDragging",validateDrag:"validateDrag",dragCursor:"dragCursor",dragActiveClass:"dragActiveClass",ghostElementAppendTo:"ghostElementAppendTo",ghostElementTemplate:"ghostElementTemplate",touchStartLongPress:"touchStartLongPress",autoScroll:"autoScroll"},outputs:{dragPointerDown:"dragPointerDown",dragStart:"dragStart",ghostElementCreated:"ghostElementCreated",dragging:"dragging",dragEnd:"dragEnd"},features:[In]}),r})();function VC(r,e,t){return r>=t.left&&r<=t.right&&e>=t.top&&e<=t.bottom}var zd=(()=>{class r{constructor(t,n,i,o,s){this.element=t,this.draggableHelper=n,this.zone=i,this.renderer=o,this.scrollContainer=s,this.dragEnter=new W,this.dragLeave=new W,this.dragOver=new W,this.drop=new W}ngOnInit(){this.currentDragSubscription=this.draggableHelper.currentDrag.subscribe(t=>{am(this.renderer,this.element,this.dragActiveClass);let n={updateCache:!0},i=this.renderer.listen(this.scrollContainer?this.scrollContainer.elementRef.nativeElement:"window","scroll",()=>{n.updateCache=!0}),o,s=t.pipe(ne(({clientX:l,clientY:d,dropData:u,target:m})=>{o={clientX:l,clientY:d,dropData:u,target:m},n.updateCache&&(n.rect=this.element.nativeElement.getBoundingClientRect(),this.scrollContainer&&(n.scrollContainerRect=this.scrollContainer.elementRef.nativeElement.getBoundingClientRect()),n.updateCache=!1);let p=VC(l,d,n.rect),v=!this.validateDrop||this.validateDrop({clientX:l,clientY:d,target:m,dropData:u});return n.scrollContainerRect?p&&v&&VC(l,d,n.scrollContainerRect):p&&v})),a=s.pipe(uf()),c;a.pipe(qe(l=>l)).subscribe(()=>{c=!0,am(this.renderer,this.element,this.dragOverClass),this.dragEnter.observers.length>0&&this.zone.run(()=>{this.dragEnter.next(o)})}),s.pipe(qe(l=>l)).subscribe(()=>{this.dragOver.observers.length>0&&this.zone.run(()=>{this.dragOver.next(o)})}),a.pipe(Us(),qe(([l,d])=>l&&!d)).subscribe(()=>{c=!1,Bd(this.renderer,this.element,this.dragOverClass),this.dragLeave.observers.length>0&&this.zone.run(()=>{this.dragLeave.next(o)})}),t.subscribe({complete:()=>{i(),Bd(this.renderer,this.element,this.dragActiveClass),c&&(Bd(this.renderer,this.element,this.dragOverClass),this.drop.observers.length>0&&this.zone.run(()=>{this.drop.next(o)}))}})})}ngOnDestroy(){this.currentDragSubscription&&this.currentDragSubscription.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(x(Tt),x(zC),x(ht),x(Yt),x(KC,8))},r.\u0275dir=et({type:r,selectors:[["","mwlDroppable",""]],inputs:{dragOverClass:"dragOverClass",dragActiveClass:"dragActiveClass",validateDrop:"validateDrop"},outputs:{dragEnter:"dragEnter",dragLeave:"dragLeave",dragOver:"dragOver",drop:"drop"}}),r})(),wc=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({}),r})();var pe=function(r){return r[r.State=0]="State",r[r.Transition=1]="Transition",r[r.Sequence=2]="Sequence",r[r.Group=3]="Group",r[r.Animate=4]="Animate",r[r.Keyframes=5]="Keyframes",r[r.Style=6]="Style",r[r.Trigger=7]="Trigger",r[r.Reference=8]="Reference",r[r.AnimateChild=9]="AnimateChild",r[r.AnimateRef=10]="AnimateRef",r[r.Query=11]="Query",r[r.Stagger=12]="Stagger",r}(pe||{}),Un="*";function qC(r,e){return{type:pe.Trigger,name:r,definitions:e,options:{}}}function cm(r,e=null){return{type:pe.Animate,styles:e,timings:r}}function $C(r,e=null){return{type:pe.Sequence,steps:r,options:e}}function ks(r){return{type:pe.Style,styles:r,offset:null}}function lm(r,e,t){return{type:pe.State,name:r,styles:e,options:t}}function dm(r,e,t=null){return{type:pe.Transition,expr:r,animation:e,options:t}}var ti=class{constructor(e=0,t=0){this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._originalOnDoneFns=[],this._originalOnStartFns=[],this._started=!1,this._destroyed=!1,this._finished=!1,this._position=0,this.parentPlayer=null,this.totalTime=e+t}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}init(){}play(){this.hasStarted()||(this._onStart(),this.triggerMicrotask()),this._started=!0}triggerMicrotask(){queueMicrotask(()=>this._onFinish())}_onStart(){this._onStartFns.forEach(e=>e()),this._onStartFns=[]}pause(){}restart(){}finish(){this._onFinish()}destroy(){this._destroyed||(this._destroyed=!0,this.hasStarted()||this._onStart(),this.finish(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this._started=!1,this._finished=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}setPosition(e){this._position=this.totalTime?e*this.totalTime:1}getPosition(){return this.totalTime?this._position/this.totalTime:1}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},Tc=class{constructor(e){this._onDoneFns=[],this._onStartFns=[],this._finished=!1,this._started=!1,this._destroyed=!1,this._onDestroyFns=[],this.parentPlayer=null,this.totalTime=0,this.players=e;let t=0,n=0,i=0,o=this.players.length;o==0?queueMicrotask(()=>this._onFinish()):this.players.forEach(s=>{s.onDone(()=>{++t==o&&this._onFinish()}),s.onDestroy(()=>{++n==o&&this._onDestroy()}),s.onStart(()=>{++i==o&&this._onStart()})}),this.totalTime=this.players.reduce((s,a)=>Math.max(s,a.totalTime),0)}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this.players.forEach(e=>e.init())}onStart(e){this._onStartFns.push(e)}_onStart(){this.hasStarted()||(this._started=!0,this._onStartFns.forEach(e=>e()),this._onStartFns=[])}onDone(e){this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}hasStarted(){return this._started}play(){this.parentPlayer||this.init(),this._onStart(),this.players.forEach(e=>e.play())}pause(){this.players.forEach(e=>e.pause())}restart(){this.players.forEach(e=>e.restart())}finish(){this._onFinish(),this.players.forEach(e=>e.finish())}destroy(){this._onDestroy()}_onDestroy(){this._destroyed||(this._destroyed=!0,this._onFinish(),this.players.forEach(e=>e.destroy()),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}reset(){this.players.forEach(e=>e.reset()),this._destroyed=!1,this._finished=!1,this._started=!1}setPosition(e){let t=e*this.totalTime;this.players.forEach(n=>{let i=n.totalTime?Math.min(1,t/n.totalTime):1;n.setPosition(i)})}getPosition(){let e=this.players.reduce((t,n)=>t===null||n.totalTime>t.totalTime?n:t,null);return e!=null?e.getPosition():0}beforeDestroy(){this.players.forEach(e=>{e.beforeDestroy&&e.beforeDestroy()})}triggerCallback(e){let t=e=="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},Kd="!";var eo=typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;function bA(r){let e=r.cloneNode(!0),t=e.querySelectorAll("[id]"),n=r.nodeName.toLowerCase();return e.removeAttribute("id"),t.forEach(i=>{i.removeAttribute("id")}),n==="canvas"?GC(r,e):(n==="input"||n==="select"||n==="textarea")&&WC(r,e),jC("canvas",r,e,GC),jC("input, textarea, select",r,e,WC),e}function jC(r,e,t,n){let i=e.querySelectorAll(r);if(i.length){let o=t.querySelectorAll(r);for(let s=0;s<i.length;s++)n(i[s],o[s])}}var kA=0;function WC(r,e){e.type!=="file"&&(e.value=r.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${kA++}`)}function GC(r,e){let t=e.getContext("2d");if(t)try{t.drawImage(r,0,0)}catch{}}function YC(r,e,t,n){let i={top:r.top,bottom:r.bottom,left:r.left,right:r.right};return e.top&&(i.top+=n),e.bottom&&(i.bottom+=n),e.left&&(i.left+=t),e.right&&(i.right+=t),i.height=i.bottom-i.top,i.width=i.right-i.left,i}function RA(r,e){let t=0,n=0,i=r.nativeElement.style,s=["transform","-ms-transform","-moz-transform","-o-transform"].map(a=>i[a]).find(a=>!!a);if(s&&s.includes("translate")&&(t=s.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),n=s.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),e==="absolute")return{height:r.nativeElement.offsetHeight,width:r.nativeElement.offsetWidth,top:r.nativeElement.offsetTop-n,bottom:r.nativeElement.offsetHeight+r.nativeElement.offsetTop-n,left:r.nativeElement.offsetLeft-t,right:r.nativeElement.offsetWidth+r.nativeElement.offsetLeft-t};{let a=r.nativeElement.getBoundingClientRect();return{height:a.height,width:a.width,top:a.top-n,bottom:a.bottom-n,left:a.left-t,right:a.right-t,scrollTop:r.nativeElement.scrollTop,scrollLeft:r.nativeElement.scrollLeft}}}var QC=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function XC(r,e){return r.left&&r.top?e.topLeft:r.right&&r.top?e.topRight:r.left&&r.bottom?e.bottomLeft:r.right&&r.bottom?e.bottomRight:r.left||r.right?e.leftOrRight:r.top||r.bottom?e.topOrBottom:""}function qd({edges:r,initialRectangle:e,newRectangle:t}){let n={};return Object.keys(r).forEach(i=>{n[i]=(t[i]||0)-(e[i]||0)}),n}var JC="resize-active",DA="resize-ghost-element",MA=50,hm=(()=>{class r{constructor(t,n,i,o){this.platformId=t,this.renderer=n,this.elm=i,this.zone=o,this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=QC,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=MA,this.resizeStart=new W,this.resizing=new W,this.resizeEnd=new W,this.mouseup=new be,this.mousedown=new be,this.mousemove=new be,this.destroy$=new be,this.pointerEventListeners=um.getInstance(n,o)}ngOnInit(){let t=ln(this.pointerEventListeners.pointerDown,this.mousedown),n=ln(this.pointerEventListeners.pointerMove,this.mousemove).pipe(Qe(({event:l})=>{o&&l.cancelable&&l.preventDefault()}),un()),i=ln(this.pointerEventListeners.pointerUp,this.mouseup),o,s=()=>{o&&o.clonedNode&&(this.elm.nativeElement.parentElement.removeChild(o.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","inherit"))},a=()=>g(g({},QC),this.resizeCursors);t.pipe(dt(l=>{function d(p){return{clientX:p.clientX-l.clientX,clientY:p.clientY-l.clientY}}let u=()=>{let p={x:1,y:1};return o&&(this.resizeSnapGrid.left&&o.edges.left?p.x=+this.resizeSnapGrid.left:this.resizeSnapGrid.right&&o.edges.right&&(p.x=+this.resizeSnapGrid.right),this.resizeSnapGrid.top&&o.edges.top?p.y=+this.resizeSnapGrid.top:this.resizeSnapGrid.bottom&&o.edges.bottom&&(p.y=+this.resizeSnapGrid.bottom)),p};function m(p,v){return{x:Math.ceil(p.clientX/v.x),y:Math.ceil(p.clientY/v.y)}}return ln(n.pipe(ut(1)).pipe(ne(p=>[,p])),n.pipe(Us())).pipe(ne(([p,v])=>[p&&d(p),d(v)])).pipe(qe(([p,v])=>{if(!p)return!0;let T=u(),I=m(p,T),k=m(v,T);return I.x!==k.x||I.y!==k.y})).pipe(ne(([,p])=>{let v=u();return{clientX:Math.round(p.clientX/v.x)*v.x,clientY:Math.round(p.clientY/v.y)*v.y}})).pipe(Ft(ln(i,t)))})).pipe(qe(()=>!!o)).pipe(ne(({clientX:l,clientY:d})=>YC(o.startingRect,o.edges,l,d))).pipe(qe(l=>this.allowNegativeResizes||!!(l.height&&l.width&&l.height>0&&l.width>0))).pipe(qe(l=>this.validateResize?this.validateResize({rectangle:l,edges:qd({edges:o.edges,initialRectangle:o.startingRect,newRectangle:l})}):!0),Ft(this.destroy$)).subscribe(l=>{o&&o.clonedNode&&(this.renderer.setStyle(o.clonedNode,"height",`${l.height}px`),this.renderer.setStyle(o.clonedNode,"width",`${l.width}px`),this.renderer.setStyle(o.clonedNode,"top",`${l.top}px`),this.renderer.setStyle(o.clonedNode,"left",`${l.left}px`)),this.resizing.observers.length>0&&this.zone.run(()=>{this.resizing.emit({edges:qd({edges:o.edges,initialRectangle:o.startingRect,newRectangle:l}),rectangle:l})}),o.currentRect=l}),t.pipe(ne(({edges:l})=>l||{}),qe(l=>Object.keys(l).length>0),Ft(this.destroy$)).subscribe(l=>{o&&s();let d=RA(this.elm,this.ghostElementPositioning);o={edges:l,startingRect:d,currentRect:d};let u=a(),m=XC(o.edges,u);this.renderer.setStyle(document.body,"cursor",m),this.setElementClass(this.elm,JC,!0),this.enableGhostResize&&(o.clonedNode=bA(this.elm.nativeElement),this.elm.nativeElement.parentElement.appendChild(o.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","hidden"),this.renderer.setStyle(o.clonedNode,"position",this.ghostElementPositioning),this.renderer.setStyle(o.clonedNode,"left",`${o.startingRect.left}px`),this.renderer.setStyle(o.clonedNode,"top",`${o.startingRect.top}px`),this.renderer.setStyle(o.clonedNode,"height",`${o.startingRect.height}px`),this.renderer.setStyle(o.clonedNode,"width",`${o.startingRect.width}px`),this.renderer.setStyle(o.clonedNode,"cursor",XC(o.edges,u)),this.renderer.addClass(o.clonedNode,DA),o.clonedNode.scrollTop=o.startingRect.scrollTop,o.clonedNode.scrollLeft=o.startingRect.scrollLeft),this.resizeStart.observers.length>0&&this.zone.run(()=>{this.resizeStart.emit({edges:qd({edges:l,initialRectangle:d,newRectangle:d}),rectangle:YC(d,{},0,0)})})}),i.pipe(Ft(this.destroy$)).subscribe(()=>{o&&(this.renderer.removeClass(this.elm.nativeElement,JC),this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(this.elm.nativeElement,"cursor",""),this.resizeEnd.observers.length>0&&this.zone.run(()=>{this.resizeEnd.emit({edges:qd({edges:o.edges,initialRectangle:o.startingRect,newRectangle:o.currentRect}),rectangle:o.currentRect})}),s(),o=null)})}ngOnDestroy(){Xf(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.destroy$.next()}setElementClass(t,n,i){i?this.renderer.addClass(t.nativeElement,n):this.renderer.removeClass(t.nativeElement,n)}}return r.\u0275fac=function(t){return new(t||r)(x(si),x(Yt),x(Tt),x(ht))},r.\u0275dir=et({type:r,selectors:[["","mwlResizable",""]],inputs:{validateResize:"validateResize",enableGhostResize:"enableGhostResize",resizeSnapGrid:"resizeSnapGrid",resizeCursors:"resizeCursors",ghostElementPositioning:"ghostElementPositioning",allowNegativeResizes:"allowNegativeResizes",mouseMoveThrottleMS:"mouseMoveThrottleMS"},outputs:{resizeStart:"resizeStart",resizing:"resizing",resizeEnd:"resizeEnd"},exportAs:["mwlResizable"]}),r})(),um=class r{constructor(e,t){this.pointerDown=new mr(n=>{let i,o;return t.runOutsideAngular(()=>{i=e.listen("document","mousedown",s=>{n.next({clientX:s.clientX,clientY:s.clientY,event:s})}),eo&&(o=e.listen("document","touchstart",s=>{n.next({clientX:s.touches[0].clientX,clientY:s.touches[0].clientY,event:s})}))}),()=>{i(),eo&&o()}}).pipe(un()),this.pointerMove=new mr(n=>{let i,o;return t.runOutsideAngular(()=>{i=e.listen("document","mousemove",s=>{n.next({clientX:s.clientX,clientY:s.clientY,event:s})}),eo&&(o=e.listen("document","touchmove",s=>{n.next({clientX:s.targetTouches[0].clientX,clientY:s.targetTouches[0].clientY,event:s})}))}),()=>{i(),eo&&o()}}).pipe(un()),this.pointerUp=new mr(n=>{let i,o,s;return t.runOutsideAngular(()=>{i=e.listen("document","mouseup",a=>{n.next({clientX:a.clientX,clientY:a.clientY,event:a})}),eo&&(o=e.listen("document","touchend",a=>{n.next({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY,event:a})}),s=e.listen("document","touchcancel",a=>{n.next({clientX:a.changedTouches[0].clientX,clientY:a.changedTouches[0].clientY,event:a})}))}),()=>{i(),eo&&(o(),s())}}).pipe(un())}static getInstance(e,t){return r.instance||(r.instance=new r(e,t)),r.instance}},ZC=(()=>{class r{constructor(t,n,i,o){this.renderer=t,this.element=n,this.zone=i,this.resizableDirective=o,this.resizeEdges={},this.eventListeners={},this.destroy$=new be}ngOnInit(){this.zone.runOutsideAngular(()=>{this.listenOnTheHost("mousedown").subscribe(t=>{this.onMousedown(t,t.clientX,t.clientY)}),this.listenOnTheHost("mouseup").subscribe(t=>{this.onMouseup(t.clientX,t.clientY)}),eo&&(this.listenOnTheHost("touchstart").subscribe(t=>{this.onMousedown(t,t.touches[0].clientX,t.touches[0].clientY)}),ln(this.listenOnTheHost("touchend"),this.listenOnTheHost("touchcancel")).subscribe(t=>{this.onMouseup(t.changedTouches[0].clientX,t.changedTouches[0].clientY)}))})}ngOnDestroy(){this.destroy$.next(),this.unsubscribeEventListeners()}onMousedown(t,n,i){t.cancelable&&t.preventDefault(),this.eventListeners.touchmove||(this.eventListeners.touchmove=this.renderer.listen(this.element.nativeElement,"touchmove",o=>{this.onMousemove(o,o.targetTouches[0].clientX,o.targetTouches[0].clientY)})),this.eventListeners.mousemove||(this.eventListeners.mousemove=this.renderer.listen(this.element.nativeElement,"mousemove",o=>{this.onMousemove(o,o.clientX,o.clientY)})),this.resizable.mousedown.next({clientX:n,clientY:i,edges:this.resizeEdges})}onMouseup(t,n){this.unsubscribeEventListeners(),this.resizable.mouseup.next({clientX:t,clientY:n,edges:this.resizeEdges})}get resizable(){return this.resizableDirective||this.resizableContainer}onMousemove(t,n,i){this.resizable.mousemove.next({clientX:n,clientY:i,edges:this.resizeEdges,event:t})}unsubscribeEventListeners(){Object.keys(this.eventListeners).forEach(t=>{this.eventListeners[t](),delete this.eventListeners[t]})}listenOnTheHost(t){return Fs(this.element.nativeElement,t).pipe(Ft(this.destroy$))}}return r.\u0275fac=function(t){return new(t||r)(x(Yt),x(Tt),x(ht),x(hm,8))},r.\u0275dir=et({type:r,selectors:[["","mwlResizeHandle",""]],inputs:{resizeEdges:"resizeEdges",resizableContainer:"resizableContainer"}}),r})(),pm=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({}),r})();var PA=(r,e)=>({event:r,trackByActionId:e}),NA=r=>({action:r});function xA(r,e){if(r&1){let t=Ce();C(0,"a",5),De(1,"calendarA11y"),L("mwlClick",function(i){let o=P(t).$implicit,s=b(2).event;return N(o.onClick({event:s,sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=P(t).$implicit,s=b(2).event;return N(o.onClick({event:s,sourceEvent:i}))}),w()}if(r&2){let t=e.$implicit;S("ngClass",t.cssClass)("innerHtml",t.label,Fc),Et("aria-label",Mt(1,3,$n(6,NA,t),"actionButtonLabel"))}}function LA(r,e){if(r&1&&(C(0,"span",3),$(1,xA,2,8,"a",4),w()),r&2){let t=b(),n=t.event,i=t.trackByActionId;_(),S("ngForOf",n.actions)("ngForTrackBy",i)}}function FA(r,e){if(r&1&&$(0,LA,2,2,"span",2),r&2){let t=e.event;S("ngIf",t.actions)}}function HA(r,e){}var UA=(r,e)=>({event:r,view:e}),Rs=()=>({});function BA(r,e){if(r&1&&(G(0,"span",2),De(1,"calendarEventTitle"),De(2,"calendarA11y")),r&2){let t=e.event,n=e.view;S("innerHTML",Qt(1,2,t.title,n,t),Fc),Et("aria-hidden",Mt(2,6,st(9,Rs),"hideEventTitle"))}}function VA(r,e){}var zA=(r,e,t)=>({contents:r,placement:e,event:t});function KA(r,e){if(r&1&&(C(0,"div",2),G(1,"div",3)(2,"div",4),w()),r&2){let t=e.contents,n=e.placement;S("ngClass","cal-tooltip-"+n),_(2),S("innerHtml",t,Fc)}}function qA(r,e){}var $A=(r,e,t,n,i,o,s,a,c,l,d,u)=>({day:r,openDay:e,locale:t,tooltipPlacement:n,highlightDay:i,unhighlightDay:o,eventClicked:s,tooltipTemplate:a,tooltipAppendToBody:c,tooltipDelay:l,trackByEventId:d,validateDrag:u}),jA=(r,e)=>({day:r,locale:e}),Cm=r=>({backgroundColor:r}),WA=(r,e)=>({event:r,draggedFrom:e}),_c=(r,e)=>({x:r,y:e}),Wd=()=>({delay:300,delta:30});function GA(r,e){if(r&1&&(C(0,"span",7),B(1),w()),r&2){let t=b().day;_(),Ht(t.badgeTotal)}}function YA(r,e){if(r&1){let t=Ce();C(0,"div",10),De(1,"calendarEventTitle"),De(2,"calendarA11y"),L("mouseenter",function(){let i=P(t).$implicit,o=b(2).highlightDay;return N(o.emit({event:i}))})("mouseleave",function(){let i=P(t).$implicit,o=b(2).unhighlightDay;return N(o.emit({event:i}))})("mwlClick",function(i){let o=P(t).$implicit,s=b(2).eventClicked;return N(s.emit({event:o,sourceEvent:i}))}),w()}if(r&2){let t=e.$implicit,n=b(2),i=n.day,o=n.tooltipPlacement,s=n.tooltipTemplate,a=n.tooltipAppendToBody,c=n.tooltipDelay,l=n.validateDrag;Ve("cal-draggable",t.draggable),S("ngStyle",$n(22,Cm,t.color==null?null:t.color.primary))("ngClass",t==null?null:t.cssClass)("mwlCalendarTooltip",Qt(1,15,t.title,"monthTooltip",t))("tooltipPlacement",o)("tooltipEvent",t)("tooltipTemplate",s)("tooltipAppendToBody",a)("tooltipDelay",c)("dropData",pt(24,WA,t,i))("dragAxis",pt(27,_c,t.draggable,t.draggable))("validateDrag",l)("touchStartLongPress",st(30,Wd)),Et("aria-hidden",Mt(2,19,st(31,Rs),"hideMonthCellEvents"))}}function QA(r,e){if(r&1&&(C(0,"div",8),$(1,YA,3,32,"div",9),w()),r&2){let t=b(),n=t.day,i=t.trackByEventId;_(),S("ngForOf",n.events)("ngForTrackBy",i)}}function XA(r,e){if(r&1&&(C(0,"div",2),De(1,"calendarA11y"),C(2,"span",3),$(3,GA,2,1,"span",4),C(4,"span",5),B(5),De(6,"calendarDate"),w()()(),$(7,QA,2,2,"div",6)),r&2){let t=e.day,n=e.locale;Et("aria-label",Mt(1,4,pt(11,jA,t,n),"monthCell")),_(3),S("ngIf",t.badgeTotal>0),_(2),Ht(Qt(6,7,t.date,"monthViewDayNumber",n)),_(2),S("ngIf",t.events.length>0)}}function JA(r,e){}var ZA=(r,e,t,n,i)=>({events:r,eventClicked:e,isOpen:t,trackByEventId:n,validateDrag:i}),ew=(r,e)=>({date:r,locale:e}),eI=r=>({event:r}),iw=(r,e)=>({event:r,locale:e});function tI(r,e){if(r&1){let t=Ce();C(0,"div",7),G(1,"span",8),B(2," "),C(3,"mwl-calendar-event-title",9),De(4,"calendarA11y"),L("mwlClick",function(i){let o=P(t).$implicit,s=b(2).eventClicked;return N(s.emit({event:o,sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=P(t).$implicit,s=b(2).eventClicked;return N(s.emit({event:o,sourceEvent:i}))}),w(),B(5," "),G(6,"mwl-calendar-event-actions",10),w()}if(r&2){let t=e.$implicit,n=b(2).validateDrag,i=b();Ve("cal-draggable",t.draggable),S("ngClass",t==null?null:t.cssClass)("dropData",$n(16,eI,t))("dragAxis",pt(18,_c,t.draggable,t.draggable))("validateDrag",n)("touchStartLongPress",st(21,Wd)),_(),S("ngStyle",$n(22,Cm,t.color==null?null:t.color.primary)),_(2),S("event",t)("customTemplate",i.eventTitleTemplate),Et("aria-label",Mt(4,13,pt(24,iw,t,i.locale),"eventDescription")),_(3),S("event",t)("customTemplate",i.eventActionsTemplate)}}function nI(r,e){if(r&1&&(C(0,"div",3),G(1,"span",4),De(2,"calendarA11y"),G(3,"span",5),De(4,"calendarA11y"),$(5,tI,7,27,"div",6),w()),r&2){let t=b(),n=t.events,i=t.trackByEventId,o=b();S("@collapse",void 0),_(),Et("aria-label",Mt(2,5,pt(11,ew,o.date,o.locale),"openDayEventsAlert")),_(2),Et("aria-label",Mt(4,8,pt(14,ew,o.date,o.locale),"openDayEventsLandmark")),_(2),S("ngForOf",n)("ngForTrackBy",i)}}function rI(r,e){if(r&1&&$(0,nI,6,17,"div",2),r&2){let t=e.isOpen;S("ngIf",t)}}function iI(r,e){}var oI=(r,e,t)=>({days:r,locale:e,trackByWeekDayHeaderDate:t});function sI(r,e){if(r&1){let t=Ce();C(0,"div",4),L("click",function(i){let o=P(t).$implicit,s=b(2);return N(s.columnHeaderClicked.emit({isoDayNumber:o.day,sourceEvent:i}))}),B(1),De(2,"calendarDate"),w()}if(r&2){let t=e.$implicit,n=b().locale;Ve("cal-past",t.isPast)("cal-today",t.isToday)("cal-future",t.isFuture)("cal-weekend",t.isWeekend),S("ngClass",t.cssClass),_(),yr(" ",Qt(2,10,t.date,"monthViewColumnHeader",n)," ")}}function aI(r,e){if(r&1&&(C(0,"div",2),$(1,sI,3,14,"div",3),w()),r&2){let t=e.days,n=e.trackByWeekDayHeaderDate;_(),S("ngForOf",t)("ngForTrackBy",n)}}function cI(r,e){}function lI(r,e){if(r&1){let t=Ce();C(0,"mwl-calendar-month-cell",7),De(1,"calendarA11y"),L("mwlClick",function(i){let o=P(t).$implicit,s=b(2);return N(s.dayClicked.emit({day:o,sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=P(t).$implicit,s=b(2);return N(s.dayClicked.emit({day:o,sourceEvent:i}))})("highlightDay",function(i){P(t);let o=b(2);return N(o.toggleDayHighlight(i.event,!0))})("unhighlightDay",function(i){P(t);let o=b(2);return N(o.toggleDayHighlight(i.event,!1))})("drop",function(i){let o=P(t).$implicit,s=b(2);return N(s.eventDropped(o,i.dropData.event,i.dropData.draggedFrom))})("eventClicked",function(i){P(t);let o=b(2);return N(o.eventClicked.emit({event:i.event,sourceEvent:i.sourceEvent}))}),w()}if(r&2){let t=e.$implicit,n=b(2);S("ngClass",t==null?null:t.cssClass)("day",t)("openDay",n.openDay)("locale",n.locale)("tooltipPlacement",n.tooltipPlacement)("tooltipAppendToBody",n.tooltipAppendToBody)("tooltipTemplate",n.tooltipTemplate)("tooltipDelay",n.tooltipDelay)("customTemplate",n.cellTemplate)("ngStyle",$n(15,Cm,t.backgroundColor))("clickListenerDisabled",n.dayClicked.observers.length===0),Et("tabindex",Mt(1,12,st(17,Rs),"monthCellTabIndex"))}}function dI(r,e){if(r&1){let t=Ce();C(0,"div")(1,"div",4),$(2,lI,2,18,"mwl-calendar-month-cell",5),De(3,"slice"),w(),C(4,"mwl-calendar-open-day-events",6),L("eventClicked",function(i){P(t);let o=b();return N(o.eventClicked.emit({event:i.event,sourceEvent:i.sourceEvent}))})("drop",function(i){P(t);let o=b();return N(o.eventDropped(o.openDay,i.dropData.event,i.dropData.draggedFrom))}),w()()}if(r&2){let t=e.$implicit,n=b();_(2),S("ngForOf",Qt(3,9,n.view.days,t,t+n.view.totalDaysVisibleInWeek))("ngForTrackBy",n.trackByDate),_(2),S("locale",n.locale)("isOpen",n.openRowIndex===t)("events",n.openDay==null?null:n.openDay.events)("date",n.openDay==null?null:n.openDay.date)("customTemplate",n.openDayEventsTemplate)("eventTitleTemplate",n.eventTitleTemplate)("eventActionsTemplate",n.eventActionsTemplate)}}var uI=(r,e,t,n,i,o)=>({days:r,locale:e,dayHeaderClicked:t,eventDropped:n,dragEnter:i,trackByWeekDayHeaderDate:o});function hI(r,e){if(r&1){let t=Ce();C(0,"div",4),L("mwlClick",function(i){let o=P(t).$implicit,s=b().dayHeaderClicked;return N(s.emit({day:o,sourceEvent:i}))})("drop",function(i){let o=P(t).$implicit,s=b().eventDropped;return N(s.emit({event:i.dropData.event,newStart:o.date}))})("dragEnter",function(){let i=P(t).$implicit,o=b().dragEnter;return N(o.emit({date:i.date}))}),C(1,"b"),B(2),De(3,"calendarDate"),w(),G(4,"br"),C(5,"span"),B(6),De(7,"calendarDate"),w()()}if(r&2){let t=e.$implicit,n=b().locale;Ve("cal-past",t.isPast)("cal-today",t.isToday)("cal-future",t.isFuture)("cal-weekend",t.isWeekend),S("ngClass",t.cssClass),_(2),Ht(Qt(3,11,t.date,"weekViewColumnHeader",n)),_(4),Ht(Qt(7,15,t.date,"weekViewColumnSubHeader",n))}}function pI(r,e){if(r&1&&(C(0,"div",2),$(1,hI,8,19,"div",3),w()),r&2){let t=e.days,n=e.trackByWeekDayHeaderDate;_(),S("ngForOf",t)("ngForTrackBy",n)}}function mI(r,e){}var fI=(r,e,t,n,i,o,s,a,c)=>({weekEvent:r,tooltipPlacement:e,eventClicked:t,tooltipTemplate:n,tooltipAppendToBody:i,tooltipDisabled:o,tooltipDelay:s,column:a,daysInWeek:c}),gI=(r,e,t)=>({color:r,backgroundColor:e,borderColor:t});function vI(r,e){if(r&1){let t=Ce();C(0,"div",2),De(1,"calendarEventTitle"),De(2,"calendarA11y"),L("mwlClick",function(i){let o=P(t).eventClicked;return N(o.emit({sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=P(t).eventClicked;return N(o.emit({sourceEvent:i}))}),G(3,"mwl-calendar-event-actions",3),B(4," "),G(5,"mwl-calendar-event-title",4),w()}if(r&2){let t=e.weekEvent,n=e.tooltipPlacement,i=e.tooltipTemplate,o=e.tooltipAppendToBody,s=e.tooltipDisabled,a=e.tooltipDelay,c=e.daysInWeek,l=b();S("ngStyle",Uc(20,gI,t.event.color==null?null:t.event.color.secondaryText,t.event.color==null?null:t.event.color.secondary,t.event.color==null?null:t.event.color.primary))("mwlCalendarTooltip",s?"":Qt(1,13,t.event.title,c===1?"dayTooltip":"weekTooltip",t.tempEvent||t.event))("tooltipPlacement",n)("tooltipEvent",t.tempEvent||t.event)("tooltipTemplate",i)("tooltipAppendToBody",o)("tooltipDelay",a),Et("aria-label",Mt(2,17,pt(24,iw,t.tempEvent||t.event,l.locale),"eventDescription")),_(3),S("event",t.tempEvent||t.event)("customTemplate",l.eventActionsTemplate),_(2),S("event",t.tempEvent||t.event)("customTemplate",l.eventTitleTemplate)("view",c===1?"day":"week")}}function yI(r,e){}var CI=(r,e,t,n,i)=>({segment:r,locale:e,segmentHeight:t,isTimeLabel:n,daysInWeek:i});function wI(r,e){if(r&1&&(C(0,"div",4),B(1),De(2,"calendarDate"),w()),r&2){let t=b(),n=t.segment,i=t.locale,o=t.daysInWeek;_(),yr(" ",Qt(2,1,n.displayDate,o===1?"dayViewHour":"weekViewHour",i)," ")}}function TI(r,e){if(r&1&&(C(0,"div",2),De(1,"calendarA11y"),$(2,wI,3,5,"div",3),w()),r&2){let t=e.segment,n=e.segmentHeight,i=e.isTimeLabel,o=e.daysInWeek;Kn("height",n,"px"),Ve("cal-hour-start",t.isStart)("cal-after-hour-start",!t.isStart),S("ngClass",t.cssClass),Et("aria-hidden",Mt(1,9,st(12,Rs),o===1?"hideDayHourSegment":"hideWeekHourSegment")),_(2),S("ngIf",i)}}function _I(r,e){}var EI=(r,e,t,n,i,o,s)=>({columnDate:r,dayStartHour:e,dayStartMinute:t,dayEndHour:n,dayEndMinute:i,isVisible:o,topPx:s});function SI(r,e){if(r&1&&G(0,"div",3),r&2){let t=b().topPx;Kn("top",t,"px")}}function AI(r,e){if(r&1&&$(0,SI,1,2,"div",2),r&2){let t=e.isVisible;S("ngIf",t)}}function II(r,e){}var bI=(r,e)=>({left:r,right:e}),ow=(r,e)=>({event:r,calendarId:e}),kI=r=>({x:r}),RI=()=>({left:!0}),DI=()=>({right:!0}),MI=(r,e,t,n)=>({left:r,right:e,top:t,bottom:n}),OI=()=>({left:!0,top:!0}),PI=()=>({right:!0,bottom:!0});function NI(r,e){r&1&&Of(0)}function xI(r,e){if(r&1){let t=Ce();C(0,"div",17),L("drop",function(i){let o=P(t).$implicit,s=b(2);return N(s.eventDropped(i,o.date,!0))})("dragEnter",function(){let i=P(t).$implicit,o=b(2);return N(o.dateDragEnter(i.date))}),w()}}function LI(r,e){r&1&&G(0,"div",24),r&2&&S("resizeEdges",st(1,RI))}function FI(r,e){r&1&&G(0,"div",25),r&2&&S("resizeEdges",st(1,DI))}function HI(r,e){if(r&1){let t=Ce();C(0,"div",20,3),L("resizeStart",function(i){let o=P(t).$implicit;b();let s=Pe(1),a=b(2);return N(a.allDayEventResizeStarted(s,o,i))})("resizing",function(i){let o=P(t).$implicit,s=b(3);return N(s.allDayEventResizing(o,i,s.dayColumnWidth))})("resizeEnd",function(){let i=P(t).$implicit,o=b(3);return N(o.allDayEventResizeEnded(i))})("dragStart",function(){let i=P(t).$implicit,o=Pe(1);b();let s=Pe(1),a=b(2);return N(a.dragStarted(s,o,i,!1))})("dragging",function(){P(t);let i=b(3);return N(i.allDayEventDragMove())})("dragEnd",function(i){let o=P(t).$implicit,s=b(3);return N(s.dragEnded(o,i,s.dayColumnWidth))}),$(2,LI,1,2,"div",21),C(3,"mwl-calendar-week-view-event",22),L("eventClicked",function(i){let o=P(t).$implicit,s=b(3);return N(s.eventClicked.emit({event:o.event,sourceEvent:i.sourceEvent}))}),w(),$(4,FI,1,2,"div",23),w()}if(r&2){let t=e.$implicit,n=b(3);Kn("width",100/n.days.length*t.span,"%")("margin-left",n.rtl?null:100/n.days.length*t.offset,"%")("margin-right",n.rtl?100/n.days.length*t.offset:null,"%"),Ve("cal-draggable",t.event.draggable&&n.allDayEventResizes.size===0)("cal-starts-within-week",!t.startsBeforeWeek)("cal-ends-within-week",!t.endsAfterWeek),S("ngClass",t.event==null?null:t.event.cssClass)("resizeCursors",n.resizeCursors)("resizeSnapGrid",pt(33,bI,n.dayColumnWidth,n.dayColumnWidth))("validateResize",n.validateResize)("dropData",pt(36,ow,t.event,n.calendarId))("dragAxis",pt(39,_c,t.event.draggable&&n.allDayEventResizes.size===0,!n.snapDraggedEvents&&t.event.draggable&&n.allDayEventResizes.size===0))("dragSnapGrid",n.snapDraggedEvents?$n(42,kI,n.dayColumnWidth):st(44,Rs))("validateDrag",n.validateDrag)("touchStartLongPress",st(45,Wd)),_(2),S("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.beforeStart)&&!t.startsBeforeWeek),_(),S("locale",n.locale)("weekEvent",t)("tooltipPlacement",n.tooltipPlacement)("tooltipTemplate",n.tooltipTemplate)("tooltipAppendToBody",n.tooltipAppendToBody)("tooltipDelay",n.tooltipDelay)("customTemplate",n.eventTemplate)("eventTitleTemplate",n.eventTitleTemplate)("eventActionsTemplate",n.eventActionsTemplate)("daysInWeek",n.daysInWeek),_(),S("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.afterEnd)&&!t.endsAfterWeek)}}function UI(r,e){if(r&1&&(C(0,"div",18,2),$(2,HI,5,46,"div",19),w()),r&2){let t=e.$implicit,n=b(2);_(2),S("ngForOf",t.row)("ngForTrackBy",n.trackByWeekAllDayEvent)}}function BI(r,e){if(r&1){let t=Ce();C(0,"div",12,1),L("dragEnter",function(){P(t);let i=b();return N(i.dragEnter("allDay"))})("dragLeave",function(){P(t);let i=b();return N(i.dragLeave("allDay"))}),C(2,"div",10)(3,"div",13),$(4,NI,1,0,"ng-container",14),w(),$(5,xI,1,0,"div",15),w(),$(6,UI,3,2,"div",16),w()}if(r&2){let t=b();_(4),S("ngTemplateOutlet",t.allDayEventsLabelTemplate),_(),S("ngForOf",t.days)("ngForTrackBy",t.trackByWeekDayHeaderDate),_(),S("ngForOf",t.view.allDayEventRows)("ngForTrackBy",t.trackById)}}function VI(r,e){if(r&1&&G(0,"mwl-calendar-week-view-hour-segment",29),r&2){let t=e.$implicit,n=b(3);Kn("height",n.hourSegmentHeight,"px"),S("segment",t)("segmentHeight",n.hourSegmentHeight)("locale",n.locale)("customTemplate",n.hourSegmentTemplate)("isTimeLabel",!0)("daysInWeek",n.daysInWeek)}}function zI(r,e){if(r&1&&(C(0,"div",27),$(1,VI,1,8,"mwl-calendar-week-view-hour-segment",28),w()),r&2){let t=e.$implicit,n=e.odd,i=b(2);Ve("cal-hour-odd",n),_(),S("ngForOf",t.segments)("ngForTrackBy",i.trackByHourSegment)}}function KI(r,e){if(r&1&&(C(0,"div",13),$(1,zI,2,4,"div",26),w()),r&2){let t=b();_(),S("ngForOf",t.view.hourColumns[0].hours)("ngForTrackBy",t.trackByHour)}}function qI(r,e){r&1&&G(0,"div",24),r&2&&S("resizeEdges",st(1,OI))}function $I(r,e){}function jI(r,e){if(r&1){let t=Ce();C(0,"mwl-calendar-week-view-event",36),L("eventClicked",function(i){P(t);let o=b().$implicit,s=b(2);return N(s.eventClicked.emit({event:o.event,sourceEvent:i.sourceEvent}))}),w()}if(r&2){let t=b().$implicit,n=b().$implicit,i=b();S("locale",i.locale)("weekEvent",t)("tooltipPlacement",i.tooltipPlacement)("tooltipTemplate",i.tooltipTemplate)("tooltipAppendToBody",i.tooltipAppendToBody)("tooltipDisabled",i.dragActive||i.timeEventResizes.size>0)("tooltipDelay",i.tooltipDelay)("customTemplate",i.eventTemplate)("eventTitleTemplate",i.eventTitleTemplate)("eventActionsTemplate",i.eventActionsTemplate)("column",n)("daysInWeek",i.daysInWeek)}}function WI(r,e){r&1&&G(0,"div",25),r&2&&S("resizeEdges",st(1,PI))}function GI(r,e){if(r&1){let t=Ce();C(0,"div",34,3),L("resizeStart",function(i){let o=P(t).$implicit,s=b(2),a=Pe(6);return N(s.timeEventResizeStarted(a,o,i))})("resizing",function(i){let o=P(t).$implicit,s=b(2);return N(s.timeEventResizing(o,i))})("resizeEnd",function(){let i=P(t).$implicit,o=b(2);return N(o.timeEventResizeEnded(i))})("dragStart",function(){let i=P(t).$implicit,o=Pe(1),s=b(2),a=Pe(6);return N(s.dragStarted(a,o,i,!0))})("dragging",function(i){let o=P(t).$implicit,s=b(2);return N(s.dragMove(o,i))})("dragEnd",function(i){let o=P(t).$implicit,s=b(2);return N(s.dragEnded(o,i,s.dayColumnWidth,!0))}),$(2,qI,1,2,"div",21)(3,$I,0,0,"ng-template",35)(4,jI,1,12,"ng-template",null,4,Ot)(6,WI,1,2,"div",23),w()}if(r&2){let t=e.$implicit,n=Pe(5),i=b(2);Kn("top",t.top,"px")("height",t.height,"px")("left",t.left,"%")("width",t.width,"%"),Ve("cal-draggable",t.event.draggable&&i.timeEventResizes.size===0)("cal-starts-within-day",!t.startsBeforeDay)("cal-ends-within-day",!t.endsAfterDay),S("ngClass",t.event.cssClass)("hidden",t.height===0&&t.width===0)("resizeCursors",i.resizeCursors)("resizeSnapGrid",Pf(30,MI,i.dayColumnWidth,i.dayColumnWidth,i.eventSnapSize||i.hourSegmentHeight,i.eventSnapSize||i.hourSegmentHeight))("validateResize",i.validateResize)("allowNegativeResizes",!0)("dropData",pt(35,ow,t.event,i.calendarId))("dragAxis",pt(38,_c,t.event.draggable&&i.timeEventResizes.size===0,t.event.draggable&&i.timeEventResizes.size===0))("dragSnapGrid",i.snapDraggedEvents?pt(41,_c,i.dayColumnWidth,i.eventSnapSize||i.hourSegmentHeight):st(44,Rs))("touchStartLongPress",st(45,Wd))("ghostDragEnabled",!i.snapDraggedEvents)("ghostElementTemplate",n)("validateDrag",i.validateDrag),_(2),S("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.beforeStart)&&!t.startsBeforeDay),_(),S("ngTemplateOutlet",n),_(3),S("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.afterEnd)&&!t.endsAfterDay)}}function YI(r,e){if(r&1){let t=Ce();C(0,"mwl-calendar-week-view-hour-segment",38),L("mwlClick",function(i){let o=P(t).$implicit,s=b(3);return N(s.hourSegmentClicked.emit({date:o.date,sourceEvent:i}))})("drop",function(i){let o=P(t).$implicit,s=b(3);return N(s.eventDropped(i,o.date,!1))})("dragEnter",function(){let i=P(t).$implicit,o=b(3);return N(o.dateDragEnter(i.date))}),w()}if(r&2){let t=e.$implicit,n=b(3);Kn("height",n.hourSegmentHeight,"px"),S("segment",t)("segmentHeight",n.hourSegmentHeight)("locale",n.locale)("customTemplate",n.hourSegmentTemplate)("daysInWeek",n.daysInWeek)("clickListenerDisabled",n.hourSegmentClicked.observers.length===0)("dragOverClass",!n.dragActive||!n.snapDraggedEvents?"cal-drag-over":null)("isTimeLabel",n.daysInWeek===1)}}function QI(r,e){if(r&1&&(C(0,"div",27),$(1,YI,1,10,"mwl-calendar-week-view-hour-segment",37),w()),r&2){let t=e.$implicit,n=e.odd,i=b(2);Ve("cal-hour-odd",n),_(),S("ngForOf",t.segments)("ngForTrackBy",i.trackByHourSegment)}}function XI(r,e){if(r&1&&(C(0,"div",30),G(1,"mwl-calendar-week-view-current-time-marker",31),C(2,"div",32),$(3,GI,7,46,"div",33),w(),$(4,QI,2,4,"div",26),w()),r&2){let t=e.$implicit,n=b();_(),S("columnDate",t.date)("dayStartHour",n.dayStartHour)("dayStartMinute",n.dayStartMinute)("dayEndHour",n.dayEndHour)("dayEndMinute",n.dayEndMinute)("hourSegments",n.hourSegments)("hourDuration",n.hourDuration)("hourSegmentHeight",n.hourSegmentHeight)("customTemplate",n.currentTimeMarkerTemplate),_(2),S("ngForOf",t.events)("ngForTrackBy",n.trackByWeekTimeEvent),_(),S("ngForOf",t.hours)("ngForTrackBy",n.trackByHour)}}var to=(()=>{class r{constructor(t,n,i){this.renderer=t,this.elm=n,this.document=i,this.clickListenerDisabled=!1,this.click=new W,this.destroy$=new be}ngOnInit(){this.clickListenerDisabled||this.listen().pipe(Ft(this.destroy$)).subscribe(t=>{t.stopPropagation(),this.click.emit(t)})}ngOnDestroy(){this.destroy$.next()}listen(){return new mr(t=>this.renderer.listen(this.elm.nativeElement,"click",n=>{t.next(n)}))}}return r.\u0275fac=function(t){return new(t||r)(x(Yt),x(Tt),x(Je))},r.\u0275dir=et({type:r,selectors:[["","mwlClick",""]],inputs:{clickListenerDisabled:"clickListenerDisabled"},outputs:{click:"mwlClick"}}),r})(),Gd=(()=>{class r{constructor(t,n,i){this.host=t,this.ngZone=n,this.renderer=i,this.keydown=new W,this.keydownListener=null}ngOnInit(){this.ngZone.runOutsideAngular(()=>{this.keydownListener=this.renderer.listen(this.host.nativeElement,"keydown",t=>{(t.keyCode===13||t.which===13||t.key==="Enter")&&(t.preventDefault(),t.stopPropagation(),this.ngZone.run(()=>{this.keydown.emit(t)}))})})}ngOnDestroy(){this.keydownListener!==null&&(this.keydownListener(),this.keydownListener=null)}}return r.\u0275fac=function(t){return new(t||r)(x(Tt),x(ht),x(Yt))},r.\u0275dir=et({type:r,selectors:[["","mwlKeydownEnter",""]],outputs:{keydown:"mwlKeydownEnter"}}),r})(),$d=(()=>{class r{constructor(t){this.i18nPlural=t}monthCell({day:t,locale:n}){return t.badgeTotal>0?`
        ${tt(t.date,"EEEE MMMM d",n)},
        ${this.i18nPlural.transform(t.badgeTotal,{"=0":"No events","=1":"One event",other:"# events"})},
         click to expand
      `:`${tt(t.date,"EEEE MMMM d",n)}`}openDayEventsLandmark({date:t,locale:n}){return`
      Beginning of expanded view for ${tt(t,"EEEE MMMM dd",n)}
    `}openDayEventsAlert({date:t,locale:n}){return`${tt(t,"EEEE MMMM dd",n)} expanded`}eventDescription({event:t,locale:n}){if(t.allDay===!0)return this.allDayEventDescription({event:t,locale:n});let i=`
      ${tt(t.start,"EEEE MMMM dd",n)},
      ${t.title}, from ${tt(t.start,"hh:mm a",n)}
    `;return t.end?i+` to ${tt(t.end,"hh:mm a",n)}`:i}allDayEventDescription({event:t,locale:n}){let i=`
      ${t.title}, event spans multiple days:
      start time ${tt(t.start,"MMMM dd hh:mm a",n)}
    `;return t.end?i+`, stop time ${tt(t.end,"MMMM d hh:mm a",n)}`:i+", no stop time"}actionButtonLabel({action:t}){return t.a11yLabel}monthCellTabIndex(){return 0}hideMonthCellEvents(){return!0}hideEventTitle(){return!0}hideWeekHourSegment(){return!0}hideDayHourSegment(){return!0}}return r.\u0275fac=function(t){return new(t||r)(se(zc))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),no=(()=>{class r{constructor(t,n){this.calendarA11y=t,this.locale=n}transform(t,n){if(t.locale=t.locale||this.locale,typeof this.calendarA11y[n]>"u"){let i=Object.getOwnPropertyNames(Object.getPrototypeOf($d.prototype)).filter(o=>o!=="constructor");throw new Error(`${n} is not a valid a11y method. Can only be one of ${i.join(", ")}`)}return this.calendarA11y[n](t)}}return r.\u0275fac=function(t){return new(t||r)(x($d,16),x(Ks,16))},r.\u0275pipe=ho({name:"calendarA11y",type:r,pure:!0}),r})(),sw=(()=>{class r{constructor(){this.trackByActionId=(t,n)=>n.id?n.id:n}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-event-actions"]],inputs:{event:"event",customTemplate:"customTemplate"},decls:3,vars:5,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cal-event-actions",4,"ngIf"],[1,"cal-event-actions"],["class","cal-event-action","href","javascript:;","tabindex","0","role","button",3,"ngClass","innerHtml","mwlClick","mwlKeydownEnter",4,"ngFor","ngForOf","ngForTrackBy"],["href","javascript:;","tabindex","0","role","button",1,"cal-event-action",3,"mwlClick","mwlKeydownEnter","ngClass","innerHtml"]],template:function(t,n){if(t&1&&$(0,FA,1,1,"ng-template",null,0,Ot)(2,HA,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",pt(2,PA,n.event,n.trackByActionId))}},dependencies:[Xt,bn,mn,Jt,to,Gd,no],encapsulation:2}),r})(),Ec=class{month(e,t){return e.title}monthTooltip(e,t){return e.title}week(e,t){return e.title}weekTooltip(e,t){return e.title}day(e,t){return e.title}dayTooltip(e,t){return e.title}},wm=(()=>{class r{constructor(t){this.calendarEventTitle=t}transform(t,n,i){return this.calendarEventTitle[n](i,t)}}return r.\u0275fac=function(t){return new(t||r)(x(Ec,16))},r.\u0275pipe=ho({name:"calendarEventTitle",type:r,pure:!0}),r})(),aw=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-event-title"]],inputs:{event:"event",customTemplate:"customTemplate",view:"view"},decls:3,vars:5,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-event-title",3,"innerHTML"]],template:function(t,n){if(t&1&&$(0,BA,3,10,"ng-template",null,0,Ot)(2,VA,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",pt(2,UA,n.event,n.view))}},dependencies:[Jt,wm,no],encapsulation:2}),r})(),JI=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-tooltip-window"]],inputs:{contents:"contents",placement:"placement",event:"event",customTemplate:"customTemplate"},decls:3,vars:6,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-tooltip",3,"ngClass"],[1,"cal-tooltip-arrow"],[1,"cal-tooltip-inner",3,"innerHtml"]],template:function(t,n){if(t&1&&$(0,KA,3,2,"ng-template",null,0,Ot)(2,qA,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Uc(2,zA,n.contents,n.placement,n.event))}},dependencies:[Xt,Jt],encapsulation:2}),r})(),cw=(()=>{class r{constructor(t,n,i,o,s,a){this.elementRef=t,this.injector=n,this.renderer=i,this.viewContainerRef=s,this.document=a,this.placement="auto",this.delay=null,this.cancelTooltipDelay$=new be,this.tooltipFactory=o.resolveComponentFactory(JI)}ngOnChanges(t){this.tooltipRef&&(t.contents||t.customTemplate||t.event)&&(this.tooltipRef.instance.contents=this.contents,this.tooltipRef.instance.customTemplate=this.customTemplate,this.tooltipRef.instance.event=this.event,this.tooltipRef.changeDetectorRef.markForCheck(),this.contents||this.hide())}ngOnDestroy(){this.hide()}onMouseOver(){(this.delay===null?Q("now"):af(this.delay)).pipe(Ft(this.cancelTooltipDelay$)).subscribe(()=>{this.show()})}onMouseOut(){this.hide()}show(){!this.tooltipRef&&this.contents&&(this.tooltipRef=this.viewContainerRef.createComponent(this.tooltipFactory,0,this.injector,[]),this.tooltipRef.instance.contents=this.contents,this.tooltipRef.instance.customTemplate=this.customTemplate,this.tooltipRef.instance.event=this.event,this.appendToBody&&this.document.body.appendChild(this.tooltipRef.location.nativeElement),requestAnimationFrame(()=>{this.positionTooltip()}))}hide(){this.tooltipRef&&(this.viewContainerRef.remove(this.viewContainerRef.indexOf(this.tooltipRef.hostView)),this.tooltipRef=null),this.cancelTooltipDelay$.next()}positionTooltip(t=[]){this.tooltipRef&&(this.tooltipRef.changeDetectorRef.detectChanges(),this.tooltipRef.instance.placement=Qp(this.elementRef.nativeElement,this.tooltipRef.location.nativeElement.children[0],this.placement,this.appendToBody),t.indexOf(this.tooltipRef.instance.placement)===-1&&this.positionTooltip([...t,this.tooltipRef.instance.placement]))}}return r.\u0275fac=function(t){return new(t||r)(x(Tt),x(Lc),x(Yt),x(Af),x(po),x(Je))},r.\u0275dir=et({type:r,selectors:[["","mwlCalendarTooltip",""]],hostBindings:function(t,n){t&1&&L("mouseenter",function(){return n.onMouseOver()})("mouseleave",function(){return n.onMouseOut()})},inputs:{contents:[0,"mwlCalendarTooltip","contents"],placement:[0,"tooltipPlacement","placement"],customTemplate:[0,"tooltipTemplate","customTemplate"],event:[0,"tooltipEvent","event"],appendToBody:[0,"tooltipAppendToBody","appendToBody"],delay:[0,"tooltipDelay","delay"]},features:[In]}),r})(),Bn=function(r){return r.Month="month",r.Week="week",r.Day="day",r}(Bn||{}),lw=r=>xC(r,(...t)=>console.warn("angular-calendar",...t));function dw(r,e){return Math.floor(r.left)<=Math.ceil(e.left)&&Math.floor(e.left)<=Math.ceil(r.right)&&Math.floor(r.left)<=Math.ceil(e.right)&&Math.floor(e.right)<=Math.ceil(r.right)}function ZI(r,e){return Math.floor(r.top)<=Math.ceil(e.top)&&Math.floor(e.top)<=Math.ceil(r.bottom)&&Math.floor(r.top)<=Math.ceil(e.bottom)&&Math.floor(e.bottom)<=Math.ceil(r.bottom)}function eb(r,e){return dw(r,e)&&ZI(r,e)}function uw(r,e){return Math.round(r/e)*e}var hw=(r,e)=>e.id?e.id:e,Tm=(r,e)=>e.date.toISOString(),tb=(r,e)=>e.date.toISOString(),nb=(r,e)=>e.segments[0].date.toISOString(),rb=(r,e)=>e.event.id?e.event.id:e.event,ib=(r,e)=>e.event.id?e.event.id:e.event,ob=60;function sb(r,e,t){return(t||ob)/(r*e)}function mm(r,e,t,n,i){let o=uw(r,n||t),s=sb(e,t,i);return o*s}function tw(r,e,t){return e.end?e.end:r.addMinutes(e.start,t)}function _n(r,e,t,n){let i=0,o=0,s=t<0?r.subDays:r.addDays,a=e;for(;o<=Math.abs(t);){a=s(e,i);let c=r.getDay(a);n.indexOf(c)===-1&&o++,i++}return a}function ab(r,e,t){let n=e||r;return t.start<=r&&r<=t.end||t.start<=n&&n<=t.end}function cb(r,e,t,n){return r.dropData&&r.dropData.event&&(r.dropData.calendarId!==n||r.dropData.event.allDay&&!t||!r.dropData.event.allDay&&t)}function fm(r,e,t,n=[],i){let o=i?r.startOfDay(e):r.startOfWeek(e,{weekStartsOn:t}),s=r.endOfWeek(e,{weekStartsOn:t});for(;n.indexOf(r.getDay(o))>-1&&o<s;)o=r.addDays(o,1);if(i){let a=r.endOfDay(_n(r,o,i-1,n));return{viewStart:o,viewEnd:a}}else{let a=s;for(;n.indexOf(r.getDay(a))>-1&&a>o;)a=r.subDays(a,1);return{viewStart:o,viewEnd:a}}}function _m({x:r,y:e}){return Math.abs(r)>1||Math.abs(e)>1}var sn=class{},pw=(()=>{class r{constructor(t){this.dateAdapter=t,this.excludeDays=[],this.viewDateChange=new W}onClick(){let t={day:this.dateAdapter.subDays,week:this.dateAdapter.subWeeks,month:this.dateAdapter.subMonths}[this.view];this.view===Bn.Day?this.viewDateChange.emit(_n(this.dateAdapter,this.viewDate,-1,this.excludeDays)):this.view===Bn.Week&&this.daysInWeek?this.viewDateChange.emit(_n(this.dateAdapter,this.viewDate,-this.daysInWeek,this.excludeDays)):this.viewDateChange.emit(t(this.viewDate,1))}}return r.\u0275fac=function(t){return new(t||r)(x(sn))},r.\u0275dir=et({type:r,selectors:[["","mwlCalendarPreviousView",""]],hostBindings:function(t,n){t&1&&L("click",function(){return n.onClick()})},inputs:{view:"view",viewDate:"viewDate",excludeDays:"excludeDays",daysInWeek:"daysInWeek"},outputs:{viewDateChange:"viewDateChange"}}),r})(),mw=(()=>{class r{constructor(t){this.dateAdapter=t,this.excludeDays=[],this.viewDateChange=new W}onClick(){let t={day:this.dateAdapter.addDays,week:this.dateAdapter.addWeeks,month:this.dateAdapter.addMonths}[this.view];this.view===Bn.Day?this.viewDateChange.emit(_n(this.dateAdapter,this.viewDate,1,this.excludeDays)):this.view===Bn.Week&&this.daysInWeek?this.viewDateChange.emit(_n(this.dateAdapter,this.viewDate,this.daysInWeek,this.excludeDays)):this.viewDateChange.emit(t(this.viewDate,1))}}return r.\u0275fac=function(t){return new(t||r)(x(sn))},r.\u0275dir=et({type:r,selectors:[["","mwlCalendarNextView",""]],hostBindings:function(t,n){t&1&&L("click",function(){return n.onClick()})},inputs:{view:"view",viewDate:"viewDate",excludeDays:"excludeDays",daysInWeek:"daysInWeek"},outputs:{viewDateChange:"viewDateChange"}}),r})(),fw=(()=>{class r{constructor(t){this.dateAdapter=t,this.viewDateChange=new W}onClick(){this.viewDateChange.emit(this.dateAdapter.startOfDay(new Date))}}return r.\u0275fac=function(t){return new(t||r)(x(sn))},r.\u0275dir=et({type:r,selectors:[["","mwlCalendarToday",""]],hostBindings:function(t,n){t&1&&L("click",function(){return n.onClick()})},inputs:{viewDate:"viewDate"},outputs:{viewDateChange:"viewDateChange"}}),r})(),lb=(()=>{class r{constructor(t){this.dateAdapter=t}monthViewColumnHeader({date:t,locale:n}){return tt(t,"EEEE",n)}monthViewDayNumber({date:t,locale:n}){return tt(t,"d",n)}monthViewTitle({date:t,locale:n}){return tt(t,"LLLL y",n)}weekViewColumnHeader({date:t,locale:n}){return tt(t,"EEEE",n)}weekViewColumnSubHeader({date:t,locale:n}){return tt(t,"MMM d",n)}weekViewTitle({date:t,locale:n,weekStartsOn:i,excludeDays:o,daysInWeek:s}){let{viewStart:a,viewEnd:c}=fm(this.dateAdapter,t,i,o,s),l=(d,u)=>tt(d,"MMM d"+(u?", yyyy":""),n);return`${l(a,a.getUTCFullYear()!==c.getUTCFullYear())} - ${l(c,!0)}`}weekViewHour({date:t,locale:n}){return tt(t,"h a",n)}dayViewHour({date:t,locale:n}){return tt(t,"h a",n)}dayViewTitle({date:t,locale:n}){return tt(t,"EEEE, MMMM d, y",n)}}return r.\u0275fac=function(t){return new(t||r)(se(sn))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),jd=(()=>{class r extends lb{}return r.\u0275fac=(()=>{let e;return function(n){return(e||(e=Vs(r)))(n||r)}})(),r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),Ds=(()=>{class r{constructor(t,n){this.dateFormatter=t,this.locale=n}transform(t,n,i=this.locale,o=0,s=[],a){if(typeof this.dateFormatter[n]>"u"){let c=Object.getOwnPropertyNames(Object.getPrototypeOf(jd.prototype)).filter(l=>l!=="constructor");throw new Error(`${n} is not a valid date formatter. Can only be one of ${c.join(", ")}`)}return this.dateFormatter[n]({date:t,locale:i,weekStartsOn:o,excludeDays:s,daysInWeek:a})}}return r.\u0275fac=function(t){return new(t||r)(x(jd,16),x(Ks,16))},r.\u0275pipe=ho({name:"calendarDate",type:r,pure:!0}),r})(),Yd=(()=>{class r{constructor(t){this.dateAdapter=t}getMonthView(t){return NC(this.dateAdapter,t)}getWeekViewHeader(t){return Ud(this.dateAdapter,t)}getWeekView(t){return PC(this.dateAdapter,t)}}return r.\u0275fac=function(t){return new(t||r)(se(sn))},r.\u0275prov=he({token:r,factory:r.\u0275fac}),r})(),oK=new Xe("Moment");var ni=function(r){return r.Drag="drag",r.Drop="drop",r.Resize="resize",r}(ni||{}),Sc=(()=>{class r{static forRoot(t,n={}){return{ngModule:r,providers:[t,n.eventTitleFormatter||Ec,n.dateFormatter||jd,n.utils||Yd,n.a11y||$d]}}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({providers:[zc],imports:[Ut]}),r})(),db=(()=>{class r{constructor(){this.highlightDay=new W,this.unhighlightDay=new W,this.eventClicked=new W,this.trackByEventId=hw,this.validateDrag=_m}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-month-cell"]],hostAttrs:[1,"cal-cell","cal-day-cell"],hostVars:18,hostBindings:function(t,n){t&2&&Ve("cal-past",n.day.isPast)("cal-today",n.day.isToday)("cal-future",n.day.isFuture)("cal-weekend",n.day.isWeekend)("cal-in-month",n.day.inMonth)("cal-out-month",!n.day.inMonth)("cal-has-events",n.day.events.length>0)("cal-open",n.day===n.openDay)("cal-event-highlight",!!n.day.backgroundColor)},inputs:{day:"day",openDay:"openDay",locale:"locale",tooltipPlacement:"tooltipPlacement",tooltipAppendToBody:"tooltipAppendToBody",customTemplate:"customTemplate",tooltipTemplate:"tooltipTemplate",tooltipDelay:"tooltipDelay"},outputs:{highlightDay:"highlightDay",unhighlightDay:"unhighlightDay",eventClicked:"eventClicked"},decls:3,vars:15,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-cell-top"],["aria-hidden","true"],["class","cal-day-badge",4,"ngIf"],[1,"cal-day-number"],["class","cal-events",4,"ngIf"],[1,"cal-day-badge"],[1,"cal-events"],["class","cal-event","mwlDraggable","","dragActiveClass","cal-drag-active",3,"ngStyle","ngClass","mwlCalendarTooltip","tooltipPlacement","tooltipEvent","tooltipTemplate","tooltipAppendToBody","tooltipDelay","cal-draggable","dropData","dragAxis","validateDrag","touchStartLongPress","mouseenter","mouseleave","mwlClick",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDraggable","","dragActiveClass","cal-drag-active",1,"cal-event",3,"mouseenter","mouseleave","mwlClick","ngStyle","ngClass","mwlCalendarTooltip","tooltipPlacement","tooltipEvent","tooltipTemplate","tooltipAppendToBody","tooltipDelay","dropData","dragAxis","validateDrag","touchStartLongPress"]],template:function(t,n){if(t&1&&$(0,XA,8,14,"ng-template",null,0,Ot)(2,JA,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",bu(2,$A,[n.day,n.openDay,n.locale,n.tooltipPlacement,n.highlightDay,n.unhighlightDay,n.eventClicked,n.tooltipTemplate,n.tooltipAppendToBody,n.tooltipDelay,n.trackByEventId,n.validateDrag]))}},dependencies:[Xt,bn,mn,Jt,qs,Vd,cw,to,Ds,wm,no],encapsulation:2}),r})(),Em=qC("collapse",[lm("void",ks({height:0,overflow:"hidden","padding-top":0,"padding-bottom":0})),lm("*",ks({height:"*",overflow:"hidden","padding-top":"*","padding-bottom":"*"})),dm("* => void",cm("150ms ease-out")),dm("void => *",cm("150ms ease-in"))]),ub=(()=>{class r{constructor(){this.isOpen=!1,this.eventClicked=new W,this.trackByEventId=hw,this.validateDrag=_m}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-open-day-events"]],inputs:{locale:"locale",isOpen:"isOpen",events:"events",customTemplate:"customTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",date:"date"},outputs:{eventClicked:"eventClicked"},decls:3,vars:8,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cal-open-day-events","role","application",4,"ngIf"],["role","application",1,"cal-open-day-events"],["tabindex","-1","role","alert"],["tabindex","0","role","landmark"],["mwlDraggable","","dragActiveClass","cal-drag-active",3,"ngClass","cal-draggable","dropData","dragAxis","validateDrag","touchStartLongPress",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDraggable","","dragActiveClass","cal-drag-active",3,"ngClass","dropData","dragAxis","validateDrag","touchStartLongPress"],[1,"cal-event",3,"ngStyle"],["view","month","tabindex","0",3,"mwlClick","mwlKeydownEnter","event","customTemplate"],[3,"event","customTemplate"]],template:function(t,n){if(t&1&&$(0,rI,1,1,"ng-template",null,0,Ot)(2,iI,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Iu(2,ZA,n.events,n.eventClicked,n.isOpen,n.trackByEventId,n.validateDrag))}},dependencies:[Xt,bn,mn,Jt,qs,Vd,sw,aw,to,Gd,no],encapsulation:2,data:{animation:[Em]}}),r})(),hb=(()=>{class r{constructor(){this.columnHeaderClicked=new W,this.trackByWeekDayHeaderDate=Tm}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-month-view-header"]],inputs:{days:"days",locale:"locale",customTemplate:"customTemplate"},outputs:{columnHeaderClicked:"columnHeaderClicked"},decls:3,vars:6,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["role","row",1,"cal-cell-row","cal-header"],["class","cal-cell","tabindex","0","role","columnheader",3,"cal-past","cal-today","cal-future","cal-weekend","ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],["tabindex","0","role","columnheader",1,"cal-cell",3,"click","ngClass"]],template:function(t,n){if(t&1&&$(0,aI,2,2,"ng-template",null,0,Ot)(2,cI,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Uc(2,oI,n.days,n.locale,n.trackByWeekDayHeaderDate))}},dependencies:[Xt,bn,Jt,Ds],encapsulation:2}),r})(),gw=(()=>{class r{constructor(t,n,i,o){this.cdr=t,this.utils=n,this.dateAdapter=o,this.events=[],this.excludeDays=[],this.activeDayIsOpen=!1,this.tooltipPlacement="auto",this.tooltipAppendToBody=!0,this.tooltipDelay=null,this.beforeViewRender=new W,this.dayClicked=new W,this.eventClicked=new W,this.columnHeaderClicked=new W,this.eventTimesChanged=new W,this.trackByRowOffset=(s,a)=>this.view.days.slice(a,this.view.totalDaysVisibleInWeek).map(c=>c.date.toISOString()).join("-"),this.trackByDate=(s,a)=>a.date.toISOString(),this.locale=i}ngOnInit(){this.refresh&&(this.refreshSubscription=this.refresh.subscribe(()=>{this.refreshAll(),this.cdr.markForCheck()}))}ngOnChanges(t){let n=t.viewDate||t.excludeDays||t.weekendDays,i=t.viewDate||t.events||t.excludeDays||t.weekendDays;n&&this.refreshHeader(),t.events&&lw(this.events),i&&this.refreshBody(),(n||i)&&this.emitBeforeViewRender(),(t.activeDayIsOpen||t.viewDate||t.events||t.excludeDays||t.activeDay)&&this.checkActiveDayIsOpen()}ngOnDestroy(){this.refreshSubscription&&this.refreshSubscription.unsubscribe()}toggleDayHighlight(t,n){this.view.days.forEach(i=>{n&&i.events.indexOf(t)>-1?i.backgroundColor=t.color&&t.color.secondary||"#D1E8FF":delete i.backgroundColor})}eventDropped(t,n,i){if(t!==i){let o=this.dateAdapter.getYear(t.date),s=this.dateAdapter.getMonth(t.date),a=this.dateAdapter.getDate(t.date),c=this.dateAdapter.setDate(this.dateAdapter.setMonth(this.dateAdapter.setYear(n.start,o),s),a),l;if(n.end){let d=this.dateAdapter.differenceInSeconds(c,n.start);l=this.dateAdapter.addSeconds(n.end,d)}this.eventTimesChanged.emit({event:n,newStart:c,newEnd:l,day:t,type:ni.Drop})}}refreshHeader(){this.columnHeaders=this.utils.getWeekViewHeader({viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,weekendDays:this.weekendDays})}refreshBody(){this.view=this.utils.getMonthView({events:this.events,viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,weekendDays:this.weekendDays})}checkActiveDayIsOpen(){if(this.activeDayIsOpen===!0){let t=this.activeDay||this.viewDate;this.openDay=this.view.days.find(i=>this.dateAdapter.isSameDay(i.date,t));let n=this.view.days.indexOf(this.openDay);this.openRowIndex=Math.floor(n/this.view.totalDaysVisibleInWeek)*this.view.totalDaysVisibleInWeek}else this.openRowIndex=null,this.openDay=null}refreshAll(){this.refreshHeader(),this.refreshBody(),this.emitBeforeViewRender(),this.checkActiveDayIsOpen()}emitBeforeViewRender(){this.columnHeaders&&this.view&&this.beforeViewRender.emit({header:this.columnHeaders,body:this.view.days,period:this.view.period})}}return r.\u0275fac=function(t){return new(t||r)(x(Tr),x(Yd),x(Ks),x(sn))},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-month-view"]],inputs:{viewDate:"viewDate",events:"events",excludeDays:"excludeDays",activeDayIsOpen:"activeDayIsOpen",activeDay:"activeDay",refresh:"refresh",locale:"locale",tooltipPlacement:"tooltipPlacement",tooltipTemplate:"tooltipTemplate",tooltipAppendToBody:"tooltipAppendToBody",tooltipDelay:"tooltipDelay",weekStartsOn:"weekStartsOn",headerTemplate:"headerTemplate",cellTemplate:"cellTemplate",openDayEventsTemplate:"openDayEventsTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",weekendDays:"weekendDays"},outputs:{beforeViewRender:"beforeViewRender",dayClicked:"dayClicked",eventClicked:"eventClicked",columnHeaderClicked:"columnHeaderClicked",eventTimesChanged:"eventTimesChanged"},features:[In],decls:4,vars:5,consts:[["role","grid",1,"cal-month-view"],[3,"columnHeaderClicked","days","locale","customTemplate"],[1,"cal-days"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","row",1,"cal-cell-row"],["role","gridcell","mwlDroppable","","dragOverClass","cal-drag-over",3,"ngClass","day","openDay","locale","tooltipPlacement","tooltipAppendToBody","tooltipTemplate","tooltipDelay","customTemplate","ngStyle","clickListenerDisabled","mwlClick","mwlKeydownEnter","highlightDay","unhighlightDay","drop","eventClicked",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragOverClass","cal-drag-over",3,"eventClicked","drop","locale","isOpen","events","date","customTemplate","eventTitleTemplate","eventActionsTemplate"],["role","gridcell","mwlDroppable","","dragOverClass","cal-drag-over",3,"mwlClick","mwlKeydownEnter","highlightDay","unhighlightDay","drop","eventClicked","ngClass","day","openDay","locale","tooltipPlacement","tooltipAppendToBody","tooltipTemplate","tooltipDelay","customTemplate","ngStyle","clickListenerDisabled"]],template:function(t,n){t&1&&(C(0,"div",0)(1,"mwl-calendar-month-view-header",1),L("columnHeaderClicked",function(o){return n.columnHeaderClicked.emit(o)}),w(),C(2,"div",2),$(3,dI,5,13,"div",3),w()()),t&2&&(_(),S("days",n.columnHeaders)("locale",n.locale)("customTemplate",n.headerTemplate),_(2),S("ngForOf",n.view.rowOffsets)("ngForTrackBy",n.trackByRowOffset))},dependencies:[Xt,bn,qs,zd,to,Gd,db,ub,hb,Yf,no],encapsulation:2}),r})(),nw=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({imports:[Ut,wc,Sc,wc]}),r})(),gm=class{constructor(e,t){this.dragContainerElement=e,this.startPosition=t.getBoundingClientRect()}validateDrag({x:e,y:t,snapDraggedEvents:n,dragAlreadyMoved:i,transform:o}){let s=_m({x:e,y:t})||i;if(n){let a=Object.assign({},this.startPosition,{left:this.startPosition.left+o.x,right:this.startPosition.right+o.x,top:this.startPosition.top+o.y,bottom:this.startPosition.bottom+o.y});if(s){let c=this.dragContainerElement.getBoundingClientRect(),l=c.top<a.top&&a.top<c.bottom,d=c.top<a.bottom&&a.bottom<c.bottom;return dw(c,a)&&(l||d)}return!1}else return s}},vm=class{constructor(e,t,n){this.resizeContainerElement=e,this.minWidth=t,this.rtl=n}validateResize({rectangle:e,edges:t}){return this.rtl&&(typeof t.left<"u"?(e.left-=t.left,e.right+=t.left):typeof t.right<"u"&&(e.left+=t.right,e.right-=t.right),e.width=e.right-e.left),this.minWidth&&Math.ceil(e.width)<Math.ceil(this.minWidth)?!1:eb(this.resizeContainerElement.getBoundingClientRect(),e)}},pb=(()=>{class r{constructor(){this.dayHeaderClicked=new W,this.eventDropped=new W,this.dragEnter=new W,this.trackByWeekDayHeaderDate=Tm}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-week-view-header"]],inputs:{days:"days",locale:"locale",customTemplate:"customTemplate"},outputs:{dayHeaderClicked:"dayHeaderClicked",eventDropped:"eventDropped",dragEnter:"dragEnter"},decls:3,vars:9,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["role","row",1,"cal-day-headers"],["class","cal-header","mwlDroppable","","dragOverClass","cal-drag-over","tabindex","0","role","columnheader",3,"cal-past","cal-today","cal-future","cal-weekend","ngClass","mwlClick","drop","dragEnter",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragOverClass","cal-drag-over","tabindex","0","role","columnheader",1,"cal-header",3,"mwlClick","drop","dragEnter","ngClass"]],template:function(t,n){if(t&1&&$(0,pI,2,2,"ng-template",null,0,Ot)(2,mI,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Nf(2,uI,n.days,n.locale,n.dayHeaderClicked,n.eventDropped,n.dragEnter,n.trackByWeekDayHeaderDate))}},dependencies:[Xt,bn,Jt,zd,to,Ds],encapsulation:2}),r})(),mb=(()=>{class r{constructor(){this.eventClicked=new W}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-week-view-event"]],inputs:{locale:"locale",weekEvent:"weekEvent",tooltipPlacement:"tooltipPlacement",tooltipAppendToBody:"tooltipAppendToBody",tooltipDisabled:"tooltipDisabled",tooltipDelay:"tooltipDelay",customTemplate:"customTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",tooltipTemplate:"tooltipTemplate",column:"column",daysInWeek:"daysInWeek"},outputs:{eventClicked:"eventClicked"},decls:3,vars:12,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["tabindex","0","role","application",1,"cal-event",3,"mwlClick","mwlKeydownEnter","ngStyle","mwlCalendarTooltip","tooltipPlacement","tooltipEvent","tooltipTemplate","tooltipAppendToBody","tooltipDelay"],[3,"event","customTemplate"],[3,"event","customTemplate","view"]],template:function(t,n){if(t&1&&$(0,vI,6,27,"ng-template",null,0,Ot)(2,yI,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",bu(2,fI,[n.weekEvent,n.tooltipPlacement,n.eventClicked,n.tooltipTemplate,n.tooltipAppendToBody,n.tooltipDisabled,n.tooltipDelay,n.column,n.daysInWeek]))}},dependencies:[Jt,qs,sw,aw,cw,to,Gd,wm,no],encapsulation:2}),r})(),fb=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-week-view-hour-segment"]],inputs:{segment:"segment",segmentHeight:"segmentHeight",locale:"locale",isTimeLabel:"isTimeLabel",daysInWeek:"daysInWeek",customTemplate:"customTemplate"},decls:3,vars:8,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-hour-segment",3,"ngClass"],["class","cal-time",4,"ngIf"],[1,"cal-time"]],template:function(t,n){if(t&1&&$(0,TI,3,13,"ng-template",null,0,Ot)(2,_I,0,0,"ng-template",1),t&2){let i=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Iu(2,CI,n.segment,n.locale,n.segmentHeight,n.isTimeLabel,n.daysInWeek))}},dependencies:[Xt,mn,Jt,Ds,no],encapsulation:2}),r})(),gb=(()=>{class r{constructor(t,n){this.dateAdapter=t,this.zone=n,this.columnDate$=new yt(void 0),this.marker$=this.zone.onStable.pipe(Ze(()=>cf(60*1e3)),uo(0),mf(this.columnDate$),ne(i=>{let o=this.dateAdapter.setMinutes(this.dateAdapter.setHours(i,this.dayStartHour),this.dayStartMinute),s=this.dateAdapter.setMinutes(this.dateAdapter.setHours(i,this.dayEndHour),this.dayEndMinute),a=this.hourSegments*this.hourSegmentHeight/(this.hourDuration||60),c=new Date;return{isVisible:this.dateAdapter.isSameDay(i,c)&&c>=o&&c<=s,top:this.dateAdapter.differenceInMinutes(c,o)*a}}))}ngOnChanges(t){t.columnDate&&this.columnDate$.next(t.columnDate.currentValue)}}return r.\u0275fac=function(t){return new(t||r)(x(sn),x(ht))},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-week-view-current-time-marker"]],inputs:{columnDate:"columnDate",dayStartHour:"dayStartHour",dayStartMinute:"dayStartMinute",dayEndHour:"dayEndHour",dayEndMinute:"dayEndMinute",hourSegments:"hourSegments",hourDuration:"hourDuration",hourSegmentHeight:"hourSegmentHeight",customTemplate:"customTemplate"},features:[In],decls:5,vars:14,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cal-current-time-marker",3,"top",4,"ngIf"],[1,"cal-current-time-marker"]],template:function(t,n){if(t&1&&($(0,AI,1,1,"ng-template",null,0,Ot)(2,II,0,0,"ng-template",1),De(3,"async"),De(4,"async")),t&2){let i,o=Pe(1);_(2),S("ngTemplateOutlet",n.customTemplate||o)("ngTemplateOutletContext",xf(6,EI,n.columnDate,n.dayStartHour,n.dayStartMinute,n.dayEndHour,n.dayEndMinute,(i=ku(3,2,n.marker$))==null?null:i.isVisible,(i=ku(4,4,n.marker$))==null?null:i.top))}},dependencies:[mn,Jt,Gf],encapsulation:2}),r})(),Sm=(()=>{class r{constructor(t,n,i,o,s){this.cdr=t,this.utils=n,this.dateAdapter=o,this.element=s,this.events=[],this.excludeDays=[],this.tooltipPlacement="auto",this.tooltipAppendToBody=!0,this.tooltipDelay=null,this.precision="days",this.snapDraggedEvents=!0,this.hourSegments=2,this.hourSegmentHeight=30,this.minimumEventHeight=30,this.dayStartHour=0,this.dayStartMinute=0,this.dayEndHour=23,this.dayEndMinute=59,this.dayHeaderClicked=new W,this.eventClicked=new W,this.eventTimesChanged=new W,this.beforeViewRender=new W,this.hourSegmentClicked=new W,this.allDayEventResizes=new Map,this.timeEventResizes=new Map,this.eventDragEnterByType={allDay:0,time:0},this.dragActive=!1,this.dragAlreadyMoved=!1,this.calendarId=Symbol("angular calendar week view id"),this.rtl=!1,this.trackByWeekDayHeaderDate=Tm,this.trackByHourSegment=tb,this.trackByHour=nb,this.trackByWeekAllDayEvent=rb,this.trackByWeekTimeEvent=ib,this.trackByHourColumn=(a,c)=>c.hours[0]?c.hours[0].segments[0].date.toISOString():c,this.trackById=(a,c)=>c.id,this.locale=i}ngOnInit(){this.refresh&&(this.refreshSubscription=this.refresh.subscribe(()=>{this.refreshAll(),this.cdr.markForCheck()}))}ngOnChanges(t){let n=t.viewDate||t.excludeDays||t.weekendDays||t.daysInWeek||t.weekStartsOn,i=t.viewDate||t.dayStartHour||t.dayStartMinute||t.dayEndHour||t.dayEndMinute||t.hourSegments||t.hourDuration||t.weekStartsOn||t.weekendDays||t.excludeDays||t.hourSegmentHeight||t.events||t.daysInWeek||t.minimumEventHeight;n&&this.refreshHeader(),t.events&&lw(this.events),i&&this.refreshBody(),(n||i)&&this.emitBeforeViewRender()}ngOnDestroy(){this.refreshSubscription&&this.refreshSubscription.unsubscribe()}ngAfterViewInit(){this.rtl=typeof window<"u"&&getComputedStyle(this.element.nativeElement).direction==="rtl",this.cdr.detectChanges()}timeEventResizeStarted(t,n,i){this.timeEventResizes.set(n.event,i),this.resizeStarted(t,n)}timeEventResizing(t,n){this.timeEventResizes.set(t.event,n);let i=new Map,o=[...this.events];this.timeEventResizes.forEach((s,a)=>{let c=this.getTimeEventResizedDates(a,s),l=g(g({},a),c);i.set(l,a);let d=o.indexOf(a);o[d]=l}),this.restoreOriginalEvents(o,i,!0)}timeEventResizeEnded(t){this.view=this.getWeekView(this.events);let n=this.timeEventResizes.get(t.event);if(n){this.timeEventResizes.delete(t.event);let i=this.getTimeEventResizedDates(t.event,n);this.eventTimesChanged.emit({newStart:i.start,newEnd:i.end,event:t.event,type:ni.Resize})}}allDayEventResizeStarted(t,n,i){this.allDayEventResizes.set(n,{originalOffset:n.offset,originalSpan:n.span,edge:typeof i.edges.left<"u"?"left":"right"}),this.resizeStarted(t,n,this.getDayColumnWidth(t))}allDayEventResizing(t,n,i){let o=this.allDayEventResizes.get(t),s=this.rtl?-1:1;if(typeof n.edges.left<"u"){let a=Math.round(+n.edges.left/i)*s;t.offset=o.originalOffset+a,t.span=o.originalSpan-a}else if(typeof n.edges.right<"u"){let a=Math.round(+n.edges.right/i)*s;t.span=o.originalSpan+a}}allDayEventResizeEnded(t){let n=this.allDayEventResizes.get(t);if(n){let i=n.edge==="left",o;i?o=t.offset-n.originalOffset:o=t.span-n.originalSpan,t.offset=n.originalOffset,t.span=n.originalSpan;let s=this.getAllDayEventResizedDates(t.event,o,i);this.eventTimesChanged.emit({newStart:s.start,newEnd:s.end,event:t.event,type:ni.Resize}),this.allDayEventResizes.delete(t)}}getDayColumnWidth(t){return Math.floor(t.offsetWidth/this.days.length)}dateDragEnter(t){this.lastDragEnterDate=t}eventDropped(t,n,i){cb(t,n,i,this.calendarId)&&this.lastDragEnterDate.getTime()===n.getTime()&&(!this.snapDraggedEvents||t.dropData.event!==this.lastDraggedEvent)&&this.eventTimesChanged.emit({type:ni.Drop,event:t.dropData.event,newStart:n,allDay:i}),this.lastDraggedEvent=null}dragEnter(t){this.eventDragEnterByType[t]++}dragLeave(t){this.eventDragEnterByType[t]--}dragStarted(t,n,i,o){this.dayColumnWidth=this.getDayColumnWidth(t);let s=new gm(t,n);this.validateDrag=({x:a,y:c,transform:l})=>{let d=this.allDayEventResizes.size===0&&this.timeEventResizes.size===0&&s.validateDrag({x:a,y:c,snapDraggedEvents:this.snapDraggedEvents,dragAlreadyMoved:this.dragAlreadyMoved,transform:l});if(d&&this.validateEventTimesChanged){let u=this.getDragMovedEventTimes(i,{x:a,y:c},this.dayColumnWidth,o);return this.validateEventTimesChanged({type:ni.Drag,event:i.event,newStart:u.start,newEnd:u.end})}return d},this.dragActive=!0,this.dragAlreadyMoved=!1,this.lastDraggedEvent=null,this.eventDragEnterByType={allDay:0,time:0},!this.snapDraggedEvents&&o&&this.view.hourColumns.forEach(a=>{let c=a.events.find(l=>l.event===i.event&&l!==i);c&&(c.width=0,c.height=0)}),this.cdr.markForCheck()}dragMove(t,n){let i=this.getDragMovedEventTimes(t,n,this.dayColumnWidth,!0),o=t.event,s=g(g({},o),i),a=this.events.map(c=>c===o?s:c);this.restoreOriginalEvents(a,new Map([[s,o]]),this.snapDraggedEvents),this.dragAlreadyMoved=!0}allDayEventDragMove(){this.dragAlreadyMoved=!0}dragEnded(t,n,i,o=!1){this.view=this.getWeekView(this.events),this.dragActive=!1,this.validateDrag=null;let{start:s,end:a}=this.getDragMovedEventTimes(t,n,i,o);(this.snapDraggedEvents||this.eventDragEnterByType[o?"time":"allDay"]>0)&&ab(s,a,this.view.period)&&(this.lastDraggedEvent=t.event,this.eventTimesChanged.emit({newStart:s,newEnd:a,event:t.event,type:ni.Drag,allDay:!o}))}refreshHeader(){this.days=this.utils.getWeekViewHeader(g({viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,weekendDays:this.weekendDays},fm(this.dateAdapter,this.viewDate,this.weekStartsOn,this.excludeDays,this.daysInWeek)))}refreshBody(){this.view=this.getWeekView(this.events)}refreshAll(){this.refreshHeader(),this.refreshBody(),this.emitBeforeViewRender()}emitBeforeViewRender(){this.days&&this.view&&this.beforeViewRender.emit(g({header:this.days},this.view))}getWeekView(t){return this.utils.getWeekView(g({events:t,viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,precision:this.precision,absolutePositionedEvents:!0,hourSegments:this.hourSegments,hourDuration:this.hourDuration,dayStart:{hour:this.dayStartHour,minute:this.dayStartMinute},dayEnd:{hour:this.dayEndHour,minute:this.dayEndMinute},segmentHeight:this.hourSegmentHeight,weekendDays:this.weekendDays,minimumEventHeight:this.minimumEventHeight},fm(this.dateAdapter,this.viewDate,this.weekStartsOn,this.excludeDays,this.daysInWeek)))}getDragMovedEventTimes(t,n,i,o){let s=uw(n.x,i)/i*(this.rtl?-1:1),a=o?mm(n.y,this.hourSegments,this.hourSegmentHeight,this.eventSnapSize,this.hourDuration):0,c=this.dateAdapter.addMinutes(_n(this.dateAdapter,t.event.start,s,this.excludeDays),a),l;return t.event.end&&(l=this.dateAdapter.addMinutes(_n(this.dateAdapter,t.event.end,s,this.excludeDays),a)),{start:c,end:l}}restoreOriginalEvents(t,n,i=!0){let o=this.view;i&&(this.view=this.getWeekView(t));let s=t.filter(a=>n.has(a));this.view.hourColumns.forEach((a,c)=>{o.hourColumns[c].hours.forEach((l,d)=>{l.segments.forEach((u,m)=>{a.hours[d].segments[m].cssClass=u.cssClass})}),s.forEach(l=>{let d=n.get(l),u=a.events.find(m=>m.event===(i?l:d));if(u)u.event=d,u.tempEvent=l,i||(u.height=0,u.width=0);else{let m={event:d,left:0,top:0,height:0,width:0,startsBeforeDay:!1,endsAfterDay:!1,tempEvent:l};a.events.push(m)}})}),n.clear()}getTimeEventResizedDates(t,n){let i={start:t.start,end:tw(this.dateAdapter,t,this.minimumEventHeight)},l=t,{end:o}=l,s=Rt(l,["end"]),a={start:this.dateAdapter.addMinutes(i.end,this.minimumEventHeight*-1),end:tw(this.dateAdapter,s,this.minimumEventHeight)},c=this.rtl?-1:1;if(typeof n.edges.left<"u"){let d=Math.round(+n.edges.left/this.dayColumnWidth)*c,u=_n(this.dateAdapter,i.start,d,this.excludeDays);u<a.start?i.start=u:i.start=a.start}else if(typeof n.edges.right<"u"){let d=Math.round(+n.edges.right/this.dayColumnWidth)*c,u=_n(this.dateAdapter,i.end,d,this.excludeDays);u>a.end?i.end=u:i.end=a.end}if(typeof n.edges.top<"u"){let d=mm(n.edges.top,this.hourSegments,this.hourSegmentHeight,this.eventSnapSize,this.hourDuration),u=this.dateAdapter.addMinutes(i.start,d);u<a.start?i.start=u:i.start=a.start}else if(typeof n.edges.bottom<"u"){let d=mm(n.edges.bottom,this.hourSegments,this.hourSegmentHeight,this.eventSnapSize,this.hourDuration),u=this.dateAdapter.addMinutes(i.end,d);u>a.end?i.end=u:i.end=a.end}return i}resizeStarted(t,n,i){this.dayColumnWidth=this.getDayColumnWidth(t);let o=new vm(t,i,this.rtl);this.validateResize=({rectangle:s,edges:a})=>{let c=o.validateResize({rectangle:g({},s),edges:a});if(c&&this.validateEventTimesChanged){let l;if(!i)l=this.getTimeEventResizedDates(n.event,{rectangle:s,edges:a});else{let d=this.rtl?-1:1;if(typeof a.left<"u"){let u=Math.round(+a.left/i)*d;l=this.getAllDayEventResizedDates(n.event,u,!this.rtl)}else{let u=Math.round(+a.right/i)*d;l=this.getAllDayEventResizedDates(n.event,u,this.rtl)}}return this.validateEventTimesChanged({type:ni.Resize,event:n.event,newStart:l.start,newEnd:l.end})}return c},this.cdr.markForCheck()}getAllDayEventResizedDates(t,n,i){let o=t.start,s=t.end||t.start;return i?o=_n(this.dateAdapter,o,n,this.excludeDays):s=_n(this.dateAdapter,s,n,this.excludeDays),{start:o,end:s}}}return r.\u0275fac=function(t){return new(t||r)(x(Tr),x(Yd),x(Ks),x(sn),x(Tt))},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-week-view"]],inputs:{viewDate:"viewDate",events:"events",excludeDays:"excludeDays",refresh:"refresh",locale:"locale",tooltipPlacement:"tooltipPlacement",tooltipTemplate:"tooltipTemplate",tooltipAppendToBody:"tooltipAppendToBody",tooltipDelay:"tooltipDelay",weekStartsOn:"weekStartsOn",headerTemplate:"headerTemplate",eventTemplate:"eventTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",precision:"precision",weekendDays:"weekendDays",snapDraggedEvents:"snapDraggedEvents",hourSegments:"hourSegments",hourDuration:"hourDuration",hourSegmentHeight:"hourSegmentHeight",minimumEventHeight:"minimumEventHeight",dayStartHour:"dayStartHour",dayStartMinute:"dayStartMinute",dayEndHour:"dayEndHour",dayEndMinute:"dayEndMinute",hourSegmentTemplate:"hourSegmentTemplate",eventSnapSize:"eventSnapSize",allDayEventsLabelTemplate:"allDayEventsLabelTemplate",daysInWeek:"daysInWeek",currentTimeMarkerTemplate:"currentTimeMarkerTemplate",validateEventTimesChanged:"validateEventTimesChanged",resizeCursors:"resizeCursors"},outputs:{dayHeaderClicked:"dayHeaderClicked",eventClicked:"eventClicked",eventTimesChanged:"eventTimesChanged",beforeViewRender:"beforeViewRender",hourSegmentClicked:"hourSegmentClicked"},features:[In],decls:8,vars:9,consts:[["dayColumns",""],["allDayEventsContainer",""],["eventRowContainer",""],["event",""],["weekEventTemplate",""],["role","grid",1,"cal-week-view"],[3,"dayHeaderClicked","eventDropped","dragEnter","days","locale","customTemplate"],["class","cal-all-day-events","mwlDroppable","",3,"dragEnter","dragLeave",4,"ngIf"],["mwlDroppable","",1,"cal-time-events",3,"dragEnter","dragLeave"],["class","cal-time-label-column",4,"ngIf"],[1,"cal-day-columns"],["class","cal-day-column",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","",1,"cal-all-day-events",3,"dragEnter","dragLeave"],[1,"cal-time-label-column"],[4,"ngTemplateOutlet"],["class","cal-day-column","mwlDroppable","","dragOverClass","cal-drag-over",3,"drop","dragEnter",4,"ngFor","ngForOf","ngForTrackBy"],["class","cal-events-row",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragOverClass","cal-drag-over",1,"cal-day-column",3,"drop","dragEnter"],[1,"cal-events-row"],["class","cal-event-container","mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",3,"cal-draggable","cal-starts-within-week","cal-ends-within-week","ngClass","width","marginLeft","marginRight","resizeCursors","resizeSnapGrid","validateResize","dropData","dragAxis","dragSnapGrid","validateDrag","touchStartLongPress","resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd",4,"ngFor","ngForOf","ngForTrackBy"],["mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",1,"cal-event-container",3,"resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd","ngClass","resizeCursors","resizeSnapGrid","validateResize","dropData","dragAxis","dragSnapGrid","validateDrag","touchStartLongPress"],["class","cal-resize-handle cal-resize-handle-before-start","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],[3,"eventClicked","locale","weekEvent","tooltipPlacement","tooltipTemplate","tooltipAppendToBody","tooltipDelay","customTemplate","eventTitleTemplate","eventActionsTemplate","daysInWeek"],["class","cal-resize-handle cal-resize-handle-after-end","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],["mwlResizeHandle","",1,"cal-resize-handle","cal-resize-handle-before-start",3,"resizeEdges"],["mwlResizeHandle","",1,"cal-resize-handle","cal-resize-handle-after-end",3,"resizeEdges"],["class","cal-hour",3,"cal-hour-odd",4,"ngFor","ngForOf","ngForTrackBy"],[1,"cal-hour"],[3,"height","segment","segmentHeight","locale","customTemplate","isTimeLabel","daysInWeek",4,"ngFor","ngForOf","ngForTrackBy"],[3,"segment","segmentHeight","locale","customTemplate","isTimeLabel","daysInWeek"],[1,"cal-day-column"],[3,"columnDate","dayStartHour","dayStartMinute","dayEndHour","dayEndMinute","hourSegments","hourDuration","hourSegmentHeight","customTemplate"],[1,"cal-events-container"],["class","cal-event-container","mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",3,"cal-draggable","cal-starts-within-day","cal-ends-within-day","ngClass","hidden","top","height","left","width","resizeCursors","resizeSnapGrid","validateResize","allowNegativeResizes","dropData","dragAxis","dragSnapGrid","touchStartLongPress","ghostDragEnabled","ghostElementTemplate","validateDrag","resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd",4,"ngFor","ngForOf","ngForTrackBy"],["mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",1,"cal-event-container",3,"resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd","ngClass","hidden","resizeCursors","resizeSnapGrid","validateResize","allowNegativeResizes","dropData","dragAxis","dragSnapGrid","touchStartLongPress","ghostDragEnabled","ghostElementTemplate","validateDrag"],[3,"ngTemplateOutlet"],[3,"eventClicked","locale","weekEvent","tooltipPlacement","tooltipTemplate","tooltipAppendToBody","tooltipDisabled","tooltipDelay","customTemplate","eventTitleTemplate","eventActionsTemplate","column","daysInWeek"],["mwlDroppable","","dragActiveClass","cal-drag-active",3,"height","segment","segmentHeight","locale","customTemplate","daysInWeek","clickListenerDisabled","dragOverClass","isTimeLabel","mwlClick","drop","dragEnter",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragActiveClass","cal-drag-active",3,"mwlClick","drop","dragEnter","segment","segmentHeight","locale","customTemplate","daysInWeek","clickListenerDisabled","dragOverClass","isTimeLabel"]],template:function(t,n){if(t&1){let i=Ce();C(0,"div",5)(1,"mwl-calendar-week-view-header",6),L("dayHeaderClicked",function(s){return P(i),N(n.dayHeaderClicked.emit(s))})("eventDropped",function(s){return P(i),N(n.eventDropped({dropData:s},s.newStart,!0))})("dragEnter",function(s){return P(i),N(n.dateDragEnter(s.date))}),w(),$(2,BI,7,5,"div",7),C(3,"div",8),L("dragEnter",function(){return P(i),N(n.dragEnter("time"))})("dragLeave",function(){return P(i),N(n.dragLeave("time"))}),$(4,KI,2,2,"div",9),C(5,"div",10,0),$(7,XI,5,13,"div",11),w()()()}t&2&&(_(),S("days",n.days)("locale",n.locale)("customTemplate",n.headerTemplate),_(),S("ngIf",n.view.allDayEventRows.length>0),_(2),S("ngIf",n.view.hourColumns.length>0&&n.daysInWeek!==1),_(),Ve("cal-resize-active",n.timeEventResizes.size>0),_(2),S("ngForOf",n.view.hourColumns)("ngForTrackBy",n.trackByHourColumn))},dependencies:[Xt,bn,mn,Jt,hm,ZC,Vd,zd,to,pb,mb,fb,gb],encapsulation:2}),r})(),ym=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({imports:[Ut,pm,wc,Sc,pm,wc]}),r})(),vw=(()=>{class r{constructor(){this.events=[],this.hourSegments=2,this.hourSegmentHeight=30,this.minimumEventHeight=30,this.dayStartHour=0,this.dayStartMinute=0,this.dayEndHour=23,this.dayEndMinute=59,this.tooltipPlacement="auto",this.tooltipAppendToBody=!0,this.tooltipDelay=null,this.snapDraggedEvents=!0,this.eventClicked=new W,this.hourSegmentClicked=new W,this.eventTimesChanged=new W,this.beforeViewRender=new W}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=ue({type:r,selectors:[["mwl-calendar-day-view"]],inputs:{viewDate:"viewDate",events:"events",hourSegments:"hourSegments",hourSegmentHeight:"hourSegmentHeight",hourDuration:"hourDuration",minimumEventHeight:"minimumEventHeight",dayStartHour:"dayStartHour",dayStartMinute:"dayStartMinute",dayEndHour:"dayEndHour",dayEndMinute:"dayEndMinute",refresh:"refresh",locale:"locale",eventSnapSize:"eventSnapSize",tooltipPlacement:"tooltipPlacement",tooltipTemplate:"tooltipTemplate",tooltipAppendToBody:"tooltipAppendToBody",tooltipDelay:"tooltipDelay",hourSegmentTemplate:"hourSegmentTemplate",eventTemplate:"eventTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",snapDraggedEvents:"snapDraggedEvents",allDayEventsLabelTemplate:"allDayEventsLabelTemplate",currentTimeMarkerTemplate:"currentTimeMarkerTemplate",validateEventTimesChanged:"validateEventTimesChanged",resizeCursors:"resizeCursors"},outputs:{eventClicked:"eventClicked",hourSegmentClicked:"hourSegmentClicked",eventTimesChanged:"eventTimesChanged",beforeViewRender:"beforeViewRender"},decls:1,vars:27,consts:[[1,"cal-day-view",3,"eventClicked","hourSegmentClicked","eventTimesChanged","beforeViewRender","daysInWeek","viewDate","events","hourSegments","hourDuration","hourSegmentHeight","minimumEventHeight","dayStartHour","dayStartMinute","dayEndHour","dayEndMinute","refresh","locale","eventSnapSize","tooltipPlacement","tooltipTemplate","tooltipAppendToBody","tooltipDelay","resizeCursors","hourSegmentTemplate","eventTemplate","eventTitleTemplate","eventActionsTemplate","snapDraggedEvents","allDayEventsLabelTemplate","currentTimeMarkerTemplate","validateEventTimesChanged"]],template:function(t,n){t&1&&(C(0,"mwl-calendar-week-view",0),L("eventClicked",function(o){return n.eventClicked.emit(o)})("hourSegmentClicked",function(o){return n.hourSegmentClicked.emit(o)})("eventTimesChanged",function(o){return n.eventTimesChanged.emit(o)})("beforeViewRender",function(o){return n.beforeViewRender.emit(o)}),w()),t&2&&S("daysInWeek",1)("viewDate",n.viewDate)("events",n.events)("hourSegments",n.hourSegments)("hourDuration",n.hourDuration)("hourSegmentHeight",n.hourSegmentHeight)("minimumEventHeight",n.minimumEventHeight)("dayStartHour",n.dayStartHour)("dayStartMinute",n.dayStartMinute)("dayEndHour",n.dayEndHour)("dayEndMinute",n.dayEndMinute)("refresh",n.refresh)("locale",n.locale)("eventSnapSize",n.eventSnapSize)("tooltipPlacement",n.tooltipPlacement)("tooltipTemplate",n.tooltipTemplate)("tooltipAppendToBody",n.tooltipAppendToBody)("tooltipDelay",n.tooltipDelay)("resizeCursors",n.resizeCursors)("hourSegmentTemplate",n.hourSegmentTemplate)("eventTemplate",n.eventTemplate)("eventTitleTemplate",n.eventTitleTemplate)("eventActionsTemplate",n.eventActionsTemplate)("snapDraggedEvents",n.snapDraggedEvents)("allDayEventsLabelTemplate",n.allDayEventsLabelTemplate)("currentTimeMarkerTemplate",n.currentTimeMarkerTemplate)("validateEventTimesChanged",n.validateEventTimesChanged)},dependencies:[Sm],encapsulation:2}),r})(),rw=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({imports:[Ut,Sc,ym]}),r})(),Ms=(()=>{class r{static forRoot(t,n={}){return{ngModule:r,providers:[t,n.eventTitleFormatter||Ec,n.dateFormatter||jd,n.utils||Yd,n.a11y||$d]}}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=wt({type:r}),r.\u0275inj=Ct({imports:[Sc,nw,ym,rw,Sc,nw,ym,rw]}),r})();var Cw=(()=>{class r{view=Bn.Month;viewDate=new Date;locale="en";viewChange=new W;viewDateChange=new W;CalendarView=Bn;static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-calendar-header"]],inputs:{view:"view",viewDate:"viewDate",locale:"locale"},outputs:{viewChange:"viewChange",viewDateChange:"viewDateChange"},standalone:!0,features:[Ne],decls:22,vars:16,consts:[[1,"row","text-center"],[1,"col-md-4"],[1,"btn-group"],["mwlCalendarPreviousView","",1,"btn","btn-primary",3,"viewDateChange","view","viewDate"],["mwlCalendarToday","",1,"btn","btn-outline-secondary",3,"viewDateChange","viewDate"],["mwlCalendarNextView","",1,"btn","btn-primary",3,"viewDateChange","view","viewDate"],[1,"btn","btn-primary",3,"click"]],template:function(n,i){n&1&&(C(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),wr("viewDateChange",function(s){return qn(i.viewDate,s)||(i.viewDate=s),s}),L("viewDateChange",function(){return i.viewDateChange.next(i.viewDate)}),B(4," Previous "),w(),C(5,"div",4),wr("viewDateChange",function(s){return qn(i.viewDate,s)||(i.viewDate=s),s}),L("viewDateChange",function(){return i.viewDateChange.next(i.viewDate)}),B(6," Today "),w(),C(7,"div",5),wr("viewDateChange",function(s){return qn(i.viewDate,s)||(i.viewDate=s),s}),L("viewDateChange",function(){return i.viewDateChange.next(i.viewDate)}),B(8," Next "),w()()(),C(9,"div",1)(10,"h3"),B(11),De(12,"calendarDate"),w()(),C(13,"div",1)(14,"div",2)(15,"div",6),L("click",function(){return i.viewChange.emit(i.CalendarView.Month)}),B(16," Month "),w(),C(17,"div",6),L("click",function(){return i.viewChange.emit(i.CalendarView.Week)}),B(18," Week "),w(),C(19,"div",6),L("click",function(){return i.viewChange.emit(i.CalendarView.Day)}),B(20," Day "),w()()()(),G(21,"br")),n&2&&(_(3),S("view",i.view),Cr("viewDate",i.viewDate),_(2),Cr("viewDate",i.viewDate),_(2),S("view",i.view),Cr("viewDate",i.viewDate),_(4),Ht(Qt(12,12,i.viewDate,i.view+"ViewTitle",i.locale)),_(4),Ve("active",i.view===i.CalendarView.Month),_(2),Ve("active",i.view===i.CalendarView.Week),_(2),Ve("active",i.view===i.CalendarView.Day))},dependencies:[Ms,pw,mw,fw,Ds]})}return r})();function vb(r,e){if(r&1){let t=Ce();C(0,"mwl-calendar-month-view",4),L("eventTimesChanged",function(i){P(t);let o=b();return N(o.eventTimesChanged(i))}),w()}if(r&2){let t=b();S("viewDate",t.viewDate)("events",t.events())("activeDayIsOpen",!1)("refresh",t.refresh)}}function yb(r,e){if(r&1){let t=Ce();C(0,"mwl-calendar-week-view",5),L("eventTimesChanged",function(i){P(t);let o=b();return N(o.eventTimesChanged(i))}),w()}if(r&2){let t=b();S("viewDate",t.viewDate)("events",t.events())("refresh",t.refresh)}}function Cb(r,e){if(r&1){let t=Ce();C(0,"mwl-calendar-day-view",5),L("eventTimesChanged",function(i){P(t);let o=b();return N(o.eventTimesChanged(i))}),w()}if(r&2){let t=b();S("viewDate",t.viewDate)("events",t.events())("refresh",t.refresh)}}var ww=(()=>{class r{eventListService=V(Sr);destroyRef=V(vr);events=pn(()=>this.eventListService.loadedEvents().map(t=>({id:t.id,title:t.userName,start:t.fromDate,end:t.toDate,color:this.eventListService.mapColorToEventStatus(t.status)})));view=Bn.Month;viewDate=new Date;refresh=new be;isFetching=Dt(!1);error=Dt("");ngOnInit(){this.isFetching.set(!0);let t=this.eventListService.loadEvents().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{console.error(n.message),this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}eventTimesChanged({event:t,newStart:n,newEnd:i}){t.start=n,t.end=i,this.refresh.next()}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-calendar"]],standalone:!0,features:[Ne],decls:7,vars:6,consts:[[3,"viewChange","viewDateChange","view","viewDate"],[3,"ngSwitch"],[3,"viewDate","events","activeDayIsOpen","refresh","eventTimesChanged",4,"ngSwitchCase"],[3,"viewDate","events","refresh","eventTimesChanged",4,"ngSwitchCase"],[3,"eventTimesChanged","viewDate","events","activeDayIsOpen","refresh"],[3,"eventTimesChanged","viewDate","events","refresh"]],template:function(n,i){n&1&&(C(0,"header")(1,"app-calendar-header",0),wr("viewChange",function(s){return qn(i.view,s)||(i.view=s),s})("viewDateChange",function(s){return qn(i.viewDate,s)||(i.viewDate=s),s}),w()(),C(2,"main")(3,"div",1),$(4,vb,1,4,"mwl-calendar-month-view",2)(5,yb,1,3,"mwl-calendar-week-view",3)(6,Cb,1,3,"mwl-calendar-day-view",3),w()()),n&2&&(_(),Cr("view",i.view)("viewDate",i.viewDate),_(2),S("ngSwitch",i.view),_(),S("ngSwitchCase","month"),_(),S("ngSwitchCase","week"),_(),S("ngSwitchCase","day"))},dependencies:[Cw,Ms,gw,Sm,vw,Ut,jf,Wf],data:{animation:[Em]}})}return r})();var Tw=(()=>{class r{msalGuardConfig;authService;msalBroadcastService;constructor(t,n,i){this.msalGuardConfig=t,this.authService=n,this.msalBroadcastService=i,this.authService.instance.initialize().then(()=>{console.log("MsalService is initialized.")}).catch(o=>{console.error("MsalService failed to initialize:",o)})}clearInteractionStatus(){console.log("MsalService clearInteractionStatus.");let t=this.authService.instance;t.getLogger().verbose("Clearing interaction status."),t.clearCache(),localStorage.removeItem("msal.interaction.status"),sessionStorage.removeItem("msal.interaction.status")}login(){this.clearInteractionStatus(),this.msalGuardConfig.authRequest?this.authService.loginRedirect(g({},this.msalGuardConfig.authRequest)):this.authService.loginRedirect()}static \u0275fac=function(n){return new(n||r)(x(gc),x(hr),x(Ss))};static \u0275cmp=ue({type:r,selectors:[["app-login"]],standalone:!0,features:[Ne],decls:15,vars:0,consts:[[1,"container","mt-4"],[1,"display-4","text-center"],[1,"lead","text-center"],[1,"login-container"],[1,"login-box"],[1,"login-header"],["src","https://cdn-icons-png.flaticon.com/512/732/732223.png","alt","Outlook Logo",1,"outlook-logo"],[1,"login-body"],[1,"login-button",3,"click"],["src","https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg","alt","Microsoft Logo",1,"microsoft-logo"]],template:function(n,i){n&1&&(C(0,"div",0)(1,"h1",1),B(2,"Private IdeoDigital Login"),w(),C(3,"p",2),B(4," Welcome to the ideo vacation management system. Please log in to access your private room and manage your vacation plans. "),w()(),C(5,"div",3)(6,"div",4)(7,"div",5),G(8,"img",6),C(9,"h2"),B(10,"Sign in with your Outlook Account"),w()(),C(11,"div",7)(12,"button",8),L("click",function(){return i.login()}),G(13,"img",9),B(14," Sign in with Microsoft "),w()()()())},styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f3f3f3}.login-box[_ngcontent-%COMP%]{background-color:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 10px #0000001a;text-align:center;max-width:350px}.login-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.outlook-logo[_ngcontent-%COMP%]{height:50px;margin-bottom:1rem}.login-body[_ngcontent-%COMP%]{margin-top:1.5rem}.login-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem;background-color:#0078d4;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;width:100%}.microsoft-logo[_ngcontent-%COMP%]{height:24px;margin-right:10px}.login-button[_ngcontent-%COMP%]:hover{background-color:#005a9e}"]})}return r})();var _w=[...RC,{path:"",redirectTo:"calendar",pathMatch:"full"},{path:"calendar",component:ww,title:"Calendar",canActivate:[As]},{path:"login",component:Tw,title:"Login"}];function wb(r){return new Date(r).getTimezoneOffset()}function Ew(){return{addDays:bo,addHours:wv,addMinutes:Sv,addSeconds:Av,differenceInDays:Rv,differenceInMinutes:Dv,differenceInSeconds:Pv,endOfDay:Mv,endOfMonth:Ov,endOfWeek:Lv,getDay:Uv,getMonth:Kv,isSameDay:bv,isSameMonth:$v,isSameSecond:jv,max:Iv,setHours:Qv,setMinutes:Xv,startOfDay:kr,startOfMinute:Nv,startOfMonth:xv,startOfWeek:El,getHours:Vv,getMinutes:zv,getTimezoneOffset:wb}}function Sw(){return gu(gu({},Ew()),{addWeeks:Sl,addMonths:wl,subDays:Wv,subWeeks:ey,subMonths:Zv,getISOWeek:Fv,setDate:Yv,setMonth:Gv,setYear:Jv,getDate:Hv,getYear:qv})}function Aw(r){return new Z(3e3,!1)}function Tb(){return new Z(3100,!1)}function _b(){return new Z(3101,!1)}function Eb(r){return new Z(3001,!1)}function Sb(r){return new Z(3003,!1)}function Ab(r){return new Z(3004,!1)}function Ib(r,e){return new Z(3005,!1)}function bb(){return new Z(3006,!1)}function kb(){return new Z(3007,!1)}function Rb(r,e){return new Z(3008,!1)}function Db(r){return new Z(3002,!1)}function Mb(r,e,t,n,i){return new Z(3010,!1)}function Ob(){return new Z(3011,!1)}function Pb(){return new Z(3012,!1)}function Nb(){return new Z(3200,!1)}function xb(){return new Z(3202,!1)}function Lb(){return new Z(3013,!1)}function Fb(r){return new Z(3014,!1)}function Hb(r){return new Z(3015,!1)}function Ub(r){return new Z(3016,!1)}function Bb(r,e){return new Z(3404,!1)}function Vb(r){return new Z(3502,!1)}function zb(r){return new Z(3503,!1)}function Kb(){return new Z(3300,!1)}function qb(r){return new Z(3504,!1)}function $b(r){return new Z(3301,!1)}function jb(r,e){return new Z(3302,!1)}function Wb(r){return new Z(3303,!1)}function Gb(r,e){return new Z(3400,!1)}function Yb(r){return new Z(3401,!1)}function Qb(r){return new Z(3402,!1)}function Xb(r,e){return new Z(3505,!1)}function ri(r){switch(r.length){case 0:return new ti;case 1:return r[0];default:return new Tc(r)}}function Uw(r,e,t=new Map,n=new Map){let i=[],o=[],s=-1,a=null;if(e.forEach(c=>{let l=c.get("offset"),d=l==s,u=d&&a||new Map;c.forEach((m,p)=>{let v=p,T=m;if(p!=="offset")switch(v=r.normalizePropertyName(v,i),T){case Kd:T=t.get(p);break;case Un:T=n.get(p);break;default:T=r.normalizeStyleValue(p,v,T,i);break}u.set(v,T)}),d||o.push(u),a=u,s=l}),i.length)throw Vb(i);return o}function Wm(r,e,t,n){switch(e){case"start":r.onStart(()=>n(t&&Am(t,"start",r)));break;case"done":r.onDone(()=>n(t&&Am(t,"done",r)));break;case"destroy":r.onDestroy(()=>n(t&&Am(t,"destroy",r)));break}}function Am(r,e,t){let n=t.totalTime,i=!!t.disabled,o=Gm(r.element,r.triggerName,r.fromState,r.toState,e||r.phaseName,n??r.totalTime,i),s=r._data;return s!=null&&(o._data=s),o}function Gm(r,e,t,n,i="",o=0,s){return{element:r,triggerName:e,fromState:t,toState:n,phaseName:i,totalTime:o,disabled:!!s}}function Wt(r,e,t){let n=r.get(e);return n||r.set(e,n=t),n}function Iw(r){let e=r.indexOf(":"),t=r.substring(1,e),n=r.slice(e+1);return[t,n]}var Jb=typeof document>"u"?null:document.documentElement;function Ym(r){let e=r.parentNode||r.host||null;return e===Jb?null:e}function Zb(r){return r.substring(1,6)=="ebkit"}var ro=null,bw=!1;function e0(r){ro||(ro=t0()||{},bw=ro.style?"WebkitAppearance"in ro.style:!1);let e=!0;return ro.style&&!Zb(r)&&(e=r in ro.style,!e&&bw&&(e="Webkit"+r.charAt(0).toUpperCase()+r.slice(1)in ro.style)),e}function t0(){return typeof document<"u"?document.body:null}function Bw(r,e){for(;e;){if(e===r)return!0;e=Ym(e)}return!1}function Vw(r,e,t){if(t)return Array.from(r.querySelectorAll(e));let n=r.querySelector(e);return n?[n]:[]}var Qm=(()=>{let e=class e{validateStyleProperty(n){return e0(n)}containsElement(n,i){return Bw(n,i)}getParentElement(n){return Ym(n)}query(n,i,o){return Vw(n,i,o)}computeStyle(n,i,o){return o||""}animate(n,i,o,s,a,c=[],l){return new ti(o,s)}};e.\u0275fac=function(i){return new(i||e)},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})(),ef=class ef{};ef.NOOP=new Qm;var so=ef,ao=class{};var n0=1e3,zw="{{",r0="}}",Kw="ng-enter",Mm="ng-leave",Qd="ng-trigger",tu=".ng-trigger",kw="ng-animating",Om=".ng-animating";function pr(r){if(typeof r=="number")return r;let e=r.match(/^(-?[\.\d]+)(m?s)/);return!e||e.length<2?0:Pm(parseFloat(e[1]),e[2])}function Pm(r,e){switch(e){case"s":return r*n0;default:return r}}function nu(r,e,t){return r.hasOwnProperty("duration")?r:i0(r,e,t)}function i0(r,e,t){let n=/^(-?[\.\d]+)(m?s)(?:\s+(-?[\.\d]+)(m?s))?(?:\s+([-a-z]+(?:\(.+?\))?))?$/i,i,o=0,s="";if(typeof r=="string"){let a=r.match(n);if(a===null)return e.push(Aw(r)),{duration:0,delay:0,easing:""};i=Pm(parseFloat(a[1]),a[2]);let c=a[3];c!=null&&(o=Pm(parseFloat(c),a[4]));let l=a[5];l&&(s=l)}else i=r;if(!t){let a=!1,c=e.length;i<0&&(e.push(Tb()),a=!0),o<0&&(e.push(_b()),a=!0),a&&e.splice(c,0,Aw(r))}return{duration:i,delay:o,easing:s}}function o0(r){return r.length?r[0]instanceof Map?r:r.map(e=>new Map(Object.entries(e))):[]}function Vn(r,e,t){e.forEach((n,i)=>{let o=Xm(i);t&&!t.has(i)&&t.set(i,r.style[o]),r.style[o]=n})}function oo(r,e){e.forEach((t,n)=>{let i=Xm(n);r.style[i]=""})}function Ac(r){return Array.isArray(r)?r.length==1?r[0]:$C(r):r}function s0(r,e,t){let n=e.params||{},i=qw(r);i.length&&i.forEach(o=>{n.hasOwnProperty(o)||t.push(Eb(o))})}var Nm=new RegExp(`${zw}\\s*(.+?)\\s*${r0}`,"g");function qw(r){let e=[];if(typeof r=="string"){let t;for(;t=Nm.exec(r);)e.push(t[1]);Nm.lastIndex=0}return e}function bc(r,e,t){let n=`${r}`,i=n.replace(Nm,(o,s)=>{let a=e[s];return a==null&&(t.push(Sb(s)),a=""),a.toString()});return i==n?r:i}var a0=/-+([a-z0-9])/g;function Xm(r){return r.replace(a0,(...e)=>e[1].toUpperCase())}function c0(r,e){return r===0||e===0}function l0(r,e,t){if(t.size&&e.length){let n=e[0],i=[];if(t.forEach((o,s)=>{n.has(s)||i.push(s),n.set(s,o)}),i.length)for(let o=1;o<e.length;o++){let s=e[o];i.forEach(a=>s.set(a,Jm(r,a)))}}return e}function jt(r,e,t){switch(e.type){case pe.Trigger:return r.visitTrigger(e,t);case pe.State:return r.visitState(e,t);case pe.Transition:return r.visitTransition(e,t);case pe.Sequence:return r.visitSequence(e,t);case pe.Group:return r.visitGroup(e,t);case pe.Animate:return r.visitAnimate(e,t);case pe.Keyframes:return r.visitKeyframes(e,t);case pe.Style:return r.visitStyle(e,t);case pe.Reference:return r.visitReference(e,t);case pe.AnimateChild:return r.visitAnimateChild(e,t);case pe.AnimateRef:return r.visitAnimateRef(e,t);case pe.Query:return r.visitQuery(e,t);case pe.Stagger:return r.visitStagger(e,t);default:throw Ab(e.type)}}function Jm(r,e){return window.getComputedStyle(r)[e]}var d0=new Set(["width","height","minWidth","minHeight","maxWidth","maxHeight","left","top","bottom","right","fontSize","outlineWidth","outlineOffset","paddingTop","paddingLeft","paddingBottom","paddingRight","marginTop","marginLeft","marginBottom","marginRight","borderRadius","borderWidth","borderTopWidth","borderLeftWidth","borderRightWidth","borderBottomWidth","textIndent","perspective"]),ru=class extends ao{normalizePropertyName(e,t){return Xm(e)}normalizeStyleValue(e,t,n,i){let o="",s=n.toString().trim();if(d0.has(t)&&n!==0&&n!=="0")if(typeof n=="number")o="px";else{let a=n.match(/^[+-]?[\d\.]+([a-z]*)$/);a&&a[1].length==0&&i.push(Ib(e,n))}return s+o}};var iu="*";function u0(r,e){let t=[];return typeof r=="string"?r.split(/\s*,\s*/).forEach(n=>h0(n,t,e)):t.push(r),t}function h0(r,e,t){if(r[0]==":"){let c=p0(r,t);if(typeof c=="function"){e.push(c);return}r=c}let n=r.match(/^(\*|[-\w]+)\s*(<?[=-]>)\s*(\*|[-\w]+)$/);if(n==null||n.length<4)return t.push(Hb(r)),e;let i=n[1],o=n[2],s=n[3];e.push(Rw(i,s));let a=i==iu&&s==iu;o[0]=="<"&&!a&&e.push(Rw(s,i))}function p0(r,e){switch(r){case":enter":return"void => *";case":leave":return"* => void";case":increment":return(t,n)=>parseFloat(n)>parseFloat(t);case":decrement":return(t,n)=>parseFloat(n)<parseFloat(t);default:return e.push(Ub(r)),"* => *"}}var Xd=new Set(["true","1"]),Jd=new Set(["false","0"]);function Rw(r,e){let t=Xd.has(r)||Jd.has(r),n=Xd.has(e)||Jd.has(e);return(i,o)=>{let s=r==iu||r==i,a=e==iu||e==o;return!s&&t&&typeof i=="boolean"&&(s=i?Xd.has(r):Jd.has(r)),!a&&n&&typeof o=="boolean"&&(a=o?Xd.has(e):Jd.has(e)),s&&a}}var $w=":self",m0=new RegExp(`s*${$w}s*,?`,"g");function jw(r,e,t,n){return new xm(r).build(e,t,n)}var Dw="",xm=class{constructor(e){this._driver=e}build(e,t,n){let i=new Lm(t);return this._resetContextStyleTimingState(i),jt(this,Ac(e),i)}_resetContextStyleTimingState(e){e.currentQuerySelector=Dw,e.collectedStyles=new Map,e.collectedStyles.set(Dw,new Map),e.currentTime=0}visitTrigger(e,t){let n=t.queryCount=0,i=t.depCount=0,o=[],s=[];return e.name.charAt(0)=="@"&&t.errors.push(bb()),e.definitions.forEach(a=>{if(this._resetContextStyleTimingState(t),a.type==pe.State){let c=a,l=c.name;l.toString().split(/\s*,\s*/).forEach(d=>{c.name=d,o.push(this.visitState(c,t))}),c.name=l}else if(a.type==pe.Transition){let c=this.visitTransition(a,t);n+=c.queryCount,i+=c.depCount,s.push(c)}else t.errors.push(kb())}),{type:pe.Trigger,name:e.name,states:o,transitions:s,queryCount:n,depCount:i,options:null}}visitState(e,t){let n=this.visitStyle(e.styles,t),i=e.options&&e.options.params||null;if(n.containsDynamicStyles){let o=new Set,s=i||{};n.styles.forEach(a=>{a instanceof Map&&a.forEach(c=>{qw(c).forEach(l=>{s.hasOwnProperty(l)||o.add(l)})})}),o.size&&t.errors.push(Rb(e.name,[...o.values()]))}return{type:pe.State,name:e.name,style:n,options:i?{params:i}:null}}visitTransition(e,t){t.queryCount=0,t.depCount=0;let n=jt(this,Ac(e.animation),t),i=u0(e.expr,t.errors);return{type:pe.Transition,matchers:i,animation:n,queryCount:t.queryCount,depCount:t.depCount,options:io(e.options)}}visitSequence(e,t){return{type:pe.Sequence,steps:e.steps.map(n=>jt(this,n,t)),options:io(e.options)}}visitGroup(e,t){let n=t.currentTime,i=0,o=e.steps.map(s=>{t.currentTime=n;let a=jt(this,s,t);return i=Math.max(i,t.currentTime),a});return t.currentTime=i,{type:pe.Group,steps:o,options:io(e.options)}}visitAnimate(e,t){let n=y0(e.timings,t.errors);t.currentAnimateTimings=n;let i,o=e.styles?e.styles:ks({});if(o.type==pe.Keyframes)i=this.visitKeyframes(o,t);else{let s=e.styles,a=!1;if(!s){a=!0;let l={};n.easing&&(l.easing=n.easing),s=ks(l)}t.currentTime+=n.duration+n.delay;let c=this.visitStyle(s,t);c.isEmptyStep=a,i=c}return t.currentAnimateTimings=null,{type:pe.Animate,timings:n,style:i,options:null}}visitStyle(e,t){let n=this._makeStyleAst(e,t);return this._validateStyleAst(n,t),n}_makeStyleAst(e,t){let n=[],i=Array.isArray(e.styles)?e.styles:[e.styles];for(let a of i)typeof a=="string"?a===Un?n.push(a):t.errors.push(Db(a)):n.push(new Map(Object.entries(a)));let o=!1,s=null;return n.forEach(a=>{if(a instanceof Map&&(a.has("easing")&&(s=a.get("easing"),a.delete("easing")),!o)){for(let c of a.values())if(c.toString().indexOf(zw)>=0){o=!0;break}}}),{type:pe.Style,styles:n,easing:s,offset:e.offset,containsDynamicStyles:o,options:null}}_validateStyleAst(e,t){let n=t.currentAnimateTimings,i=t.currentTime,o=t.currentTime;n&&o>0&&(o-=n.duration+n.delay),e.styles.forEach(s=>{typeof s!="string"&&s.forEach((a,c)=>{let l=t.collectedStyles.get(t.currentQuerySelector),d=l.get(c),u=!0;d&&(o!=i&&o>=d.startTime&&i<=d.endTime&&(t.errors.push(Mb(c,d.startTime,d.endTime,o,i)),u=!1),o=d.startTime),u&&l.set(c,{startTime:o,endTime:i}),t.options&&s0(a,t.options,t.errors)})})}visitKeyframes(e,t){let n={type:pe.Keyframes,styles:[],options:null};if(!t.currentAnimateTimings)return t.errors.push(Ob()),n;let i=1,o=0,s=[],a=!1,c=!1,l=0,d=e.steps.map(k=>{let O=this._makeStyleAst(k,t),D=O.offset!=null?O.offset:v0(O.styles),j=0;return D!=null&&(o++,j=O.offset=D),c=c||j<0||j>1,a=a||j<l,l=j,s.push(j),O});c&&t.errors.push(Pb()),a&&t.errors.push(Nb());let u=e.steps.length,m=0;o>0&&o<u?t.errors.push(xb()):o==0&&(m=i/(u-1));let p=u-1,v=t.currentTime,T=t.currentAnimateTimings,I=T.duration;return d.forEach((k,O)=>{let D=m>0?O==p?1:m*O:s[O],j=D*I;t.currentTime=v+T.delay+j,T.duration=j,this._validateStyleAst(k,t),k.offset=D,n.styles.push(k)}),n}visitReference(e,t){return{type:pe.Reference,animation:jt(this,Ac(e.animation),t),options:io(e.options)}}visitAnimateChild(e,t){return t.depCount++,{type:pe.AnimateChild,options:io(e.options)}}visitAnimateRef(e,t){return{type:pe.AnimateRef,animation:this.visitReference(e.animation,t),options:io(e.options)}}visitQuery(e,t){let n=t.currentQuerySelector,i=e.options||{};t.queryCount++,t.currentQuery=e;let[o,s]=f0(e.selector);t.currentQuerySelector=n.length?n+" "+o:o,Wt(t.collectedStyles,t.currentQuerySelector,new Map);let a=jt(this,Ac(e.animation),t);return t.currentQuery=null,t.currentQuerySelector=n,{type:pe.Query,selector:o,limit:i.limit||0,optional:!!i.optional,includeSelf:s,animation:a,originalSelector:e.selector,options:io(e.options)}}visitStagger(e,t){t.currentQuery||t.errors.push(Lb());let n=e.timings==="full"?{duration:0,delay:0,easing:"full"}:nu(e.timings,t.errors,!0);return{type:pe.Stagger,animation:jt(this,Ac(e.animation),t),timings:n,options:null}}};function f0(r){let e=!!r.split(/\s*,\s*/).find(t=>t==$w);return e&&(r=r.replace(m0,"")),r=r.replace(/@\*/g,tu).replace(/@\w+/g,t=>tu+"-"+t.slice(1)).replace(/:animating/g,Om),[r,e]}function g0(r){return r?g({},r):null}var Lm=class{constructor(e){this.errors=e,this.queryCount=0,this.depCount=0,this.currentTransition=null,this.currentQuery=null,this.currentQuerySelector=null,this.currentAnimateTimings=null,this.currentTime=0,this.collectedStyles=new Map,this.options=null,this.unsupportedCSSPropertiesFound=new Set}};function v0(r){if(typeof r=="string")return null;let e=null;if(Array.isArray(r))r.forEach(t=>{if(t instanceof Map&&t.has("offset")){let n=t;e=parseFloat(n.get("offset")),n.delete("offset")}});else if(r instanceof Map&&r.has("offset")){let t=r;e=parseFloat(t.get("offset")),t.delete("offset")}return e}function y0(r,e){if(r.hasOwnProperty("duration"))return r;if(typeof r=="number"){let o=nu(r,e).duration;return Im(o,0,"")}let t=r;if(t.split(/\s+/).some(o=>o.charAt(0)=="{"&&o.charAt(1)=="{")){let o=Im(0,0,"");return o.dynamic=!0,o.strValue=t,o}let i=nu(t,e);return Im(i.duration,i.delay,i.easing)}function io(r){return r?(r=g({},r),r.params&&(r.params=g0(r.params))):r={},r}function Im(r,e,t){return{duration:r,delay:e,easing:t}}function Zm(r,e,t,n,i,o,s=null,a=!1){return{type:1,element:r,keyframes:e,preStyleProps:t,postStyleProps:n,duration:i,delay:o,totalTime:i+o,easing:s,subTimeline:a}}var kc=class{constructor(){this._map=new Map}get(e){return this._map.get(e)||[]}append(e,t){let n=this._map.get(e);n||this._map.set(e,n=[]),n.push(...t)}has(e){return this._map.has(e)}clear(){this._map.clear()}},C0=1,w0=":enter",T0=new RegExp(w0,"g"),_0=":leave",E0=new RegExp(_0,"g");function Ww(r,e,t,n,i,o=new Map,s=new Map,a,c,l=[]){return new Fm().buildKeyframes(r,e,t,n,i,o,s,a,c,l)}var Fm=class{buildKeyframes(e,t,n,i,o,s,a,c,l,d=[]){l=l||new kc;let u=new Hm(e,t,l,i,o,d,[]);u.options=c;let m=c.delay?pr(c.delay):0;u.currentTimeline.delayNextStep(m),u.currentTimeline.setStyles([s],null,u.errors,c),jt(this,n,u);let p=u.timelines.filter(v=>v.containsAnimation());if(p.length&&a.size){let v;for(let T=p.length-1;T>=0;T--){let I=p[T];if(I.element===t){v=I;break}}v&&!v.allowOnlyTimelineStyles()&&v.setStyles([a],null,u.errors,c)}return p.length?p.map(v=>v.buildKeyframes()):[Zm(t,[],[],[],0,m,"",!1)]}visitTrigger(e,t){}visitState(e,t){}visitTransition(e,t){}visitAnimateChild(e,t){let n=t.subInstructions.get(t.element);if(n){let i=t.createSubContext(e.options),o=t.currentTimeline.currentTime,s=this._visitSubInstructions(n,i,i.options);o!=s&&t.transformIntoNewTimeline(s)}t.previousNode=e}visitAnimateRef(e,t){let n=t.createSubContext(e.options);n.transformIntoNewTimeline(),this._applyAnimationRefDelays([e.options,e.animation.options],t,n),this.visitReference(e.animation,n),t.transformIntoNewTimeline(n.currentTimeline.currentTime),t.previousNode=e}_applyAnimationRefDelays(e,t,n){for(let i of e){let o=i?.delay;if(o){let s=typeof o=="number"?o:pr(bc(o,i?.params??{},t.errors));n.delayNextStep(s)}}}_visitSubInstructions(e,t,n){let o=t.currentTimeline.currentTime,s=n.duration!=null?pr(n.duration):null,a=n.delay!=null?pr(n.delay):null;return s!==0&&e.forEach(c=>{let l=t.appendInstructionToTimeline(c,s,a);o=Math.max(o,l.duration+l.delay)}),o}visitReference(e,t){t.updateOptions(e.options,!0),jt(this,e.animation,t),t.previousNode=e}visitSequence(e,t){let n=t.subContextCount,i=t,o=e.options;if(o&&(o.params||o.delay)&&(i=t.createSubContext(o),i.transformIntoNewTimeline(),o.delay!=null)){i.previousNode.type==pe.Style&&(i.currentTimeline.snapshotCurrentStyles(),i.previousNode=ou);let s=pr(o.delay);i.delayNextStep(s)}e.steps.length&&(e.steps.forEach(s=>jt(this,s,i)),i.currentTimeline.applyStylesToKeyframe(),i.subContextCount>n&&i.transformIntoNewTimeline()),t.previousNode=e}visitGroup(e,t){let n=[],i=t.currentTimeline.currentTime,o=e.options&&e.options.delay?pr(e.options.delay):0;e.steps.forEach(s=>{let a=t.createSubContext(e.options);o&&a.delayNextStep(o),jt(this,s,a),i=Math.max(i,a.currentTimeline.currentTime),n.push(a.currentTimeline)}),n.forEach(s=>t.currentTimeline.mergeTimelineCollectedStyles(s)),t.transformIntoNewTimeline(i),t.previousNode=e}_visitTiming(e,t){if(e.dynamic){let n=e.strValue,i=t.params?bc(n,t.params,t.errors):n;return nu(i,t.errors)}else return{duration:e.duration,delay:e.delay,easing:e.easing}}visitAnimate(e,t){let n=t.currentAnimateTimings=this._visitTiming(e.timings,t),i=t.currentTimeline;n.delay&&(t.incrementTime(n.delay),i.snapshotCurrentStyles());let o=e.style;o.type==pe.Keyframes?this.visitKeyframes(o,t):(t.incrementTime(n.duration),this.visitStyle(o,t),i.applyStylesToKeyframe()),t.currentAnimateTimings=null,t.previousNode=e}visitStyle(e,t){let n=t.currentTimeline,i=t.currentAnimateTimings;!i&&n.hasCurrentStyleProperties()&&n.forwardFrame();let o=i&&i.easing||e.easing;e.isEmptyStep?n.applyEmptyStep(o):n.setStyles(e.styles,o,t.errors,t.options),t.previousNode=e}visitKeyframes(e,t){let n=t.currentAnimateTimings,i=t.currentTimeline.duration,o=n.duration,a=t.createSubContext().currentTimeline;a.easing=n.easing,e.styles.forEach(c=>{let l=c.offset||0;a.forwardTime(l*o),a.setStyles(c.styles,c.easing,t.errors,t.options),a.applyStylesToKeyframe()}),t.currentTimeline.mergeTimelineCollectedStyles(a),t.transformIntoNewTimeline(i+o),t.previousNode=e}visitQuery(e,t){let n=t.currentTimeline.currentTime,i=e.options||{},o=i.delay?pr(i.delay):0;o&&(t.previousNode.type===pe.Style||n==0&&t.currentTimeline.hasCurrentStyleProperties())&&(t.currentTimeline.snapshotCurrentStyles(),t.previousNode=ou);let s=n,a=t.invokeQuery(e.selector,e.originalSelector,e.limit,e.includeSelf,!!i.optional,t.errors);t.currentQueryTotal=a.length;let c=null;a.forEach((l,d)=>{t.currentQueryIndex=d;let u=t.createSubContext(e.options,l);o&&u.delayNextStep(o),l===t.element&&(c=u.currentTimeline),jt(this,e.animation,u),u.currentTimeline.applyStylesToKeyframe();let m=u.currentTimeline.currentTime;s=Math.max(s,m)}),t.currentQueryIndex=0,t.currentQueryTotal=0,t.transformIntoNewTimeline(s),c&&(t.currentTimeline.mergeTimelineCollectedStyles(c),t.currentTimeline.snapshotCurrentStyles()),t.previousNode=e}visitStagger(e,t){let n=t.parentContext,i=t.currentTimeline,o=e.timings,s=Math.abs(o.duration),a=s*(t.currentQueryTotal-1),c=s*t.currentQueryIndex;switch(o.duration<0?"reverse":o.easing){case"reverse":c=a-c;break;case"full":c=n.currentStaggerTime;break}let d=t.currentTimeline;c&&d.delayNextStep(c);let u=d.currentTime;jt(this,e.animation,t),t.previousNode=e,n.currentStaggerTime=i.currentTime-u+(i.startTime-n.currentTimeline.startTime)}},ou={},Hm=class r{constructor(e,t,n,i,o,s,a,c){this._driver=e,this.element=t,this.subInstructions=n,this._enterClassName=i,this._leaveClassName=o,this.errors=s,this.timelines=a,this.parentContext=null,this.currentAnimateTimings=null,this.previousNode=ou,this.subContextCount=0,this.options={},this.currentQueryIndex=0,this.currentQueryTotal=0,this.currentStaggerTime=0,this.currentTimeline=c||new su(this._driver,t,0),a.push(this.currentTimeline)}get params(){return this.options.params}updateOptions(e,t){if(!e)return;let n=e,i=this.options;n.duration!=null&&(i.duration=pr(n.duration)),n.delay!=null&&(i.delay=pr(n.delay));let o=n.params;if(o){let s=i.params;s||(s=this.options.params={}),Object.keys(o).forEach(a=>{(!t||!s.hasOwnProperty(a))&&(s[a]=bc(o[a],s,this.errors))})}}_copyOptions(){let e={};if(this.options){let t=this.options.params;if(t){let n=e.params={};Object.keys(t).forEach(i=>{n[i]=t[i]})}}return e}createSubContext(e=null,t,n){let i=t||this.element,o=new r(this._driver,i,this.subInstructions,this._enterClassName,this._leaveClassName,this.errors,this.timelines,this.currentTimeline.fork(i,n||0));return o.previousNode=this.previousNode,o.currentAnimateTimings=this.currentAnimateTimings,o.options=this._copyOptions(),o.updateOptions(e),o.currentQueryIndex=this.currentQueryIndex,o.currentQueryTotal=this.currentQueryTotal,o.parentContext=this,this.subContextCount++,o}transformIntoNewTimeline(e){return this.previousNode=ou,this.currentTimeline=this.currentTimeline.fork(this.element,e),this.timelines.push(this.currentTimeline),this.currentTimeline}appendInstructionToTimeline(e,t,n){let i={duration:t??e.duration,delay:this.currentTimeline.currentTime+(n??0)+e.delay,easing:""},o=new Um(this._driver,e.element,e.keyframes,e.preStyleProps,e.postStyleProps,i,e.stretchStartingKeyframe);return this.timelines.push(o),i}incrementTime(e){this.currentTimeline.forwardTime(this.currentTimeline.duration+e)}delayNextStep(e){e>0&&this.currentTimeline.delayNextStep(e)}invokeQuery(e,t,n,i,o,s){let a=[];if(i&&a.push(this.element),e.length>0){e=e.replace(T0,"."+this._enterClassName),e=e.replace(E0,"."+this._leaveClassName);let c=n!=1,l=this._driver.query(this.element,e,c);n!==0&&(l=n<0?l.slice(l.length+n,l.length):l.slice(0,n)),a.push(...l)}return!o&&a.length==0&&s.push(Fb(t)),a}},su=class r{constructor(e,t,n,i){this._driver=e,this.element=t,this.startTime=n,this._elementTimelineStylesLookup=i,this.duration=0,this.easing=null,this._previousKeyframe=new Map,this._currentKeyframe=new Map,this._keyframes=new Map,this._styleSummary=new Map,this._localTimelineStyles=new Map,this._pendingStyles=new Map,this._backFill=new Map,this._currentEmptyStepKeyframe=null,this._elementTimelineStylesLookup||(this._elementTimelineStylesLookup=new Map),this._globalTimelineStyles=this._elementTimelineStylesLookup.get(t),this._globalTimelineStyles||(this._globalTimelineStyles=this._localTimelineStyles,this._elementTimelineStylesLookup.set(t,this._localTimelineStyles)),this._loadKeyframe()}containsAnimation(){switch(this._keyframes.size){case 0:return!1;case 1:return this.hasCurrentStyleProperties();default:return!0}}hasCurrentStyleProperties(){return this._currentKeyframe.size>0}get currentTime(){return this.startTime+this.duration}delayNextStep(e){let t=this._keyframes.size===1&&this._pendingStyles.size;this.duration||t?(this.forwardTime(this.currentTime+e),t&&this.snapshotCurrentStyles()):this.startTime+=e}fork(e,t){return this.applyStylesToKeyframe(),new r(this._driver,e,t||this.currentTime,this._elementTimelineStylesLookup)}_loadKeyframe(){this._currentKeyframe&&(this._previousKeyframe=this._currentKeyframe),this._currentKeyframe=this._keyframes.get(this.duration),this._currentKeyframe||(this._currentKeyframe=new Map,this._keyframes.set(this.duration,this._currentKeyframe))}forwardFrame(){this.duration+=C0,this._loadKeyframe()}forwardTime(e){this.applyStylesToKeyframe(),this.duration=e,this._loadKeyframe()}_updateStyle(e,t){this._localTimelineStyles.set(e,t),this._globalTimelineStyles.set(e,t),this._styleSummary.set(e,{time:this.currentTime,value:t})}allowOnlyTimelineStyles(){return this._currentEmptyStepKeyframe!==this._currentKeyframe}applyEmptyStep(e){e&&this._previousKeyframe.set("easing",e);for(let[t,n]of this._globalTimelineStyles)this._backFill.set(t,n||Un),this._currentKeyframe.set(t,Un);this._currentEmptyStepKeyframe=this._currentKeyframe}setStyles(e,t,n,i){t&&this._previousKeyframe.set("easing",t);let o=i&&i.params||{},s=S0(e,this._globalTimelineStyles);for(let[a,c]of s){let l=bc(c,o,n);this._pendingStyles.set(a,l),this._localTimelineStyles.has(a)||this._backFill.set(a,this._globalTimelineStyles.get(a)??Un),this._updateStyle(a,l)}}applyStylesToKeyframe(){this._pendingStyles.size!=0&&(this._pendingStyles.forEach((e,t)=>{this._currentKeyframe.set(t,e)}),this._pendingStyles.clear(),this._localTimelineStyles.forEach((e,t)=>{this._currentKeyframe.has(t)||this._currentKeyframe.set(t,e)}))}snapshotCurrentStyles(){for(let[e,t]of this._localTimelineStyles)this._pendingStyles.set(e,t),this._updateStyle(e,t)}getFinalKeyframe(){return this._keyframes.get(this.duration)}get properties(){let e=[];for(let t in this._currentKeyframe)e.push(t);return e}mergeTimelineCollectedStyles(e){e._styleSummary.forEach((t,n)=>{let i=this._styleSummary.get(n);(!i||t.time>i.time)&&this._updateStyle(n,t.value)})}buildKeyframes(){this.applyStylesToKeyframe();let e=new Set,t=new Set,n=this._keyframes.size===1&&this.duration===0,i=[];this._keyframes.forEach((a,c)=>{let l=new Map([...this._backFill,...a]);l.forEach((d,u)=>{d===Kd?e.add(u):d===Un&&t.add(u)}),n||l.set("offset",c/this.duration),i.push(l)});let o=[...e.values()],s=[...t.values()];if(n){let a=i[0],c=new Map(a);a.set("offset",0),c.set("offset",1),i=[a,c]}return Zm(this.element,i,o,s,this.duration,this.startTime,this.easing,!1)}},Um=class extends su{constructor(e,t,n,i,o,s,a=!1){super(e,t,s.delay),this.keyframes=n,this.preStyleProps=i,this.postStyleProps=o,this._stretchStartingKeyframe=a,this.timings={duration:s.duration,delay:s.delay,easing:s.easing}}containsAnimation(){return this.keyframes.length>1}buildKeyframes(){let e=this.keyframes,{delay:t,duration:n,easing:i}=this.timings;if(this._stretchStartingKeyframe&&t){let o=[],s=n+t,a=t/s,c=new Map(e[0]);c.set("offset",0),o.push(c);let l=new Map(e[0]);l.set("offset",Mw(a)),o.push(l);let d=e.length-1;for(let u=1;u<=d;u++){let m=new Map(e[u]),p=m.get("offset"),v=t+p*n;m.set("offset",Mw(v/s)),o.push(m)}n=s,t=0,i="",e=o}return Zm(this.element,e,this.preStyleProps,this.postStyleProps,n,t,i,!0)}};function Mw(r,e=3){let t=Math.pow(10,e-1);return Math.round(r*t)/t}function S0(r,e){let t=new Map,n;return r.forEach(i=>{if(i==="*"){n??=e.keys();for(let o of n)t.set(o,Un)}else for(let[o,s]of i)t.set(o,s)}),t}function Ow(r,e,t,n,i,o,s,a,c,l,d,u,m){return{type:0,element:r,triggerName:e,isRemovalTransition:i,fromState:t,fromStyles:o,toState:n,toStyles:s,timelines:a,queriedElements:c,preStyleProps:l,postStyleProps:d,totalTime:u,errors:m}}var bm={},au=class{constructor(e,t,n){this._triggerName=e,this.ast=t,this._stateStyles=n}match(e,t,n,i){return A0(this.ast.matchers,e,t,n,i)}buildStyles(e,t,n){let i=this._stateStyles.get("*");return e!==void 0&&(i=this._stateStyles.get(e?.toString())||i),i?i.buildStyles(t,n):new Map}build(e,t,n,i,o,s,a,c,l,d){let u=[],m=this.ast.options&&this.ast.options.params||bm,p=a&&a.params||bm,v=this.buildStyles(n,p,u),T=c&&c.params||bm,I=this.buildStyles(i,T,u),k=new Set,O=new Map,D=new Map,j=i==="void",oe={params:Gw(T,m),delay:this.ast.options?.delay},we=d?[]:Ww(e,t,this.ast.animation,o,s,v,I,oe,l,u),Te=0;return we.forEach(ee=>{Te=Math.max(ee.duration+ee.delay,Te)}),u.length?Ow(t,this._triggerName,n,i,j,v,I,[],[],O,D,Te,u):(we.forEach(ee=>{let re=ee.element,le=Wt(O,re,new Set);ee.preStyleProps.forEach(M=>le.add(M));let H=Wt(D,re,new Set);ee.postStyleProps.forEach(M=>H.add(M)),re!==t&&k.add(re)}),Ow(t,this._triggerName,n,i,j,v,I,we,[...k.values()],O,D,Te))}};function A0(r,e,t,n,i){return r.some(o=>o(e,t,n,i))}function Gw(r,e){let t=g({},e);return Object.entries(r).forEach(([n,i])=>{i!=null&&(t[n]=i)}),t}var Bm=class{constructor(e,t,n){this.styles=e,this.defaultParams=t,this.normalizer=n}buildStyles(e,t){let n=new Map,i=Gw(e,this.defaultParams);return this.styles.styles.forEach(o=>{typeof o!="string"&&o.forEach((s,a)=>{s&&(s=bc(s,i,t));let c=this.normalizer.normalizePropertyName(a,t);s=this.normalizer.normalizeStyleValue(a,c,s,t),n.set(a,s)})}),n}};function I0(r,e,t){return new Vm(r,e,t)}var Vm=class{constructor(e,t,n){this.name=e,this.ast=t,this._normalizer=n,this.transitionFactories=[],this.states=new Map,t.states.forEach(i=>{let o=i.options&&i.options.params||{};this.states.set(i.name,new Bm(i.style,o,n))}),Pw(this.states,"true","1"),Pw(this.states,"false","0"),t.transitions.forEach(i=>{this.transitionFactories.push(new au(e,i,this.states))}),this.fallbackTransition=b0(e,this.states,this._normalizer)}get containsQueries(){return this.ast.queryCount>0}matchTransition(e,t,n,i){return this.transitionFactories.find(s=>s.match(e,t,n,i))||null}matchStyles(e,t,n){return this.fallbackTransition.buildStyles(e,t,n)}};function b0(r,e,t){let n=[(s,a)=>!0],i={type:pe.Sequence,steps:[],options:null},o={type:pe.Transition,animation:i,matchers:n,options:null,queryCount:0,depCount:0};return new au(r,o,e)}function Pw(r,e,t){r.has(e)?r.has(t)||r.set(t,r.get(e)):r.has(t)&&r.set(e,r.get(t))}var k0=new kc,zm=class{constructor(e,t,n){this.bodyNode=e,this._driver=t,this._normalizer=n,this._animations=new Map,this._playersById=new Map,this.players=[]}register(e,t){let n=[],i=[],o=jw(this._driver,t,n,i);if(n.length)throw zb(n);i.length&&void 0,this._animations.set(e,o)}_buildPlayer(e,t,n){let i=e.element,o=Uw(this._normalizer,e.keyframes,t,n);return this._driver.animate(i,o,e.duration,e.delay,e.easing,[],!0)}create(e,t,n={}){let i=[],o=this._animations.get(e),s,a=new Map;if(o?(s=Ww(this._driver,t,o,Kw,Mm,new Map,new Map,n,k0,i),s.forEach(d=>{let u=Wt(a,d.element,new Map);d.postStyleProps.forEach(m=>u.set(m,null))})):(i.push(Kb()),s=[]),i.length)throw qb(i);a.forEach((d,u)=>{d.forEach((m,p)=>{d.set(p,this._driver.computeStyle(u,p,Un))})});let c=s.map(d=>{let u=a.get(d.element);return this._buildPlayer(d,new Map,u)}),l=ri(c);return this._playersById.set(e,l),l.onDestroy(()=>this.destroy(e)),this.players.push(l),l}destroy(e){let t=this._getPlayer(e);t.destroy(),this._playersById.delete(e);let n=this.players.indexOf(t);n>=0&&this.players.splice(n,1)}_getPlayer(e){let t=this._playersById.get(e);if(!t)throw $b(e);return t}listen(e,t,n,i){let o=Gm(t,"","","");return Wm(this._getPlayer(e),n,o,i),()=>{}}command(e,t,n,i){if(n=="register"){this.register(e,i[0]);return}if(n=="create"){let s=i[0]||{};this.create(e,t,s);return}let o=this._getPlayer(e);switch(n){case"play":o.play();break;case"pause":o.pause();break;case"reset":o.reset();break;case"restart":o.restart();break;case"finish":o.finish();break;case"init":o.init();break;case"setPosition":o.setPosition(parseFloat(i[0]));break;case"destroy":this.destroy(e);break}}},Nw="ng-animate-queued",R0=".ng-animate-queued",km="ng-animate-disabled",D0=".ng-animate-disabled",M0="ng-star-inserted",O0=".ng-star-inserted",P0=[],Yw={namespaceId:"",setForRemoval:!1,setForMove:!1,hasAnimation:!1,removedBeforeQueried:!1},N0={namespaceId:"",setForMove:!1,setForRemoval:!1,hasAnimation:!1,removedBeforeQueried:!0},En="__ng_removed",Rc=class{get params(){return this.options.params}constructor(e,t=""){this.namespaceId=t;let n=e&&e.hasOwnProperty("value"),i=n?e.value:e;if(this.value=L0(i),n){let o=e,{value:s}=o,a=Rt(o,["value"]);this.options=a}else this.options={};this.options.params||(this.options.params={})}absorbOptions(e){let t=e.params;if(t){let n=this.options.params;Object.keys(t).forEach(i=>{n[i]==null&&(n[i]=t[i])})}}},Ic="void",Rm=new Rc(Ic),Km=class{constructor(e,t,n){this.id=e,this.hostElement=t,this._engine=n,this.players=[],this._triggers=new Map,this._queue=[],this._elementListeners=new Map,this._hostClassName="ng-tns-"+e,an(t,this._hostClassName)}listen(e,t,n,i){if(!this._triggers.has(t))throw jb(n,t);if(n==null||n.length==0)throw Wb(t);if(!F0(n))throw Gb(n,t);let o=Wt(this._elementListeners,e,[]),s={name:t,phase:n,callback:i};o.push(s);let a=Wt(this._engine.statesByElement,e,new Map);return a.has(t)||(an(e,Qd),an(e,Qd+"-"+t),a.set(t,Rm)),()=>{this._engine.afterFlush(()=>{let c=o.indexOf(s);c>=0&&o.splice(c,1),this._triggers.has(t)||a.delete(t)})}}register(e,t){return this._triggers.has(e)?!1:(this._triggers.set(e,t),!0)}_getTrigger(e){let t=this._triggers.get(e);if(!t)throw Yb(e);return t}trigger(e,t,n,i=!0){let o=this._getTrigger(t),s=new Dc(this.id,t,e),a=this._engine.statesByElement.get(e);a||(an(e,Qd),an(e,Qd+"-"+t),this._engine.statesByElement.set(e,a=new Map));let c=a.get(t),l=new Rc(n,this.id);if(!(n&&n.hasOwnProperty("value"))&&c&&l.absorbOptions(c.options),a.set(t,l),c||(c=Rm),!(l.value===Ic)&&c.value===l.value){if(!B0(c.params,l.params)){let T=[],I=o.matchStyles(c.value,c.params,T),k=o.matchStyles(l.value,l.params,T);T.length?this._engine.reportError(T):this._engine.afterFlush(()=>{oo(e,I),Vn(e,k)})}return}let m=Wt(this._engine.playersByElement,e,[]);m.forEach(T=>{T.namespaceId==this.id&&T.triggerName==t&&T.queued&&T.destroy()});let p=o.matchTransition(c.value,l.value,e,l.params),v=!1;if(!p){if(!i)return;p=o.fallbackTransition,v=!0}return this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:t,transition:p,fromState:c,toState:l,player:s,isFallbackTransition:v}),v||(an(e,Nw),s.onStart(()=>{Os(e,Nw)})),s.onDone(()=>{let T=this.players.indexOf(s);T>=0&&this.players.splice(T,1);let I=this._engine.playersByElement.get(e);if(I){let k=I.indexOf(s);k>=0&&I.splice(k,1)}}),this.players.push(s),m.push(s),s}deregister(e){this._triggers.delete(e),this._engine.statesByElement.forEach(t=>t.delete(e)),this._elementListeners.forEach((t,n)=>{this._elementListeners.set(n,t.filter(i=>i.name!=e))})}clearElementCache(e){this._engine.statesByElement.delete(e),this._elementListeners.delete(e);let t=this._engine.playersByElement.get(e);t&&(t.forEach(n=>n.destroy()),this._engine.playersByElement.delete(e))}_signalRemovalForInnerTriggers(e,t){let n=this._engine.driver.query(e,tu,!0);n.forEach(i=>{if(i[En])return;let o=this._engine.fetchNamespacesByElement(i);o.size?o.forEach(s=>s.triggerLeaveAnimation(i,t,!1,!0)):this.clearElementCache(i)}),this._engine.afterFlushAnimationsDone(()=>n.forEach(i=>this.clearElementCache(i)))}triggerLeaveAnimation(e,t,n,i){let o=this._engine.statesByElement.get(e),s=new Map;if(o){let a=[];if(o.forEach((c,l)=>{if(s.set(l,c.value),this._triggers.has(l)){let d=this.trigger(e,l,Ic,i);d&&a.push(d)}}),a.length)return this._engine.markElementAsRemoved(this.id,e,!0,t,s),n&&ri(a).onDone(()=>this._engine.processLeaveNode(e)),!0}return!1}prepareLeaveAnimationListeners(e){let t=this._elementListeners.get(e),n=this._engine.statesByElement.get(e);if(t&&n){let i=new Set;t.forEach(o=>{let s=o.name;if(i.has(s))return;i.add(s);let c=this._triggers.get(s).fallbackTransition,l=n.get(s)||Rm,d=new Rc(Ic),u=new Dc(this.id,s,e);this._engine.totalQueuedPlayers++,this._queue.push({element:e,triggerName:s,transition:c,fromState:l,toState:d,player:u,isFallbackTransition:!0})})}}removeNode(e,t){let n=this._engine;if(e.childElementCount&&this._signalRemovalForInnerTriggers(e,t),this.triggerLeaveAnimation(e,t,!0))return;let i=!1;if(n.totalAnimations){let o=n.players.length?n.playersByQueriedElement.get(e):[];if(o&&o.length)i=!0;else{let s=e;for(;s=s.parentNode;)if(n.statesByElement.get(s)){i=!0;break}}}if(this.prepareLeaveAnimationListeners(e),i)n.markElementAsRemoved(this.id,e,!1,t);else{let o=e[En];(!o||o===Yw)&&(n.afterFlush(()=>this.clearElementCache(e)),n.destroyInnerAnimations(e),n._onRemovalComplete(e,t))}}insertNode(e,t){an(e,this._hostClassName)}drainQueuedTransitions(e){let t=[];return this._queue.forEach(n=>{let i=n.player;if(i.destroyed)return;let o=n.element,s=this._elementListeners.get(o);s&&s.forEach(a=>{if(a.name==n.triggerName){let c=Gm(o,n.triggerName,n.fromState.value,n.toState.value);c._data=e,Wm(n.player,a.phase,c,a.callback)}}),i.markedForDestroy?this._engine.afterFlush(()=>{i.destroy()}):t.push(n)}),this._queue=[],t.sort((n,i)=>{let o=n.transition.ast.depCount,s=i.transition.ast.depCount;return o==0||s==0?o-s:this._engine.driver.containsElement(n.element,i.element)?1:-1})}destroy(e){this.players.forEach(t=>t.destroy()),this._signalRemovalForInnerTriggers(this.hostElement,e)}},qm=class{_onRemovalComplete(e,t){this.onRemovalComplete(e,t)}constructor(e,t,n){this.bodyNode=e,this.driver=t,this._normalizer=n,this.players=[],this.newHostElements=new Map,this.playersByElement=new Map,this.playersByQueriedElement=new Map,this.statesByElement=new Map,this.disabledNodes=new Set,this.totalAnimations=0,this.totalQueuedPlayers=0,this._namespaceLookup={},this._namespaceList=[],this._flushFns=[],this._whenQuietFns=[],this.namespacesByHostElement=new Map,this.collectedEnterElements=[],this.collectedLeaveElements=[],this.onRemovalComplete=(i,o)=>{}}get queuedPlayers(){let e=[];return this._namespaceList.forEach(t=>{t.players.forEach(n=>{n.queued&&e.push(n)})}),e}createNamespace(e,t){let n=new Km(e,t,this);return this.bodyNode&&this.driver.containsElement(this.bodyNode,t)?this._balanceNamespaceList(n,t):(this.newHostElements.set(t,n),this.collectEnterElement(t)),this._namespaceLookup[e]=n}_balanceNamespaceList(e,t){let n=this._namespaceList,i=this.namespacesByHostElement;if(n.length-1>=0){let s=!1,a=this.driver.getParentElement(t);for(;a;){let c=i.get(a);if(c){let l=n.indexOf(c);n.splice(l+1,0,e),s=!0;break}a=this.driver.getParentElement(a)}s||n.unshift(e)}else n.push(e);return i.set(t,e),e}register(e,t){let n=this._namespaceLookup[e];return n||(n=this.createNamespace(e,t)),n}registerTrigger(e,t,n){let i=this._namespaceLookup[e];i&&i.register(t,n)&&this.totalAnimations++}destroy(e,t){e&&(this.afterFlush(()=>{}),this.afterFlushAnimationsDone(()=>{let n=this._fetchNamespace(e);this.namespacesByHostElement.delete(n.hostElement);let i=this._namespaceList.indexOf(n);i>=0&&this._namespaceList.splice(i,1),n.destroy(t),delete this._namespaceLookup[e]}))}_fetchNamespace(e){return this._namespaceLookup[e]}fetchNamespacesByElement(e){let t=new Set,n=this.statesByElement.get(e);if(n){for(let i of n.values())if(i.namespaceId){let o=this._fetchNamespace(i.namespaceId);o&&t.add(o)}}return t}trigger(e,t,n,i){if(Zd(t)){let o=this._fetchNamespace(e);if(o)return o.trigger(t,n,i),!0}return!1}insertNode(e,t,n,i){if(!Zd(t))return;let o=t[En];if(o&&o.setForRemoval){o.setForRemoval=!1,o.setForMove=!0;let s=this.collectedLeaveElements.indexOf(t);s>=0&&this.collectedLeaveElements.splice(s,1)}if(e){let s=this._fetchNamespace(e);s&&s.insertNode(t,n)}i&&this.collectEnterElement(t)}collectEnterElement(e){this.collectedEnterElements.push(e)}markElementAsDisabled(e,t){t?this.disabledNodes.has(e)||(this.disabledNodes.add(e),an(e,km)):this.disabledNodes.has(e)&&(this.disabledNodes.delete(e),Os(e,km))}removeNode(e,t,n){if(Zd(t)){let i=e?this._fetchNamespace(e):null;i?i.removeNode(t,n):this.markElementAsRemoved(e,t,!1,n);let o=this.namespacesByHostElement.get(t);o&&o.id!==e&&o.removeNode(t,n)}else this._onRemovalComplete(t,n)}markElementAsRemoved(e,t,n,i,o){this.collectedLeaveElements.push(t),t[En]={namespaceId:e,setForRemoval:i,hasAnimation:n,removedBeforeQueried:!1,previousTriggersValues:o}}listen(e,t,n,i,o){return Zd(t)?this._fetchNamespace(e).listen(t,n,i,o):()=>{}}_buildInstruction(e,t,n,i,o){return e.transition.build(this.driver,e.element,e.fromState.value,e.toState.value,n,i,e.fromState.options,e.toState.options,t,o)}destroyInnerAnimations(e){let t=this.driver.query(e,tu,!0);t.forEach(n=>this.destroyActiveAnimationsForElement(n)),this.playersByQueriedElement.size!=0&&(t=this.driver.query(e,Om,!0),t.forEach(n=>this.finishActiveQueriedAnimationOnElement(n)))}destroyActiveAnimationsForElement(e){let t=this.playersByElement.get(e);t&&t.forEach(n=>{n.queued?n.markedForDestroy=!0:n.destroy()})}finishActiveQueriedAnimationOnElement(e){let t=this.playersByQueriedElement.get(e);t&&t.forEach(n=>n.finish())}whenRenderingDone(){return new Promise(e=>{if(this.players.length)return ri(this.players).onDone(()=>e());e()})}processLeaveNode(e){let t=e[En];if(t&&t.setForRemoval){if(e[En]=Yw,t.namespaceId){this.destroyInnerAnimations(e);let n=this._fetchNamespace(t.namespaceId);n&&n.clearElementCache(e)}this._onRemovalComplete(e,t.setForRemoval)}e.classList?.contains(km)&&this.markElementAsDisabled(e,!1),this.driver.query(e,D0,!0).forEach(n=>{this.markElementAsDisabled(n,!1)})}flush(e=-1){let t=[];if(this.newHostElements.size&&(this.newHostElements.forEach((n,i)=>this._balanceNamespaceList(n,i)),this.newHostElements.clear()),this.totalAnimations&&this.collectedEnterElements.length)for(let n=0;n<this.collectedEnterElements.length;n++){let i=this.collectedEnterElements[n];an(i,M0)}if(this._namespaceList.length&&(this.totalQueuedPlayers||this.collectedLeaveElements.length)){let n=[];try{t=this._flushAnimations(n,e)}finally{for(let i=0;i<n.length;i++)n[i]()}}else for(let n=0;n<this.collectedLeaveElements.length;n++){let i=this.collectedLeaveElements[n];this.processLeaveNode(i)}if(this.totalQueuedPlayers=0,this.collectedEnterElements.length=0,this.collectedLeaveElements.length=0,this._flushFns.forEach(n=>n()),this._flushFns=[],this._whenQuietFns.length){let n=this._whenQuietFns;this._whenQuietFns=[],t.length?ri(t).onDone(()=>{n.forEach(i=>i())}):n.forEach(i=>i())}}reportError(e){throw Qb(e)}_flushAnimations(e,t){let n=new kc,i=[],o=new Map,s=[],a=new Map,c=new Map,l=new Map,d=new Set;this.disabledNodes.forEach(K=>{d.add(K);let Y=this.driver.query(K,R0,!0);for(let X=0;X<Y.length;X++)d.add(Y[X])});let u=this.bodyNode,m=Array.from(this.statesByElement.keys()),p=Fw(m,this.collectedEnterElements),v=new Map,T=0;p.forEach((K,Y)=>{let X=Kw+T++;v.set(Y,X),K.forEach(te=>an(te,X))});let I=[],k=new Set,O=new Set;for(let K=0;K<this.collectedLeaveElements.length;K++){let Y=this.collectedLeaveElements[K],X=Y[En];X&&X.setForRemoval&&(I.push(Y),k.add(Y),X.hasAnimation?this.driver.query(Y,O0,!0).forEach(te=>k.add(te)):O.add(Y))}let D=new Map,j=Fw(m,Array.from(k));j.forEach((K,Y)=>{let X=Mm+T++;D.set(Y,X),K.forEach(te=>an(te,X))}),e.push(()=>{p.forEach((K,Y)=>{let X=v.get(Y);K.forEach(te=>Os(te,X))}),j.forEach((K,Y)=>{let X=D.get(Y);K.forEach(te=>Os(te,X))}),I.forEach(K=>{this.processLeaveNode(K)})});let oe=[],we=[];for(let K=this._namespaceList.length-1;K>=0;K--)this._namespaceList[K].drainQueuedTransitions(t).forEach(X=>{let te=X.player,xe=X.element;if(oe.push(te),this.collectedEnterElements.length){let vt=xe[En];if(vt&&vt.setForMove){if(vt.previousTriggersValues&&vt.previousTriggersValues.has(X.triggerName)){let ii=vt.previousTriggersValues.get(X.triggerName),Gt=this.statesByElement.get(X.element);if(Gt&&Gt.has(X.triggerName)){let Mc=Gt.get(X.triggerName);Mc.value=ii,Gt.set(X.triggerName,Mc)}}te.destroy();return}}let Ke=!u||!this.driver.containsElement(u,xe),lt=D.get(xe),Sn=v.get(xe),Re=this._buildInstruction(X,n,Sn,lt,Ke);if(Re.errors&&Re.errors.length){we.push(Re);return}if(Ke){te.onStart(()=>oo(xe,Re.fromStyles)),te.onDestroy(()=>Vn(xe,Re.toStyles)),i.push(te);return}if(X.isFallbackTransition){te.onStart(()=>oo(xe,Re.fromStyles)),te.onDestroy(()=>Vn(xe,Re.toStyles)),i.push(te);return}let xs=[];Re.timelines.forEach(vt=>{vt.stretchStartingKeyframe=!0,this.disabledNodes.has(vt.element)||xs.push(vt)}),Re.timelines=xs,n.append(xe,Re.timelines);let hu={instruction:Re,player:te,element:xe};s.push(hu),Re.queriedElements.forEach(vt=>Wt(a,vt,[]).push(te)),Re.preStyleProps.forEach((vt,ii)=>{if(vt.size){let Gt=c.get(ii);Gt||c.set(ii,Gt=new Set),vt.forEach((Mc,pu)=>Gt.add(pu))}}),Re.postStyleProps.forEach((vt,ii)=>{let Gt=l.get(ii);Gt||l.set(ii,Gt=new Set),vt.forEach((Mc,pu)=>Gt.add(pu))})});if(we.length){let K=[];we.forEach(Y=>{K.push(Xb(Y.triggerName,Y.errors))}),oe.forEach(Y=>Y.destroy()),this.reportError(K)}let Te=new Map,ee=new Map;s.forEach(K=>{let Y=K.element;n.has(Y)&&(ee.set(Y,Y),this._beforeAnimationBuild(K.player.namespaceId,K.instruction,Te))}),i.forEach(K=>{let Y=K.element;this._getPreviousPlayers(Y,!1,K.namespaceId,K.triggerName,null).forEach(te=>{Wt(Te,Y,[]).push(te),te.destroy()})});let re=I.filter(K=>Hw(K,c,l)),le=new Map;Lw(le,this.driver,O,l,Un).forEach(K=>{Hw(K,c,l)&&re.push(K)});let M=new Map;p.forEach((K,Y)=>{Lw(M,this.driver,new Set(K),c,Kd)}),re.forEach(K=>{let Y=le.get(K),X=M.get(K);le.set(K,new Map([...Y?.entries()??[],...X?.entries()??[]]))});let Ie=[],Ae=[],co={};s.forEach(K=>{let{element:Y,player:X,instruction:te}=K;if(n.has(Y)){if(d.has(Y)){X.onDestroy(()=>Vn(Y,te.toStyles)),X.disabled=!0,X.overrideTotalTime(te.totalTime),i.push(X);return}let xe=co;if(ee.size>1){let lt=Y,Sn=[];for(;lt=lt.parentNode;){let Re=ee.get(lt);if(Re){xe=Re;break}Sn.push(lt)}Sn.forEach(Re=>ee.set(Re,xe))}let Ke=this._buildAnimation(X.namespaceId,te,Te,o,M,le);if(X.setRealPlayer(Ke),xe===co)Ie.push(X);else{let lt=this.playersByElement.get(xe);lt&&lt.length&&(X.parentPlayer=ri(lt)),i.push(X)}}else oo(Y,te.fromStyles),X.onDestroy(()=>Vn(Y,te.toStyles)),Ae.push(X),d.has(Y)&&i.push(X)}),Ae.forEach(K=>{let Y=o.get(K.element);if(Y&&Y.length){let X=ri(Y);K.setRealPlayer(X)}}),i.forEach(K=>{K.parentPlayer?K.syncPlayerEvents(K.parentPlayer):K.destroy()});for(let K=0;K<I.length;K++){let Y=I[K],X=Y[En];if(Os(Y,Mm),X&&X.hasAnimation)continue;let te=[];if(a.size){let Ke=a.get(Y);Ke&&Ke.length&&te.push(...Ke);let lt=this.driver.query(Y,Om,!0);for(let Sn=0;Sn<lt.length;Sn++){let Re=a.get(lt[Sn]);Re&&Re.length&&te.push(...Re)}}let xe=te.filter(Ke=>!Ke.destroyed);xe.length?H0(this,Y,xe):this.processLeaveNode(Y)}return I.length=0,Ie.forEach(K=>{this.players.push(K),K.onDone(()=>{K.destroy();let Y=this.players.indexOf(K);this.players.splice(Y,1)}),K.play()}),Ie}afterFlush(e){this._flushFns.push(e)}afterFlushAnimationsDone(e){this._whenQuietFns.push(e)}_getPreviousPlayers(e,t,n,i,o){let s=[];if(t){let a=this.playersByQueriedElement.get(e);a&&(s=a)}else{let a=this.playersByElement.get(e);if(a){let c=!o||o==Ic;a.forEach(l=>{l.queued||!c&&l.triggerName!=i||s.push(l)})}}return(n||i)&&(s=s.filter(a=>!(n&&n!=a.namespaceId||i&&i!=a.triggerName))),s}_beforeAnimationBuild(e,t,n){let i=t.triggerName,o=t.element,s=t.isRemovalTransition?void 0:e,a=t.isRemovalTransition?void 0:i;for(let c of t.timelines){let l=c.element,d=l!==o,u=Wt(n,l,[]);this._getPreviousPlayers(l,d,s,a,t.toState).forEach(p=>{let v=p.getRealPlayer();v.beforeDestroy&&v.beforeDestroy(),p.destroy(),u.push(p)})}oo(o,t.fromStyles)}_buildAnimation(e,t,n,i,o,s){let a=t.triggerName,c=t.element,l=[],d=new Set,u=new Set,m=t.timelines.map(v=>{let T=v.element;d.add(T);let I=T[En];if(I&&I.removedBeforeQueried)return new ti(v.duration,v.delay);let k=T!==c,O=U0((n.get(T)||P0).map(Te=>Te.getRealPlayer())).filter(Te=>{let ee=Te;return ee.element?ee.element===T:!1}),D=o.get(T),j=s.get(T),oe=Uw(this._normalizer,v.keyframes,D,j),we=this._buildPlayer(v,oe,O);if(v.subTimeline&&i&&u.add(T),k){let Te=new Dc(e,a,T);Te.setRealPlayer(we),l.push(Te)}return we});l.forEach(v=>{Wt(this.playersByQueriedElement,v.element,[]).push(v),v.onDone(()=>x0(this.playersByQueriedElement,v.element,v))}),d.forEach(v=>an(v,kw));let p=ri(m);return p.onDestroy(()=>{d.forEach(v=>Os(v,kw)),Vn(c,t.toStyles)}),u.forEach(v=>{Wt(i,v,[]).push(p)}),p}_buildPlayer(e,t,n){return t.length>0?this.driver.animate(e.element,t,e.duration,e.delay,e.easing,n):new ti(e.duration,e.delay)}},Dc=class{constructor(e,t,n){this.namespaceId=e,this.triggerName=t,this.element=n,this._player=new ti,this._containsRealPlayer=!1,this._queuedCallbacks=new Map,this.destroyed=!1,this.parentPlayer=null,this.markedForDestroy=!1,this.disabled=!1,this.queued=!0,this.totalTime=0}setRealPlayer(e){this._containsRealPlayer||(this._player=e,this._queuedCallbacks.forEach((t,n)=>{t.forEach(i=>Wm(e,n,void 0,i))}),this._queuedCallbacks.clear(),this._containsRealPlayer=!0,this.overrideTotalTime(e.totalTime),this.queued=!1)}getRealPlayer(){return this._player}overrideTotalTime(e){this.totalTime=e}syncPlayerEvents(e){let t=this._player;t.triggerCallback&&e.onStart(()=>t.triggerCallback("start")),e.onDone(()=>this.finish()),e.onDestroy(()=>this.destroy())}_queueEvent(e,t){Wt(this._queuedCallbacks,e,[]).push(t)}onDone(e){this.queued&&this._queueEvent("done",e),this._player.onDone(e)}onStart(e){this.queued&&this._queueEvent("start",e),this._player.onStart(e)}onDestroy(e){this.queued&&this._queueEvent("destroy",e),this._player.onDestroy(e)}init(){this._player.init()}hasStarted(){return this.queued?!1:this._player.hasStarted()}play(){!this.queued&&this._player.play()}pause(){!this.queued&&this._player.pause()}restart(){!this.queued&&this._player.restart()}finish(){this._player.finish()}destroy(){this.destroyed=!0,this._player.destroy()}reset(){!this.queued&&this._player.reset()}setPosition(e){this.queued||this._player.setPosition(e)}getPosition(){return this.queued?0:this._player.getPosition()}triggerCallback(e){let t=this._player;t.triggerCallback&&t.triggerCallback(e)}};function x0(r,e,t){let n=r.get(e);if(n){if(n.length){let i=n.indexOf(t);n.splice(i,1)}n.length==0&&r.delete(e)}return n}function L0(r){return r??null}function Zd(r){return r&&r.nodeType===1}function F0(r){return r=="start"||r=="done"}function xw(r,e){let t=r.style.display;return r.style.display=e??"none",t}function Lw(r,e,t,n,i){let o=[];t.forEach(c=>o.push(xw(c)));let s=[];n.forEach((c,l)=>{let d=new Map;c.forEach(u=>{let m=e.computeStyle(l,u,i);d.set(u,m),(!m||m.length==0)&&(l[En]=N0,s.push(l))}),r.set(l,d)});let a=0;return t.forEach(c=>xw(c,o[a++])),s}function Fw(r,e){let t=new Map;if(r.forEach(a=>t.set(a,[])),e.length==0)return t;let n=1,i=new Set(e),o=new Map;function s(a){if(!a)return n;let c=o.get(a);if(c)return c;let l=a.parentNode;return t.has(l)?c=l:i.has(l)?c=n:c=s(l),o.set(a,c),c}return e.forEach(a=>{let c=s(a);c!==n&&t.get(c).push(a)}),t}function an(r,e){r.classList?.add(e)}function Os(r,e){r.classList?.remove(e)}function H0(r,e,t){ri(t).onDone(()=>r.processLeaveNode(e))}function U0(r){let e=[];return Qw(r,e),e}function Qw(r,e){for(let t=0;t<r.length;t++){let n=r[t];n instanceof Tc?Qw(n.players,e):e.push(n)}}function B0(r,e){let t=Object.keys(r),n=Object.keys(e);if(t.length!=n.length)return!1;for(let i=0;i<t.length;i++){let o=t[i];if(!e.hasOwnProperty(o)||r[o]!==e[o])return!1}return!0}function Hw(r,e,t){let n=t.get(r);if(!n)return!1;let i=e.get(r);return i?n.forEach(o=>i.add(o)):e.set(r,n),t.delete(r),!0}var Ns=class{constructor(e,t,n){this._driver=t,this._normalizer=n,this._triggerCache={},this.onRemovalComplete=(i,o)=>{},this._transitionEngine=new qm(e.body,t,n),this._timelineEngine=new zm(e.body,t,n),this._transitionEngine.onRemovalComplete=(i,o)=>this.onRemovalComplete(i,o)}registerTrigger(e,t,n,i,o){let s=e+"-"+i,a=this._triggerCache[s];if(!a){let c=[],l=[],d=jw(this._driver,o,c,l);if(c.length)throw Bb(i,c);l.length&&void 0,a=I0(i,d,this._normalizer),this._triggerCache[s]=a}this._transitionEngine.registerTrigger(t,i,a)}register(e,t){this._transitionEngine.register(e,t)}destroy(e,t){this._transitionEngine.destroy(e,t)}onInsert(e,t,n,i){this._transitionEngine.insertNode(e,t,n,i)}onRemove(e,t,n){this._transitionEngine.removeNode(e,t,n)}disableAnimations(e,t){this._transitionEngine.markElementAsDisabled(e,t)}process(e,t,n,i){if(n.charAt(0)=="@"){let[o,s]=Iw(n),a=i;this._timelineEngine.command(o,t,s,a)}else this._transitionEngine.trigger(e,t,n,i)}listen(e,t,n,i,o){if(n.charAt(0)=="@"){let[s,a]=Iw(n);return this._timelineEngine.listen(s,t,a,o)}return this._transitionEngine.listen(e,t,n,i,o)}flush(e=-1){this._transitionEngine.flush(e)}get players(){return[...this._transitionEngine.players,...this._timelineEngine.players]}whenRenderingDone(){return this._transitionEngine.whenRenderingDone()}afterFlushAnimationsDone(e){this._transitionEngine.afterFlushAnimationsDone(e)}};function V0(r,e){let t=null,n=null;return Array.isArray(e)&&e.length?(t=Dm(e[0]),e.length>1&&(n=Dm(e[e.length-1]))):e instanceof Map&&(t=Dm(e)),t||n?new $m(r,t,n):null}var Ps=class Ps{constructor(e,t,n){this._element=e,this._startStyles=t,this._endStyles=n,this._state=0;let i=Ps.initialStylesByElement.get(e);i||Ps.initialStylesByElement.set(e,i=new Map),this._initialStyles=i}start(){this._state<1&&(this._startStyles&&Vn(this._element,this._startStyles,this._initialStyles),this._state=1)}finish(){this.start(),this._state<2&&(Vn(this._element,this._initialStyles),this._endStyles&&(Vn(this._element,this._endStyles),this._endStyles=null),this._state=1)}destroy(){this.finish(),this._state<3&&(Ps.initialStylesByElement.delete(this._element),this._startStyles&&(oo(this._element,this._startStyles),this._endStyles=null),this._endStyles&&(oo(this._element,this._endStyles),this._endStyles=null),Vn(this._element,this._initialStyles),this._state=3)}};Ps.initialStylesByElement=new WeakMap;var $m=Ps;function Dm(r){let e=null;return r.forEach((t,n)=>{z0(n)&&(e=e||new Map,e.set(n,t))}),e}function z0(r){return r==="display"||r==="position"}var cu=class{constructor(e,t,n,i){this.element=e,this.keyframes=t,this.options=n,this._specialStyles=i,this._onDoneFns=[],this._onStartFns=[],this._onDestroyFns=[],this._initialized=!1,this._finished=!1,this._started=!1,this._destroyed=!1,this._originalOnDoneFns=[],this._originalOnStartFns=[],this.time=0,this.parentPlayer=null,this.currentSnapshot=new Map,this._duration=n.duration,this._delay=n.delay||0,this.time=this._duration+this._delay}_onFinish(){this._finished||(this._finished=!0,this._onDoneFns.forEach(e=>e()),this._onDoneFns=[])}init(){this._buildPlayer(),this._preparePlayerBeforeStart()}_buildPlayer(){if(this._initialized)return;this._initialized=!0;let e=this.keyframes;this.domPlayer=this._triggerWebAnimation(this.element,e,this.options),this._finalKeyframe=e.length?e[e.length-1]:new Map;let t=()=>this._onFinish();this.domPlayer.addEventListener("finish",t),this.onDestroy(()=>{this.domPlayer.removeEventListener("finish",t)})}_preparePlayerBeforeStart(){this._delay?this._resetDomPlayerState():this.domPlayer.pause()}_convertKeyframesToObject(e){let t=[];return e.forEach(n=>{t.push(Object.fromEntries(n))}),t}_triggerWebAnimation(e,t,n){return e.animate(this._convertKeyframesToObject(t),n)}onStart(e){this._originalOnStartFns.push(e),this._onStartFns.push(e)}onDone(e){this._originalOnDoneFns.push(e),this._onDoneFns.push(e)}onDestroy(e){this._onDestroyFns.push(e)}play(){this._buildPlayer(),this.hasStarted()||(this._onStartFns.forEach(e=>e()),this._onStartFns=[],this._started=!0,this._specialStyles&&this._specialStyles.start()),this.domPlayer.play()}pause(){this.init(),this.domPlayer.pause()}finish(){this.init(),this._specialStyles&&this._specialStyles.finish(),this._onFinish(),this.domPlayer.finish()}reset(){this._resetDomPlayerState(),this._destroyed=!1,this._finished=!1,this._started=!1,this._onStartFns=this._originalOnStartFns,this._onDoneFns=this._originalOnDoneFns}_resetDomPlayerState(){this.domPlayer&&this.domPlayer.cancel()}restart(){this.reset(),this.play()}hasStarted(){return this._started}destroy(){this._destroyed||(this._destroyed=!0,this._resetDomPlayerState(),this._onFinish(),this._specialStyles&&this._specialStyles.destroy(),this._onDestroyFns.forEach(e=>e()),this._onDestroyFns=[])}setPosition(e){this.domPlayer===void 0&&this.init(),this.domPlayer.currentTime=e*this.time}getPosition(){return+(this.domPlayer.currentTime??0)/this.time}get totalTime(){return this._delay+this._duration}beforeDestroy(){let e=new Map;this.hasStarted()&&this._finalKeyframe.forEach((n,i)=>{i!=="offset"&&e.set(i,this._finished?n:Jm(this.element,i))}),this.currentSnapshot=e}triggerCallback(e){let t=e==="start"?this._onStartFns:this._onDoneFns;t.forEach(n=>n()),t.length=0}},lu=class{validateStyleProperty(e){return!0}validateAnimatableStyleProperty(e){return!0}containsElement(e,t){return Bw(e,t)}getParentElement(e){return Ym(e)}query(e,t,n){return Vw(e,t,n)}computeStyle(e,t,n){return Jm(e,t)}animate(e,t,n,i,o,s=[]){let a=i==0?"both":"forwards",c={duration:n,delay:i,fill:a};o&&(c.easing=o);let l=new Map,d=s.filter(p=>p instanceof cu);c0(n,i)&&d.forEach(p=>{p.currentSnapshot.forEach((v,T)=>l.set(T,v))});let u=o0(t).map(p=>new Map(p));u=l0(e,u,l);let m=V0(e,u);return new cu(e,u,c,m)}};var eu="@",Xw="@.disabled",du=class{constructor(e,t,n,i){this.namespaceId=e,this.delegate=t,this.engine=n,this._onDestroy=i,this.\u0275type=0}get data(){return this.delegate.data}destroyNode(e){this.delegate.destroyNode?.(e)}destroy(){this.engine.destroy(this.namespaceId,this.delegate),this.engine.afterFlushAnimationsDone(()=>{queueMicrotask(()=>{this.delegate.destroy()})}),this._onDestroy?.()}createElement(e,t){return this.delegate.createElement(e,t)}createComment(e){return this.delegate.createComment(e)}createText(e){return this.delegate.createText(e)}appendChild(e,t){this.delegate.appendChild(e,t),this.engine.onInsert(this.namespaceId,t,e,!1)}insertBefore(e,t,n,i=!0){this.delegate.insertBefore(e,t,n),this.engine.onInsert(this.namespaceId,t,e,i)}removeChild(e,t,n){this.parentNode(t)&&this.engine.onRemove(this.namespaceId,t,this.delegate)}selectRootElement(e,t){return this.delegate.selectRootElement(e,t)}parentNode(e){return this.delegate.parentNode(e)}nextSibling(e){return this.delegate.nextSibling(e)}setAttribute(e,t,n,i){this.delegate.setAttribute(e,t,n,i)}removeAttribute(e,t,n){this.delegate.removeAttribute(e,t,n)}addClass(e,t){this.delegate.addClass(e,t)}removeClass(e,t){this.delegate.removeClass(e,t)}setStyle(e,t,n,i){this.delegate.setStyle(e,t,n,i)}removeStyle(e,t,n){this.delegate.removeStyle(e,t,n)}setProperty(e,t,n){t.charAt(0)==eu&&t==Xw?this.disableAnimations(e,!!n):this.delegate.setProperty(e,t,n)}setValue(e,t){this.delegate.setValue(e,t)}listen(e,t,n){return this.delegate.listen(e,t,n)}disableAnimations(e,t){this.engine.disableAnimations(e,t)}},jm=class extends du{constructor(e,t,n,i,o){super(t,n,i,o),this.factory=e,this.namespaceId=t}setProperty(e,t,n){t.charAt(0)==eu?t.charAt(1)=="."&&t==Xw?(n=n===void 0?!0:!!n,this.disableAnimations(e,n)):this.engine.process(this.namespaceId,e,t.slice(1),n):this.delegate.setProperty(e,t,n)}listen(e,t,n){if(t.charAt(0)==eu){let i=K0(e),o=t.slice(1),s="";return o.charAt(0)!=eu&&([o,s]=q0(o)),this.engine.listen(this.namespaceId,i,o,s,a=>{let c=a._data||-1;this.factory.scheduleListenerCallback(c,n,a)})}return this.delegate.listen(e,t,n)}};function K0(r){switch(r){case"body":return document.body;case"document":return document;case"window":return window;default:return r}}function q0(r){let e=r.indexOf("."),t=r.substring(0,e),n=r.slice(e+1);return[t,n]}var uu=class{constructor(e,t,n){this.delegate=e,this.engine=t,this._zone=n,this._currentId=0,this._microtaskId=1,this._animationCallbacksBuffer=[],this._rendererCache=new Map,this._cdRecurDepth=0,t.onRemovalComplete=(i,o)=>{o?.removeChild(null,i)}}createRenderer(e,t){let n="",i=this.delegate.createRenderer(e,t);if(!e||!t?.data?.animation){let l=this._rendererCache,d=l.get(i);if(!d){let u=()=>l.delete(i);d=new du(n,i,this.engine,u),l.set(i,d)}return d}let o=t.id,s=t.id+"-"+this._currentId;this._currentId++,this.engine.register(s,e);let a=l=>{Array.isArray(l)?l.forEach(a):this.engine.registerTrigger(o,s,e,l.name,l)};return t.data.animation.forEach(a),new jm(this,s,i,this.engine)}begin(){this._cdRecurDepth++,this.delegate.begin&&this.delegate.begin()}_scheduleCountTask(){queueMicrotask(()=>{this._microtaskId++})}scheduleListenerCallback(e,t,n){if(e>=0&&e<this._microtaskId){this._zone.run(()=>t(n));return}let i=this._animationCallbacksBuffer;i.length==0&&queueMicrotask(()=>{this._zone.run(()=>{i.forEach(o=>{let[s,a]=o;s(a)}),this._animationCallbacksBuffer=[]})}),i.push([t,n])}end(){this._cdRecurDepth--,this._cdRecurDepth==0&&this._zone.runOutsideAngular(()=>{this._scheduleCountTask(),this.engine.flush(this._microtaskId)}),this.delegate.end&&this.delegate.end()}whenRenderingDone(){return this.engine.whenRenderingDone()}};var j0=(()=>{let e=class e extends Ns{constructor(n,i,o){super(n,i,o)}ngOnDestroy(){this.flush()}};e.\u0275fac=function(i){return new(i||e)(se(Je),se(so),se(ao))},e.\u0275prov=he({token:e,factory:e.\u0275fac});let r=e;return r})();function W0(){return new ru}function G0(r,e,t){return new uu(r,e,t)}var Jw=[{provide:ao,useFactory:W0},{provide:Ns,useClass:j0},{provide:Hc,useFactory:G0,deps:[el,Ns,ht]}],Y0=[{provide:so,useFactory:()=>new lu},{provide:_u,useValue:"BrowserAnimations"},...Jw],YK=[{provide:so,useClass:Qm},{provide:_u,useValue:"NoopAnimations"},...Jw];function Zw(){return If("NgEagerAnimations"),[...Y0]}function Q0(r,e){console.log(e)}function X0(){return new mc({auth:{clientId:Er.msalConfig.auth.clientId,authority:Er.msalConfig.auth.authority,redirectUri:"/calendar",postLogoutRedirectUri:"/login",navigateToLoginRequestUrl:!0},cache:{cacheLocation:ke.LocalStorage},system:{allowNativeBroker:!1,loggerOptions:{loggerCallback:Q0,logLevel:Se.Info,piiLoggingEnabled:!1}}})}function J0(){let r=new Map;return r.set(Er.apiConfig.uri,Er.apiConfig.scopes),{interactionType:F.Redirect,protectedResourceMap:r}}function Z0(){return{interactionType:F.Redirect,authRequest:{scopes:[...Er.apiConfig.scopes]},loginFailedRoute:"/login"}}var eT={providers:[tg(ng(),rg()),{provide:eg,useClass:bC,multi:!0},{provide:Pd,useFactory:X0},{provide:gc,useFactory:Z0},{provide:Yp,useFactory:J0},hr,As,Ss,Hf({eventCoalescing:!0}),hv(_w,fv(),mv({paramsInheritanceStrategy:"always"})),Rg(),vf(Ms.forRoot({provide:sn,useFactory:Sw}),Ro.forRoot()),Zw()]};var ek=()=>["/","event-list"],tk=()=>["/","calendar"];function nk(r,e){if(r&1){let t=Ce();C(0,"div",1)(1,"div",2)(2,"div",3)(3,"ul",4)(4,"li")(5,"a",5),G(6,"img",6),B(7," Events List "),w()(),C(8,"li")(9,"a",5),G(10,"img",7),B(11," Calendar "),w()()(),C(12,"div",8)(13,"button",9),L("click",function(){P(t);let i=b();return N(i.logout())}),B(14," Logout "),w()()()()()}r&2&&(_(5),S("routerLink",st(2,ek)),_(4),S("routerLink",st(3,tk)))}var tT=(()=>{class r{authService;isAuthorized=!1;ngOnInit(){this.isAuthorized=this.authService.instance.getAllAccounts().length>0}constructor(t){this.authService=t}logout(){this.authService.instance.logoutRedirect()}login(){this.authService.instance.loginRedirect()}static \u0275fac=function(n){return new(n||r)(x(hr))};static \u0275cmp=ue({type:r,selectors:[["app-header"]],standalone:!0,features:[Ne],decls:2,vars:1,consts:[["class","px-3 py-2 text-bg-dark border-bottom",4,"ngIf"],[1,"px-3","py-2","text-bg-dark","border-bottom"],[1,"container"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between"],[1,"nav","col-12","col-lg-auto","my-2","justify-content-center","my-md-0","text-small"],[1,"nav-link","text-white",3,"routerLink"],["src","events-list-ico.svg","width","24","height","24","alt","",1,"bi","d-block","mx-auto","mb-1"],["src","calendar-ico.svg","width","24","height","24","alt","",1,"bi","d-block","mx-auto","mb-1"],[1,"text-end"],["type","button",1,"btn","btn-outline-light","me-2",3,"click"]],template:function(n,i){n&1&&(C(0,"header"),$(1,nk,15,4,"div",0),w()),n&2&&(_(),S("ngIf",i.isAuthorized))},dependencies:[uv,Ut,mn],styles:["a[_ngcontent-%COMP%]{z-index:10}svg[_ngcontent-%COMP%]{z-index:9}"]})}return r})();var nT=(()=>{class r{title="ideo-private-room";static \u0275fac=function(n){return new(n||r)};static \u0275cmp=ue({type:r,selectors:[["app-root"]],standalone:!0,features:[Ne],decls:3,vars:0,template:function(n,i){n&1&&(G(0,"app-header"),C(1,"main"),G(2,"router-outlet"),w())},dependencies:[_h,tT]})}return r})();bg(nT,eT).catch(r=>console.error(r));
