import './polyfills.server.mjs';
import{a as Au,b as Iu,c as ku,d as zc,e as qc,f as Wc,g as Gc,h as bu,k as Ru,o as Du,q as Mu,r as Ou,s as Pu,t as Nu,u as xu}from"./chunk-Z4FBZ4KM.mjs";import{A as Bu,B as Vu,C as Ku,D as Ja,E as zu,F as hi,G as qu,H as Wu,I as Gu,J as $u,K as Yu,L as ju,M as Za,N as Qu,Q as es,R as Xu,S as Fn,a as Ln,b as Lu,c as di,d as Hn,e as Wa,f as Ga,g as $c,h as ui,i as $a,j as Io,k as un,l as Hu,m as Ya,n as ja,o as Fu,p as Qa,q as Uu,r as Xa,z as Yc}from"./chunk-4TBIHSIK.mjs";import{$ as dt,$b as ot,$c as Tu,Aa as sn,Bc as gr,C as wo,D as Hc,Da as nt,E as Qd,Fb as fe,Fc as za,G as Nt,Gb as x,Gc as Pe,Ha as iu,Hb as mt,Ib as Pn,Ic as _t,J as Xd,Jb as Nn,Jc as Yt,Kb as ln,Kc as Ut,Lb as xn,Lc as gu,Mb as li,Mc as fu,N as Jd,Na as Ba,Nb as we,Nc as Ao,Ob as Ue,Oc as Et,P as _o,Pb as dn,Pc as Cu,Qa as ou,Qb as Ke,R as xt,Rb as Ka,Rc as qa,S as Fa,Sa as y,Sb as du,Sc as vu,T as Mn,Ta as N,Tb as Bc,Tc as St,U as Zd,Ub as uu,V as Lt,Va as au,Vb as hu,W as Ua,Wb as Vc,Wc as yu,Xa as $t,Xb as he,Yb as Kc,Z as eu,Za as Va,Zb as it,_ as tt,_a as rt,_b as wt,ad as wu,ba as mr,c as Dn,cd as _u,da as Oe,dd as Eu,ea as de,eb as U,ed as Su,f as Me,fb as su,g as La,gb as cu,h as Ha,ha as J,hb as ht,i as Wd,ia as ut,ib as w,ic as mu,j as Lc,ja as Ye,jb as cn,jc as Eo,k as yt,ka as ci,kb as Ae,l as Tt,m as Gd,ma as tu,mb as Ht,mc as So,p as Se,pb as Fc,q as $d,qb as Uc,r as yo,ra as pr,rb as f,sa as b,sb as C,ta as R,tb as K,tc as Ft,ua as nu,ub as lu,v as To,vb as ae,w as Yd,wa as ru,x as jd,xa as On,xb as O,xc as pu,y as Pt,yb as S,z as $e,za as q}from"./chunk-ZDBO6E4J.mjs";import{a as _,b as z,d as vt,f as Ot,h as vo,i as h}from"./chunk-AYA2QI3U.mjs";var ug=function(){function r(){}return r.prototype.getAllStyles=function(e){return window.getComputedStyle(e)},r.prototype.getStyle=function(e,t){return this.getAllStyles(e)[t]},r.prototype.isStaticPositioned=function(e){return(this.getStyle(e,"position")||"static")==="static"},r.prototype.offsetParent=function(e){for(var t=e.offsetParent||document.documentElement;t&&t!==document.documentElement&&this.isStaticPositioned(t);)t=t.offsetParent;return t||document.documentElement},r.prototype.position=function(e,t){t===void 0&&(t=!0);var n,i={width:0,height:0,top:0,bottom:0,left:0,right:0};if(this.getStyle(e,"position")==="fixed")n=e.getBoundingClientRect(),n={top:n.top,bottom:n.bottom,left:n.left,right:n.right,height:n.height,width:n.width};else{var o=this.offsetParent(e);n=this.offset(e,!1),o!==document.documentElement&&(i=this.offset(o,!1)),i.top+=o.clientTop,i.left+=o.clientLeft}return n.top-=i.top,n.bottom-=i.top,n.left-=i.left,n.right-=i.left,t&&(n.top=Math.round(n.top),n.bottom=Math.round(n.bottom),n.left=Math.round(n.left),n.right=Math.round(n.right)),n},r.prototype.offset=function(e,t){t===void 0&&(t=!0);var n=e.getBoundingClientRect(),i={top:window.pageYOffset-document.documentElement.clientTop,left:window.pageXOffset-document.documentElement.clientLeft},o={height:n.height||e.offsetHeight,width:n.width||e.offsetWidth,top:n.top+i.top,bottom:n.bottom+i.top,left:n.left+i.left,right:n.right+i.left};return t&&(o.height=Math.round(o.height),o.width=Math.round(o.width),o.top=Math.round(o.top),o.bottom=Math.round(o.bottom),o.left=Math.round(o.left),o.right=Math.round(o.right)),o},r.prototype.positionElements=function(e,t,n,i){var o=n.split("-"),a=o[0],s=a===void 0?"top":a,c=o[1],l=c===void 0?"center":c,u=i?this.offset(e,!1):this.position(e,!1),m=this.getAllStyles(t),v=parseFloat(m.marginTop),g=parseFloat(m.marginBottom),A=parseFloat(m.marginLeft),k=parseFloat(m.marginRight),M=0,B=0;switch(s){case"top":M=u.top-(t.offsetHeight+v+g);break;case"bottom":M=u.top+u.height;break;case"left":B=u.left-(t.offsetWidth+A+k);break;case"right":B=u.left+u.width;break}switch(l){case"top":M=u.top;break;case"bottom":M=u.top+u.height-t.offsetHeight;break;case"left":B=u.left;break;case"right":B=u.left+u.width-t.offsetWidth;break;case"center":s==="top"||s==="bottom"?B=u.left+u.width/2-t.offsetWidth/2:M=u.top+u.height/2-t.offsetHeight/2;break}t.style.transform="translate("+Math.round(B)+"px, "+Math.round(M)+"px)";var W=t.getBoundingClientRect(),V=document.documentElement,X=window.innerHeight||V.clientHeight,te=window.innerWidth||V.clientWidth;return W.left>=0&&W.top>=0&&W.right<=te&&W.bottom<=X},r}();var hg=/\s+/,Ju=new ug;function jc(r,e,t,n,i){var o=Array.isArray(t)?t:t.split(hg),a=["top","bottom","left","right","top-left","top-right","bottom-left","bottom-right","left-top","left-bottom","right-top","right-bottom"],s=e.classList,c=function(M){var B=M.split("-"),W=B[0],V=B[1],X=[];return i&&(X.push(i+"-"+W),V&&X.push(i+"-"+W+"-"+V),X.forEach(function(te){s.add(te)})),X};i&&a.forEach(function(M){s.remove(i+"-"+M)});var l=o.findIndex(function(M){return M==="auto"});l>=0&&a.forEach(function(M){o.find(function(B){return B.search("^"+M)!==-1})==null&&o.splice(l++,1,M)});var u=e.style;u.position="absolute",u.top="0",u.left="0",u["will-change"]="transform";for(var m,v=!1,g=0,A=o;g<A.length;g++){m=A[g];var k=c(m);if(Ju.positionElements(r,e,m,n)){v=!0;break}i&&k.forEach(function(M){s.remove(M)})}return v||(m=o[0],c(m),Ju.positionElements(r,e,m,n)),m}var Bt=function(){return Bt=Object.assign||function(r){for(var e,t=1,n=arguments.length;t<n;t++){e=arguments[t];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(r[i]=e[i])}return r},Bt.apply(this,arguments)},Qc=function(r,e,t){if(t||arguments.length===2)for(var n=0,i=e.length,o;n<i;n++)(o||!(n in e))&&(o||(o=Array.prototype.slice.call(e,0,n)),o[n]=e[n]);return r.concat(o||Array.prototype.slice.call(e))},rs=function(r){return r[r.SUNDAY=0]="SUNDAY",r[r.MONDAY=1]="MONDAY",r[r.TUESDAY=2]="TUESDAY",r[r.WEDNESDAY=3]="WEDNESDAY",r[r.THURSDAY=4]="THURSDAY",r[r.FRIDAY=5]="FRIDAY",r[r.SATURDAY=6]="SATURDAY",r}(rs||{}),mg=[rs.SUNDAY,rs.SATURDAY],Xc=7,Jc=24,ts=60,Un=60*60*24;function Zu(r,e){var t=e.startDate,n=e.seconds,i=e.excluded,o=e.precision;if(i.length<1)return 0;for(var a=r.addSeconds,s=r.getDay,c=r.addDays,l=a(t,n-1),u=s(t),m=s(l),v=0,g=t,A=function(){var k=s(g);i.some(function(M){return M===k})&&(v+=pg(r,{dayStart:u,dayEnd:m,day:k,precision:o,startDate:t,endDate:l})),g=c(g,1)};g<l;)A();return v}function pg(r,e){var t=e.precision,n=e.day,i=e.dayStart,o=e.dayEnd,a=e.startDate,s=e.endDate,c=r.differenceInSeconds,l=r.endOfDay,u=r.startOfDay;if(t==="minutes"){if(n===i)return c(l(a),a)+1;if(n===o)return c(s,u(s))+1}return Un}function gg(r,e){var t=e.event,n=e.offset,i=e.startOfWeekDate,o=e.excluded,a=e.precision,s=e.totalDaysInView,c=r.max,l=r.differenceInSeconds,u=r.addDays,m=r.endOfDay,v=r.differenceInDays,g=Un,A=c([t.start,i]);if(t.end)switch(a){case"minutes":g=l(t.end,A);break;default:g=v(u(m(t.end),1),A)*Un;break}var k=n*Un,M=k+g,B=s*Un;return M>B&&(g=B-k),g-=Zu(r,{startDate:A,seconds:g,excluded:o,precision:a}),g/Un}function fg(r,e){var t=e.event,n=e.startOfWeek,i=e.excluded,o=e.precision,a=r.differenceInDays,s=r.startOfDay,c=r.differenceInSeconds;if(t.start<n)return 0;var l=0;switch(o){case"days":l=a(s(t.start),n)*Un;break;case"minutes":l=c(t.start,n);break}return l-=Zu(r,{startDate:n,seconds:l,excluded:i,precision:o}),Math.abs(l/Un)}function Cg(r,e){var t=e.event,n=e.periodStart,i=e.periodEnd,o=r.isSameSecond,a=t.start,s=t.end||t.start;return!!(a>n&&a<i||s>n&&s<i||a<n&&s>i||o(a,n)||o(a,i)||o(s,n)||o(s,i))}function ko(r,e){var t=e.events,n=e.periodStart,i=e.periodEnd;return t.filter(function(o){return Cg(r,{event:o,periodStart:n,periodEnd:i})})}function eh(r,e){var t=e.date,n=e.weekendDays,i=n===void 0?mg:n,o=r.startOfDay,a=r.isSameDay,s=r.getDay,c=o(new Date),l=s(t);return{date:t,day:l,isPast:t<c,isToday:a(t,c),isFuture:t>c,isWeekend:i.indexOf(l)>-1}}function as(r,e){for(var t=e.viewDate,n=e.weekStartsOn,i=e.excluded,o=i===void 0?[]:i,a=e.weekendDays,s=e.viewStart,c=s===void 0?r.startOfWeek(t,{weekStartsOn:n}):s,l=e.viewEnd,u=l===void 0?r.addDays(c,Xc):l,m=r.addDays,v=r.getDay,g=[],A=c;A<u;)o.some(function(k){return v(A)===k})||g.push(eh(r,{date:A,weekendDays:a})),A=m(A,1);return g}function vg(r,e){for(var t=e.date1,n=e.date2,i=e.excluded,o=t,a=0;o<n;)i.indexOf(r.getDay(o))===-1&&a++,o=r.addDays(o,1);return a}function yg(r,e){var t=e.events,n=t===void 0?[]:t,i=e.excluded,o=i===void 0?[]:i,a=e.precision,s=a===void 0?"days":a,c=e.absolutePositionedEvents,l=c===void 0?!1:c,u=e.viewStart,m=e.viewEnd;u=r.startOfDay(u),m=r.endOfDay(m);var v=r.differenceInSeconds,g=r.differenceInDays,A=vg(r,{date1:u,date2:m,excluded:o}),k=g(m,u)+1,M=n.filter(function(V){return V.allDay}).map(function(V){var X=fg(r,{event:V,startOfWeek:u,excluded:o,precision:s}),te=gg(r,{event:V,offset:X,startOfWeekDate:u,excluded:o,precision:s,totalDaysInView:k});return{event:V,offset:X,span:te}}).filter(function(V){return V.offset<A}).filter(function(V){return V.span>0}).map(function(V){return{event:V.event,offset:V.offset,span:V.span,startsBeforeWeek:V.event.start<u,endsAfterWeek:(V.event.end||V.event.start)>m}}).sort(function(V,X){var te=v(V.event.start,X.event.start);return te===0?v(X.event.end||X.event.start,V.event.end||V.event.start):te}),B=[],W=[];return M.forEach(function(V,X){if(W.indexOf(V)===-1){W.push(V);var te=V.span+V.offset,ye=M.slice(X+1).filter(function(Z){if(Z.offset>=te&&te+Z.span<=k&&W.indexOf(Z)===-1){var oe=Z.offset-te;return l||(Z.offset=oe),te+=Z.span+oe,W.push(Z),!0}}),Fe=Qc([V],ye,!0),se=Fe.filter(function(Z){return Z.event.id}).map(function(Z){return Z.event.id}).join("-");B.push(Bt({row:Fe},se?{id:se}:{}))}}),B}function Tg(r,e){var t=e.events,n=e.viewDate,i=e.hourSegments,o=e.hourDuration,a=e.dayStart,s=e.dayEnd,c=e.weekStartsOn,l=e.excluded,u=e.weekendDays,m=e.segmentHeight,v=e.viewStart,g=e.viewEnd,A=e.minimumEventHeight,k=_g(r,{viewDate:n,hourSegments:i,hourDuration:o,dayStart:a,dayEnd:s}),M=as(r,{viewDate:n,weekStartsOn:c,excluded:l,weekendDays:u,viewStart:v,viewEnd:g}),B=r.setHours,W=r.setMinutes,V=r.getHours,X=r.getMinutes;return M.map(function(te){var ye=wg(r,{events:t,viewDate:te.date,hourSegments:i,dayStart:a,dayEnd:s,segmentHeight:m,eventWidth:1,hourDuration:o,minimumEventHeight:A}),Fe=k.map(function(oe){var L=oe.segments.map(function(P){var Te=W(B(te.date,V(P.date)),X(P.date));return Bt(Bt({},P),{date:Te})});return Bt(Bt({},oe),{segments:L})});function se(oe,L){var P=Math.max.apply(Math,L.map(function(ge){return ge.left+1})),Te=oe.filter(function(ge){return ge.left>=P}).filter(function(ge){return ns(L,ge.top,ge.top+ge.height).length>0});return Te.length>0?se(oe,Te):P}var Z=ye.events.map(function(oe){var L=se(ye.events,ns(ye.events,oe.top,oe.top+oe.height)),P=100/L;return Bt(Bt({},oe),{left:oe.left*P,width:P})});return{hours:Fe,date:te.date,events:Z.map(function(oe){var L=ns(Z.filter(function(P){return P.left>oe.left}),oe.top,oe.top+oe.height);return L.length>0?Bt(Bt({},oe),{width:Math.min.apply(Math,L.map(function(P){return P.left}))-oe.left}):oe})}})}function th(r,e){var t=e.events,n=t===void 0?[]:t,i=e.viewDate,o=e.weekStartsOn,a=e.excluded,s=a===void 0?[]:a,c=e.precision,l=c===void 0?"days":c,u=e.absolutePositionedEvents,m=u===void 0?!1:u,v=e.hourSegments,g=e.hourDuration,A=e.dayStart,k=e.dayEnd,M=e.weekendDays,B=e.segmentHeight,W=e.minimumEventHeight,V=e.viewStart,X=V===void 0?r.startOfWeek(i,{weekStartsOn:o}):V,te=e.viewEnd,ye=te===void 0?r.endOfWeek(i,{weekStartsOn:o}):te;n||(n=[]);var Fe=r.startOfDay,se=r.endOfDay;X=Fe(X),ye=se(ye);var Z=ko(r,{events:n,periodStart:X,periodEnd:ye}),oe=as(r,{viewDate:i,weekStartsOn:o,excluded:s,weekendDays:M,viewStart:X,viewEnd:ye});return{allDayEventRows:yg(r,{events:Z,excluded:s,precision:l,absolutePositionedEvents:m,viewStart:X,viewEnd:ye}),period:{events:Z,start:oe[0].date,end:se(oe[oe.length-1].date)},hourColumns:Tg(r,{events:n,viewDate:i,hourSegments:v,hourDuration:g,dayStart:A,dayEnd:k,weekStartsOn:o,excluded:s,weekendDays:M,segmentHeight:B,viewStart:X,viewEnd:ye,minimumEventHeight:W})}}function nh(r,e){var t=e.events,n=t===void 0?[]:t,i=e.viewDate,o=e.weekStartsOn,a=e.excluded,s=a===void 0?[]:a,c=e.viewStart,l=c===void 0?r.startOfMonth(i):c,u=e.viewEnd,m=u===void 0?r.endOfMonth(i):u,v=e.weekendDays;n||(n=[]);for(var g=r.startOfWeek,A=r.endOfWeek,k=r.differenceInDays,M=r.startOfDay,B=r.addHours,W=r.endOfDay,V=r.isSameMonth,X=r.getDay,te=g(l,{weekStartsOn:o}),ye=A(m,{weekStartsOn:o}),Fe=ko(r,{events:n,periodStart:te,periodEnd:ye}),se=[],Z,oe=function(Pc){var Ge;if(Z?(Ge=M(B(Z,Jc)),Z.getTime()===Ge.getTime()&&(Ge=M(B(Z,Jc+1))),Z=Ge):Ge=Z=te,!s.some(function(Nc){return X(Ge)===Nc})){var si=eh(r,{date:Ge,weekendDays:v}),Mt=ko(r,{events:Fe,periodStart:M(Ge),periodEnd:W(Ge)});si.inMonth=V(Ge,i),si.events=Mt,si.badgeTotal=Mt.length,se.push(si)}},L=0;L<k(ye,te)+1;L++)oe(L);var P=[],Te=Xc-s.length;if(Te<Xc)for(var L=0;L<se.length;L+=Te){var ge=se.slice(L,L+Te),Mc=ge.some(function(Ge){return l<=Ge.date&&Ge.date<m});Mc&&(P=Qc(Qc([],P,!0),ge,!0))}else P=se;for(var Oc=Math.floor(P.length/Te),xa=[],L=0;L<Oc;L++)xa.push(L*Te);return{rowOffsets:xa,totalDaysVisibleInWeek:Te,days:P,period:{start:P[0].date,end:W(P[P.length-1].date),events:Fe}}}function ns(r,e,t){return r.filter(function(n){var i=n.top,o=n.top+n.height;return e<o&&o<t||e<i&&i<t?!0:i<=e&&t<=o})}function wg(r,e){var t=e.events,n=e.viewDate,i=e.hourSegments,o=e.dayStart,a=e.dayEnd,s=e.eventWidth,c=e.segmentHeight,l=e.hourDuration,u=e.minimumEventHeight,m=r.setMinutes,v=r.setHours,g=r.startOfDay,A=r.startOfMinute,k=r.endOfDay,M=r.differenceInMinutes,B=m(v(g(n),is(o.hour)),os(o.minute)),W=m(v(A(k(n)),is(a.hour)),os(a.minute));W.setSeconds(59,999);var V=[],X=ko(r,{events:t.filter(function(se){return!se.allDay}),periodStart:B,periodEnd:W}),te=X.sort(function(se,Z){return se.start.valueOf()-Z.start.valueOf()}).map(function(se){var Z=se.start,oe=se.end||Z,L=Z<B,P=oe>W,Te=i*c/(l||ts),ge=0;if(Z>B){var Mc=r.getTimezoneOffset(Z),Oc=r.getTimezoneOffset(B),xa=Oc-Mc;ge+=M(Z,B)+xa}ge*=Te,ge=Math.floor(ge);var Pc=L?B:Z,Ge=P?W:oe,si=r.getTimezoneOffset(Pc)-r.getTimezoneOffset(Ge),Mt=M(Ge,Pc)+si;se.end?Mt*=Te:Mt=c,u&&Mt<u&&(Mt=u),Mt=Math.floor(Mt);for(var Nc=ge+Mt,lg=ns(V,ge,Nc),xc=0;lg.some(function(dg){return dg.left===xc});)xc+=s;var qd={event:se,height:Mt,width:s,top:ge,left:xc,startsBeforeDay:L,endsAfterDay:P};return V.push(qd),qd}),ye=Math.max.apply(Math,te.map(function(se){return se.left+se.width})),Fe=ko(r,{events:t.filter(function(se){return se.allDay}),periodStart:g(B),periodEnd:k(W)});return{events:te,width:ye,allDayEvents:Fe,period:{events:X,start:B,end:W}}}function is(r){return Math.max(Math.min(23,r),0)}function os(r){return Math.max(Math.min(59,r),0)}function _g(r,e){var t=e.viewDate,n=e.hourSegments,i=e.hourDuration,o=e.dayStart,a=e.dayEnd,s=r.setMinutes,c=r.setHours,l=r.startOfDay,u=r.startOfMinute,m=r.endOfDay,v=r.addMinutes,g=r.addDays,A=[],k=s(c(l(t),is(o.hour)),os(o.minute)),M=s(c(u(m(t)),is(a.hour)),os(a.minute)),B=(i||ts)/n,W=l(t),V=m(t),X=function(oe){return oe};r.getTimezoneOffset(W)!==r.getTimezoneOffset(V)&&(W=g(W,1),k=g(k,1),M=g(M,1),X=function(oe){return g(oe,-1)});for(var te=i?Jc*60/i:ts,ye=0;ye<te;ye++){for(var Fe=[],se=0;se<n;se++){var Z=v(v(k,ye*(i||ts)),se*B);Z>=k&&Z<M&&Fe.push({date:X(Z),displayDate:Z,isStart:se===0})}Fe.length>0&&A.push({segments:Fe})}return A}var mi=function(r){return r.NotArray="Events must be an array",r.StartPropertyMissing="Event is missing the `start` property",r.StartPropertyNotDate="Event `start` property should be a javascript date object. Do `new Date(event.start)` to fix it.",r.EndPropertyNotDate="Event `end` property should be a javascript date object. Do `new Date(event.end)` to fix it.",r.EndsBeforeStart="Event `start` property occurs after the `end`",r}(mi||{});function rh(r,e){var t=!0;function n(i,o){e(i,o),t=!1}return Array.isArray(r)?(r.forEach(function(i){i.start?i.start instanceof Date||n(mi.StartPropertyNotDate,i):n(mi.StartPropertyMissing,i),i.end&&(i.end instanceof Date||n(mi.EndPropertyNotDate,i),i.start>i.end&&n(mi.EndsBeforeStart,i))}),t):(e(mi.NotArray,r),!1)}function Eg(r,e){return typeof r>"u"?typeof e>"u"?r:e:r}function nl(r,e){return r=Eg(r,e),typeof r=="function"?function(){for(var n=arguments,i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=n[a];return!!r.apply(this,o)}:r?function(){return!0}:function(){return!1}}var Zc=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol?"symbol":typeof r},oh=function(r){return r!=null&&(typeof r>"u"?"undefined":Zc(r))==="object"&&r.nodeType===1&&Zc(r.style)==="object"&&Zc(r.ownerDocument)==="object"};function ah(r,e){if(e=ol(e,!0),!oh(e))return-1;for(var t=0;t<r.length;t++)if(r[t]===e)return t;return-1}function rl(r,e){return ah(r,e)!==-1}function Sg(r,e){for(var t=0;t<e.length;t++)rl(r,e[t])||r.push(e[t]);return e}function Ag(r){for(var e=arguments,t=[],n=arguments.length-1;n-- >0;)t[n]=e[n+1];return t=t.map(ol),Sg(r,t)}function Ig(r){for(var e=arguments,t=[],n=arguments.length-1;n-- >0;)t[n]=e[n+1];return t.map(ol).reduce(function(i,o){var a=ah(r,o);return a!==-1?i.concat(r.splice(a,1)):i},[])}function ol(r,e){if(typeof r=="string")try{return document.querySelector(r)}catch(t){throw t}if(!oh(r)&&!e)throw new TypeError(r+" is not a DOM element.");return r}function kg(r,e){e=e||{};var t=nl(e.allowUpdate,!0);return function(i){if(i=i||window.event,r.target=i.target||i.srcElement||i.originalTarget,r.element=this,r.type=i.type,!!t(i)){if(i.targetTouches)r.x=i.targetTouches[0].clientX,r.y=i.targetTouches[0].clientY,r.pageX=i.targetTouches[0].pageX,r.pageY=i.targetTouches[0].pageY,r.screenX=i.targetTouches[0].screenX,r.screenY=i.targetTouches[0].screenY;else{if(i.pageX===null&&i.clientX!==null){var o=i.target&&i.target.ownerDocument||document,a=o.documentElement,s=o.body;r.pageX=i.clientX+(a&&a.scrollLeft||s&&s.scrollLeft||0)-(a&&a.clientLeft||s&&s.clientLeft||0),r.pageY=i.clientY+(a&&a.scrollTop||s&&s.scrollTop||0)-(a&&a.clientTop||s&&s.clientTop||0)}else r.pageX=i.pageX,r.pageY=i.pageY;r.x=i.clientX,r.y=i.clientY,r.screenX=i.screenX,r.screenY=i.screenY}r.clientX=r.x,r.clientY=r.y}}}function bg(){var r={top:{value:0,enumerable:!0},left:{value:0,enumerable:!0},right:{value:window.innerWidth,enumerable:!0},bottom:{value:window.innerHeight,enumerable:!0},width:{value:window.innerWidth,enumerable:!0},height:{value:window.innerHeight,enumerable:!0},x:{value:0,enumerable:!0},y:{value:0,enumerable:!0}};if(Object.create)return Object.create({},r);var e={};return Object.defineProperties(e,r),e}function sh(r){if(r===window)return bg();try{var e=r.getBoundingClientRect();return e.x===void 0&&(e.x=e.left,e.y=e.top),e}catch{throw new TypeError("Can't call getBoundingClientRect on "+r)}}function Rg(r,e){var t=sh(e);return r.y>t.top&&r.y<t.bottom&&r.x>t.left&&r.x<t.right}var il=void 0;typeof Object.create!="function"?il=function(r){var e=function(){};return function(t,n){if(t!==Object(t)&&t!==null)throw TypeError("Argument must be an object, or null");e.prototype=t||{};var i=new e;return e.prototype=null,n!==r&&Object.defineProperties(i,n),t===null&&(i.__proto__=null),i}}():il=Object.create;var Dg=il,fr=["altKey","button","buttons","clientX","clientY","ctrlKey","metaKey","movementX","movementY","offsetX","offsetY","pageX","pageY","region","relatedTarget","screenX","screenY","shiftKey","which","x","y"];function Mg(r){var e={screenX:0,screenY:0,clientX:0,clientY:0,ctrlKey:!1,shiftKey:!1,altKey:!1,metaKey:!1,button:0,buttons:1,relatedTarget:null,region:null};r!==void 0&&r.addEventListener("mousemove",t);function t(o){for(var a=0;a<fr.length;a++)e[fr[a]]=o[fr[a]]}var n=function(){if(MouseEvent)return function(a,s,c){var l=new MouseEvent("mousemove",el(e,s));return tl(l,c),a.dispatchEvent(l)};if(typeof document.createEvent=="function")return function(a,s,c){var l=el(e,s),u=document.createEvent("MouseEvents");return u.initMouseEvent("mousemove",!0,!0,window,0,l.screenX,l.screenY,l.clientX,l.clientY,l.ctrlKey,l.altKey,l.shiftKey,l.metaKey,l.button,l.relatedTarget),tl(u,c),a.dispatchEvent(u)};if(typeof document.createEventObject=="function")return function(a,s,c){var l=document.createEventObject(),u=el(e,s);for(var m in u)l[m]=u[m];return tl(l,c),a.dispatchEvent(l)}}();function i(){r&&r.removeEventListener("mousemove",t,!1),e=null}return{destroy:i,dispatch:n}}function el(r,e){e=e||{};for(var t=Dg(r),n=0;n<fr.length;n++)e[fr[n]]!==void 0&&(t[fr[n]]=e[fr[n]]);return t}function tl(r,e){console.log("data ",e),r.data=e||{},r.dispatched="mousemove"}var Ro=["webkit","moz","ms","o"],bo=function(){if(typeof window>"u")return function(){};for(var r=0,e=Ro.length;r<e&&!window.requestAnimationFrame;++r)window.requestAnimationFrame=window[Ro[r]+"RequestAnimationFrame"];if(!window.requestAnimationFrame){var t=0;window.requestAnimationFrame=function(n){var i=new Date().getTime(),o=Math.max(0,16-i-t),a=window.setTimeout(function(){return n(i+o)},o);return t=i+o,a}}return window.requestAnimationFrame.bind(window)}(),pi=function(){if(typeof window>"u")return function(){};for(var r=0,e=Ro.length;r<e&&!window.cancelAnimationFrame;++r)window.cancelAnimationFrame=window[Ro[r]+"CancelAnimationFrame"]||window[Ro[r]+"CancelRequestAnimationFrame"];return window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){window.clearTimeout(t)}),window.cancelAnimationFrame.bind(window)}();function Og(r,e){e===void 0&&(e={});var t=this,n=4,i=!1;if(typeof e.margin!="object"){var o=e.margin||-1;this.margin={left:o,right:o,top:o,bottom:o}}else this.margin=e.margin;this.scrollWhenOutside=e.scrollWhenOutside||!1;var a={},s=kg(a),c=Mg(),l=!1;window.addEventListener("mousemove",s,!1),window.addEventListener("touchmove",s,!1),isNaN(e.maxSpeed)||(n=e.maxSpeed),typeof n!="object"&&(n={left:n,right:n,top:n,bottom:n}),this.autoScroll=nl(e.autoScroll),this.syncMove=nl(e.syncMove,!1),this.destroy=function(L){window.removeEventListener("mousemove",s,!1),window.removeEventListener("touchmove",s,!1),window.removeEventListener("mousedown",k,!1),window.removeEventListener("touchstart",k,!1),window.removeEventListener("mouseup",M,!1),window.removeEventListener("touchend",M,!1),window.removeEventListener("pointerup",M,!1),window.removeEventListener("mouseleave",W,!1),window.removeEventListener("mousemove",te,!1),window.removeEventListener("touchmove",te,!1),window.removeEventListener("scroll",A,!0),r=[],L&&B()},this.add=function(){for(var L=[],P=arguments.length;P--;)L[P]=arguments[P];return Ag.apply(void 0,[r].concat(L)),this},this.remove=function(){for(var L=[],P=arguments.length;P--;)L[P]=arguments[P];return Ig.apply(void 0,[r].concat(L))};var u=null,m;Object.prototype.toString.call(r)!=="[object Array]"&&(r=[r]),function(L){r=[],L.forEach(function(P){P===window?u=window:t.add(P)})}(r),Object.defineProperties(this,{down:{get:function(){return l}},maxSpeed:{get:function(){return n}},point:{get:function(){return a}},scrolling:{get:function(){return i}}});var v=null,g;window.addEventListener("mousedown",k,!1),window.addEventListener("touchstart",k,!1),window.addEventListener("mouseup",M,!1),window.addEventListener("touchend",M,!1),window.addEventListener("pointerup",M,!1),window.addEventListener("mousemove",te,!1),window.addEventListener("touchmove",te,!1),window.addEventListener("mouseleave",W,!1),window.addEventListener("scroll",A,!0);function A(L){for(var P=0;P<r.length;P++)if(r[P]===L.target){i=!0;break}i&&bo(function(){return i=!1})}function k(){l=!0}function M(){l=!1,B()}function B(){pi(g),pi(m)}function W(){l=!1}function V(L){if(!L)return null;if(v===L||rl(r,L))return L;for(;L=L.parentNode;)if(rl(r,L))return L;return null}function X(){for(var L=null,P=0;P<r.length;P++)ih(a,r[P])&&(L=r[P]);return L}function te(L){if(t.autoScroll()&&!L.dispatched){var P=L.target,Te=document.body;v&&!ih(a,v)&&(t.scrollWhenOutside||(v=null)),P&&P.parentNode===Te?P=X():(P=V(P),P||(P=X())),P&&P!==v&&(v=P),u&&(pi(m),m=bo(ye)),v&&(pi(g),g=bo(Fe))}}function ye(){se(u),pi(m),m=bo(ye)}function Fe(){v&&(se(v),pi(g),g=bo(Fe))}function se(L){var P=sh(L),Te,ge;a.x<P.left+t.margin.left?Te=Math.floor(Math.max(-1,(a.x-P.left)/t.margin.left-1)*t.maxSpeed.left):a.x>P.right-t.margin.right?Te=Math.ceil(Math.min(1,(a.x-P.right)/t.margin.right+1)*t.maxSpeed.right):Te=0,a.y<P.top+t.margin.top?ge=Math.floor(Math.max(-1,(a.y-P.top)/t.margin.top-1)*t.maxSpeed.top):a.y>P.bottom-t.margin.bottom?ge=Math.ceil(Math.min(1,(a.y-P.bottom)/t.margin.bottom+1)*t.maxSpeed.bottom):ge=0,t.syncMove()&&c.dispatch(L,{pageX:a.pageX+Te,pageY:a.pageY+ge,clientX:a.x+Te,clientY:a.y+ge}),setTimeout(function(){ge&&Z(L,ge),Te&&oe(L,Te)})}function Z(L,P){L===window?window.scrollTo(L.pageXOffset,L.pageYOffset+P):L.scrollTop+=P}function oe(L,P){L===window?window.scrollTo(L.pageXOffset+P,L.pageYOffset):L.scrollLeft+=P}}function Pg(r,e){return new Og(r,e)}function ih(r,e,t){return t?r.y>t.top&&r.y<t.bottom&&r.x>t.left&&r.x<t.right:Rg(r,e)}var ch=Pg;function al(r,e,t){t&&t.split(" ").forEach(n=>r.addClass(e.nativeElement,n))}function ss(r,e,t){t&&t.split(" ").forEach(n=>r.removeClass(e.nativeElement,n))}var dh=(()=>{class r{constructor(){this.currentDrag=new Me}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=tt({token:r,factory:r.\u0275fac,providedIn:"root"}),r})(),uh=(()=>{class r{constructor(t){this.elementRef=t}}return r.\u0275fac=function(t){return new(t||r)(N(nt))},r.\u0275dir=Ye({type:r,selectors:[["","mwlDraggableScrollContainer",""]]}),r})(),cs=(()=>{class r{constructor(t,n,i,o,a,s,c){this.element=t,this.renderer=n,this.draggableHelper=i,this.zone=o,this.vcr=a,this.scrollContainer=s,this.document=c,this.dragAxis={x:!0,y:!0},this.dragSnapGrid={},this.ghostDragEnabled=!0,this.showOriginalElementWhileDragging=!1,this.dragCursor="",this.autoScroll={margin:20},this.dragPointerDown=new q,this.dragStart=new q,this.ghostElementCreated=new q,this.dragging=new q,this.dragEnd=new q,this.pointerDown$=new Me,this.pointerMove$=new Me,this.pointerUp$=new Me,this.eventListenerSubscriptions={},this.destroy$=new Me,this.timeLongPress={timerBegin:0,timerEnd:0}}ngOnInit(){this.checkEventListeners();let t=this.pointerDown$.pipe($e(()=>this.canDrag()),yo(n=>{n.event.stopPropagation&&!this.scrollContainer&&n.event.stopPropagation();let i=this.renderer.createElement("style");this.renderer.setAttribute(i,"type","text/css"),this.renderer.appendChild(i,this.renderer.createText(`
          body * {
           -moz-user-select: none;
           -ms-user-select: none;
           -webkit-user-select: none;
           user-select: none;
          }
        `)),requestAnimationFrame(()=>{this.document.head.appendChild(i)});let o=this.getScrollPosition(),a=new Dn(g=>{let A=this.scrollContainer?this.scrollContainer.elementRef.nativeElement:"window";return this.renderer.listen(A,"scroll",k=>g.next(k))}).pipe(Fa(o),Se(()=>this.getScrollPosition())),s=new Me,c=new Ha;this.dragPointerDown.observers.length>0&&this.zone.run(()=>{this.dragPointerDown.next({x:0,y:0})});let l=Pt(this.pointerUp$,this.pointerDown$,c,this.destroy$).pipe(xt()),u=$d([this.pointerMove$,a]).pipe(Se(([g,A])=>({currentDrag$:s,transformX:g.clientX-n.clientX,transformY:g.clientY-n.clientY,clientX:g.clientX,clientY:g.clientY,scrollLeft:A.left,scrollTop:A.top,target:g.event.target})),Se(g=>(this.dragSnapGrid.x&&(g.transformX=Math.round(g.transformX/this.dragSnapGrid.x)*this.dragSnapGrid.x),this.dragSnapGrid.y&&(g.transformY=Math.round(g.transformY/this.dragSnapGrid.y)*this.dragSnapGrid.y),g)),Se(g=>(this.dragAxis.x||(g.transformX=0),this.dragAxis.y||(g.transformY=0),g)),Se(g=>{let A=g.scrollLeft-o.left,k=g.scrollTop-o.top;return z(_({},g),{x:g.transformX+A,y:g.transformY+k})}),$e(({x:g,y:A,transformX:k,transformY:M})=>!this.validateDrag||this.validateDrag({x:g,y:A,transform:{x:k,y:M}})),Lt(l),xt()),m=u.pipe(Nt(1),xt()),v=u.pipe(Jd(1),xt());return m.subscribe(({clientX:g,clientY:A,x:k,y:M})=>{if(this.dragStart.observers.length>0&&this.zone.run(()=>{this.dragStart.next({cancelDrag$:c})}),this.scroller=ch([this.scrollContainer?this.scrollContainer.elementRef.nativeElement:this.document.defaultView],z(_({},this.autoScroll),{autoScroll(){return!0}})),al(this.renderer,this.element,this.dragActiveClass),this.ghostDragEnabled){let B=this.element.nativeElement.getBoundingClientRect(),W=this.element.nativeElement.cloneNode(!0);if(this.showOriginalElementWhileDragging||this.renderer.setStyle(this.element.nativeElement,"visibility","hidden"),this.ghostElementAppendTo?this.ghostElementAppendTo.appendChild(W):this.element.nativeElement.parentNode.insertBefore(W,this.element.nativeElement.nextSibling),this.ghostElement=W,this.document.body.style.cursor=this.dragCursor,this.setElementStyles(W,{position:"fixed",top:`${B.top}px`,left:`${B.left}px`,width:`${B.width}px`,height:`${B.height}px`,cursor:this.dragCursor,margin:"0",willChange:"transform",pointerEvents:"none"}),this.ghostElementTemplate){let V=this.vcr.createEmbeddedView(this.ghostElementTemplate);W.innerHTML="",V.rootNodes.filter(X=>X instanceof Node).forEach(X=>{W.appendChild(X)}),v.subscribe(()=>{this.vcr.remove(this.vcr.indexOf(V))})}this.ghostElementCreated.observers.length>0&&this.zone.run(()=>{this.ghostElementCreated.emit({clientX:g-k,clientY:A-M,element:W})}),v.subscribe(()=>{W.parentElement.removeChild(W),this.ghostElement=null,this.renderer.setStyle(this.element.nativeElement,"visibility","")})}this.draggableHelper.currentDrag.next(s)}),v.pipe(yo(g=>{let A=c.pipe(Qd(),Nt(1),Se(k=>z(_({},g),{dragCancelled:k>0})));return c.complete(),A})).subscribe(({x:g,y:A,dragCancelled:k})=>{this.scroller.destroy(),this.dragEnd.observers.length>0&&this.zone.run(()=>{this.dragEnd.next({x:g,y:A,dragCancelled:k})}),ss(this.renderer,this.element,this.dragActiveClass),s.complete()}),Pt(l,v).pipe(Nt(1)).subscribe(()=>{requestAnimationFrame(()=>{this.document.head.removeChild(i)})}),u}),xt());Pt(t.pipe(Nt(1),Se(n=>[,n])),t.pipe(_o())).pipe($e(([n,i])=>n?n.x!==i.x||n.y!==i.y:!0),Se(([n,i])=>i)).subscribe(({x:n,y:i,currentDrag$:o,clientX:a,clientY:s,transformX:c,transformY:l,target:u})=>{this.dragging.observers.length>0&&this.zone.run(()=>{this.dragging.next({x:n,y:i})}),requestAnimationFrame(()=>{if(this.ghostElement){let m=`translate3d(${c}px, ${l}px, 0px)`;this.setElementStyles(this.ghostElement,{transform:m,"-webkit-transform":m,"-ms-transform":m,"-moz-transform":m,"-o-transform":m})}}),o.next({clientX:a,clientY:s,dropData:this.dropData,target:u})})}ngOnChanges(t){t.dragAxis&&this.checkEventListeners()}ngOnDestroy(){this.unsubscribeEventListeners(),this.pointerDown$.complete(),this.pointerMove$.complete(),this.pointerUp$.complete(),this.destroy$.next()}checkEventListeners(){let t=this.canDrag(),n=Object.keys(this.eventListenerSubscriptions).length>0;t&&!n?this.zone.runOutsideAngular(()=>{this.eventListenerSubscriptions.mousedown=this.renderer.listen(this.element.nativeElement,"mousedown",i=>{this.onMouseDown(i)}),this.eventListenerSubscriptions.mouseup=this.renderer.listen("document","mouseup",i=>{this.onMouseUp(i)}),this.eventListenerSubscriptions.touchstart=this.renderer.listen(this.element.nativeElement,"touchstart",i=>{this.onTouchStart(i)}),this.eventListenerSubscriptions.touchend=this.renderer.listen("document","touchend",i=>{this.onTouchEnd(i)}),this.eventListenerSubscriptions.touchcancel=this.renderer.listen("document","touchcancel",i=>{this.onTouchEnd(i)}),this.eventListenerSubscriptions.mouseenter=this.renderer.listen(this.element.nativeElement,"mouseenter",()=>{this.onMouseEnter()}),this.eventListenerSubscriptions.mouseleave=this.renderer.listen(this.element.nativeElement,"mouseleave",()=>{this.onMouseLeave()})}):!t&&n&&this.unsubscribeEventListeners()}onMouseDown(t){t.button===0&&(this.eventListenerSubscriptions.mousemove||(this.eventListenerSubscriptions.mousemove=this.renderer.listen("document","mousemove",n=>{this.pointerMove$.next({event:n,clientX:n.clientX,clientY:n.clientY})})),this.pointerDown$.next({event:t,clientX:t.clientX,clientY:t.clientY}))}onMouseUp(t){t.button===0&&(this.eventListenerSubscriptions.mousemove&&(this.eventListenerSubscriptions.mousemove(),delete this.eventListenerSubscriptions.mousemove),this.pointerUp$.next({event:t,clientX:t.clientX,clientY:t.clientY}))}onTouchStart(t){let n,i,o;if(this.touchStartLongPress&&(this.timeLongPress.timerBegin=Date.now(),i=!1,o=this.hasScrollbar(),n=this.getScrollPosition()),!this.eventListenerSubscriptions.touchmove){let a=To(this.document,"contextmenu").subscribe(c=>{c.preventDefault()}),s=To(this.document,"touchmove",{passive:!1}).subscribe(c=>{this.touchStartLongPress&&!i&&o&&(i=this.shouldBeginDrag(t,c,n)),(!this.touchStartLongPress||!o||i)&&(c.preventDefault(),this.pointerMove$.next({event:c,clientX:c.targetTouches[0].clientX,clientY:c.targetTouches[0].clientY}))});this.eventListenerSubscriptions.touchmove=()=>{a.unsubscribe(),s.unsubscribe()}}this.pointerDown$.next({event:t,clientX:t.touches[0].clientX,clientY:t.touches[0].clientY})}onTouchEnd(t){this.eventListenerSubscriptions.touchmove&&(this.eventListenerSubscriptions.touchmove(),delete this.eventListenerSubscriptions.touchmove,this.touchStartLongPress&&this.enableScroll()),this.pointerUp$.next({event:t,clientX:t.changedTouches[0].clientX,clientY:t.changedTouches[0].clientY})}onMouseEnter(){this.setCursor(this.dragCursor)}onMouseLeave(){this.setCursor("")}canDrag(){return this.dragAxis.x||this.dragAxis.y}setCursor(t){this.eventListenerSubscriptions.mousemove||this.renderer.setStyle(this.element.nativeElement,"cursor",t)}unsubscribeEventListeners(){Object.keys(this.eventListenerSubscriptions).forEach(t=>{this.eventListenerSubscriptions[t](),delete this.eventListenerSubscriptions[t]})}setElementStyles(t,n){Object.keys(n).forEach(i=>{this.renderer.setStyle(t,i,n[i])})}getScrollElement(){return this.scrollContainer?this.scrollContainer.elementRef.nativeElement:this.document.body}getScrollPosition(){return this.scrollContainer?{top:this.scrollContainer.elementRef.nativeElement.scrollTop,left:this.scrollContainer.elementRef.nativeElement.scrollLeft}:{top:window.pageYOffset||this.document.documentElement.scrollTop,left:window.pageXOffset||this.document.documentElement.scrollLeft}}shouldBeginDrag(t,n,i){let o=this.getScrollPosition(),a={top:Math.abs(o.top-i.top),left:Math.abs(o.left-i.left)},s=Math.abs(n.targetTouches[0].clientX-t.touches[0].clientX)-a.left,c=Math.abs(n.targetTouches[0].clientY-t.touches[0].clientY)-a.top,l=s+c,u=this.touchStartLongPress;return(l>u.delta||a.top>0||a.left>0)&&(this.timeLongPress.timerBegin=Date.now()),this.timeLongPress.timerEnd=Date.now(),this.timeLongPress.timerEnd-this.timeLongPress.timerBegin>=u.delay?(this.disableScroll(),!0):!1}enableScroll(){this.scrollContainer&&this.renderer.setStyle(this.scrollContainer.elementRef.nativeElement,"overflow",""),this.renderer.setStyle(this.document.body,"overflow","")}disableScroll(){this.scrollContainer&&this.renderer.setStyle(this.scrollContainer.elementRef.nativeElement,"overflow","hidden"),this.renderer.setStyle(this.document.body,"overflow","hidden")}hasScrollbar(){let t=this.getScrollElement(),n=t.scrollWidth>t.clientWidth,i=t.scrollHeight>t.clientHeight;return n||i}}return r.\u0275fac=function(t){return new(t||r)(N(nt),N($t),N(dh),N(sn),N(Va),N(uh,8),N(gr))},r.\u0275dir=Ye({type:r,selectors:[["","mwlDraggable",""]],inputs:{dropData:"dropData",dragAxis:"dragAxis",dragSnapGrid:"dragSnapGrid",ghostDragEnabled:"ghostDragEnabled",showOriginalElementWhileDragging:"showOriginalElementWhileDragging",validateDrag:"validateDrag",dragCursor:"dragCursor",dragActiveClass:"dragActiveClass",ghostElementAppendTo:"ghostElementAppendTo",ghostElementTemplate:"ghostElementTemplate",touchStartLongPress:"touchStartLongPress",autoScroll:"autoScroll"},outputs:{dragPointerDown:"dragPointerDown",dragStart:"dragStart",ghostElementCreated:"ghostElementCreated",dragging:"dragging",dragEnd:"dragEnd"},features:[pr]}),r})();function lh(r,e,t){return r>=t.left&&r<=t.right&&e>=t.top&&e<=t.bottom}var ls=(()=>{class r{constructor(t,n,i,o,a){this.element=t,this.draggableHelper=n,this.zone=i,this.renderer=o,this.scrollContainer=a,this.dragEnter=new q,this.dragLeave=new q,this.dragOver=new q,this.drop=new q}ngOnInit(){this.currentDragSubscription=this.draggableHelper.currentDrag.subscribe(t=>{al(this.renderer,this.element,this.dragActiveClass);let n={updateCache:!0},i=this.renderer.listen(this.scrollContainer?this.scrollContainer.elementRef.nativeElement:"window","scroll",()=>{n.updateCache=!0}),o,a=t.pipe(Se(({clientX:l,clientY:u,dropData:m,target:v})=>{o={clientX:l,clientY:u,dropData:m,target:v},n.updateCache&&(n.rect=this.element.nativeElement.getBoundingClientRect(),this.scrollContainer&&(n.scrollContainerRect=this.scrollContainer.elementRef.nativeElement.getBoundingClientRect()),n.updateCache=!1);let g=lh(l,u,n.rect),A=!this.validateDrop||this.validateDrop({clientX:l,clientY:u,target:v,dropData:m});return n.scrollContainerRect?g&&A&&lh(l,u,n.scrollContainerRect):g&&A})),s=a.pipe(Xd()),c;s.pipe($e(l=>l)).subscribe(()=>{c=!0,al(this.renderer,this.element,this.dragOverClass),this.dragEnter.observers.length>0&&this.zone.run(()=>{this.dragEnter.next(o)})}),a.pipe($e(l=>l)).subscribe(()=>{this.dragOver.observers.length>0&&this.zone.run(()=>{this.dragOver.next(o)})}),s.pipe(_o(),$e(([l,u])=>l&&!u)).subscribe(()=>{c=!1,ss(this.renderer,this.element,this.dragOverClass),this.dragLeave.observers.length>0&&this.zone.run(()=>{this.dragLeave.next(o)})}),t.subscribe({complete:()=>{i(),ss(this.renderer,this.element,this.dragActiveClass),c&&(ss(this.renderer,this.element,this.dragOverClass),this.drop.observers.length>0&&this.zone.run(()=>{this.drop.next(o)}))}})})}ngOnDestroy(){this.currentDragSubscription&&this.currentDragSubscription.unsubscribe()}}return r.\u0275fac=function(t){return new(t||r)(N(nt),N(dh),N(sn),N($t),N(uh,8))},r.\u0275dir=Ye({type:r,selectors:[["","mwlDroppable",""]],inputs:{dragOverClass:"dragOverClass",dragActiveClass:"dragActiveClass",validateDrop:"validateDrop"},outputs:{dragEnter:"dragEnter",dragLeave:"dragLeave",dragOver:"dragOver",drop:"drop"}}),r})(),Do=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({}),r})();var Cr=typeof window>"u"?!1:"ontouchstart"in window||navigator.maxTouchPoints>0||navigator.msMaxTouchPoints>0;function xg(r){let e=r.cloneNode(!0),t=e.querySelectorAll("[id]"),n=r.nodeName.toLowerCase();return e.removeAttribute("id"),t.forEach(i=>{i.removeAttribute("id")}),n==="canvas"?ph(r,e):(n==="input"||n==="select"||n==="textarea")&&mh(r,e),hh("canvas",r,e,ph),hh("input, textarea, select",r,e,mh),e}function hh(r,e,t,n){let i=e.querySelectorAll(r);if(i.length){let o=t.querySelectorAll(r);for(let a=0;a<i.length;a++)n(i[a],o[a])}}var Lg=0;function mh(r,e){e.type!=="file"&&(e.value=r.value),e.type==="radio"&&e.name&&(e.name=`mat-clone-${e.name}-${Lg++}`)}function ph(r,e){let t=e.getContext("2d");if(t)try{t.drawImage(r,0,0)}catch{}}function gh(r,e,t,n){let i={top:r.top,bottom:r.bottom,left:r.left,right:r.right};return e.top&&(i.top+=n),e.bottom&&(i.bottom+=n),e.left&&(i.left+=t),e.right&&(i.right+=t),i.height=i.bottom-i.top,i.width=i.right-i.left,i}function Hg(r,e){let t=0,n=0,i=r.nativeElement.style,a=["transform","-ms-transform","-moz-transform","-o-transform"].map(s=>i[s]).find(s=>!!s);if(a&&a.includes("translate")&&(t=a.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$1"),n=a.replace(/.*translate3?d?\((-?[0-9]*)px, (-?[0-9]*)px.*/,"$2")),e==="absolute")return{height:r.nativeElement.offsetHeight,width:r.nativeElement.offsetWidth,top:r.nativeElement.offsetTop-n,bottom:r.nativeElement.offsetHeight+r.nativeElement.offsetTop-n,left:r.nativeElement.offsetLeft-t,right:r.nativeElement.offsetWidth+r.nativeElement.offsetLeft-t};{let s=r.nativeElement.getBoundingClientRect();return{height:s.height,width:s.width,top:s.top-n,bottom:s.bottom-n,left:s.left-t,right:s.right-t,scrollTop:r.nativeElement.scrollTop,scrollLeft:r.nativeElement.scrollLeft}}}var fh=Object.freeze({topLeft:"nw-resize",topRight:"ne-resize",bottomLeft:"sw-resize",bottomRight:"se-resize",leftOrRight:"col-resize",topOrBottom:"row-resize"});function Ch(r,e){return r.left&&r.top?e.topLeft:r.right&&r.top?e.topRight:r.left&&r.bottom?e.bottomLeft:r.right&&r.bottom?e.bottomRight:r.left||r.right?e.leftOrRight:r.top||r.bottom?e.topOrBottom:""}function ds({edges:r,initialRectangle:e,newRectangle:t}){let n={};return Object.keys(r).forEach(i=>{n[i]=(t[i]||0)-(e[i]||0)}),n}var vh="resize-active",Fg="resize-ghost-element",Ug=50,cl=(()=>{class r{constructor(t,n,i,o){this.platformId=t,this.renderer=n,this.elm=i,this.zone=o,this.enableGhostResize=!1,this.resizeSnapGrid={},this.resizeCursors=fh,this.ghostElementPositioning="fixed",this.allowNegativeResizes=!1,this.mouseMoveThrottleMS=Ug,this.resizeStart=new q,this.resizing=new q,this.resizeEnd=new q,this.mouseup=new Me,this.mousedown=new Me,this.mousemove=new Me,this.destroy$=new Me,this.pointerEventListeners=sl.getInstance(n,o)}ngOnInit(){let t=Pt(this.pointerEventListeners.pointerDown,this.mousedown),n=Pt(this.pointerEventListeners.pointerMove,this.mousemove).pipe(Ua(({event:l})=>{o&&l.cancelable&&l.preventDefault()}),xt()),i=Pt(this.pointerEventListeners.pointerUp,this.mouseup),o,a=()=>{o&&o.clonedNode&&(this.elm.nativeElement.parentElement.removeChild(o.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","inherit"))},s=()=>_(_({},fh),this.resizeCursors);t.pipe(yo(l=>{function u(g){return{clientX:g.clientX-l.clientX,clientY:g.clientY-l.clientY}}let m=()=>{let g={x:1,y:1};return o&&(this.resizeSnapGrid.left&&o.edges.left?g.x=+this.resizeSnapGrid.left:this.resizeSnapGrid.right&&o.edges.right&&(g.x=+this.resizeSnapGrid.right),this.resizeSnapGrid.top&&o.edges.top?g.y=+this.resizeSnapGrid.top:this.resizeSnapGrid.bottom&&o.edges.bottom&&(g.y=+this.resizeSnapGrid.bottom)),g};function v(g,A){return{x:Math.ceil(g.clientX/A.x),y:Math.ceil(g.clientY/A.y)}}return Pt(n.pipe(Nt(1)).pipe(Se(g=>[,g])),n.pipe(_o())).pipe(Se(([g,A])=>[g&&u(g),u(A)])).pipe($e(([g,A])=>{if(!g)return!0;let k=m(),M=v(g,k),B=v(A,k);return M.x!==B.x||M.y!==B.y})).pipe(Se(([,g])=>{let A=m();return{clientX:Math.round(g.clientX/A.x)*A.x,clientY:Math.round(g.clientY/A.y)*A.y}})).pipe(Lt(Pt(i,t)))})).pipe($e(()=>!!o)).pipe(Se(({clientX:l,clientY:u})=>gh(o.startingRect,o.edges,l,u))).pipe($e(l=>this.allowNegativeResizes||!!(l.height&&l.width&&l.height>0&&l.width>0))).pipe($e(l=>this.validateResize?this.validateResize({rectangle:l,edges:ds({edges:o.edges,initialRectangle:o.startingRect,newRectangle:l})}):!0),Lt(this.destroy$)).subscribe(l=>{o&&o.clonedNode&&(this.renderer.setStyle(o.clonedNode,"height",`${l.height}px`),this.renderer.setStyle(o.clonedNode,"width",`${l.width}px`),this.renderer.setStyle(o.clonedNode,"top",`${l.top}px`),this.renderer.setStyle(o.clonedNode,"left",`${l.left}px`)),this.resizing.observers.length>0&&this.zone.run(()=>{this.resizing.emit({edges:ds({edges:o.edges,initialRectangle:o.startingRect,newRectangle:l}),rectangle:l})}),o.currentRect=l}),t.pipe(Se(({edges:l})=>l||{}),$e(l=>Object.keys(l).length>0),Lt(this.destroy$)).subscribe(l=>{o&&a();let u=Hg(this.elm,this.ghostElementPositioning);o={edges:l,startingRect:u,currentRect:u};let m=s(),v=Ch(o.edges,m);this.renderer.setStyle(document.body,"cursor",v),this.setElementClass(this.elm,vh,!0),this.enableGhostResize&&(o.clonedNode=xg(this.elm.nativeElement),this.elm.nativeElement.parentElement.appendChild(o.clonedNode),this.renderer.setStyle(this.elm.nativeElement,"visibility","hidden"),this.renderer.setStyle(o.clonedNode,"position",this.ghostElementPositioning),this.renderer.setStyle(o.clonedNode,"left",`${o.startingRect.left}px`),this.renderer.setStyle(o.clonedNode,"top",`${o.startingRect.top}px`),this.renderer.setStyle(o.clonedNode,"height",`${o.startingRect.height}px`),this.renderer.setStyle(o.clonedNode,"width",`${o.startingRect.width}px`),this.renderer.setStyle(o.clonedNode,"cursor",Ch(o.edges,m)),this.renderer.addClass(o.clonedNode,Fg),o.clonedNode.scrollTop=o.startingRect.scrollTop,o.clonedNode.scrollLeft=o.startingRect.scrollLeft),this.resizeStart.observers.length>0&&this.zone.run(()=>{this.resizeStart.emit({edges:ds({edges:l,initialRectangle:u,newRectangle:u}),rectangle:gh(u,{},0,0)})})}),i.pipe(Lt(this.destroy$)).subscribe(()=>{o&&(this.renderer.removeClass(this.elm.nativeElement,vh),this.renderer.setStyle(document.body,"cursor",""),this.renderer.setStyle(this.elm.nativeElement,"cursor",""),this.resizeEnd.observers.length>0&&this.zone.run(()=>{this.resizeEnd.emit({edges:ds({edges:o.edges,initialRectangle:o.startingRect,newRectangle:o.currentRect}),rectangle:o.currentRect})}),a(),o=null)})}ngOnDestroy(){yu(this.platformId)&&this.renderer.setStyle(document.body,"cursor",""),this.mousedown.complete(),this.mouseup.complete(),this.mousemove.complete(),this.destroy$.next()}setElementClass(t,n,i){i?this.renderer.addClass(t.nativeElement,n):this.renderer.removeClass(t.nativeElement,n)}}return r.\u0275fac=function(t){return new(t||r)(N(iu),N($t),N(nt),N(sn))},r.\u0275dir=Ye({type:r,selectors:[["","mwlResizable",""]],inputs:{validateResize:"validateResize",enableGhostResize:"enableGhostResize",resizeSnapGrid:"resizeSnapGrid",resizeCursors:"resizeCursors",ghostElementPositioning:"ghostElementPositioning",allowNegativeResizes:"allowNegativeResizes",mouseMoveThrottleMS:"mouseMoveThrottleMS"},outputs:{resizeStart:"resizeStart",resizing:"resizing",resizeEnd:"resizeEnd"},exportAs:["mwlResizable"]}),r})(),sl=class r{constructor(e,t){this.pointerDown=new Dn(n=>{let i,o;return t.runOutsideAngular(()=>{i=e.listen("document","mousedown",a=>{n.next({clientX:a.clientX,clientY:a.clientY,event:a})}),Cr&&(o=e.listen("document","touchstart",a=>{n.next({clientX:a.touches[0].clientX,clientY:a.touches[0].clientY,event:a})}))}),()=>{i(),Cr&&o()}}).pipe(xt()),this.pointerMove=new Dn(n=>{let i,o;return t.runOutsideAngular(()=>{i=e.listen("document","mousemove",a=>{n.next({clientX:a.clientX,clientY:a.clientY,event:a})}),Cr&&(o=e.listen("document","touchmove",a=>{n.next({clientX:a.targetTouches[0].clientX,clientY:a.targetTouches[0].clientY,event:a})}))}),()=>{i(),Cr&&o()}}).pipe(xt()),this.pointerUp=new Dn(n=>{let i,o,a;return t.runOutsideAngular(()=>{i=e.listen("document","mouseup",s=>{n.next({clientX:s.clientX,clientY:s.clientY,event:s})}),Cr&&(o=e.listen("document","touchend",s=>{n.next({clientX:s.changedTouches[0].clientX,clientY:s.changedTouches[0].clientY,event:s})}),a=e.listen("document","touchcancel",s=>{n.next({clientX:s.changedTouches[0].clientX,clientY:s.changedTouches[0].clientY,event:s})}))}),()=>{i(),Cr&&(o(),a())}}).pipe(xt())}static getInstance(e,t){return r.instance||(r.instance=new r(e,t)),r.instance}},yh=(()=>{class r{constructor(t,n,i,o){this.renderer=t,this.element=n,this.zone=i,this.resizableDirective=o,this.resizeEdges={},this.eventListeners={},this.destroy$=new Me}ngOnInit(){this.zone.runOutsideAngular(()=>{this.listenOnTheHost("mousedown").subscribe(t=>{this.onMousedown(t,t.clientX,t.clientY)}),this.listenOnTheHost("mouseup").subscribe(t=>{this.onMouseup(t.clientX,t.clientY)}),Cr&&(this.listenOnTheHost("touchstart").subscribe(t=>{this.onMousedown(t,t.touches[0].clientX,t.touches[0].clientY)}),Pt(this.listenOnTheHost("touchend"),this.listenOnTheHost("touchcancel")).subscribe(t=>{this.onMouseup(t.changedTouches[0].clientX,t.changedTouches[0].clientY)}))})}ngOnDestroy(){this.destroy$.next(),this.unsubscribeEventListeners()}onMousedown(t,n,i){t.cancelable&&t.preventDefault(),this.eventListeners.touchmove||(this.eventListeners.touchmove=this.renderer.listen(this.element.nativeElement,"touchmove",o=>{this.onMousemove(o,o.targetTouches[0].clientX,o.targetTouches[0].clientY)})),this.eventListeners.mousemove||(this.eventListeners.mousemove=this.renderer.listen(this.element.nativeElement,"mousemove",o=>{this.onMousemove(o,o.clientX,o.clientY)})),this.resizable.mousedown.next({clientX:n,clientY:i,edges:this.resizeEdges})}onMouseup(t,n){this.unsubscribeEventListeners(),this.resizable.mouseup.next({clientX:t,clientY:n,edges:this.resizeEdges})}get resizable(){return this.resizableDirective||this.resizableContainer}onMousemove(t,n,i){this.resizable.mousemove.next({clientX:n,clientY:i,edges:this.resizeEdges,event:t})}unsubscribeEventListeners(){Object.keys(this.eventListeners).forEach(t=>{this.eventListeners[t](),delete this.eventListeners[t]})}listenOnTheHost(t){return To(this.element.nativeElement,t).pipe(Lt(this.destroy$))}}return r.\u0275fac=function(t){return new(t||r)(N($t),N(nt),N(sn),N(cl,8))},r.\u0275dir=Ye({type:r,selectors:[["","mwlResizeHandle",""]],inputs:{resizeEdges:"resizeEdges",resizableContainer:"resizableContainer"}}),r})(),ll=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({}),r})();var Vg=(r,e)=>({event:r,trackByActionId:e}),Kg=r=>({action:r});function zg(r,e){if(r&1){let t=ae();f(0,"a",5),he(1,"calendarA11y"),O("mwlClick",function(i){let o=b(t).$implicit,a=S(2).event;return R(o.onClick({event:a,sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=b(t).$implicit,a=S(2).event;return R(o.onClick({event:a,sourceEvent:i}))}),C()}if(r&2){let t=e.$implicit;w("ngClass",t.cssClass)("innerHtml",t.label,Ba),ht("aria-label",it(1,3,dn(6,Kg,t),"actionButtonLabel"))}}function qg(r,e){if(r&1&&(f(0,"span",3),U(1,zg,2,8,"a",4),C()),r&2){let t=S(),n=t.event,i=t.trackByActionId;y(),w("ngForOf",n.actions)("ngForTrackBy",i)}}function Wg(r,e){if(r&1&&U(0,qg,2,2,"span",2),r&2){let t=e.event;w("ngIf",t.actions)}}function Gg(r,e){}var $g=(r,e)=>({event:r,view:e}),gi=()=>({});function Yg(r,e){if(r&1&&(K(0,"span",2),he(1,"calendarEventTitle"),he(2,"calendarA11y")),r&2){let t=e.event,n=e.view;w("innerHTML",wt(1,2,t.title,n,t),Ba),ht("aria-hidden",it(2,6,Ue(9,gi),"hideEventTitle"))}}function jg(r,e){}var Qg=(r,e,t)=>({contents:r,placement:e,event:t});function Xg(r,e){if(r&1&&(f(0,"div",2),K(1,"div",3)(2,"div",4),C()),r&2){let t=e.contents,n=e.placement;w("ngClass","cal-tooltip-"+n),y(2),w("innerHtml",t,Ba)}}function Jg(r,e){}var Zg=(r,e,t,n,i,o,a,s,c,l,u,m)=>({day:r,openDay:e,locale:t,tooltipPlacement:n,highlightDay:i,unhighlightDay:o,eventClicked:a,tooltipTemplate:s,tooltipAppendToBody:c,tooltipDelay:l,trackByEventId:u,validateDrag:m}),ef=(r,e)=>({day:r,locale:e}),gl=r=>({backgroundColor:r}),tf=(r,e)=>({event:r,draggedFrom:e}),Mo=(r,e)=>({x:r,y:e}),ps=()=>({delay:300,delta:30});function nf(r,e){if(r&1&&(f(0,"span",7),x(1),C()),r&2){let t=S().day;y(),mt(t.badgeTotal)}}function rf(r,e){if(r&1){let t=ae();f(0,"div",10),he(1,"calendarEventTitle"),he(2,"calendarA11y"),O("mouseenter",function(){let i=b(t).$implicit,o=S(2).highlightDay;return R(o.emit({event:i}))})("mouseleave",function(){let i=b(t).$implicit,o=S(2).unhighlightDay;return R(o.emit({event:i}))})("mwlClick",function(i){let o=b(t).$implicit,a=S(2).eventClicked;return R(a.emit({event:o,sourceEvent:i}))}),C()}if(r&2){let t=e.$implicit,n=S(2),i=n.day,o=n.tooltipPlacement,a=n.tooltipTemplate,s=n.tooltipAppendToBody,c=n.tooltipDelay,l=n.validateDrag;Ae("cal-draggable",t.draggable),w("ngStyle",dn(22,gl,t.color==null?null:t.color.primary))("ngClass",t==null?null:t.cssClass)("mwlCalendarTooltip",wt(1,15,t.title,"monthTooltip",t))("tooltipPlacement",o)("tooltipEvent",t)("tooltipTemplate",a)("tooltipAppendToBody",s)("tooltipDelay",c)("dropData",Ke(24,tf,t,i))("dragAxis",Ke(27,Mo,t.draggable,t.draggable))("validateDrag",l)("touchStartLongPress",Ue(30,ps)),ht("aria-hidden",it(2,19,Ue(31,gi),"hideMonthCellEvents"))}}function of(r,e){if(r&1&&(f(0,"div",8),U(1,rf,3,32,"div",9),C()),r&2){let t=S(),n=t.day,i=t.trackByEventId;y(),w("ngForOf",n.events)("ngForTrackBy",i)}}function af(r,e){if(r&1&&(f(0,"div",2),he(1,"calendarA11y"),f(2,"span",3),U(3,nf,2,1,"span",4),f(4,"span",5),x(5),he(6,"calendarDate"),C()()(),U(7,of,2,2,"div",6)),r&2){let t=e.day,n=e.locale;ht("aria-label",it(1,4,Ke(11,ef,t,n),"monthCell")),y(3),w("ngIf",t.badgeTotal>0),y(2),mt(wt(6,7,t.date,"monthViewDayNumber",n)),y(2),w("ngIf",t.events.length>0)}}function sf(r,e){}var cf=(r,e,t,n,i)=>({events:r,eventClicked:e,isOpen:t,trackByEventId:n,validateDrag:i}),Th=(r,e)=>({date:r,locale:e}),lf=r=>({event:r}),Sh=(r,e)=>({event:r,locale:e});function df(r,e){if(r&1){let t=ae();f(0,"div",7),K(1,"span",8),x(2," "),f(3,"mwl-calendar-event-title",9),he(4,"calendarA11y"),O("mwlClick",function(i){let o=b(t).$implicit,a=S(2).eventClicked;return R(a.emit({event:o,sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=b(t).$implicit,a=S(2).eventClicked;return R(a.emit({event:o,sourceEvent:i}))}),C(),x(5," "),K(6,"mwl-calendar-event-actions",10),C()}if(r&2){let t=e.$implicit,n=S(2).validateDrag,i=S();Ae("cal-draggable",t.draggable),w("ngClass",t==null?null:t.cssClass)("dropData",dn(16,lf,t))("dragAxis",Ke(18,Mo,t.draggable,t.draggable))("validateDrag",n)("touchStartLongPress",Ue(21,ps)),y(),w("ngStyle",dn(22,gl,t.color==null?null:t.color.primary)),y(2),w("event",t)("customTemplate",i.eventTitleTemplate),ht("aria-label",it(4,13,Ke(24,Sh,t,i.locale),"eventDescription")),y(3),w("event",t)("customTemplate",i.eventActionsTemplate)}}function uf(r,e){if(r&1&&(f(0,"div",3),K(1,"span",4),he(2,"calendarA11y"),K(3,"span",5),he(4,"calendarA11y"),U(5,df,7,27,"div",6),C()),r&2){let t=S(),n=t.events,i=t.trackByEventId,o=S();w("@collapse",void 0),y(),ht("aria-label",it(2,5,Ke(11,Th,o.date,o.locale),"openDayEventsAlert")),y(2),ht("aria-label",it(4,8,Ke(14,Th,o.date,o.locale),"openDayEventsLandmark")),y(2),w("ngForOf",n)("ngForTrackBy",i)}}function hf(r,e){if(r&1&&U(0,uf,6,17,"div",2),r&2){let t=e.isOpen;w("ngIf",t)}}function mf(r,e){}var pf=(r,e,t)=>({days:r,locale:e,trackByWeekDayHeaderDate:t});function gf(r,e){if(r&1){let t=ae();f(0,"div",4),O("click",function(i){let o=b(t).$implicit,a=S(2);return R(a.columnHeaderClicked.emit({isoDayNumber:o.day,sourceEvent:i}))}),x(1),he(2,"calendarDate"),C()}if(r&2){let t=e.$implicit,n=S().locale;Ae("cal-past",t.isPast)("cal-today",t.isToday)("cal-future",t.isFuture)("cal-weekend",t.isWeekend),w("ngClass",t.cssClass),y(),Pn(" ",wt(2,10,t.date,"monthViewColumnHeader",n)," ")}}function ff(r,e){if(r&1&&(f(0,"div",2),U(1,gf,3,14,"div",3),C()),r&2){let t=e.days,n=e.trackByWeekDayHeaderDate;y(),w("ngForOf",t)("ngForTrackBy",n)}}function Cf(r,e){}function vf(r,e){if(r&1){let t=ae();f(0,"mwl-calendar-month-cell",7),he(1,"calendarA11y"),O("mwlClick",function(i){let o=b(t).$implicit,a=S(2);return R(a.dayClicked.emit({day:o,sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=b(t).$implicit,a=S(2);return R(a.dayClicked.emit({day:o,sourceEvent:i}))})("highlightDay",function(i){b(t);let o=S(2);return R(o.toggleDayHighlight(i.event,!0))})("unhighlightDay",function(i){b(t);let o=S(2);return R(o.toggleDayHighlight(i.event,!1))})("drop",function(i){let o=b(t).$implicit,a=S(2);return R(a.eventDropped(o,i.dropData.event,i.dropData.draggedFrom))})("eventClicked",function(i){b(t);let o=S(2);return R(o.eventClicked.emit({event:i.event,sourceEvent:i.sourceEvent}))}),C()}if(r&2){let t=e.$implicit,n=S(2);w("ngClass",t==null?null:t.cssClass)("day",t)("openDay",n.openDay)("locale",n.locale)("tooltipPlacement",n.tooltipPlacement)("tooltipAppendToBody",n.tooltipAppendToBody)("tooltipTemplate",n.tooltipTemplate)("tooltipDelay",n.tooltipDelay)("customTemplate",n.cellTemplate)("ngStyle",dn(15,gl,t.backgroundColor))("clickListenerDisabled",n.dayClicked.observers.length===0),ht("tabindex",it(1,12,Ue(17,gi),"monthCellTabIndex"))}}function yf(r,e){if(r&1){let t=ae();f(0,"div")(1,"div",4),U(2,vf,2,18,"mwl-calendar-month-cell",5),he(3,"slice"),C(),f(4,"mwl-calendar-open-day-events",6),O("eventClicked",function(i){b(t);let o=S();return R(o.eventClicked.emit({event:i.event,sourceEvent:i.sourceEvent}))})("drop",function(i){b(t);let o=S();return R(o.eventDropped(o.openDay,i.dropData.event,i.dropData.draggedFrom))}),C()()}if(r&2){let t=e.$implicit,n=S();y(2),w("ngForOf",wt(3,9,n.view.days,t,t+n.view.totalDaysVisibleInWeek))("ngForTrackBy",n.trackByDate),y(2),w("locale",n.locale)("isOpen",n.openRowIndex===t)("events",n.openDay==null?null:n.openDay.events)("date",n.openDay==null?null:n.openDay.date)("customTemplate",n.openDayEventsTemplate)("eventTitleTemplate",n.eventTitleTemplate)("eventActionsTemplate",n.eventActionsTemplate)}}var Tf=(r,e,t,n,i,o)=>({days:r,locale:e,dayHeaderClicked:t,eventDropped:n,dragEnter:i,trackByWeekDayHeaderDate:o});function wf(r,e){if(r&1){let t=ae();f(0,"div",4),O("mwlClick",function(i){let o=b(t).$implicit,a=S().dayHeaderClicked;return R(a.emit({day:o,sourceEvent:i}))})("drop",function(i){let o=b(t).$implicit,a=S().eventDropped;return R(a.emit({event:i.dropData.event,newStart:o.date}))})("dragEnter",function(){let i=b(t).$implicit,o=S().dragEnter;return R(o.emit({date:i.date}))}),f(1,"b"),x(2),he(3,"calendarDate"),C(),K(4,"br"),f(5,"span"),x(6),he(7,"calendarDate"),C()()}if(r&2){let t=e.$implicit,n=S().locale;Ae("cal-past",t.isPast)("cal-today",t.isToday)("cal-future",t.isFuture)("cal-weekend",t.isWeekend),w("ngClass",t.cssClass),y(2),mt(wt(3,11,t.date,"weekViewColumnHeader",n)),y(4),mt(wt(7,15,t.date,"weekViewColumnSubHeader",n))}}function _f(r,e){if(r&1&&(f(0,"div",2),U(1,wf,8,19,"div",3),C()),r&2){let t=e.days,n=e.trackByWeekDayHeaderDate;y(),w("ngForOf",t)("ngForTrackBy",n)}}function Ef(r,e){}var Sf=(r,e,t,n,i,o,a,s,c)=>({weekEvent:r,tooltipPlacement:e,eventClicked:t,tooltipTemplate:n,tooltipAppendToBody:i,tooltipDisabled:o,tooltipDelay:a,column:s,daysInWeek:c}),Af=(r,e,t)=>({color:r,backgroundColor:e,borderColor:t});function If(r,e){if(r&1){let t=ae();f(0,"div",2),he(1,"calendarEventTitle"),he(2,"calendarA11y"),O("mwlClick",function(i){let o=b(t).eventClicked;return R(o.emit({sourceEvent:i}))})("mwlKeydownEnter",function(i){let o=b(t).eventClicked;return R(o.emit({sourceEvent:i}))}),K(3,"mwl-calendar-event-actions",3),x(4," "),K(5,"mwl-calendar-event-title",4),C()}if(r&2){let t=e.weekEvent,n=e.tooltipPlacement,i=e.tooltipTemplate,o=e.tooltipAppendToBody,a=e.tooltipDisabled,s=e.tooltipDelay,c=e.daysInWeek,l=S();w("ngStyle",Ka(20,Af,t.event.color==null?null:t.event.color.secondaryText,t.event.color==null?null:t.event.color.secondary,t.event.color==null?null:t.event.color.primary))("mwlCalendarTooltip",a?"":wt(1,13,t.event.title,c===1?"dayTooltip":"weekTooltip",t.tempEvent||t.event))("tooltipPlacement",n)("tooltipEvent",t.tempEvent||t.event)("tooltipTemplate",i)("tooltipAppendToBody",o)("tooltipDelay",s),ht("aria-label",it(2,17,Ke(24,Sh,t.tempEvent||t.event,l.locale),"eventDescription")),y(3),w("event",t.tempEvent||t.event)("customTemplate",l.eventActionsTemplate),y(2),w("event",t.tempEvent||t.event)("customTemplate",l.eventTitleTemplate)("view",c===1?"day":"week")}}function kf(r,e){}var bf=(r,e,t,n,i)=>({segment:r,locale:e,segmentHeight:t,isTimeLabel:n,daysInWeek:i});function Rf(r,e){if(r&1&&(f(0,"div",4),x(1),he(2,"calendarDate"),C()),r&2){let t=S(),n=t.segment,i=t.locale,o=t.daysInWeek;y(),Pn(" ",wt(2,1,n.displayDate,o===1?"dayViewHour":"weekViewHour",i)," ")}}function Df(r,e){if(r&1&&(f(0,"div",2),he(1,"calendarA11y"),U(2,Rf,3,5,"div",3),C()),r&2){let t=e.segment,n=e.segmentHeight,i=e.isTimeLabel,o=e.daysInWeek;cn("height",n,"px"),Ae("cal-hour-start",t.isStart)("cal-after-hour-start",!t.isStart),w("ngClass",t.cssClass),ht("aria-hidden",it(1,9,Ue(12,gi),o===1?"hideDayHourSegment":"hideWeekHourSegment")),y(2),w("ngIf",i)}}function Mf(r,e){}var Of=(r,e,t,n,i,o,a)=>({columnDate:r,dayStartHour:e,dayStartMinute:t,dayEndHour:n,dayEndMinute:i,isVisible:o,topPx:a});function Pf(r,e){if(r&1&&K(0,"div",3),r&2){let t=S().topPx;cn("top",t,"px")}}function Nf(r,e){if(r&1&&U(0,Pf,1,2,"div",2),r&2){let t=e.isVisible;w("ngIf",t)}}function xf(r,e){}var Lf=(r,e)=>({left:r,right:e}),Ah=(r,e)=>({event:r,calendarId:e}),Hf=r=>({x:r}),Ff=()=>({left:!0}),Uf=()=>({right:!0}),Bf=(r,e,t,n)=>({left:r,right:e,top:t,bottom:n}),Vf=()=>({left:!0,top:!0}),Kf=()=>({right:!0,bottom:!0});function zf(r,e){r&1&&lu(0)}function qf(r,e){if(r&1){let t=ae();f(0,"div",17),O("drop",function(i){let o=b(t).$implicit,a=S(2);return R(a.eventDropped(i,o.date,!0))})("dragEnter",function(){let i=b(t).$implicit,o=S(2);return R(o.dateDragEnter(i.date))}),C()}}function Wf(r,e){r&1&&K(0,"div",24),r&2&&w("resizeEdges",Ue(1,Ff))}function Gf(r,e){r&1&&K(0,"div",25),r&2&&w("resizeEdges",Ue(1,Uf))}function $f(r,e){if(r&1){let t=ae();f(0,"div",20,3),O("resizeStart",function(i){let o=b(t).$implicit;S();let a=fe(1),s=S(2);return R(s.allDayEventResizeStarted(a,o,i))})("resizing",function(i){let o=b(t).$implicit,a=S(3);return R(a.allDayEventResizing(o,i,a.dayColumnWidth))})("resizeEnd",function(){let i=b(t).$implicit,o=S(3);return R(o.allDayEventResizeEnded(i))})("dragStart",function(){let i=b(t).$implicit,o=fe(1);S();let a=fe(1),s=S(2);return R(s.dragStarted(a,o,i,!1))})("dragging",function(){b(t);let i=S(3);return R(i.allDayEventDragMove())})("dragEnd",function(i){let o=b(t).$implicit,a=S(3);return R(a.dragEnded(o,i,a.dayColumnWidth))}),U(2,Wf,1,2,"div",21),f(3,"mwl-calendar-week-view-event",22),O("eventClicked",function(i){let o=b(t).$implicit,a=S(3);return R(a.eventClicked.emit({event:o.event,sourceEvent:i.sourceEvent}))}),C(),U(4,Gf,1,2,"div",23),C()}if(r&2){let t=e.$implicit,n=S(3);cn("width",100/n.days.length*t.span,"%")("margin-left",n.rtl?null:100/n.days.length*t.offset,"%")("margin-right",n.rtl?100/n.days.length*t.offset:null,"%"),Ae("cal-draggable",t.event.draggable&&n.allDayEventResizes.size===0)("cal-starts-within-week",!t.startsBeforeWeek)("cal-ends-within-week",!t.endsAfterWeek),w("ngClass",t.event==null?null:t.event.cssClass)("resizeCursors",n.resizeCursors)("resizeSnapGrid",Ke(33,Lf,n.dayColumnWidth,n.dayColumnWidth))("validateResize",n.validateResize)("dropData",Ke(36,Ah,t.event,n.calendarId))("dragAxis",Ke(39,Mo,t.event.draggable&&n.allDayEventResizes.size===0,!n.snapDraggedEvents&&t.event.draggable&&n.allDayEventResizes.size===0))("dragSnapGrid",n.snapDraggedEvents?dn(42,Hf,n.dayColumnWidth):Ue(44,gi))("validateDrag",n.validateDrag)("touchStartLongPress",Ue(45,ps)),y(2),w("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.beforeStart)&&!t.startsBeforeWeek),y(),w("locale",n.locale)("weekEvent",t)("tooltipPlacement",n.tooltipPlacement)("tooltipTemplate",n.tooltipTemplate)("tooltipAppendToBody",n.tooltipAppendToBody)("tooltipDelay",n.tooltipDelay)("customTemplate",n.eventTemplate)("eventTitleTemplate",n.eventTitleTemplate)("eventActionsTemplate",n.eventActionsTemplate)("daysInWeek",n.daysInWeek),y(),w("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.afterEnd)&&!t.endsAfterWeek)}}function Yf(r,e){if(r&1&&(f(0,"div",18,2),U(2,$f,5,46,"div",19),C()),r&2){let t=e.$implicit,n=S(2);y(2),w("ngForOf",t.row)("ngForTrackBy",n.trackByWeekAllDayEvent)}}function jf(r,e){if(r&1){let t=ae();f(0,"div",12,1),O("dragEnter",function(){b(t);let i=S();return R(i.dragEnter("allDay"))})("dragLeave",function(){b(t);let i=S();return R(i.dragLeave("allDay"))}),f(2,"div",10)(3,"div",13),U(4,zf,1,0,"ng-container",14),C(),U(5,qf,1,0,"div",15),C(),U(6,Yf,3,2,"div",16),C()}if(r&2){let t=S();y(4),w("ngTemplateOutlet",t.allDayEventsLabelTemplate),y(),w("ngForOf",t.days)("ngForTrackBy",t.trackByWeekDayHeaderDate),y(),w("ngForOf",t.view.allDayEventRows)("ngForTrackBy",t.trackById)}}function Qf(r,e){if(r&1&&K(0,"mwl-calendar-week-view-hour-segment",29),r&2){let t=e.$implicit,n=S(3);cn("height",n.hourSegmentHeight,"px"),w("segment",t)("segmentHeight",n.hourSegmentHeight)("locale",n.locale)("customTemplate",n.hourSegmentTemplate)("isTimeLabel",!0)("daysInWeek",n.daysInWeek)}}function Xf(r,e){if(r&1&&(f(0,"div",27),U(1,Qf,1,8,"mwl-calendar-week-view-hour-segment",28),C()),r&2){let t=e.$implicit,n=e.odd,i=S(2);Ae("cal-hour-odd",n),y(),w("ngForOf",t.segments)("ngForTrackBy",i.trackByHourSegment)}}function Jf(r,e){if(r&1&&(f(0,"div",13),U(1,Xf,2,4,"div",26),C()),r&2){let t=S();y(),w("ngForOf",t.view.hourColumns[0].hours)("ngForTrackBy",t.trackByHour)}}function Zf(r,e){r&1&&K(0,"div",24),r&2&&w("resizeEdges",Ue(1,Vf))}function eC(r,e){}function tC(r,e){if(r&1){let t=ae();f(0,"mwl-calendar-week-view-event",36),O("eventClicked",function(i){b(t);let o=S().$implicit,a=S(2);return R(a.eventClicked.emit({event:o.event,sourceEvent:i.sourceEvent}))}),C()}if(r&2){let t=S().$implicit,n=S().$implicit,i=S();w("locale",i.locale)("weekEvent",t)("tooltipPlacement",i.tooltipPlacement)("tooltipTemplate",i.tooltipTemplate)("tooltipAppendToBody",i.tooltipAppendToBody)("tooltipDisabled",i.dragActive||i.timeEventResizes.size>0)("tooltipDelay",i.tooltipDelay)("customTemplate",i.eventTemplate)("eventTitleTemplate",i.eventTitleTemplate)("eventActionsTemplate",i.eventActionsTemplate)("column",n)("daysInWeek",i.daysInWeek)}}function nC(r,e){r&1&&K(0,"div",25),r&2&&w("resizeEdges",Ue(1,Kf))}function rC(r,e){if(r&1){let t=ae();f(0,"div",34,3),O("resizeStart",function(i){let o=b(t).$implicit,a=S(2),s=fe(6);return R(a.timeEventResizeStarted(s,o,i))})("resizing",function(i){let o=b(t).$implicit,a=S(2);return R(a.timeEventResizing(o,i))})("resizeEnd",function(){let i=b(t).$implicit,o=S(2);return R(o.timeEventResizeEnded(i))})("dragStart",function(){let i=b(t).$implicit,o=fe(1),a=S(2),s=fe(6);return R(a.dragStarted(s,o,i,!0))})("dragging",function(i){let o=b(t).$implicit,a=S(2);return R(a.dragMove(o,i))})("dragEnd",function(i){let o=b(t).$implicit,a=S(2);return R(a.dragEnded(o,i,a.dayColumnWidth,!0))}),U(2,Zf,1,2,"div",21)(3,eC,0,0,"ng-template",35)(4,tC,1,12,"ng-template",null,4,ot)(6,nC,1,2,"div",23),C()}if(r&2){let t=e.$implicit,n=fe(5),i=S(2);cn("top",t.top,"px")("height",t.height,"px")("left",t.left,"%")("width",t.width,"%"),Ae("cal-draggable",t.event.draggable&&i.timeEventResizes.size===0)("cal-starts-within-day",!t.startsBeforeDay)("cal-ends-within-day",!t.endsAfterDay),w("ngClass",t.event.cssClass)("hidden",t.height===0&&t.width===0)("resizeCursors",i.resizeCursors)("resizeSnapGrid",du(30,Bf,i.dayColumnWidth,i.dayColumnWidth,i.eventSnapSize||i.hourSegmentHeight,i.eventSnapSize||i.hourSegmentHeight))("validateResize",i.validateResize)("allowNegativeResizes",!0)("dropData",Ke(35,Ah,t.event,i.calendarId))("dragAxis",Ke(38,Mo,t.event.draggable&&i.timeEventResizes.size===0,t.event.draggable&&i.timeEventResizes.size===0))("dragSnapGrid",i.snapDraggedEvents?Ke(41,Mo,i.dayColumnWidth,i.eventSnapSize||i.hourSegmentHeight):Ue(44,gi))("touchStartLongPress",Ue(45,ps))("ghostDragEnabled",!i.snapDraggedEvents)("ghostElementTemplate",n)("validateDrag",i.validateDrag),y(2),w("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.beforeStart)&&!t.startsBeforeDay),y(),w("ngTemplateOutlet",n),y(3),w("ngIf",(t.event==null||t.event.resizable==null?null:t.event.resizable.afterEnd)&&!t.endsAfterDay)}}function iC(r,e){if(r&1){let t=ae();f(0,"mwl-calendar-week-view-hour-segment",38),O("mwlClick",function(i){let o=b(t).$implicit,a=S(3);return R(a.hourSegmentClicked.emit({date:o.date,sourceEvent:i}))})("drop",function(i){let o=b(t).$implicit,a=S(3);return R(a.eventDropped(i,o.date,!1))})("dragEnter",function(){let i=b(t).$implicit,o=S(3);return R(o.dateDragEnter(i.date))}),C()}if(r&2){let t=e.$implicit,n=S(3);cn("height",n.hourSegmentHeight,"px"),w("segment",t)("segmentHeight",n.hourSegmentHeight)("locale",n.locale)("customTemplate",n.hourSegmentTemplate)("daysInWeek",n.daysInWeek)("clickListenerDisabled",n.hourSegmentClicked.observers.length===0)("dragOverClass",!n.dragActive||!n.snapDraggedEvents?"cal-drag-over":null)("isTimeLabel",n.daysInWeek===1)}}function oC(r,e){if(r&1&&(f(0,"div",27),U(1,iC,1,10,"mwl-calendar-week-view-hour-segment",37),C()),r&2){let t=e.$implicit,n=e.odd,i=S(2);Ae("cal-hour-odd",n),y(),w("ngForOf",t.segments)("ngForTrackBy",i.trackByHourSegment)}}function aC(r,e){if(r&1&&(f(0,"div",30),K(1,"mwl-calendar-week-view-current-time-marker",31),f(2,"div",32),U(3,rC,7,46,"div",33),C(),U(4,oC,2,4,"div",26),C()),r&2){let t=e.$implicit,n=S();y(),w("columnDate",t.date)("dayStartHour",n.dayStartHour)("dayStartMinute",n.dayStartMinute)("dayEndHour",n.dayEndHour)("dayEndMinute",n.dayEndMinute)("hourSegments",n.hourSegments)("hourDuration",n.hourDuration)("hourSegmentHeight",n.hourSegmentHeight)("customTemplate",n.currentTimeMarkerTemplate),y(2),w("ngForOf",t.events)("ngForTrackBy",n.trackByWeekTimeEvent),y(),w("ngForOf",t.hours)("ngForTrackBy",n.trackByHour)}}var vr=(()=>{class r{constructor(t,n,i){this.renderer=t,this.elm=n,this.document=i,this.clickListenerDisabled=!1,this.click=new q,this.destroy$=new Me}ngOnInit(){this.clickListenerDisabled||this.listen().pipe(Lt(this.destroy$)).subscribe(t=>{t.stopPropagation(),this.click.emit(t)})}ngOnDestroy(){this.destroy$.next()}listen(){return new Dn(t=>this.renderer.listen(this.elm.nativeElement,"click",n=>{t.next(n)}))}}return r.\u0275fac=function(t){return new(t||r)(N($t),N(nt),N(gr))},r.\u0275dir=Ye({type:r,selectors:[["","mwlClick",""]],inputs:{clickListenerDisabled:"clickListenerDisabled"},outputs:{click:"mwlClick"}}),r})(),gs=(()=>{class r{constructor(t,n,i){this.host=t,this.ngZone=n,this.renderer=i,this.keydown=new q,this.keydownListener=null}ngOnInit(){this.ngZone.runOutsideAngular(()=>{this.keydownListener=this.renderer.listen(this.host.nativeElement,"keydown",t=>{(t.keyCode===13||t.which===13||t.key==="Enter")&&(t.preventDefault(),t.stopPropagation(),this.ngZone.run(()=>{this.keydown.emit(t)}))})})}ngOnDestroy(){this.keydownListener!==null&&(this.keydownListener(),this.keydownListener=null)}}return r.\u0275fac=function(t){return new(t||r)(N(nt),N(sn),N($t))},r.\u0275dir=Ye({type:r,selectors:[["","mwlKeydownEnter",""]],outputs:{keydown:"mwlKeydownEnter"}}),r})(),us=(()=>{class r{constructor(t){this.i18nPlural=t}monthCell({day:t,locale:n}){return t.badgeTotal>0?`
        ${Pe(t.date,"EEEE MMMM d",n)},
        ${this.i18nPlural.transform(t.badgeTotal,{"=0":"No events","=1":"One event",other:"# events"})},
         click to expand
      `:`${Pe(t.date,"EEEE MMMM d",n)}`}openDayEventsLandmark({date:t,locale:n}){return`
      Beginning of expanded view for ${Pe(t,"EEEE MMMM dd",n)}
    `}openDayEventsAlert({date:t,locale:n}){return`${Pe(t,"EEEE MMMM dd",n)} expanded`}eventDescription({event:t,locale:n}){if(t.allDay===!0)return this.allDayEventDescription({event:t,locale:n});let i=`
      ${Pe(t.start,"EEEE MMMM dd",n)},
      ${t.title}, from ${Pe(t.start,"hh:mm a",n)}
    `;return t.end?i+` to ${Pe(t.end,"hh:mm a",n)}`:i}allDayEventDescription({event:t,locale:n}){let i=`
      ${t.title}, event spans multiple days:
      start time ${Pe(t.start,"MMMM dd hh:mm a",n)}
    `;return t.end?i+`, stop time ${Pe(t.end,"MMMM d hh:mm a",n)}`:i+", no stop time"}actionButtonLabel({action:t}){return t.a11yLabel}monthCellTabIndex(){return 0}hideMonthCellEvents(){return!0}hideEventTitle(){return!0}hideWeekHourSegment(){return!0}hideDayHourSegment(){return!0}}return r.\u0275fac=function(t){return new(t||r)(Oe(qa))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),yr=(()=>{class r{constructor(t,n){this.calendarA11y=t,this.locale=n}transform(t,n){if(t.locale=t.locale||this.locale,typeof this.calendarA11y[n]>"u"){let i=Object.getOwnPropertyNames(Object.getPrototypeOf(us.prototype)).filter(o=>o!=="constructor");throw new Error(`${n} is not a valid a11y method. Can only be one of ${i.join(", ")}`)}return this.calendarA11y[n](t)}}return r.\u0275fac=function(t){return new(t||r)(N(us,16),N(Eo,16))},r.\u0275pipe=ci({name:"calendarA11y",type:r,pure:!0}),r})(),Ih=(()=>{class r{constructor(){this.trackByActionId=(t,n)=>n.id?n.id:n}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-event-actions"]],inputs:{event:"event",customTemplate:"customTemplate"},decls:3,vars:5,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cal-event-actions",4,"ngIf"],[1,"cal-event-actions"],["class","cal-event-action","href","javascript:;","tabindex","0","role","button",3,"ngClass","innerHtml","mwlClick","mwlKeydownEnter",4,"ngFor","ngForOf","ngForTrackBy"],["href","javascript:;","tabindex","0","role","button",1,"cal-event-action",3,"mwlClick","mwlKeydownEnter","ngClass","innerHtml"]],template:function(t,n){if(t&1&&U(0,Wg,1,1,"ng-template",null,0,ot)(2,Gg,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Ke(2,Vg,n.event,n.trackByActionId))}},dependencies:[_t,Yt,Ut,Et,vr,gs,yr],encapsulation:2}),r})(),Oo=class{month(e,t){return e.title}monthTooltip(e,t){return e.title}week(e,t){return e.title}weekTooltip(e,t){return e.title}day(e,t){return e.title}dayTooltip(e,t){return e.title}},fl=(()=>{class r{constructor(t){this.calendarEventTitle=t}transform(t,n,i){return this.calendarEventTitle[n](i,t)}}return r.\u0275fac=function(t){return new(t||r)(N(Oo,16))},r.\u0275pipe=ci({name:"calendarEventTitle",type:r,pure:!0}),r})(),kh=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-event-title"]],inputs:{event:"event",customTemplate:"customTemplate",view:"view"},decls:3,vars:5,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-event-title",3,"innerHTML"]],template:function(t,n){if(t&1&&U(0,Yg,3,10,"ng-template",null,0,ot)(2,jg,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Ke(2,$g,n.event,n.view))}},dependencies:[Et,fl,yr],encapsulation:2}),r})(),sC=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-tooltip-window"]],inputs:{contents:"contents",placement:"placement",event:"event",customTemplate:"customTemplate"},decls:3,vars:6,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-tooltip",3,"ngClass"],[1,"cal-tooltip-arrow"],[1,"cal-tooltip-inner",3,"innerHtml"]],template:function(t,n){if(t&1&&U(0,Xg,3,2,"ng-template",null,0,ot)(2,Jg,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Ka(2,Qg,n.contents,n.placement,n.event))}},dependencies:[_t,Et],encapsulation:2}),r})(),bh=(()=>{class r{constructor(t,n,i,o,a,s){this.elementRef=t,this.injector=n,this.renderer=i,this.viewContainerRef=a,this.document=s,this.placement="auto",this.delay=null,this.cancelTooltipDelay$=new Me,this.tooltipFactory=o.resolveComponentFactory(sC)}ngOnChanges(t){this.tooltipRef&&(t.contents||t.customTemplate||t.event)&&(this.tooltipRef.instance.contents=this.contents,this.tooltipRef.instance.customTemplate=this.customTemplate,this.tooltipRef.instance.event=this.event,this.tooltipRef.changeDetectorRef.markForCheck(),this.contents||this.hide())}ngOnDestroy(){this.hide()}onMouseOver(){(this.delay===null?Tt("now"):Yd(this.delay)).pipe(Lt(this.cancelTooltipDelay$)).subscribe(()=>{this.show()})}onMouseOut(){this.hide()}show(){!this.tooltipRef&&this.contents&&(this.tooltipRef=this.viewContainerRef.createComponent(this.tooltipFactory,0,this.injector,[]),this.tooltipRef.instance.contents=this.contents,this.tooltipRef.instance.customTemplate=this.customTemplate,this.tooltipRef.instance.event=this.event,this.appendToBody&&this.document.body.appendChild(this.tooltipRef.location.nativeElement),requestAnimationFrame(()=>{this.positionTooltip()}))}hide(){this.tooltipRef&&(this.viewContainerRef.remove(this.viewContainerRef.indexOf(this.tooltipRef.hostView)),this.tooltipRef=null),this.cancelTooltipDelay$.next()}positionTooltip(t=[]){this.tooltipRef&&(this.tooltipRef.changeDetectorRef.detectChanges(),this.tooltipRef.instance.placement=jc(this.elementRef.nativeElement,this.tooltipRef.location.nativeElement.children[0],this.placement,this.appendToBody),t.indexOf(this.tooltipRef.instance.placement)===-1&&this.positionTooltip([...t,this.tooltipRef.instance.placement]))}}return r.\u0275fac=function(t){return new(t||r)(N(nt),N(ru),N($t),N(au),N(Va),N(gr))},r.\u0275dir=Ye({type:r,selectors:[["","mwlCalendarTooltip",""]],hostBindings:function(t,n){t&1&&O("mouseenter",function(){return n.onMouseOver()})("mouseleave",function(){return n.onMouseOut()})},inputs:{contents:[0,"mwlCalendarTooltip","contents"],placement:[0,"tooltipPlacement","placement"],customTemplate:[0,"tooltipTemplate","customTemplate"],event:[0,"tooltipEvent","event"],appendToBody:[0,"tooltipAppendToBody","appendToBody"],delay:[0,"tooltipDelay","delay"]},features:[pr]}),r})(),jt=function(r){return r.Month="month",r.Week="week",r.Day="day",r}(jt||{}),Rh=r=>rh(r,(...t)=>console.warn("angular-calendar",...t));function Dh(r,e){return Math.floor(r.left)<=Math.ceil(e.left)&&Math.floor(e.left)<=Math.ceil(r.right)&&Math.floor(r.left)<=Math.ceil(e.right)&&Math.floor(e.right)<=Math.ceil(r.right)}function cC(r,e){return Math.floor(r.top)<=Math.ceil(e.top)&&Math.floor(e.top)<=Math.ceil(r.bottom)&&Math.floor(r.top)<=Math.ceil(e.bottom)&&Math.floor(e.bottom)<=Math.ceil(r.bottom)}function lC(r,e){return Dh(r,e)&&cC(r,e)}function Mh(r,e){return Math.round(r/e)*e}var Oh=(r,e)=>e.id?e.id:e,Cl=(r,e)=>e.date.toISOString(),dC=(r,e)=>e.date.toISOString(),uC=(r,e)=>e.segments[0].date.toISOString(),hC=(r,e)=>e.event.id?e.event.id:e.event,mC=(r,e)=>e.event.id?e.event.id:e.event,pC=60;function gC(r,e,t){return(t||pC)/(r*e)}function dl(r,e,t,n,i){let o=Mh(r,n||t),a=gC(e,t,i);return o*a}function wh(r,e,t){return e.end?e.end:r.addMinutes(e.start,t)}function Vt(r,e,t,n){let i=0,o=0,a=t<0?r.subDays:r.addDays,s=e;for(;o<=Math.abs(t);){s=a(e,i);let c=r.getDay(s);n.indexOf(c)===-1&&o++,i++}return s}function fC(r,e,t){let n=e||r;return t.start<=r&&r<=t.end||t.start<=n&&n<=t.end}function CC(r,e,t,n){return r.dropData&&r.dropData.event&&(r.dropData.calendarId!==n||r.dropData.event.allDay&&!t||!r.dropData.event.allDay&&t)}function ul(r,e,t,n=[],i){let o=i?r.startOfDay(e):r.startOfWeek(e,{weekStartsOn:t}),a=r.endOfWeek(e,{weekStartsOn:t});for(;n.indexOf(r.getDay(o))>-1&&o<a;)o=r.addDays(o,1);if(i){let s=r.endOfDay(Vt(r,o,i-1,n));return{viewStart:o,viewEnd:s}}else{let s=a;for(;n.indexOf(r.getDay(s))>-1&&s>o;)s=r.subDays(s,1);return{viewStart:o,viewEnd:s}}}function vl({x:r,y:e}){return Math.abs(r)>1||Math.abs(e)>1}var At=class{},Ph=(()=>{class r{constructor(t){this.dateAdapter=t,this.excludeDays=[],this.viewDateChange=new q}onClick(){let t={day:this.dateAdapter.subDays,week:this.dateAdapter.subWeeks,month:this.dateAdapter.subMonths}[this.view];this.view===jt.Day?this.viewDateChange.emit(Vt(this.dateAdapter,this.viewDate,-1,this.excludeDays)):this.view===jt.Week&&this.daysInWeek?this.viewDateChange.emit(Vt(this.dateAdapter,this.viewDate,-this.daysInWeek,this.excludeDays)):this.viewDateChange.emit(t(this.viewDate,1))}}return r.\u0275fac=function(t){return new(t||r)(N(At))},r.\u0275dir=Ye({type:r,selectors:[["","mwlCalendarPreviousView",""]],hostBindings:function(t,n){t&1&&O("click",function(){return n.onClick()})},inputs:{view:"view",viewDate:"viewDate",excludeDays:"excludeDays",daysInWeek:"daysInWeek"},outputs:{viewDateChange:"viewDateChange"}}),r})(),Nh=(()=>{class r{constructor(t){this.dateAdapter=t,this.excludeDays=[],this.viewDateChange=new q}onClick(){let t={day:this.dateAdapter.addDays,week:this.dateAdapter.addWeeks,month:this.dateAdapter.addMonths}[this.view];this.view===jt.Day?this.viewDateChange.emit(Vt(this.dateAdapter,this.viewDate,1,this.excludeDays)):this.view===jt.Week&&this.daysInWeek?this.viewDateChange.emit(Vt(this.dateAdapter,this.viewDate,this.daysInWeek,this.excludeDays)):this.viewDateChange.emit(t(this.viewDate,1))}}return r.\u0275fac=function(t){return new(t||r)(N(At))},r.\u0275dir=Ye({type:r,selectors:[["","mwlCalendarNextView",""]],hostBindings:function(t,n){t&1&&O("click",function(){return n.onClick()})},inputs:{view:"view",viewDate:"viewDate",excludeDays:"excludeDays",daysInWeek:"daysInWeek"},outputs:{viewDateChange:"viewDateChange"}}),r})(),xh=(()=>{class r{constructor(t){this.dateAdapter=t,this.viewDateChange=new q}onClick(){this.viewDateChange.emit(this.dateAdapter.startOfDay(new Date))}}return r.\u0275fac=function(t){return new(t||r)(N(At))},r.\u0275dir=Ye({type:r,selectors:[["","mwlCalendarToday",""]],hostBindings:function(t,n){t&1&&O("click",function(){return n.onClick()})},inputs:{viewDate:"viewDate"},outputs:{viewDateChange:"viewDateChange"}}),r})(),vC=(()=>{class r{constructor(t){this.dateAdapter=t}monthViewColumnHeader({date:t,locale:n}){return Pe(t,"EEEE",n)}monthViewDayNumber({date:t,locale:n}){return Pe(t,"d",n)}monthViewTitle({date:t,locale:n}){return Pe(t,"LLLL y",n)}weekViewColumnHeader({date:t,locale:n}){return Pe(t,"EEEE",n)}weekViewColumnSubHeader({date:t,locale:n}){return Pe(t,"MMM d",n)}weekViewTitle({date:t,locale:n,weekStartsOn:i,excludeDays:o,daysInWeek:a}){let{viewStart:s,viewEnd:c}=ul(this.dateAdapter,t,i,o,a),l=(u,m)=>Pe(u,"MMM d"+(m?", yyyy":""),n);return`${l(s,s.getUTCFullYear()!==c.getUTCFullYear())} - ${l(c,!0)}`}weekViewHour({date:t,locale:n}){return Pe(t,"h a",n)}dayViewHour({date:t,locale:n}){return Pe(t,"h a",n)}dayViewTitle({date:t,locale:n}){return Pe(t,"EEEE, MMMM d, y",n)}}return r.\u0275fac=function(t){return new(t||r)(Oe(At))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),hs=(()=>{class r extends vC{}return r.\u0275fac=(()=>{let e;return function(n){return(e||(e=nu(r)))(n||r)}})(),r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),fi=(()=>{class r{constructor(t,n){this.dateFormatter=t,this.locale=n}transform(t,n,i=this.locale,o=0,a=[],s){if(typeof this.dateFormatter[n]>"u"){let c=Object.getOwnPropertyNames(Object.getPrototypeOf(hs.prototype)).filter(l=>l!=="constructor");throw new Error(`${n} is not a valid date formatter. Can only be one of ${c.join(", ")}`)}return this.dateFormatter[n]({date:t,locale:i,weekStartsOn:o,excludeDays:a,daysInWeek:s})}}return r.\u0275fac=function(t){return new(t||r)(N(hs,16),N(Eo,16))},r.\u0275pipe=ci({name:"calendarDate",type:r,pure:!0}),r})(),fs=(()=>{class r{constructor(t){this.dateAdapter=t}getMonthView(t){return nh(this.dateAdapter,t)}getWeekViewHeader(t){return as(this.dateAdapter,t)}getWeekView(t){return th(this.dateAdapter,t)}}return r.\u0275fac=function(t){return new(t||r)(Oe(At))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),fT=new mr("Moment");var Bn=function(r){return r.Drag="drag",r.Drop="drop",r.Resize="resize",r}(Bn||{}),Po=(()=>{class r{static forRoot(t,n={}){return{ngModule:r,providers:[t,n.eventTitleFormatter||Oo,n.dateFormatter||hs,n.utils||fs,n.a11y||us]}}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({providers:[qa],imports:[St]}),r})(),yC=(()=>{class r{constructor(){this.highlightDay=new q,this.unhighlightDay=new q,this.eventClicked=new q,this.trackByEventId=Oh,this.validateDrag=vl}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-month-cell"]],hostAttrs:[1,"cal-cell","cal-day-cell"],hostVars:18,hostBindings:function(t,n){t&2&&Ae("cal-past",n.day.isPast)("cal-today",n.day.isToday)("cal-future",n.day.isFuture)("cal-weekend",n.day.isWeekend)("cal-in-month",n.day.inMonth)("cal-out-month",!n.day.inMonth)("cal-has-events",n.day.events.length>0)("cal-open",n.day===n.openDay)("cal-event-highlight",!!n.day.backgroundColor)},inputs:{day:"day",openDay:"openDay",locale:"locale",tooltipPlacement:"tooltipPlacement",tooltipAppendToBody:"tooltipAppendToBody",customTemplate:"customTemplate",tooltipTemplate:"tooltipTemplate",tooltipDelay:"tooltipDelay"},outputs:{highlightDay:"highlightDay",unhighlightDay:"unhighlightDay",eventClicked:"eventClicked"},decls:3,vars:15,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-cell-top"],["aria-hidden","true"],["class","cal-day-badge",4,"ngIf"],[1,"cal-day-number"],["class","cal-events",4,"ngIf"],[1,"cal-day-badge"],[1,"cal-events"],["class","cal-event","mwlDraggable","","dragActiveClass","cal-drag-active",3,"ngStyle","ngClass","mwlCalendarTooltip","tooltipPlacement","tooltipEvent","tooltipTemplate","tooltipAppendToBody","tooltipDelay","cal-draggable","dropData","dragAxis","validateDrag","touchStartLongPress","mouseenter","mouseleave","mwlClick",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDraggable","","dragActiveClass","cal-drag-active",1,"cal-event",3,"mouseenter","mouseleave","mwlClick","ngStyle","ngClass","mwlCalendarTooltip","tooltipPlacement","tooltipEvent","tooltipTemplate","tooltipAppendToBody","tooltipDelay","dropData","dragAxis","validateDrag","touchStartLongPress"]],template:function(t,n){if(t&1&&U(0,af,8,14,"ng-template",null,0,ot)(2,sf,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Vc(2,Zg,[n.day,n.openDay,n.locale,n.tooltipPlacement,n.highlightDay,n.unhighlightDay,n.eventClicked,n.tooltipTemplate,n.tooltipAppendToBody,n.tooltipDelay,n.trackByEventId,n.validateDrag]))}},dependencies:[_t,Yt,Ut,Et,Ao,cs,bh,vr,fi,fl,yr],encapsulation:2}),r})(),yl=ku("collapse",[Wc("void",qc({height:0,overflow:"hidden","padding-top":0,"padding-bottom":0})),Wc("*",qc({height:"*",overflow:"hidden","padding-top":"*","padding-bottom":"*"})),Gc("* => void",zc("150ms ease-out")),Gc("void => *",zc("150ms ease-in"))]),TC=(()=>{class r{constructor(){this.isOpen=!1,this.eventClicked=new q,this.trackByEventId=Oh,this.validateDrag=vl}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-open-day-events"]],inputs:{locale:"locale",isOpen:"isOpen",events:"events",customTemplate:"customTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",date:"date"},outputs:{eventClicked:"eventClicked"},decls:3,vars:8,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cal-open-day-events","role","application",4,"ngIf"],["role","application",1,"cal-open-day-events"],["tabindex","-1","role","alert"],["tabindex","0","role","landmark"],["mwlDraggable","","dragActiveClass","cal-drag-active",3,"ngClass","cal-draggable","dropData","dragAxis","validateDrag","touchStartLongPress",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDraggable","","dragActiveClass","cal-drag-active",3,"ngClass","dropData","dragAxis","validateDrag","touchStartLongPress"],[1,"cal-event",3,"ngStyle"],["view","month","tabindex","0",3,"mwlClick","mwlKeydownEnter","event","customTemplate"],[3,"event","customTemplate"]],template:function(t,n){if(t&1&&U(0,hf,1,1,"ng-template",null,0,ot)(2,mf,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Bc(2,cf,n.events,n.eventClicked,n.isOpen,n.trackByEventId,n.validateDrag))}},dependencies:[_t,Yt,Ut,Et,Ao,cs,Ih,kh,vr,gs,yr],encapsulation:2,data:{animation:[yl]}}),r})(),wC=(()=>{class r{constructor(){this.columnHeaderClicked=new q,this.trackByWeekDayHeaderDate=Cl}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-month-view-header"]],inputs:{days:"days",locale:"locale",customTemplate:"customTemplate"},outputs:{columnHeaderClicked:"columnHeaderClicked"},decls:3,vars:6,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["role","row",1,"cal-cell-row","cal-header"],["class","cal-cell","tabindex","0","role","columnheader",3,"cal-past","cal-today","cal-future","cal-weekend","ngClass","click",4,"ngFor","ngForOf","ngForTrackBy"],["tabindex","0","role","columnheader",1,"cal-cell",3,"click","ngClass"]],template:function(t,n){if(t&1&&U(0,ff,2,2,"ng-template",null,0,ot)(2,Cf,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Ka(2,pf,n.days,n.locale,n.trackByWeekDayHeaderDate))}},dependencies:[_t,Yt,Et,fi],encapsulation:2}),r})(),Lh=(()=>{class r{constructor(t,n,i,o){this.cdr=t,this.utils=n,this.dateAdapter=o,this.events=[],this.excludeDays=[],this.activeDayIsOpen=!1,this.tooltipPlacement="auto",this.tooltipAppendToBody=!0,this.tooltipDelay=null,this.beforeViewRender=new q,this.dayClicked=new q,this.eventClicked=new q,this.columnHeaderClicked=new q,this.eventTimesChanged=new q,this.trackByRowOffset=(a,s)=>this.view.days.slice(s,this.view.totalDaysVisibleInWeek).map(c=>c.date.toISOString()).join("-"),this.trackByDate=(a,s)=>s.date.toISOString(),this.locale=i}ngOnInit(){this.refresh&&(this.refreshSubscription=this.refresh.subscribe(()=>{this.refreshAll(),this.cdr.markForCheck()}))}ngOnChanges(t){let n=t.viewDate||t.excludeDays||t.weekendDays,i=t.viewDate||t.events||t.excludeDays||t.weekendDays;n&&this.refreshHeader(),t.events&&Rh(this.events),i&&this.refreshBody(),(n||i)&&this.emitBeforeViewRender(),(t.activeDayIsOpen||t.viewDate||t.events||t.excludeDays||t.activeDay)&&this.checkActiveDayIsOpen()}ngOnDestroy(){this.refreshSubscription&&this.refreshSubscription.unsubscribe()}toggleDayHighlight(t,n){this.view.days.forEach(i=>{n&&i.events.indexOf(t)>-1?i.backgroundColor=t.color&&t.color.secondary||"#D1E8FF":delete i.backgroundColor})}eventDropped(t,n,i){if(t!==i){let o=this.dateAdapter.getYear(t.date),a=this.dateAdapter.getMonth(t.date),s=this.dateAdapter.getDate(t.date),c=this.dateAdapter.setDate(this.dateAdapter.setMonth(this.dateAdapter.setYear(n.start,o),a),s),l;if(n.end){let u=this.dateAdapter.differenceInSeconds(c,n.start);l=this.dateAdapter.addSeconds(n.end,u)}this.eventTimesChanged.emit({event:n,newStart:c,newEnd:l,day:t,type:Bn.Drop})}}refreshHeader(){this.columnHeaders=this.utils.getWeekViewHeader({viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,weekendDays:this.weekendDays})}refreshBody(){this.view=this.utils.getMonthView({events:this.events,viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,weekendDays:this.weekendDays})}checkActiveDayIsOpen(){if(this.activeDayIsOpen===!0){let t=this.activeDay||this.viewDate;this.openDay=this.view.days.find(i=>this.dateAdapter.isSameDay(i.date,t));let n=this.view.days.indexOf(this.openDay);this.openRowIndex=Math.floor(n/this.view.totalDaysVisibleInWeek)*this.view.totalDaysVisibleInWeek}else this.openRowIndex=null,this.openDay=null}refreshAll(){this.refreshHeader(),this.refreshBody(),this.emitBeforeViewRender(),this.checkActiveDayIsOpen()}emitBeforeViewRender(){this.columnHeaders&&this.view&&this.beforeViewRender.emit({header:this.columnHeaders,body:this.view.days,period:this.view.period})}}return r.\u0275fac=function(t){return new(t||r)(N(So),N(fs),N(Eo),N(At))},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-month-view"]],inputs:{viewDate:"viewDate",events:"events",excludeDays:"excludeDays",activeDayIsOpen:"activeDayIsOpen",activeDay:"activeDay",refresh:"refresh",locale:"locale",tooltipPlacement:"tooltipPlacement",tooltipTemplate:"tooltipTemplate",tooltipAppendToBody:"tooltipAppendToBody",tooltipDelay:"tooltipDelay",weekStartsOn:"weekStartsOn",headerTemplate:"headerTemplate",cellTemplate:"cellTemplate",openDayEventsTemplate:"openDayEventsTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",weekendDays:"weekendDays"},outputs:{beforeViewRender:"beforeViewRender",dayClicked:"dayClicked",eventClicked:"eventClicked",columnHeaderClicked:"columnHeaderClicked",eventTimesChanged:"eventTimesChanged"},features:[pr],decls:4,vars:5,consts:[["role","grid",1,"cal-month-view"],[3,"columnHeaderClicked","days","locale","customTemplate"],[1,"cal-days"],[4,"ngFor","ngForOf","ngForTrackBy"],["role","row",1,"cal-cell-row"],["role","gridcell","mwlDroppable","","dragOverClass","cal-drag-over",3,"ngClass","day","openDay","locale","tooltipPlacement","tooltipAppendToBody","tooltipTemplate","tooltipDelay","customTemplate","ngStyle","clickListenerDisabled","mwlClick","mwlKeydownEnter","highlightDay","unhighlightDay","drop","eventClicked",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragOverClass","cal-drag-over",3,"eventClicked","drop","locale","isOpen","events","date","customTemplate","eventTitleTemplate","eventActionsTemplate"],["role","gridcell","mwlDroppable","","dragOverClass","cal-drag-over",3,"mwlClick","mwlKeydownEnter","highlightDay","unhighlightDay","drop","eventClicked","ngClass","day","openDay","locale","tooltipPlacement","tooltipAppendToBody","tooltipTemplate","tooltipDelay","customTemplate","ngStyle","clickListenerDisabled"]],template:function(t,n){t&1&&(f(0,"div",0)(1,"mwl-calendar-month-view-header",1),O("columnHeaderClicked",function(o){return n.columnHeaderClicked.emit(o)}),C(),f(2,"div",2),U(3,yf,5,13,"div",3),C()()),t&2&&(y(),w("days",n.columnHeaders)("locale",n.locale)("customTemplate",n.headerTemplate),y(2),w("ngForOf",n.view.rowOffsets)("ngForTrackBy",n.trackByRowOffset))},dependencies:[_t,Yt,Ao,ls,vr,gs,yC,TC,wC,vu,yr],encapsulation:2}),r})(),_h=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({imports:[St,Do,Po,Do]}),r})(),hl=class{constructor(e,t){this.dragContainerElement=e,this.startPosition=t.getBoundingClientRect()}validateDrag({x:e,y:t,snapDraggedEvents:n,dragAlreadyMoved:i,transform:o}){let a=vl({x:e,y:t})||i;if(n){let s=Object.assign({},this.startPosition,{left:this.startPosition.left+o.x,right:this.startPosition.right+o.x,top:this.startPosition.top+o.y,bottom:this.startPosition.bottom+o.y});if(a){let c=this.dragContainerElement.getBoundingClientRect(),l=c.top<s.top&&s.top<c.bottom,u=c.top<s.bottom&&s.bottom<c.bottom;return Dh(c,s)&&(l||u)}return!1}else return a}},ml=class{constructor(e,t,n){this.resizeContainerElement=e,this.minWidth=t,this.rtl=n}validateResize({rectangle:e,edges:t}){return this.rtl&&(typeof t.left<"u"?(e.left-=t.left,e.right+=t.left):typeof t.right<"u"&&(e.left+=t.right,e.right-=t.right),e.width=e.right-e.left),this.minWidth&&Math.ceil(e.width)<Math.ceil(this.minWidth)?!1:lC(this.resizeContainerElement.getBoundingClientRect(),e)}},_C=(()=>{class r{constructor(){this.dayHeaderClicked=new q,this.eventDropped=new q,this.dragEnter=new q,this.trackByWeekDayHeaderDate=Cl}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-week-view-header"]],inputs:{days:"days",locale:"locale",customTemplate:"customTemplate"},outputs:{dayHeaderClicked:"dayHeaderClicked",eventDropped:"eventDropped",dragEnter:"dragEnter"},decls:3,vars:9,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["role","row",1,"cal-day-headers"],["class","cal-header","mwlDroppable","","dragOverClass","cal-drag-over","tabindex","0","role","columnheader",3,"cal-past","cal-today","cal-future","cal-weekend","ngClass","mwlClick","drop","dragEnter",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragOverClass","cal-drag-over","tabindex","0","role","columnheader",1,"cal-header",3,"mwlClick","drop","dragEnter","ngClass"]],template:function(t,n){if(t&1&&U(0,_f,2,2,"ng-template",null,0,ot)(2,Ef,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",uu(2,Tf,n.days,n.locale,n.dayHeaderClicked,n.eventDropped,n.dragEnter,n.trackByWeekDayHeaderDate))}},dependencies:[_t,Yt,Et,ls,vr,fi],encapsulation:2}),r})(),EC=(()=>{class r{constructor(){this.eventClicked=new q}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-week-view-event"]],inputs:{locale:"locale",weekEvent:"weekEvent",tooltipPlacement:"tooltipPlacement",tooltipAppendToBody:"tooltipAppendToBody",tooltipDisabled:"tooltipDisabled",tooltipDelay:"tooltipDelay",customTemplate:"customTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",tooltipTemplate:"tooltipTemplate",column:"column",daysInWeek:"daysInWeek"},outputs:{eventClicked:"eventClicked"},decls:3,vars:12,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["tabindex","0","role","application",1,"cal-event",3,"mwlClick","mwlKeydownEnter","ngStyle","mwlCalendarTooltip","tooltipPlacement","tooltipEvent","tooltipTemplate","tooltipAppendToBody","tooltipDelay"],[3,"event","customTemplate"],[3,"event","customTemplate","view"]],template:function(t,n){if(t&1&&U(0,If,6,27,"ng-template",null,0,ot)(2,kf,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Vc(2,Sf,[n.weekEvent,n.tooltipPlacement,n.eventClicked,n.tooltipTemplate,n.tooltipAppendToBody,n.tooltipDisabled,n.tooltipDelay,n.column,n.daysInWeek]))}},dependencies:[Et,Ao,Ih,kh,bh,vr,gs,fl,yr],encapsulation:2}),r})(),SC=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-week-view-hour-segment"]],inputs:{segment:"segment",segmentHeight:"segmentHeight",locale:"locale",isTimeLabel:"isTimeLabel",daysInWeek:"daysInWeek",customTemplate:"customTemplate"},decls:3,vars:8,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"cal-hour-segment",3,"ngClass"],["class","cal-time",4,"ngIf"],[1,"cal-time"]],template:function(t,n){if(t&1&&U(0,Df,3,13,"ng-template",null,0,ot)(2,Mf,0,0,"ng-template",1),t&2){let i=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||i)("ngTemplateOutletContext",Bc(2,bf,n.segment,n.locale,n.segmentHeight,n.isTimeLabel,n.daysInWeek))}},dependencies:[_t,Ut,Et,fi,yr],encapsulation:2}),r})(),AC=(()=>{class r{constructor(t,n){this.dateAdapter=t,this.zone=n,this.columnDate$=new La(void 0),this.marker$=this.zone.onStable.pipe(Mn(()=>jd(60*1e3)),Fa(0),Zd(this.columnDate$),Se(i=>{let o=this.dateAdapter.setMinutes(this.dateAdapter.setHours(i,this.dayStartHour),this.dayStartMinute),a=this.dateAdapter.setMinutes(this.dateAdapter.setHours(i,this.dayEndHour),this.dayEndMinute),s=this.hourSegments*this.hourSegmentHeight/(this.hourDuration||60),c=new Date;return{isVisible:this.dateAdapter.isSameDay(i,c)&&c>=o&&c<=a,top:this.dateAdapter.differenceInMinutes(c,o)*s}}))}ngOnChanges(t){t.columnDate&&this.columnDate$.next(t.columnDate.currentValue)}}return r.\u0275fac=function(t){return new(t||r)(N(At),N(sn))},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-week-view-current-time-marker"]],inputs:{columnDate:"columnDate",dayStartHour:"dayStartHour",dayStartMinute:"dayStartMinute",dayEndHour:"dayEndHour",dayEndMinute:"dayEndMinute",hourSegments:"hourSegments",hourDuration:"hourDuration",hourSegmentHeight:"hourSegmentHeight",customTemplate:"customTemplate"},features:[pr],decls:5,vars:14,consts:[["defaultTemplate",""],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","cal-current-time-marker",3,"top",4,"ngIf"],[1,"cal-current-time-marker"]],template:function(t,n){if(t&1&&(U(0,Nf,1,1,"ng-template",null,0,ot)(2,xf,0,0,"ng-template",1),he(3,"async"),he(4,"async")),t&2){let i,o=fe(1);y(2),w("ngTemplateOutlet",n.customTemplate||o)("ngTemplateOutletContext",hu(6,Of,n.columnDate,n.dayStartHour,n.dayStartMinute,n.dayEndHour,n.dayEndMinute,(i=Kc(3,2,n.marker$))==null?null:i.isVisible,(i=Kc(4,4,n.marker$))==null?null:i.top))}},dependencies:[Ut,Et,Cu],encapsulation:2}),r})(),Tl=(()=>{class r{constructor(t,n,i,o,a){this.cdr=t,this.utils=n,this.dateAdapter=o,this.element=a,this.events=[],this.excludeDays=[],this.tooltipPlacement="auto",this.tooltipAppendToBody=!0,this.tooltipDelay=null,this.precision="days",this.snapDraggedEvents=!0,this.hourSegments=2,this.hourSegmentHeight=30,this.minimumEventHeight=30,this.dayStartHour=0,this.dayStartMinute=0,this.dayEndHour=23,this.dayEndMinute=59,this.dayHeaderClicked=new q,this.eventClicked=new q,this.eventTimesChanged=new q,this.beforeViewRender=new q,this.hourSegmentClicked=new q,this.allDayEventResizes=new Map,this.timeEventResizes=new Map,this.eventDragEnterByType={allDay:0,time:0},this.dragActive=!1,this.dragAlreadyMoved=!1,this.calendarId=Symbol("angular calendar week view id"),this.rtl=!1,this.trackByWeekDayHeaderDate=Cl,this.trackByHourSegment=dC,this.trackByHour=uC,this.trackByWeekAllDayEvent=hC,this.trackByWeekTimeEvent=mC,this.trackByHourColumn=(s,c)=>c.hours[0]?c.hours[0].segments[0].date.toISOString():c,this.trackById=(s,c)=>c.id,this.locale=i}ngOnInit(){this.refresh&&(this.refreshSubscription=this.refresh.subscribe(()=>{this.refreshAll(),this.cdr.markForCheck()}))}ngOnChanges(t){let n=t.viewDate||t.excludeDays||t.weekendDays||t.daysInWeek||t.weekStartsOn,i=t.viewDate||t.dayStartHour||t.dayStartMinute||t.dayEndHour||t.dayEndMinute||t.hourSegments||t.hourDuration||t.weekStartsOn||t.weekendDays||t.excludeDays||t.hourSegmentHeight||t.events||t.daysInWeek||t.minimumEventHeight;n&&this.refreshHeader(),t.events&&Rh(this.events),i&&this.refreshBody(),(n||i)&&this.emitBeforeViewRender()}ngOnDestroy(){this.refreshSubscription&&this.refreshSubscription.unsubscribe()}ngAfterViewInit(){this.rtl=typeof window<"u"&&getComputedStyle(this.element.nativeElement).direction==="rtl",this.cdr.detectChanges()}timeEventResizeStarted(t,n,i){this.timeEventResizes.set(n.event,i),this.resizeStarted(t,n)}timeEventResizing(t,n){this.timeEventResizes.set(t.event,n);let i=new Map,o=[...this.events];this.timeEventResizes.forEach((a,s)=>{let c=this.getTimeEventResizedDates(s,a),l=_(_({},s),c);i.set(l,s);let u=o.indexOf(s);o[u]=l}),this.restoreOriginalEvents(o,i,!0)}timeEventResizeEnded(t){this.view=this.getWeekView(this.events);let n=this.timeEventResizes.get(t.event);if(n){this.timeEventResizes.delete(t.event);let i=this.getTimeEventResizedDates(t.event,n);this.eventTimesChanged.emit({newStart:i.start,newEnd:i.end,event:t.event,type:Bn.Resize})}}allDayEventResizeStarted(t,n,i){this.allDayEventResizes.set(n,{originalOffset:n.offset,originalSpan:n.span,edge:typeof i.edges.left<"u"?"left":"right"}),this.resizeStarted(t,n,this.getDayColumnWidth(t))}allDayEventResizing(t,n,i){let o=this.allDayEventResizes.get(t),a=this.rtl?-1:1;if(typeof n.edges.left<"u"){let s=Math.round(+n.edges.left/i)*a;t.offset=o.originalOffset+s,t.span=o.originalSpan-s}else if(typeof n.edges.right<"u"){let s=Math.round(+n.edges.right/i)*a;t.span=o.originalSpan+s}}allDayEventResizeEnded(t){let n=this.allDayEventResizes.get(t);if(n){let i=n.edge==="left",o;i?o=t.offset-n.originalOffset:o=t.span-n.originalSpan,t.offset=n.originalOffset,t.span=n.originalSpan;let a=this.getAllDayEventResizedDates(t.event,o,i);this.eventTimesChanged.emit({newStart:a.start,newEnd:a.end,event:t.event,type:Bn.Resize}),this.allDayEventResizes.delete(t)}}getDayColumnWidth(t){return Math.floor(t.offsetWidth/this.days.length)}dateDragEnter(t){this.lastDragEnterDate=t}eventDropped(t,n,i){CC(t,n,i,this.calendarId)&&this.lastDragEnterDate.getTime()===n.getTime()&&(!this.snapDraggedEvents||t.dropData.event!==this.lastDraggedEvent)&&this.eventTimesChanged.emit({type:Bn.Drop,event:t.dropData.event,newStart:n,allDay:i}),this.lastDraggedEvent=null}dragEnter(t){this.eventDragEnterByType[t]++}dragLeave(t){this.eventDragEnterByType[t]--}dragStarted(t,n,i,o){this.dayColumnWidth=this.getDayColumnWidth(t);let a=new hl(t,n);this.validateDrag=({x:s,y:c,transform:l})=>{let u=this.allDayEventResizes.size===0&&this.timeEventResizes.size===0&&a.validateDrag({x:s,y:c,snapDraggedEvents:this.snapDraggedEvents,dragAlreadyMoved:this.dragAlreadyMoved,transform:l});if(u&&this.validateEventTimesChanged){let m=this.getDragMovedEventTimes(i,{x:s,y:c},this.dayColumnWidth,o);return this.validateEventTimesChanged({type:Bn.Drag,event:i.event,newStart:m.start,newEnd:m.end})}return u},this.dragActive=!0,this.dragAlreadyMoved=!1,this.lastDraggedEvent=null,this.eventDragEnterByType={allDay:0,time:0},!this.snapDraggedEvents&&o&&this.view.hourColumns.forEach(s=>{let c=s.events.find(l=>l.event===i.event&&l!==i);c&&(c.width=0,c.height=0)}),this.cdr.markForCheck()}dragMove(t,n){let i=this.getDragMovedEventTimes(t,n,this.dayColumnWidth,!0),o=t.event,a=_(_({},o),i),s=this.events.map(c=>c===o?a:c);this.restoreOriginalEvents(s,new Map([[a,o]]),this.snapDraggedEvents),this.dragAlreadyMoved=!0}allDayEventDragMove(){this.dragAlreadyMoved=!0}dragEnded(t,n,i,o=!1){this.view=this.getWeekView(this.events),this.dragActive=!1,this.validateDrag=null;let{start:a,end:s}=this.getDragMovedEventTimes(t,n,i,o);(this.snapDraggedEvents||this.eventDragEnterByType[o?"time":"allDay"]>0)&&fC(a,s,this.view.period)&&(this.lastDraggedEvent=t.event,this.eventTimesChanged.emit({newStart:a,newEnd:s,event:t.event,type:Bn.Drag,allDay:!o}))}refreshHeader(){this.days=this.utils.getWeekViewHeader(_({viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,weekendDays:this.weekendDays},ul(this.dateAdapter,this.viewDate,this.weekStartsOn,this.excludeDays,this.daysInWeek)))}refreshBody(){this.view=this.getWeekView(this.events)}refreshAll(){this.refreshHeader(),this.refreshBody(),this.emitBeforeViewRender()}emitBeforeViewRender(){this.days&&this.view&&this.beforeViewRender.emit(_({header:this.days},this.view))}getWeekView(t){return this.utils.getWeekView(_({events:t,viewDate:this.viewDate,weekStartsOn:this.weekStartsOn,excluded:this.excludeDays,precision:this.precision,absolutePositionedEvents:!0,hourSegments:this.hourSegments,hourDuration:this.hourDuration,dayStart:{hour:this.dayStartHour,minute:this.dayStartMinute},dayEnd:{hour:this.dayEndHour,minute:this.dayEndMinute},segmentHeight:this.hourSegmentHeight,weekendDays:this.weekendDays,minimumEventHeight:this.minimumEventHeight},ul(this.dateAdapter,this.viewDate,this.weekStartsOn,this.excludeDays,this.daysInWeek)))}getDragMovedEventTimes(t,n,i,o){let a=Mh(n.x,i)/i*(this.rtl?-1:1),s=o?dl(n.y,this.hourSegments,this.hourSegmentHeight,this.eventSnapSize,this.hourDuration):0,c=this.dateAdapter.addMinutes(Vt(this.dateAdapter,t.event.start,a,this.excludeDays),s),l;return t.event.end&&(l=this.dateAdapter.addMinutes(Vt(this.dateAdapter,t.event.end,a,this.excludeDays),s)),{start:c,end:l}}restoreOriginalEvents(t,n,i=!0){let o=this.view;i&&(this.view=this.getWeekView(t));let a=t.filter(s=>n.has(s));this.view.hourColumns.forEach((s,c)=>{o.hourColumns[c].hours.forEach((l,u)=>{l.segments.forEach((m,v)=>{s.hours[u].segments[v].cssClass=m.cssClass})}),a.forEach(l=>{let u=n.get(l),m=s.events.find(v=>v.event===(i?l:u));if(m)m.event=u,m.tempEvent=l,i||(m.height=0,m.width=0);else{let v={event:u,left:0,top:0,height:0,width:0,startsBeforeDay:!1,endsAfterDay:!1,tempEvent:l};s.events.push(v)}})}),n.clear()}getTimeEventResizedDates(t,n){let i={start:t.start,end:wh(this.dateAdapter,t,this.minimumEventHeight)},l=t,{end:o}=l,a=vt(l,["end"]),s={start:this.dateAdapter.addMinutes(i.end,this.minimumEventHeight*-1),end:wh(this.dateAdapter,a,this.minimumEventHeight)},c=this.rtl?-1:1;if(typeof n.edges.left<"u"){let u=Math.round(+n.edges.left/this.dayColumnWidth)*c,m=Vt(this.dateAdapter,i.start,u,this.excludeDays);m<s.start?i.start=m:i.start=s.start}else if(typeof n.edges.right<"u"){let u=Math.round(+n.edges.right/this.dayColumnWidth)*c,m=Vt(this.dateAdapter,i.end,u,this.excludeDays);m>s.end?i.end=m:i.end=s.end}if(typeof n.edges.top<"u"){let u=dl(n.edges.top,this.hourSegments,this.hourSegmentHeight,this.eventSnapSize,this.hourDuration),m=this.dateAdapter.addMinutes(i.start,u);m<s.start?i.start=m:i.start=s.start}else if(typeof n.edges.bottom<"u"){let u=dl(n.edges.bottom,this.hourSegments,this.hourSegmentHeight,this.eventSnapSize,this.hourDuration),m=this.dateAdapter.addMinutes(i.end,u);m>s.end?i.end=m:i.end=s.end}return i}resizeStarted(t,n,i){this.dayColumnWidth=this.getDayColumnWidth(t);let o=new ml(t,i,this.rtl);this.validateResize=({rectangle:a,edges:s})=>{let c=o.validateResize({rectangle:_({},a),edges:s});if(c&&this.validateEventTimesChanged){let l;if(!i)l=this.getTimeEventResizedDates(n.event,{rectangle:a,edges:s});else{let u=this.rtl?-1:1;if(typeof s.left<"u"){let m=Math.round(+s.left/i)*u;l=this.getAllDayEventResizedDates(n.event,m,!this.rtl)}else{let m=Math.round(+s.right/i)*u;l=this.getAllDayEventResizedDates(n.event,m,this.rtl)}}return this.validateEventTimesChanged({type:Bn.Resize,event:n.event,newStart:l.start,newEnd:l.end})}return c},this.cdr.markForCheck()}getAllDayEventResizedDates(t,n,i){let o=t.start,a=t.end||t.start;return i?o=Vt(this.dateAdapter,o,n,this.excludeDays):a=Vt(this.dateAdapter,a,n,this.excludeDays),{start:o,end:a}}}return r.\u0275fac=function(t){return new(t||r)(N(So),N(fs),N(Eo),N(At),N(nt))},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-week-view"]],inputs:{viewDate:"viewDate",events:"events",excludeDays:"excludeDays",refresh:"refresh",locale:"locale",tooltipPlacement:"tooltipPlacement",tooltipTemplate:"tooltipTemplate",tooltipAppendToBody:"tooltipAppendToBody",tooltipDelay:"tooltipDelay",weekStartsOn:"weekStartsOn",headerTemplate:"headerTemplate",eventTemplate:"eventTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",precision:"precision",weekendDays:"weekendDays",snapDraggedEvents:"snapDraggedEvents",hourSegments:"hourSegments",hourDuration:"hourDuration",hourSegmentHeight:"hourSegmentHeight",minimumEventHeight:"minimumEventHeight",dayStartHour:"dayStartHour",dayStartMinute:"dayStartMinute",dayEndHour:"dayEndHour",dayEndMinute:"dayEndMinute",hourSegmentTemplate:"hourSegmentTemplate",eventSnapSize:"eventSnapSize",allDayEventsLabelTemplate:"allDayEventsLabelTemplate",daysInWeek:"daysInWeek",currentTimeMarkerTemplate:"currentTimeMarkerTemplate",validateEventTimesChanged:"validateEventTimesChanged",resizeCursors:"resizeCursors"},outputs:{dayHeaderClicked:"dayHeaderClicked",eventClicked:"eventClicked",eventTimesChanged:"eventTimesChanged",beforeViewRender:"beforeViewRender",hourSegmentClicked:"hourSegmentClicked"},features:[pr],decls:8,vars:9,consts:[["dayColumns",""],["allDayEventsContainer",""],["eventRowContainer",""],["event",""],["weekEventTemplate",""],["role","grid",1,"cal-week-view"],[3,"dayHeaderClicked","eventDropped","dragEnter","days","locale","customTemplate"],["class","cal-all-day-events","mwlDroppable","",3,"dragEnter","dragLeave",4,"ngIf"],["mwlDroppable","",1,"cal-time-events",3,"dragEnter","dragLeave"],["class","cal-time-label-column",4,"ngIf"],[1,"cal-day-columns"],["class","cal-day-column",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","",1,"cal-all-day-events",3,"dragEnter","dragLeave"],[1,"cal-time-label-column"],[4,"ngTemplateOutlet"],["class","cal-day-column","mwlDroppable","","dragOverClass","cal-drag-over",3,"drop","dragEnter",4,"ngFor","ngForOf","ngForTrackBy"],["class","cal-events-row",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragOverClass","cal-drag-over",1,"cal-day-column",3,"drop","dragEnter"],[1,"cal-events-row"],["class","cal-event-container","mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",3,"cal-draggable","cal-starts-within-week","cal-ends-within-week","ngClass","width","marginLeft","marginRight","resizeCursors","resizeSnapGrid","validateResize","dropData","dragAxis","dragSnapGrid","validateDrag","touchStartLongPress","resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd",4,"ngFor","ngForOf","ngForTrackBy"],["mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",1,"cal-event-container",3,"resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd","ngClass","resizeCursors","resizeSnapGrid","validateResize","dropData","dragAxis","dragSnapGrid","validateDrag","touchStartLongPress"],["class","cal-resize-handle cal-resize-handle-before-start","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],[3,"eventClicked","locale","weekEvent","tooltipPlacement","tooltipTemplate","tooltipAppendToBody","tooltipDelay","customTemplate","eventTitleTemplate","eventActionsTemplate","daysInWeek"],["class","cal-resize-handle cal-resize-handle-after-end","mwlResizeHandle","",3,"resizeEdges",4,"ngIf"],["mwlResizeHandle","",1,"cal-resize-handle","cal-resize-handle-before-start",3,"resizeEdges"],["mwlResizeHandle","",1,"cal-resize-handle","cal-resize-handle-after-end",3,"resizeEdges"],["class","cal-hour",3,"cal-hour-odd",4,"ngFor","ngForOf","ngForTrackBy"],[1,"cal-hour"],[3,"height","segment","segmentHeight","locale","customTemplate","isTimeLabel","daysInWeek",4,"ngFor","ngForOf","ngForTrackBy"],[3,"segment","segmentHeight","locale","customTemplate","isTimeLabel","daysInWeek"],[1,"cal-day-column"],[3,"columnDate","dayStartHour","dayStartMinute","dayEndHour","dayEndMinute","hourSegments","hourDuration","hourSegmentHeight","customTemplate"],[1,"cal-events-container"],["class","cal-event-container","mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",3,"cal-draggable","cal-starts-within-day","cal-ends-within-day","ngClass","hidden","top","height","left","width","resizeCursors","resizeSnapGrid","validateResize","allowNegativeResizes","dropData","dragAxis","dragSnapGrid","touchStartLongPress","ghostDragEnabled","ghostElementTemplate","validateDrag","resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd",4,"ngFor","ngForOf","ngForTrackBy"],["mwlResizable","","mwlDraggable","","dragActiveClass","cal-drag-active",1,"cal-event-container",3,"resizeStart","resizing","resizeEnd","dragStart","dragging","dragEnd","ngClass","hidden","resizeCursors","resizeSnapGrid","validateResize","allowNegativeResizes","dropData","dragAxis","dragSnapGrid","touchStartLongPress","ghostDragEnabled","ghostElementTemplate","validateDrag"],[3,"ngTemplateOutlet"],[3,"eventClicked","locale","weekEvent","tooltipPlacement","tooltipTemplate","tooltipAppendToBody","tooltipDisabled","tooltipDelay","customTemplate","eventTitleTemplate","eventActionsTemplate","column","daysInWeek"],["mwlDroppable","","dragActiveClass","cal-drag-active",3,"height","segment","segmentHeight","locale","customTemplate","daysInWeek","clickListenerDisabled","dragOverClass","isTimeLabel","mwlClick","drop","dragEnter",4,"ngFor","ngForOf","ngForTrackBy"],["mwlDroppable","","dragActiveClass","cal-drag-active",3,"mwlClick","drop","dragEnter","segment","segmentHeight","locale","customTemplate","daysInWeek","clickListenerDisabled","dragOverClass","isTimeLabel"]],template:function(t,n){if(t&1){let i=ae();f(0,"div",5)(1,"mwl-calendar-week-view-header",6),O("dayHeaderClicked",function(a){return b(i),R(n.dayHeaderClicked.emit(a))})("eventDropped",function(a){return b(i),R(n.eventDropped({dropData:a},a.newStart,!0))})("dragEnter",function(a){return b(i),R(n.dateDragEnter(a.date))}),C(),U(2,jf,7,5,"div",7),f(3,"div",8),O("dragEnter",function(){return b(i),R(n.dragEnter("time"))})("dragLeave",function(){return b(i),R(n.dragLeave("time"))}),U(4,Jf,2,2,"div",9),f(5,"div",10,0),U(7,aC,5,13,"div",11),C()()()}t&2&&(y(),w("days",n.days)("locale",n.locale)("customTemplate",n.headerTemplate),y(),w("ngIf",n.view.allDayEventRows.length>0),y(2),w("ngIf",n.view.hourColumns.length>0&&n.daysInWeek!==1),y(),Ae("cal-resize-active",n.timeEventResizes.size>0),y(2),w("ngForOf",n.view.hourColumns)("ngForTrackBy",n.trackByHourColumn))},dependencies:[_t,Yt,Ut,Et,cl,yh,cs,ls,vr,_C,EC,SC,AC],encapsulation:2}),r})(),pl=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({imports:[St,ll,Do,Po,ll,Do]}),r})(),Hh=(()=>{class r{constructor(){this.events=[],this.hourSegments=2,this.hourSegmentHeight=30,this.minimumEventHeight=30,this.dayStartHour=0,this.dayStartMinute=0,this.dayEndHour=23,this.dayEndMinute=59,this.tooltipPlacement="auto",this.tooltipAppendToBody=!0,this.tooltipDelay=null,this.snapDraggedEvents=!0,this.eventClicked=new q,this.hourSegmentClicked=new q,this.eventTimesChanged=new q,this.beforeViewRender=new q}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=J({type:r,selectors:[["mwl-calendar-day-view"]],inputs:{viewDate:"viewDate",events:"events",hourSegments:"hourSegments",hourSegmentHeight:"hourSegmentHeight",hourDuration:"hourDuration",minimumEventHeight:"minimumEventHeight",dayStartHour:"dayStartHour",dayStartMinute:"dayStartMinute",dayEndHour:"dayEndHour",dayEndMinute:"dayEndMinute",refresh:"refresh",locale:"locale",eventSnapSize:"eventSnapSize",tooltipPlacement:"tooltipPlacement",tooltipTemplate:"tooltipTemplate",tooltipAppendToBody:"tooltipAppendToBody",tooltipDelay:"tooltipDelay",hourSegmentTemplate:"hourSegmentTemplate",eventTemplate:"eventTemplate",eventTitleTemplate:"eventTitleTemplate",eventActionsTemplate:"eventActionsTemplate",snapDraggedEvents:"snapDraggedEvents",allDayEventsLabelTemplate:"allDayEventsLabelTemplate",currentTimeMarkerTemplate:"currentTimeMarkerTemplate",validateEventTimesChanged:"validateEventTimesChanged",resizeCursors:"resizeCursors"},outputs:{eventClicked:"eventClicked",hourSegmentClicked:"hourSegmentClicked",eventTimesChanged:"eventTimesChanged",beforeViewRender:"beforeViewRender"},decls:1,vars:27,consts:[[1,"cal-day-view",3,"eventClicked","hourSegmentClicked","eventTimesChanged","beforeViewRender","daysInWeek","viewDate","events","hourSegments","hourDuration","hourSegmentHeight","minimumEventHeight","dayStartHour","dayStartMinute","dayEndHour","dayEndMinute","refresh","locale","eventSnapSize","tooltipPlacement","tooltipTemplate","tooltipAppendToBody","tooltipDelay","resizeCursors","hourSegmentTemplate","eventTemplate","eventTitleTemplate","eventActionsTemplate","snapDraggedEvents","allDayEventsLabelTemplate","currentTimeMarkerTemplate","validateEventTimesChanged"]],template:function(t,n){t&1&&(f(0,"mwl-calendar-week-view",0),O("eventClicked",function(o){return n.eventClicked.emit(o)})("hourSegmentClicked",function(o){return n.hourSegmentClicked.emit(o)})("eventTimesChanged",function(o){return n.eventTimesChanged.emit(o)})("beforeViewRender",function(o){return n.beforeViewRender.emit(o)}),C()),t&2&&w("daysInWeek",1)("viewDate",n.viewDate)("events",n.events)("hourSegments",n.hourSegments)("hourDuration",n.hourDuration)("hourSegmentHeight",n.hourSegmentHeight)("minimumEventHeight",n.minimumEventHeight)("dayStartHour",n.dayStartHour)("dayStartMinute",n.dayStartMinute)("dayEndHour",n.dayEndHour)("dayEndMinute",n.dayEndMinute)("refresh",n.refresh)("locale",n.locale)("eventSnapSize",n.eventSnapSize)("tooltipPlacement",n.tooltipPlacement)("tooltipTemplate",n.tooltipTemplate)("tooltipAppendToBody",n.tooltipAppendToBody)("tooltipDelay",n.tooltipDelay)("resizeCursors",n.resizeCursors)("hourSegmentTemplate",n.hourSegmentTemplate)("eventTemplate",n.eventTemplate)("eventTitleTemplate",n.eventTitleTemplate)("eventActionsTemplate",n.eventActionsTemplate)("snapDraggedEvents",n.snapDraggedEvents)("allDayEventsLabelTemplate",n.allDayEventsLabelTemplate)("currentTimeMarkerTemplate",n.currentTimeMarkerTemplate)("validateEventTimesChanged",n.validateEventTimesChanged)},dependencies:[Tl],encapsulation:2}),r})(),Eh=(()=>{class r{}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({imports:[St,Po,pl]}),r})(),Ci=(()=>{class r{static forRoot(t,n={}){return{ngModule:r,providers:[t,n.eventTitleFormatter||Oo,n.dateFormatter||hs,n.utils||fs,n.a11y||us]}}}return r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=ut({type:r}),r.\u0275inj=dt({imports:[Po,_h,pl,Eh,Po,_h,pl,Eh]}),r})();var Uh=(()=>{class r{view=jt.Month;viewDate=new Date;locale="en";viewChange=new q;viewDateChange=new q;CalendarView=jt;static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-calendar-header"]],inputs:{view:"view",viewDate:"viewDate",locale:"locale"},outputs:{viewChange:"viewChange",viewDateChange:"viewDateChange"},standalone:!0,features:[we],decls:22,vars:16,consts:[[1,"row","text-center"],[1,"col-md-4"],[1,"btn-group"],["mwlCalendarPreviousView","",1,"btn","btn-primary",3,"viewDateChange","view","viewDate"],["mwlCalendarToday","",1,"btn","btn-outline-secondary",3,"viewDateChange","viewDate"],["mwlCalendarNextView","",1,"btn","btn-primary",3,"viewDateChange","view","viewDate"],[1,"btn","btn-primary",3,"click"]],template:function(n,i){n&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3),xn("viewDateChange",function(a){return ln(i.viewDate,a)||(i.viewDate=a),a}),O("viewDateChange",function(){return i.viewDateChange.next(i.viewDate)}),x(4," Previous "),C(),f(5,"div",4),xn("viewDateChange",function(a){return ln(i.viewDate,a)||(i.viewDate=a),a}),O("viewDateChange",function(){return i.viewDateChange.next(i.viewDate)}),x(6," Today "),C(),f(7,"div",5),xn("viewDateChange",function(a){return ln(i.viewDate,a)||(i.viewDate=a),a}),O("viewDateChange",function(){return i.viewDateChange.next(i.viewDate)}),x(8," Next "),C()()(),f(9,"div",1)(10,"h3"),x(11),he(12,"calendarDate"),C()(),f(13,"div",1)(14,"div",2)(15,"div",6),O("click",function(){return i.viewChange.emit(i.CalendarView.Month)}),x(16," Month "),C(),f(17,"div",6),O("click",function(){return i.viewChange.emit(i.CalendarView.Week)}),x(18," Week "),C(),f(19,"div",6),O("click",function(){return i.viewChange.emit(i.CalendarView.Day)}),x(20," Day "),C()()()(),K(21,"br")),n&2&&(y(3),w("view",i.view),Nn("viewDate",i.viewDate),y(2),Nn("viewDate",i.viewDate),y(2),w("view",i.view),Nn("viewDate",i.viewDate),y(4),mt(wt(12,12,i.viewDate,i.view+"ViewTitle",i.locale)),y(4),Ae("active",i.view===i.CalendarView.Month),y(2),Ae("active",i.view===i.CalendarView.Week),y(2),Ae("active",i.view===i.CalendarView.Day))},dependencies:[Ci,Ph,Nh,xh,fi]})}return r})();function IC(r,e){if(r&1){let t=ae();f(0,"mwl-calendar-month-view",4),O("eventTimesChanged",function(i){b(t);let o=S();return R(o.eventTimesChanged(i))}),C()}if(r&2){let t=S();w("viewDate",t.viewDate)("events",t.events())("activeDayIsOpen",!1)("refresh",t.refresh)}}function kC(r,e){if(r&1){let t=ae();f(0,"mwl-calendar-week-view",5),O("eventTimesChanged",function(i){b(t);let o=S();return R(o.eventTimesChanged(i))}),C()}if(r&2){let t=S();w("viewDate",t.viewDate)("events",t.events())("refresh",t.refresh)}}function bC(r,e){if(r&1){let t=ae();f(0,"mwl-calendar-day-view",5),O("eventTimesChanged",function(i){b(t);let o=S();return R(o.eventTimesChanged(i))}),C()}if(r&2){let t=S();w("viewDate",t.viewDate)("events",t.events())("refresh",t.refresh)}}var Bh=(()=>{class r{eventListService=de(Hn);destroyRef=de(On);events=Ft(()=>this.eventListService.loadedEvents().map(t=>({id:t.id,title:t.userName,start:t.fromDate,end:t.toDate,color:this.eventListService.mapColorToEventStatus(t.status)})));view=jt.Month;viewDate=new Date;refresh=new Me;isFetching=rt(!1);error=rt("");ngOnInit(){this.isFetching.set(!0);let t=this.eventListService.loadEvents().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{console.error(n.message),this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}eventTimesChanged({event:t,newStart:n,newEnd:i}){t.start=n,t.end=i,this.refresh.next()}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-calendar"]],standalone:!0,features:[we],decls:7,vars:6,consts:[[3,"viewChange","viewDateChange","view","viewDate"],[3,"ngSwitch"],[3,"viewDate","events","activeDayIsOpen","refresh","eventTimesChanged",4,"ngSwitchCase"],[3,"viewDate","events","refresh","eventTimesChanged",4,"ngSwitchCase"],[3,"eventTimesChanged","viewDate","events","activeDayIsOpen","refresh"],[3,"eventTimesChanged","viewDate","events","refresh"]],template:function(n,i){n&1&&(f(0,"header")(1,"app-calendar-header",0),xn("viewChange",function(a){return ln(i.view,a)||(i.view=a),a})("viewDateChange",function(a){return ln(i.viewDate,a)||(i.viewDate=a),a}),C()(),f(2,"main")(3,"div",1),U(4,IC,1,4,"mwl-calendar-month-view",2)(5,kC,1,3,"mwl-calendar-week-view",3)(6,bC,1,3,"mwl-calendar-day-view",3),C()()),n&2&&(y(),Nn("view",i.view)("viewDate",i.viewDate),y(2),w("ngSwitch",i.view),y(),w("ngSwitchCase","month"),y(),w("ngSwitchCase","week"),y(),w("ngSwitchCase","day"))},dependencies:[Uh,Ci,Lh,Tl,Hh,St,gu,fu],data:{animation:[yl]}})}return r})();var rc={};Ot(rc,{blockAPICallsBeforeInitialize:()=>tc,blockAcquireTokenInPopups:()=>Sm,blockNonBrowserEnvironment:()=>Am,blockRedirectInIframe:()=>Em,blockReloadInHiddenIframes:()=>_m,clearHash:()=>Od,createGuid:()=>Tv,getCurrentUri:()=>st,getHomepage:()=>Nd,invoke:()=>Ze,invokeAsync:()=>E,isInIframe:()=>Ea,isInPopup:()=>wm,preconnect:()=>Aa,preflightCheck:()=>Sa,redirectPreflightCheck:()=>nc,replaceHash:()=>Pd});var $n={};Ot($n,{checkMaxAge:()=>ea,extractTokenClaims:()=>fn,getJWSPayload:()=>qh});var p={LIBRARY_NAME:"MSAL.JS",SKU:"msal.js.common",CACHE_PREFIX:"msal",DEFAULT_AUTHORITY:"https://login.microsoftonline.com/common/",DEFAULT_AUTHORITY_HOST:"login.microsoftonline.com",DEFAULT_COMMON_TENANT:"common",ADFS:"adfs",DSTS:"dstsv2",AAD_INSTANCE_DISCOVERY_ENDPT:"https://login.microsoftonline.com/common/discovery/instance?api-version=1.1&authorization_endpoint=",CIAM_AUTH_URL:".ciamlogin.com",AAD_TENANT_DOMAIN_SUFFIX:".onmicrosoft.com",RESOURCE_DELIM:"|",NO_ACCOUNT:"NO_ACCOUNT",CLAIMS:"claims",CONSUMER_UTID:"9188040d-6c67-4c5b-b112-36a304b66dad",OPENID_SCOPE:"openid",PROFILE_SCOPE:"profile",OFFLINE_ACCESS_SCOPE:"offline_access",EMAIL_SCOPE:"email",CODE_RESPONSE_TYPE:"code",CODE_GRANT_TYPE:"authorization_code",RT_GRANT_TYPE:"refresh_token",FRAGMENT_RESPONSE_MODE:"fragment",S256_CODE_CHALLENGE_METHOD:"S256",URL_FORM_CONTENT_TYPE:"application/x-www-form-urlencoded;charset=utf-8",AUTHORIZATION_PENDING:"authorization_pending",NOT_DEFINED:"not_defined",EMPTY_STRING:"",NOT_APPLICABLE:"N/A",NOT_AVAILABLE:"Not Available",FORWARD_SLASH:"/",IMDS_ENDPOINT:"http://169.254.169.254/metadata/instance/compute/location",IMDS_VERSION:"2020-06-01",IMDS_TIMEOUT:2e3,AZURE_REGION_AUTO_DISCOVER_FLAG:"TryAutoDetect",REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX:"login.microsoft.com",KNOWN_PUBLIC_CLOUDS:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"],TOKEN_RESPONSE_TYPE:"token",ID_TOKEN_RESPONSE_TYPE:"id_token",SHR_NONCE_VALIDITY:240,INVALID_INSTANCE:"invalid_instance"},vi={SUCCESS:200,SUCCESS_RANGE_START:200,SUCCESS_RANGE_END:299,REDIRECT:302,CLIENT_ERROR:400,CLIENT_ERROR_RANGE_START:400,BAD_REQUEST:400,UNAUTHORIZED:401,NOT_FOUND:404,REQUEST_TIMEOUT:408,TOO_MANY_REQUESTS:429,CLIENT_ERROR_RANGE_END:499,SERVER_ERROR:500,SERVER_ERROR_RANGE_START:500,SERVICE_UNAVAILABLE:503,GATEWAY_TIMEOUT:504,SERVER_ERROR_RANGE_END:599,MULTI_SIDED_ERROR:600},pt=[p.OPENID_SCOPE,p.PROFILE_SCOPE,p.OFFLINE_ACCESS_SCOPE],wl=[...pt,p.EMAIL_SCOPE],je={CONTENT_TYPE:"Content-Type",RETRY_AFTER:"Retry-After",CCS_HEADER:"X-AnchorMailbox",WWWAuthenticate:"WWW-Authenticate",AuthenticationInfo:"Authentication-Info",X_MS_REQUEST_ID:"x-ms-request-id",X_MS_HTTP_VERSION:"x-ms-httpver"},be={ID_TOKEN:"idtoken",CLIENT_INFO:"client.info",ADAL_ID_TOKEN:"adal.idtoken",ERROR:"error",ERROR_DESC:"error.description",ACTIVE_ACCOUNT:"active-account",ACTIVE_ACCOUNT_FILTERS:"active-account-filters"},Kt={COMMON:"common",ORGANIZATIONS:"organizations",CONSUMERS:"consumers"},yi={ACCESS_TOKEN:"access_token",XMS_CC:"xms_cc"},Ce={LOGIN:"login",SELECT_ACCOUNT:"select_account",CONSENT:"consent",NONE:"none",CREATE:"create",NO_SESSION:"no_session"},Cs={PLAIN:"plain",S256:"S256"},zt={QUERY:"query",FRAGMENT:"fragment"},_l=z(_({},zt),{FORM_POST:"form_post"}),No={IMPLICIT_GRANT:"implicit",AUTHORIZATION_CODE_GRANT:"authorization_code",CLIENT_CREDENTIALS_GRANT:"client_credentials",RESOURCE_OWNER_PASSWORD_GRANT:"password",REFRESH_TOKEN_GRANT:"refresh_token",DEVICE_CODE_GRANT:"device_code",JWT_BEARER:"urn:ietf:params:oauth:grant-type:jwt-bearer"},Ti={MSSTS_ACCOUNT_TYPE:"MSSTS",ADFS_ACCOUNT_TYPE:"ADFS",MSAV1_ACCOUNT_TYPE:"MSA",GENERIC_ACCOUNT_TYPE:"Generic"},ke={CACHE_KEY_SEPARATOR:"-",CLIENT_INFO_SEPARATOR:"."},G={ID_TOKEN:"IdToken",ACCESS_TOKEN:"AccessToken",ACCESS_TOKEN_WITH_AUTH_SCHEME:"AccessToken_With_AuthScheme",REFRESH_TOKEN:"RefreshToken"};var xo="appmetadata",Vh="client_info",Vn="1",wi={CACHE_KEY:"authority-metadata",REFRESH_TIME_SECONDS:3600*24},Qe={CONFIG:"config",CACHE:"cache",NETWORK:"network",HARDCODED_VALUES:"hardcoded_values"},Ne={SCHEMA_VERSION:5,MAX_CUR_HEADER_BYTES:80,MAX_LAST_HEADER_BYTES:330,MAX_CACHED_ERRORS:50,CACHE_KEY:"server-telemetry",CATEGORY_SEPARATOR:"|",VALUE_SEPARATOR:",",OVERFLOW_TRUE:"1",OVERFLOW_FALSE:"0",UNKNOWN_ERROR:"unknown_error"},ne={BEARER:"Bearer",POP:"pop",SSH:"ssh-cert"},hn={DEFAULT_THROTTLE_TIME_SECONDS:60,DEFAULT_MAX_THROTTLE_TIME_SECONDS:3600,THROTTLING_PREFIX:"throttling",X_MS_LIB_CAPABILITY_VALUE:"retry-after, h429"},vs={INVALID_GRANT_ERROR:"invalid_grant",CLIENT_MISMATCH_ERROR:"client_mismatch"},ys={username:"username",password:"password"},Lo={httpSuccess:200,httpBadRequest:400},Tr={FAILED_AUTO_DETECTION:"1",INTERNAL_CACHE:"2",ENVIRONMENT_VARIABLE:"3",IMDS:"4"},Ts={CONFIGURED_MATCHES_DETECTED:"1",CONFIGURED_NO_AUTO_DETECTION:"2",CONFIGURED_NOT_DETECTED:"3",AUTO_DETECTION_REQUESTED_SUCCESSFUL:"4",AUTO_DETECTION_REQUESTED_FAILED:"5"},qt={NOT_APPLICABLE:"0",FORCE_REFRESH_OR_CLAIMS:"1",NO_CACHED_ACCESS_TOKEN:"2",CACHED_ACCESS_TOKEN_EXPIRED:"3",PROACTIVELY_REFRESHED:"4"},ws={Jwt:"JWT",Jwk:"JWK",Pop:"pop"};var El=300;var wr={};Ot(wr,{postRequestFailed:()=>Fo,unexpectedError:()=>Ho});var Ho="unexpected_error",Fo="post_request_failed";var _s={[Ho]:"Unexpected error in authentication.",[Fo]:"Post request failed from the network, could be a 4xx/5xx or a network unavailability. Please check the exact error code for details."},Kh={unexpectedError:{code:Ho,desc:_s[Ho]},postRequestFailed:{code:Fo,desc:_s[Fo]}},re=class r extends Error{constructor(e,t,n){let i=t?`${e}: ${t}`:e;super(i),Object.setPrototypeOf(this,r.prototype),this.errorCode=e||p.EMPTY_STRING,this.errorMessage=t||p.EMPTY_STRING,this.subError=n||p.EMPTY_STRING,this.name="AuthError"}setCorrelationId(e){this.correlationId=e}};function Uo(r,e){return new re(r,e?`${_s[r]} ${e}`:_s[r])}var xe={};Ot(xe,{authTimeNotFound:()=>mn,authorizationCodeMissingFromServerResponse:()=>Lr,bindingKeyNotRemoved:()=>Hr,cannotAppendScopeSet:()=>Pr,cannotRemoveEmptyScope:()=>Or,clientInfoDecodingError:()=>Kn,clientInfoEmptyError:()=>_r,deviceCodeExpired:()=>zo,deviceCodePollingCancelled:()=>Ko,deviceCodeUnknownError:()=>qo,emptyInputScopeSet:()=>Wn,endSessionEndpointNotSupported:()=>Fr,endpointResolutionError:()=>Xe,hashNotDeserialized:()=>Ir,invalidAssertion:()=>$o,invalidCacheEnvironment:()=>gn,invalidCacheRecord:()=>Nr,invalidClientCredential:()=>Yo,invalidState:()=>Wt,keyIdMissing:()=>Ur,maxAgeTranspired:()=>Rr,methodNotImplemented:()=>Y,missingTenantIdError:()=>Jo,multipleMatchingAccounts:()=>Vo,multipleMatchingAppMetadata:()=>Dr,multipleMatchingTokens:()=>Bo,nestedAppAuthBridgeDisabled:()=>Zo,networkError:()=>Sr,noAccountFound:()=>Wo,noAccountInSilentRequest:()=>pn,noCryptoObject:()=>Gn,noNetworkConnectivity:()=>Qo,nonceMismatch:()=>br,nullOrEmptyToken:()=>Er,openIdConfigError:()=>Ar,requestCannotBeMade:()=>Mr,stateMismatch:()=>kr,stateNotFound:()=>qn,tokenClaimsCnfRequiredForSignedJwt:()=>xr,tokenParsingError:()=>zn,tokenRefreshRequired:()=>Qt,unexpectedCredentialType:()=>Go,userCanceled:()=>Xo,userTimeoutReached:()=>jo});var Kn="client_info_decoding_error",_r="client_info_empty_error",zn="token_parsing_error",Er="null_or_empty_token",Xe="endpoints_resolution_error",Sr="network_error",Ar="openid_config_error",Ir="hash_not_deserialized",Wt="invalid_state",kr="state_mismatch",qn="state_not_found",br="nonce_mismatch",mn="auth_time_not_found",Rr="max_age_transpired",Bo="multiple_matching_tokens",Vo="multiple_matching_accounts",Dr="multiple_matching_appMetadata",Mr="request_cannot_be_made",Or="cannot_remove_empty_scope",Pr="cannot_append_scopeset",Wn="empty_input_scopeset",Ko="device_code_polling_cancelled",zo="device_code_expired",qo="device_code_unknown_error",pn="no_account_in_silent_request",Nr="invalid_cache_record",gn="invalid_cache_environment",Wo="no_account_found",Gn="no_crypto_object",Go="unexpected_credential_type",$o="invalid_assertion",Yo="invalid_client_credential",Qt="token_refresh_required",jo="user_timeout_reached",xr="token_claims_cnf_required_for_signedjwt",Lr="authorization_code_missing_from_server_response",Hr="binding_key_not_removed",Fr="end_session_endpoint_not_supported",Ur="key_id_missing",Qo="no_network_connectivity",Xo="user_canceled",Jo="missing_tenant_id_error",Y="method_not_implemented",Zo="nested_app_auth_bridge_disabled";var j={[Kn]:"The client info could not be parsed/decoded correctly",[_r]:"The client info was empty",[zn]:"Token cannot be parsed",[Er]:"The token is null or empty",[Xe]:"Endpoints cannot be resolved",[Sr]:"Network request failed",[Ar]:"Could not retrieve endpoints. Check your authority and verify the .well-known/openid-configuration endpoint returns the required endpoints.",[Ir]:"The hash parameters could not be deserialized",[Wt]:"State was not the expected format",[kr]:"State mismatch error",[qn]:"State not found",[br]:"Nonce mismatch error",[mn]:"Max Age was requested and the ID token is missing the auth_time variable. auth_time is an optional claim and is not enabled by default - it must be enabled. See https://aka.ms/msaljs/optional-claims for more information.",[Rr]:"Max Age is set to 0, or too much time has elapsed since the last end-user authentication.",[Bo]:"The cache contains multiple tokens satisfying the requirements. Call AcquireToken again providing more requirements such as authority or account.",[Vo]:"The cache contains multiple accounts satisfying the given parameters. Please pass more info to obtain the correct account",[Dr]:"The cache contains multiple appMetadata satisfying the given parameters. Please pass more info to obtain the correct appMetadata",[Mr]:"Token request cannot be made without authorization code or refresh token.",[Or]:"Cannot remove null or empty scope from ScopeSet",[Pr]:"Cannot append ScopeSet",[Wn]:"Empty input ScopeSet cannot be processed",[Ko]:"Caller has cancelled token endpoint polling during device code flow by setting DeviceCodeRequest.cancel = true.",[zo]:"Device code is expired.",[qo]:"Device code stopped polling for unknown reasons.",[pn]:"Please pass an account object, silent flow is not supported without account information",[Nr]:"Cache record object was null or undefined.",[gn]:"Invalid environment when attempting to create cache entry",[Wo]:"No account found in cache for given key.",[Gn]:"No crypto object detected.",[Go]:"Unexpected credential type.",[$o]:"Client assertion must meet requirements described in https://tools.ietf.org/html/rfc7515",[Yo]:"Client credential (secret, certificate, or assertion) must not be empty when creating a confidential client. An application should at most have one credential",[Qt]:"Cannot return token from cache because it must be refreshed. This may be due to one of the following reasons: forceRefresh parameter is set to true, claims have been requested, there is no cached access token or it is expired.",[jo]:"User defined timeout for device code polling reached",[xr]:"Cannot generate a POP jwt if the token_claims are not populated",[Lr]:"Server response does not contain an authorization code to proceed",[Hr]:"Could not remove the credential's binding key from storage.",[Fr]:"The provided authority does not support logout",[Ur]:"A keyId value is missing from the requested bound token's cache record and is required to match the token to it's stored binding key.",[Qo]:"No network connectivity. Check your internet connection.",[Xo]:"User cancelled the flow.",[Jo]:"A tenant id - not common, organizations, or consumers - must be specified when using the client_credentials flow.",[Y]:"This method has not been implemented",[Zo]:"The nested app auth bridge is disabled"},zh={clientInfoDecodingError:{code:Kn,desc:j[Kn]},clientInfoEmptyError:{code:_r,desc:j[_r]},tokenParsingError:{code:zn,desc:j[zn]},nullOrEmptyToken:{code:Er,desc:j[Er]},endpointResolutionError:{code:Xe,desc:j[Xe]},networkError:{code:Sr,desc:j[Sr]},unableToGetOpenidConfigError:{code:Ar,desc:j[Ar]},hashNotDeserialized:{code:Ir,desc:j[Ir]},invalidStateError:{code:Wt,desc:j[Wt]},stateMismatchError:{code:kr,desc:j[kr]},stateNotFoundError:{code:qn,desc:j[qn]},nonceMismatchError:{code:br,desc:j[br]},authTimeNotFoundError:{code:mn,desc:j[mn]},maxAgeTranspired:{code:Rr,desc:j[Rr]},multipleMatchingTokens:{code:Bo,desc:j[Bo]},multipleMatchingAccounts:{code:Vo,desc:j[Vo]},multipleMatchingAppMetadata:{code:Dr,desc:j[Dr]},tokenRequestCannotBeMade:{code:Mr,desc:j[Mr]},removeEmptyScopeError:{code:Or,desc:j[Or]},appendScopeSetError:{code:Pr,desc:j[Pr]},emptyInputScopeSetError:{code:Wn,desc:j[Wn]},DeviceCodePollingCancelled:{code:Ko,desc:j[Ko]},DeviceCodeExpired:{code:zo,desc:j[zo]},DeviceCodeUnknownError:{code:qo,desc:j[qo]},NoAccountInSilentRequest:{code:pn,desc:j[pn]},invalidCacheRecord:{code:Nr,desc:j[Nr]},invalidCacheEnvironment:{code:gn,desc:j[gn]},noAccountFound:{code:Wo,desc:j[Wo]},noCryptoObj:{code:Gn,desc:j[Gn]},unexpectedCredentialType:{code:Go,desc:j[Go]},invalidAssertion:{code:$o,desc:j[$o]},invalidClientCredential:{code:Yo,desc:j[Yo]},tokenRefreshRequired:{code:Qt,desc:j[Qt]},userTimeoutReached:{code:jo,desc:j[jo]},tokenClaimsRequired:{code:xr,desc:j[xr]},noAuthorizationCodeFromServer:{code:Lr,desc:j[Lr]},bindingKeyNotRemovedError:{code:Hr,desc:j[Hr]},logoutNotSupported:{code:Fr,desc:j[Fr]},keyIdMissing:{code:Ur,desc:j[Ur]},noNetworkConnectivity:{code:Qo,desc:j[Qo]},userCanceledError:{code:Xo,desc:j[Xo]},missingTenantIdError:{code:Jo,desc:j[Jo]},nestedAppAuthBridgeDisabled:{code:Zo,desc:j[Zo]}},Br=class r extends re{constructor(e,t){super(e,t?`${j[e]}: ${t}`:j[e]),this.name="ClientAuthError",Object.setPrototypeOf(this,r.prototype)}};function T(r,e){return new Br(r,e)}function fn(r,e){let t=qh(r);try{let n=e(t);return JSON.parse(n)}catch{throw T(zn)}}function qh(r){if(!r)throw T(Er);let t=/^([^\.\s]*)\.([^\.\s]+)\.([^\.\s]*)$/.exec(r);if(!t||t.length<4)throw T(zn);return t[2]}function ea(r,e){if(e===0||Date.now()-3e5>r+e)throw T(Rr)}var ks={};Ot(ks,{createDiscoveredInstance:()=>Nl});var Je={Default:0,Adfs:1,Dsts:2,Ciam:3};function Wh(r){return r.hasOwnProperty("authorization_endpoint")&&r.hasOwnProperty("token_endpoint")&&r.hasOwnProperty("issuer")&&r.hasOwnProperty("jwks_uri")}var Gt={};Ot(Gt,{authorityMismatch:()=>sa,authorityUriInsecure:()=>Kr,cannotAllowNativeBroker:()=>aa,cannotSetOIDCOptions:()=>oa,claimsRequestParsingError:()=>ta,emptyInputScopesError:()=>qr,invalidAuthenticationHeader:()=>ia,invalidAuthorityMetadata:()=>jr,invalidClaims:()=>Cn,invalidCloudDiscoveryMetadata:()=>Yn,invalidCodeChallengeMethod:()=>Yr,invalidPromptValue:()=>Wr,logoutRequestEmpty:()=>$r,missingNonceAuthenticationHeader:()=>ra,missingSshJwk:()=>yn,missingSshKid:()=>na,pkceParamsMissing:()=>vn,redirectUriEmpty:()=>Vr,tokenRequestEmpty:()=>Gr,untrustedAuthority:()=>Qr,urlEmptyError:()=>zr,urlParseError:()=>Xt});var Vr="redirect_uri_empty",ta="claims_request_parsing_error",Kr="authority_uri_insecure",Xt="url_parse_error",zr="empty_url_error",qr="empty_input_scopes_error",Wr="invalid_prompt_value",Cn="invalid_claims",Gr="token_request_empty",$r="logout_request_empty",Yr="invalid_code_challenge_method",vn="pkce_params_missing",Yn="invalid_cloud_discovery_metadata",jr="invalid_authority_metadata",Qr="untrusted_authority",yn="missing_ssh_jwk",na="missing_ssh_kid",ra="missing_nonce_authentication_header",ia="invalid_authentication_header",oa="cannot_set_OIDCOptions",aa="cannot_allow_native_broker",sa="authority_mismatch";var Ie={[Vr]:"A redirect URI is required for all calls, and none has been set.",[ta]:"Could not parse the given claims request object.",[Kr]:"Authority URIs must use https.  Please see here for valid authority configuration options: https://docs.microsoft.com/en-us/azure/active-directory/develop/msal-js-initializing-client-applications#configuration-options",[Xt]:"URL could not be parsed into appropriate segments.",[zr]:"URL was empty or null.",[qr]:"Scopes cannot be passed as null, undefined or empty array because they are required to obtain an access token.",[Wr]:"Please see here for valid configuration options: https://azuread.github.io/microsoft-authentication-library-for-js/ref/modules/_azure_msal_common.html#commonauthorizationurlrequest",[Cn]:"Given claims parameter must be a stringified JSON object.",[Gr]:"Token request was empty and not found in cache.",[$r]:"The logout request was null or undefined.",[Yr]:'code_challenge_method passed is invalid. Valid values are "plain" and "S256".',[vn]:"Both params: code_challenge and code_challenge_method are to be passed if to be sent in the request",[Yn]:"Invalid cloudDiscoveryMetadata provided. Must be a stringified JSON object containing tenant_discovery_endpoint and metadata fields",[jr]:"Invalid authorityMetadata provided. Must by a stringified JSON object containing authorization_endpoint, token_endpoint, issuer fields.",[Qr]:"The provided authority is not a trusted authority. Please include this authority in the knownAuthorities config parameter.",[yn]:"Missing sshJwk in SSH certificate request. A stringified JSON Web Key is required when using the SSH authentication scheme.",[na]:"Missing sshKid in SSH certificate request. A string that uniquely identifies the public SSH key is required when using the SSH authentication scheme.",[ra]:"Unable to find an authentication header containing server nonce. Either the Authentication-Info or WWW-Authenticate headers must be present in order to obtain a server nonce.",[ia]:"Invalid authentication header provided",[oa]:"Cannot set OIDCOptions parameter. Please change the protocol mode to OIDC or use a non-Microsoft authority.",[aa]:"Cannot set allowNativeBroker parameter to true when not in AAD protocol mode.",[sa]:"Authority mismatch error. Authority provided in login request or PublicClientApplication config does not match the environment of the provided account. Please use a matching account or make an interactive request to login to this authority."},Gh={redirectUriNotSet:{code:Vr,desc:Ie[Vr]},claimsRequestParsingError:{code:ta,desc:Ie[ta]},authorityUriInsecure:{code:Kr,desc:Ie[Kr]},urlParseError:{code:Xt,desc:Ie[Xt]},urlEmptyError:{code:zr,desc:Ie[zr]},emptyScopesError:{code:qr,desc:Ie[qr]},invalidPrompt:{code:Wr,desc:Ie[Wr]},invalidClaimsRequest:{code:Cn,desc:Ie[Cn]},tokenRequestEmptyError:{code:Gr,desc:Ie[Gr]},logoutRequestEmptyError:{code:$r,desc:Ie[$r]},invalidCodeChallengeMethod:{code:Yr,desc:Ie[Yr]},invalidCodeChallengeParams:{code:vn,desc:Ie[vn]},invalidCloudDiscoveryMetadata:{code:Yn,desc:Ie[Yn]},invalidAuthorityMetadata:{code:jr,desc:Ie[jr]},untrustedAuthority:{code:Qr,desc:Ie[Qr]},missingSshJwk:{code:yn,desc:Ie[yn]},missingSshKid:{code:na,desc:Ie[na]},missingNonceAuthenticationHeader:{code:ra,desc:Ie[ra]},invalidAuthenticationHeader:{code:ia,desc:Ie[ia]},cannotSetOIDCOptions:{code:oa,desc:Ie[oa]},cannotAllowNativeBroker:{code:aa,desc:Ie[aa]},authorityMismatch:{code:sa,desc:Ie[sa]}},ca=class r extends re{constructor(e){super(e,Ie[e]),this.name="ClientConfigurationError",Object.setPrototypeOf(this,r.prototype)}};function ie(r){return new ca(r)}var _e=class{static isEmptyObj(e){if(e)try{let t=JSON.parse(e);return Object.keys(t).length===0}catch{}return!0}static startsWith(e,t){return e.indexOf(t)===0}static endsWith(e,t){return e.length>=t.length&&e.lastIndexOf(t)===e.length-t.length}static queryStringToObject(e){let t={},n=e.split("&"),i=o=>decodeURIComponent(o.replace(/\+/g," "));return n.forEach(o=>{if(o.trim()){let[a,s]=o.split(/=(.+)/g,2);a&&s&&(t[i(a)]=i(s))}}),t}static trimArrayEntries(e){return e.map(t=>t.trim())}static removeEmptyStringsFromArray(e){return e.filter(t=>!!t)}static jsonParseHelper(e){try{return JSON.parse(e)}catch{return null}}static matchPattern(e,t){return new RegExp(e.replace(/\\/g,"\\\\").replace(/\*/g,"[^ ]*").replace(/\?/g,"\\?")).test(t)}};var jn={};Ot(jn,{getDeserializedResponse:()=>Sl,stripLeadingHashOrQuery:()=>$h});function $h(r){return r.startsWith("#/")?r.substring(2):r.startsWith("#")||r.startsWith("?")?r.substring(1):r}function Sl(r){if(!r||r.indexOf("=")<0)return null;try{let e=$h(r),t=Object.fromEntries(new URLSearchParams(e));if(t.code||t.error||t.error_description||t.state)return t}catch{throw T(Ir)}return null}var Q=class r{get urlString(){return this._urlString}constructor(e){if(this._urlString=e,!this._urlString)throw ie(zr);e.includes("#")||(this._urlString=r.canonicalizeUri(e))}static canonicalizeUri(e){if(e){let t=e.toLowerCase();return _e.endsWith(t,"?")?t=t.slice(0,-1):_e.endsWith(t,"?/")&&(t=t.slice(0,-2)),_e.endsWith(t,"/")||(t+="/"),t}return e}validateAsUri(){let e;try{e=this.getUrlComponents()}catch{throw ie(Xt)}if(!e.HostNameAndPort||!e.PathSegments)throw ie(Xt);if(!e.Protocol||e.Protocol.toLowerCase()!=="https:")throw ie(Kr)}static appendQueryString(e,t){return t?e.indexOf("?")<0?`${e}?${t}`:`${e}&${t}`:e}static removeHashFromUrl(e){return r.canonicalizeUri(e.split("#")[0])}replaceTenantPath(e){let t=this.getUrlComponents(),n=t.PathSegments;return e&&n.length!==0&&(n[0]===Kt.COMMON||n[0]===Kt.ORGANIZATIONS)&&(n[0]=e),r.constructAuthorityUriFromObject(t)}getUrlComponents(){let e=RegExp("^(([^:/?#]+):)?(//([^/?#]*))?([^?#]*)(\\?([^#]*))?(#(.*))?"),t=this.urlString.match(e);if(!t)throw ie(Xt);let n={Protocol:t[1],HostNameAndPort:t[4],AbsolutePath:t[5],QueryString:t[7]},i=n.AbsolutePath.split("/");return i=i.filter(o=>o&&o.length>0),n.PathSegments=i,n.QueryString&&n.QueryString.endsWith("/")&&(n.QueryString=n.QueryString.substring(0,n.QueryString.length-1)),n}static getDomainFromUrl(e){let t=RegExp("^([^:/?#]+://)?([^/?#]*)"),n=e.match(t);if(!n)throw ie(Xt);return n[2]}static getAbsoluteUrl(e,t){if(e[0]===p.FORWARD_SLASH){let i=new r(t).getUrlComponents();return i.Protocol+"//"+i.HostNameAndPort+e}return e}static constructAuthorityUriFromObject(e){return new r(e.Protocol+"//"+e.HostNameAndPort+"/"+e.PathSegments.join("/"))}static hashContainsKnownProperties(e){return!!Sl(e)}};var jh={endpointMetadata:{"login.microsoftonline.com":{token_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.com/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.com/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.com/{tenantid}/oauth2/v2.0/logout"},"login.chinacloudapi.cn":{token_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.chinacloudapi.cn/{tenantid}/discovery/v2.0/keys",issuer:"https://login.partner.microsoftonline.cn/{tenantid}/v2.0",authorization_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.chinacloudapi.cn/{tenantid}/oauth2/v2.0/logout"},"login.microsoftonline.us":{token_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/token",jwks_uri:"https://login.microsoftonline.us/{tenantid}/discovery/v2.0/keys",issuer:"https://login.microsoftonline.us/{tenantid}/v2.0",authorization_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/authorize",end_session_endpoint:"https://login.microsoftonline.us/{tenantid}/oauth2/v2.0/logout"}},instanceDiscoveryMetadata:{tenant_discovery_endpoint:"https://{canonicalAuthority}/v2.0/.well-known/openid-configuration",metadata:[{preferred_network:"login.microsoftonline.com",preferred_cache:"login.windows.net",aliases:["login.microsoftonline.com","login.windows.net","login.microsoft.com","sts.windows.net"]},{preferred_network:"login.partner.microsoftonline.cn",preferred_cache:"login.partner.microsoftonline.cn",aliases:["login.partner.microsoftonline.cn","login.chinacloudapi.cn"]},{preferred_network:"login.microsoftonline.de",preferred_cache:"login.microsoftonline.de",aliases:["login.microsoftonline.de"]},{preferred_network:"login.microsoftonline.us",preferred_cache:"login.microsoftonline.us",aliases:["login.microsoftonline.us","login.usgovcloudapi.net"]},{preferred_network:"login-us.microsoftonline.com",preferred_cache:"login-us.microsoftonline.com",aliases:["login-us.microsoftonline.com"]}]}},Al=jh.endpointMetadata,Il=jh.instanceDiscoveryMetadata,kl=new Set;Il.metadata.forEach(r=>{r.aliases.forEach(e=>{kl.add(e)})});function Qh(r,e){let t,n=r.canonicalAuthority;if(n){let i=new Q(n).getUrlComponents().HostNameAndPort;t=Yh(i,r.cloudDiscoveryMetadata?.metadata,Qe.CONFIG,e)||Yh(i,Il.metadata,Qe.HARDCODED_VALUES,e)||r.knownAuthorities}return t||[]}function Yh(r,e,t,n){if(n?.trace(`getAliasesFromMetadata called with source: ${t}`),r&&e){let i=la(e,r);if(i)return n?.trace(`getAliasesFromMetadata: found cloud discovery metadata in ${t}, returning aliases`),i.aliases;n?.trace(`getAliasesFromMetadata: did not find cloud discovery metadata in ${t}`)}return null}function Xh(r){return la(Il.metadata,r)}function la(r,e){for(let t=0;t<r.length;t++){let n=r[t];if(n.aliases.includes(e))return n}return null}var qe={AAD:"AAD",OIDC:"OIDC"};var Qn={None:"none",AzurePublic:"https://login.microsoftonline.com",AzurePpe:"https://login.windows-ppe.net",AzureChina:"https://login.chinacloudapi.cn",AzureGermany:"https://login.microsoftonline.de",AzureUsGovernment:"https://login.microsoftonline.us"};function Jh(r){return r.hasOwnProperty("tenant_discovery_endpoint")&&r.hasOwnProperty("metadata")}function Zh(r){return r.hasOwnProperty("error")&&r.hasOwnProperty("error_description")}var d={AcquireTokenByCode:"acquireTokenByCode",AcquireTokenByRefreshToken:"acquireTokenByRefreshToken",AcquireTokenSilent:"acquireTokenSilent",AcquireTokenSilentAsync:"acquireTokenSilentAsync",AcquireTokenPopup:"acquireTokenPopup",AcquireTokenPreRedirect:"acquireTokenPreRedirect",AcquireTokenRedirect:"acquireTokenRedirect",CryptoOptsGetPublicKeyThumbprint:"cryptoOptsGetPublicKeyThumbprint",CryptoOptsSignJwt:"cryptoOptsSignJwt",SilentCacheClientAcquireToken:"silentCacheClientAcquireToken",SilentIframeClientAcquireToken:"silentIframeClientAcquireToken",AwaitConcurrentIframe:"awaitConcurrentIframe",SilentRefreshClientAcquireToken:"silentRefreshClientAcquireToken",SsoSilent:"ssoSilent",StandardInteractionClientGetDiscoveredAuthority:"standardInteractionClientGetDiscoveredAuthority",FetchAccountIdWithNativeBroker:"fetchAccountIdWithNativeBroker",NativeInteractionClientAcquireToken:"nativeInteractionClientAcquireToken",BaseClientCreateTokenRequestHeaders:"baseClientCreateTokenRequestHeaders",RefreshTokenClientExecutePostToTokenEndpoint:"refreshTokenClientExecutePostToTokenEndpoint",AuthorizationCodeClientExecutePostToTokenEndpoint:"authorizationCodeClientExecutePostToTokenEndpoint",BrokerHandhshake:"brokerHandshake",AcquireTokenByRefreshTokenInBroker:"acquireTokenByRefreshTokenInBroker",AcquireTokenByBroker:"acquireTokenByBroker",RefreshTokenClientExecuteTokenRequest:"refreshTokenClientExecuteTokenRequest",RefreshTokenClientAcquireToken:"refreshTokenClientAcquireToken",RefreshTokenClientAcquireTokenWithCachedRefreshToken:"refreshTokenClientAcquireTokenWithCachedRefreshToken",RefreshTokenClientAcquireTokenByRefreshToken:"refreshTokenClientAcquireTokenByRefreshToken",RefreshTokenClientCreateTokenRequestBody:"refreshTokenClientCreateTokenRequestBody",AcquireTokenFromCache:"acquireTokenFromCache",SilentFlowClientAcquireCachedToken:"silentFlowClientAcquireCachedToken",SilentFlowClientGenerateResultFromCacheRecord:"silentFlowClientGenerateResultFromCacheRecord",AcquireTokenBySilentIframe:"acquireTokenBySilentIframe",InitializeBaseRequest:"initializeBaseRequest",InitializeSilentRequest:"initializeSilentRequest",InitializeClientApplication:"initializeClientApplication",PopupClientTokenHelper:"popupClientTokenHelper",SilentIframeClientTokenHelper:"silentIframeClientTokenHelper",SilentHandlerInitiateAuthRequest:"silentHandlerInitiateAuthRequest",SilentHandlerMonitorIframeForHash:"silentHandlerMonitorIframeForHash",SilentHandlerLoadFrame:"silentHandlerLoadFrame",SilentHandlerLoadFrameSync:"silentHandlerLoadFrameSync",StandardInteractionClientCreateAuthCodeClient:"standardInteractionClientCreateAuthCodeClient",StandardInteractionClientGetClientConfiguration:"standardInteractionClientGetClientConfiguration",StandardInteractionClientInitializeAuthorizationRequest:"standardInteractionClientInitializeAuthorizationRequest",StandardInteractionClientInitializeAuthorizationCodeRequest:"standardInteractionClientInitializeAuthorizationCodeRequest",GetAuthCodeUrl:"getAuthCodeUrl",HandleCodeResponseFromServer:"handleCodeResponseFromServer",HandleCodeResponse:"handleCodeResponse",UpdateTokenEndpointAuthority:"updateTokenEndpointAuthority",AuthClientAcquireToken:"authClientAcquireToken",AuthClientExecuteTokenRequest:"authClientExecuteTokenRequest",AuthClientCreateTokenRequestBody:"authClientCreateTokenRequestBody",AuthClientCreateQueryString:"authClientCreateQueryString",PopTokenGenerateCnf:"popTokenGenerateCnf",PopTokenGenerateKid:"popTokenGenerateKid",HandleServerTokenResponse:"handleServerTokenResponse",DeserializeResponse:"deserializeResponse",AuthorityFactoryCreateDiscoveredInstance:"authorityFactoryCreateDiscoveredInstance",AuthorityResolveEndpointsAsync:"authorityResolveEndpointsAsync",AuthorityResolveEndpointsFromLocalSources:"authorityResolveEndpointsFromLocalSources",AuthorityGetCloudDiscoveryMetadataFromNetwork:"authorityGetCloudDiscoveryMetadataFromNetwork",AuthorityUpdateCloudDiscoveryMetadata:"authorityUpdateCloudDiscoveryMetadata",AuthorityGetEndpointMetadataFromNetwork:"authorityGetEndpointMetadataFromNetwork",AuthorityUpdateEndpointMetadata:"authorityUpdateEndpointMetadata",AuthorityUpdateMetadataWithRegionalInformation:"authorityUpdateMetadataWithRegionalInformation",RegionDiscoveryDetectRegion:"regionDiscoveryDetectRegion",RegionDiscoveryGetRegionFromIMDS:"regionDiscoveryGetRegionFromIMDS",RegionDiscoveryGetCurrentVersion:"regionDiscoveryGetCurrentVersion",AcquireTokenByCodeAsync:"acquireTokenByCodeAsync",GetEndpointMetadataFromNetwork:"getEndpointMetadataFromNetwork",GetCloudDiscoveryMetadataFromNetworkMeasurement:"getCloudDiscoveryMetadataFromNetworkMeasurement",HandleRedirectPromiseMeasurement:"handleRedirectPromise",HandleNativeRedirectPromiseMeasurement:"handleNativeRedirectPromise",UpdateCloudDiscoveryMetadataMeasurement:"updateCloudDiscoveryMetadataMeasurement",UsernamePasswordClientAcquireToken:"usernamePasswordClientAcquireToken",NativeMessageHandlerHandshake:"nativeMessageHandlerHandshake",NativeGenerateAuthResult:"nativeGenerateAuthResult",RemoveHiddenIframe:"removeHiddenIframe",ClearTokensAndKeysWithClaims:"clearTokensAndKeysWithClaims",CacheManagerGetRefreshToken:"cacheManagerGetRefreshToken",GeneratePkceCodes:"generatePkceCodes",GenerateCodeVerifier:"generateCodeVerifier",GenerateCodeChallengeFromVerifier:"generateCodeChallengeFromVerifier",Sha256Digest:"sha256Digest",GetRandomValues:"getRandomValues"},uw=new Map([[d.AcquireTokenByCode,"ATByCode"],[d.AcquireTokenByRefreshToken,"ATByRT"],[d.AcquireTokenSilent,"ATS"],[d.AcquireTokenSilentAsync,"ATSAsync"],[d.AcquireTokenPopup,"ATPopup"],[d.AcquireTokenRedirect,"ATRedirect"],[d.CryptoOptsGetPublicKeyThumbprint,"CryptoGetPKThumb"],[d.CryptoOptsSignJwt,"CryptoSignJwt"],[d.SilentCacheClientAcquireToken,"SltCacheClientAT"],[d.SilentIframeClientAcquireToken,"SltIframeClientAT"],[d.SilentRefreshClientAcquireToken,"SltRClientAT"],[d.SsoSilent,"SsoSlt"],[d.StandardInteractionClientGetDiscoveredAuthority,"StdIntClientGetDiscAuth"],[d.FetchAccountIdWithNativeBroker,"FetchAccIdWithNtvBroker"],[d.NativeInteractionClientAcquireToken,"NtvIntClientAT"],[d.BaseClientCreateTokenRequestHeaders,"BaseClientCreateTReqHead"],[d.RefreshTokenClientExecutePostToTokenEndpoint,"RTClientExecPost"],[d.AuthorizationCodeClientExecutePostToTokenEndpoint,"AuthCodeClientExecPost"],[d.BrokerHandhshake,"BrokerHandshake"],[d.AcquireTokenByRefreshTokenInBroker,"ATByRTInBroker"],[d.AcquireTokenByBroker,"ATByBroker"],[d.RefreshTokenClientExecuteTokenRequest,"RTClientExecTReq"],[d.RefreshTokenClientAcquireToken,"RTClientAT"],[d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,"RTClientATWithCachedRT"],[d.RefreshTokenClientAcquireTokenByRefreshToken,"RTClientATByRT"],[d.RefreshTokenClientCreateTokenRequestBody,"RTClientCreateTReqBody"],[d.AcquireTokenFromCache,"ATFromCache"],[d.SilentFlowClientAcquireCachedToken,"SltFlowClientATCached"],[d.SilentFlowClientGenerateResultFromCacheRecord,"SltFlowClientGenResFromCache"],[d.AcquireTokenBySilentIframe,"ATBySltIframe"],[d.InitializeBaseRequest,"InitBaseReq"],[d.InitializeSilentRequest,"InitSltReq"],[d.InitializeClientApplication,"InitClientApplication"],[d.SilentIframeClientTokenHelper,"SIClientTHelper"],[d.SilentHandlerInitiateAuthRequest,"SHandlerInitAuthReq"],[d.SilentHandlerMonitorIframeForHash,"SltHandlerMonitorIframeForHash"],[d.SilentHandlerLoadFrame,"SHandlerLoadFrame"],[d.SilentHandlerLoadFrameSync,"SHandlerLoadFrameSync"],[d.StandardInteractionClientCreateAuthCodeClient,"StdIntClientCreateAuthCodeClient"],[d.StandardInteractionClientGetClientConfiguration,"StdIntClientGetClientConf"],[d.StandardInteractionClientInitializeAuthorizationRequest,"StdIntClientInitAuthReq"],[d.StandardInteractionClientInitializeAuthorizationCodeRequest,"StdIntClientInitAuthCodeReq"],[d.GetAuthCodeUrl,"GetAuthCodeUrl"],[d.HandleCodeResponseFromServer,"HandleCodeResFromServer"],[d.HandleCodeResponse,"HandleCodeResp"],[d.UpdateTokenEndpointAuthority,"UpdTEndpointAuth"],[d.AuthClientAcquireToken,"AuthClientAT"],[d.AuthClientExecuteTokenRequest,"AuthClientExecTReq"],[d.AuthClientCreateTokenRequestBody,"AuthClientCreateTReqBody"],[d.AuthClientCreateQueryString,"AuthClientCreateQueryStr"],[d.PopTokenGenerateCnf,"PopTGenCnf"],[d.PopTokenGenerateKid,"PopTGenKid"],[d.HandleServerTokenResponse,"HandleServerTRes"],[d.DeserializeResponse,"DeserializeRes"],[d.AuthorityFactoryCreateDiscoveredInstance,"AuthFactCreateDiscInst"],[d.AuthorityResolveEndpointsAsync,"AuthResolveEndpointsAsync"],[d.AuthorityResolveEndpointsFromLocalSources,"AuthResolveEndpointsFromLocal"],[d.AuthorityGetCloudDiscoveryMetadataFromNetwork,"AuthGetCDMetaFromNet"],[d.AuthorityUpdateCloudDiscoveryMetadata,"AuthUpdCDMeta"],[d.AuthorityGetEndpointMetadataFromNetwork,"AuthUpdCDMetaFromNet"],[d.AuthorityUpdateEndpointMetadata,"AuthUpdEndpointMeta"],[d.AuthorityUpdateMetadataWithRegionalInformation,"AuthUpdMetaWithRegInfo"],[d.RegionDiscoveryDetectRegion,"RegDiscDetectReg"],[d.RegionDiscoveryGetRegionFromIMDS,"RegDiscGetRegFromIMDS"],[d.RegionDiscoveryGetCurrentVersion,"RegDiscGetCurrentVer"],[d.AcquireTokenByCodeAsync,"ATByCodeAsync"],[d.GetEndpointMetadataFromNetwork,"GetEndpointMetaFromNet"],[d.GetCloudDiscoveryMetadataFromNetworkMeasurement,"GetCDMetaFromNet"],[d.HandleRedirectPromiseMeasurement,"HandleRedirectPromise"],[d.HandleNativeRedirectPromiseMeasurement,"HandleNtvRedirectPromise"],[d.UpdateCloudDiscoveryMetadataMeasurement,"UpdateCDMeta"],[d.UsernamePasswordClientAcquireToken,"UserPassClientAT"],[d.NativeMessageHandlerHandshake,"NtvMsgHandlerHandshake"],[d.NativeGenerateAuthResult,"NtvGenAuthRes"],[d.RemoveHiddenIframe,"RemoveHiddenIframe"],[d.ClearTokensAndKeysWithClaims,"ClearTAndKeysWithClaims"],[d.CacheManagerGetRefreshToken,"CacheManagerGetRT"],[d.GeneratePkceCodes,"GenPkceCodes"],[d.GenerateCodeVerifier,"GenCodeVerifier"],[d.GenerateCodeChallengeFromVerifier,"GenCodeChallengeFromVerifier"],[d.Sha256Digest,"Sha256Digest"],[d.GetRandomValues,"GetRandomValues"]]),bl={NotStarted:0,InProgress:1,Completed:2};var Ze=(r,e,t,n,i)=>(...o)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,i);if(i){let s=e+"CallCount";n?.incrementFields({[s]:1},i)}try{let s=r(...o);return a?.end({success:!0}),t.trace(`Returning result from ${e}`),s}catch(s){t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s}},E=(r,e,t,n,i)=>(...o)=>{t.trace(`Executing function ${e}`);let a=n?.startMeasurement(e,i);if(i){let s=e+"CallCount";n?.incrementFields({[s]:1},i)}return n?.setPreQueueTime(e,i),r(...o).then(s=>(t.trace(`Returning result from ${e}`),a?.end({success:!0}),s)).catch(s=>{t.trace(`Error occurred in ${e}`);try{t.trace(JSON.stringify(s))}catch{t.trace("Unable to print error message.")}throw a?.end({success:!1},s),s})};var em=(()=>{class r{constructor(t,n,i,o){this.networkInterface=t,this.logger=n,this.performanceClient=i,this.correlationId=o}detectRegion(t,n){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RegionDiscoveryDetectRegion,this.correlationId);let i=t;if(i)n.region_source=Tr.ENVIRONMENT_VARIABLE;else{let o=r.IMDS_OPTIONS;try{let a=yield E(this.getRegionFromIMDS.bind(this),d.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(p.IMDS_VERSION,o);if(a.status===Lo.httpSuccess&&(i=a.body,n.region_source=Tr.IMDS),a.status===Lo.httpBadRequest){let s=yield E(this.getCurrentVersion.bind(this),d.RegionDiscoveryGetCurrentVersion,this.logger,this.performanceClient,this.correlationId)(o);if(!s)return n.region_source=Tr.FAILED_AUTO_DETECTION,null;let c=yield E(this.getRegionFromIMDS.bind(this),d.RegionDiscoveryGetRegionFromIMDS,this.logger,this.performanceClient,this.correlationId)(s,o);c.status===Lo.httpSuccess&&(i=c.body,n.region_source=Tr.IMDS)}}catch{return n.region_source=Tr.FAILED_AUTO_DETECTION,null}}return i||(n.region_source=Tr.FAILED_AUTO_DETECTION),i||null})}getRegionFromIMDS(t,n){return h(this,null,function*(){return this.performanceClient?.addQueueMeasurement(d.RegionDiscoveryGetRegionFromIMDS,this.correlationId),this.networkInterface.sendGetRequestAsync(`${p.IMDS_ENDPOINT}?api-version=${t}&format=text`,n,p.IMDS_TIMEOUT)})}getCurrentVersion(t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RegionDiscoveryGetCurrentVersion,this.correlationId);try{let n=yield this.networkInterface.sendGetRequestAsync(`${p.IMDS_ENDPOINT}?format=json`,t);return n.status===Lo.httpBadRequest&&n.body&&n.body["newest-versions"]&&n.body["newest-versions"].length>0?n.body["newest-versions"][0]:null}catch{return null}})}}return r.IMDS_OPTIONS={headers:{Metadata:"true"}},r})();var me={};Ot(me,{createAccessTokenEntity:()=>Ml,createIdTokenEntity:()=>Dl,createRefreshTokenEntity:()=>Ol,generateAppMetadataKey:()=>BC,generateAuthorityMetadataExpiresAt:()=>Ss,generateCredentialKey:()=>ua,isAccessTokenEntity:()=>DC,isAppMetadataEntity:()=>VC,isAuthorityMetadataEntity:()=>KC,isAuthorityMetadataExpired:()=>As,isCredentialEntity:()=>Es,isIdTokenEntity:()=>MC,isRefreshTokenEntity:()=>OC,isServerTelemetryEntity:()=>FC,isThrottlingEntity:()=>UC,updateAuthorityEndpointMetadata:()=>Ei,updateCloudDiscoveryMetadata:()=>ha});var da={};Ot(da,{delay:()=>RC,isTokenExpired:()=>_i,nowSeconds:()=>gt,wasClockTurnedBack:()=>Rl});function gt(){return Math.round(new Date().getTime()/1e3)}function _i(r,e){let t=Number(r)||0;return gt()+e>t}function Rl(r){return Number(r)>gt()}function RC(r,e){return new Promise(t=>setTimeout(()=>t(e),r))}function ua(r){return[PC(r),NC(r),xC(r),LC(r),HC(r)].join(ke.CACHE_KEY_SEPARATOR).toLowerCase()}function Dl(r,e,t,n,i){return{credentialType:G.ID_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t,realm:i}}function Ml(r,e,t,n,i,o,a,s,c,l,u,m,v,g,A){let k={homeAccountId:r,credentialType:G.ACCESS_TOKEN,secret:t,cachedAt:gt().toString(),expiresOn:a.toString(),extendedExpiresOn:s.toString(),environment:e,clientId:n,realm:i,target:o,tokenType:u||ne.BEARER};if(m&&(k.userAssertionHash=m),l&&(k.refreshOn=l.toString()),g&&(k.requestedClaims=g,k.requestedClaimsHash=A),k.tokenType?.toLowerCase()!==ne.BEARER.toLowerCase())switch(k.credentialType=G.ACCESS_TOKEN_WITH_AUTH_SCHEME,k.tokenType){case ne.POP:let M=fn(t,c);if(!M?.cnf?.kid)throw T(xr);k.keyId=M.cnf.kid;break;case ne.SSH:k.keyId=v}return k}function Ol(r,e,t,n,i,o,a){let s={credentialType:G.REFRESH_TOKEN,homeAccountId:r,environment:e,clientId:n,secret:t};return o&&(s.userAssertionHash=o),i&&(s.familyId=i),a&&(s.expiresOn=a.toString()),s}function Es(r){return r.hasOwnProperty("homeAccountId")&&r.hasOwnProperty("environment")&&r.hasOwnProperty("credentialType")&&r.hasOwnProperty("clientId")&&r.hasOwnProperty("secret")}function DC(r){return r?Es(r)&&r.hasOwnProperty("realm")&&r.hasOwnProperty("target")&&(r.credentialType===G.ACCESS_TOKEN||r.credentialType===G.ACCESS_TOKEN_WITH_AUTH_SCHEME):!1}function MC(r){return r?Es(r)&&r.hasOwnProperty("realm")&&r.credentialType===G.ID_TOKEN:!1}function OC(r){return r?Es(r)&&r.credentialType===G.REFRESH_TOKEN:!1}function PC(r){return[r.homeAccountId,r.environment].join(ke.CACHE_KEY_SEPARATOR).toLowerCase()}function NC(r){let e=r.credentialType===G.REFRESH_TOKEN&&r.familyId||r.clientId;return[r.credentialType,e,r.realm||""].join(ke.CACHE_KEY_SEPARATOR).toLowerCase()}function xC(r){return(r.target||"").toLowerCase()}function LC(r){return(r.requestedClaimsHash||"").toLowerCase()}function HC(r){return r.tokenType&&r.tokenType.toLowerCase()!==ne.BEARER.toLowerCase()?r.tokenType.toLowerCase():""}function FC(r,e){let t=r.indexOf(Ne.CACHE_KEY)===0,n=!0;return e&&(n=e.hasOwnProperty("failedRequests")&&e.hasOwnProperty("errors")&&e.hasOwnProperty("cacheHits")),t&&n}function UC(r,e){let t=!1;r&&(t=r.indexOf(hn.THROTTLING_PREFIX)===0);let n=!0;return e&&(n=e.hasOwnProperty("throttleTime")),t&&n}function BC({environment:r,clientId:e}){return[xo,r,e].join(ke.CACHE_KEY_SEPARATOR).toLowerCase()}function VC(r,e){return e?r.indexOf(xo)===0&&e.hasOwnProperty("clientId")&&e.hasOwnProperty("environment"):!1}function KC(r,e){return e?r.indexOf(wi.CACHE_KEY)===0&&e.hasOwnProperty("aliases")&&e.hasOwnProperty("preferred_cache")&&e.hasOwnProperty("preferred_network")&&e.hasOwnProperty("canonical_authority")&&e.hasOwnProperty("authorization_endpoint")&&e.hasOwnProperty("token_endpoint")&&e.hasOwnProperty("issuer")&&e.hasOwnProperty("aliasesFromNetwork")&&e.hasOwnProperty("endpointsFromNetwork")&&e.hasOwnProperty("expiresAt")&&e.hasOwnProperty("jwks_uri"):!1}function Ss(){return gt()+wi.REFRESH_TIME_SECONDS}function Ei(r,e,t){r.authorization_endpoint=e.authorization_endpoint,r.token_endpoint=e.token_endpoint,r.end_session_endpoint=e.end_session_endpoint,r.issuer=e.issuer,r.endpointsFromNetwork=t,r.jwks_uri=e.jwks_uri}function ha(r,e,t){r.aliases=e.aliases,r.preferred_cache=e.preferred_cache,r.preferred_network=e.preferred_network,r.aliasesFromNetwork=t}function As(r){return r.expiresAt<=gt()}var It=class r{constructor(e,t,n,i,o,a,s,c){this.canonicalAuthority=e,this._canonicalAuthority.validateAsUri(),this.networkInterface=t,this.cacheManager=n,this.authorityOptions=i,this.regionDiscoveryMetadata={region_used:void 0,region_source:void 0,region_outcome:void 0},this.logger=o,this.performanceClient=s,this.correlationId=a,this.managedIdentity=c||!1,this.regionDiscovery=new em(t,this.logger,this.performanceClient,this.correlationId)}getAuthorityType(e){if(e.HostNameAndPort.endsWith(p.CIAM_AUTH_URL))return Je.Ciam;let t=e.PathSegments;if(t.length)switch(t[0].toLowerCase()){case p.ADFS:return Je.Adfs;case p.DSTS:return Je.Dsts}return Je.Default}get authorityType(){return this.getAuthorityType(this.canonicalAuthorityUrlComponents)}get protocolMode(){return this.authorityOptions.protocolMode}get options(){return this.authorityOptions}get canonicalAuthority(){return this._canonicalAuthority.urlString}set canonicalAuthority(e){this._canonicalAuthority=new Q(e),this._canonicalAuthority.validateAsUri(),this._canonicalAuthorityUrlComponents=null}get canonicalAuthorityUrlComponents(){return this._canonicalAuthorityUrlComponents||(this._canonicalAuthorityUrlComponents=this._canonicalAuthority.getUrlComponents()),this._canonicalAuthorityUrlComponents}get hostnameAndPort(){return this.canonicalAuthorityUrlComponents.HostNameAndPort.toLowerCase()}get tenant(){return this.canonicalAuthorityUrlComponents.PathSegments[0]}get authorizationEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.authorization_endpoint);throw T(Xe)}get tokenEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint);throw T(Xe)}get deviceCodeEndpoint(){if(this.discoveryComplete())return this.replacePath(this.metadata.token_endpoint.replace("/token","/devicecode"));throw T(Xe)}get endSessionEndpoint(){if(this.discoveryComplete()){if(!this.metadata.end_session_endpoint)throw T(Fr);return this.replacePath(this.metadata.end_session_endpoint)}else throw T(Xe)}get selfSignedJwtAudience(){if(this.discoveryComplete())return this.replacePath(this.metadata.issuer);throw T(Xe)}get jwksUri(){if(this.discoveryComplete())return this.replacePath(this.metadata.jwks_uri);throw T(Xe)}canReplaceTenant(e){return e.PathSegments.length===1&&!r.reservedTenantDomains.has(e.PathSegments[0])&&this.getAuthorityType(e)===Je.Default&&this.protocolMode===qe.AAD}replaceTenant(e){return e.replace(/{tenant}|{tenantid}/g,this.tenant)}replacePath(e){let t=e,i=new Q(this.metadata.canonical_authority).getUrlComponents(),o=i.PathSegments;return this.canonicalAuthorityUrlComponents.PathSegments.forEach((s,c)=>{let l=o[c];if(c===0&&this.canReplaceTenant(i)){let u=new Q(this.metadata.authorization_endpoint).getUrlComponents().PathSegments[0];l!==u&&(this.logger.verbose(`Replacing tenant domain name ${l} with id ${u}`),l=u)}s!==l&&(t=t.replace(`/${l}/`,`/${s}/`))}),this.replaceTenant(t)}get defaultOpenIdConfigurationEndpoint(){let e=this.hostnameAndPort;return this.canonicalAuthority.endsWith("v2.0/")||this.authorityType===Je.Adfs||this.protocolMode!==qe.AAD&&!this.isAliasOfKnownMicrosoftAuthority(e)?`${this.canonicalAuthority}.well-known/openid-configuration`:`${this.canonicalAuthority}v2.0/.well-known/openid-configuration`}discoveryComplete(){return!!this.metadata}resolveEndpointsAsync(){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityResolveEndpointsAsync,this.correlationId);let e=this.getCurrentMetadataEntity(),t=yield E(this.updateCloudDiscoveryMetadata.bind(this),d.AuthorityUpdateCloudDiscoveryMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.canonicalAuthority=this.canonicalAuthority.replace(this.hostnameAndPort,e.preferred_network);let n=yield E(this.updateEndpointMetadata.bind(this),d.AuthorityUpdateEndpointMetadata,this.logger,this.performanceClient,this.correlationId)(e);this.updateCachedMetadata(e,t,{source:n}),this.performanceClient?.addFields({cloudDiscoverySource:t,authorityEndpointSource:n},this.correlationId)})}getCurrentMetadataEntity(){let e=this.cacheManager.getAuthorityMetadataByAlias(this.hostnameAndPort);return e||(e={aliases:[],preferred_cache:this.hostnameAndPort,preferred_network:this.hostnameAndPort,canonical_authority:this.canonicalAuthority,authorization_endpoint:"",token_endpoint:"",end_session_endpoint:"",issuer:"",aliasesFromNetwork:!1,endpointsFromNetwork:!1,expiresAt:Ss(),jwks_uri:""}),e}updateCachedMetadata(e,t,n){t!==Qe.CACHE&&n?.source!==Qe.CACHE&&(e.expiresAt=Ss(),e.canonical_authority=this.canonicalAuthority);let i=this.cacheManager.generateAuthorityMetadataCacheKey(e.preferred_cache);this.cacheManager.setAuthorityMetadata(i,e),this.metadata=e}updateEndpointMetadata(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityUpdateEndpointMetadata,this.correlationId);let t=this.updateEndpointMetadataFromLocalSources(e);if(t){if(t.source===Qe.HARDCODED_VALUES&&this.authorityOptions.azureRegionConfiguration?.azureRegion&&t.metadata){let i=yield E(this.updateMetadataWithRegionalInformation.bind(this),d.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(t.metadata);Ei(e,i,!1),e.canonical_authority=this.canonicalAuthority}return t.source}let n=yield E(this.getEndpointMetadataFromNetwork.bind(this),d.AuthorityGetEndpointMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return this.authorityOptions.azureRegionConfiguration?.azureRegion&&(n=yield E(this.updateMetadataWithRegionalInformation.bind(this),d.AuthorityUpdateMetadataWithRegionalInformation,this.logger,this.performanceClient,this.correlationId)(n)),Ei(e,n,!0),Qe.NETWORK;throw T(Ar,this.defaultOpenIdConfigurationEndpoint)})}updateEndpointMetadataFromLocalSources(e){this.logger.verbose("Attempting to get endpoint metadata from authority configuration");let t=this.getEndpointMetadataFromConfig();if(t)return this.logger.verbose("Found endpoint metadata in authority configuration"),Ei(e,t,!1),{source:Qe.CONFIG};if(this.logger.verbose("Did not find endpoint metadata in the config... Attempting to get endpoint metadata from the hardcoded values."),this.authorityOptions.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get endpoint metadata from the network metadata cache.");else{let i=this.getEndpointMetadataFromHardcodedValues();if(i)return Ei(e,i,!1),{source:Qe.HARDCODED_VALUES,metadata:i};this.logger.verbose("Did not find endpoint metadata in hardcoded values... Attempting to get endpoint metadata from the network metadata cache.")}let n=As(e);return this.isAuthoritySameType(e)&&e.endpointsFromNetwork&&!n?(this.logger.verbose("Found endpoint metadata in the cache."),{source:Qe.CACHE}):(n&&this.logger.verbose("The metadata entity is expired."),null)}isAuthoritySameType(e){return new Q(e.canonical_authority).getUrlComponents().PathSegments.length===this.canonicalAuthorityUrlComponents.PathSegments.length}getEndpointMetadataFromConfig(){if(this.authorityOptions.authorityMetadata)try{return JSON.parse(this.authorityOptions.authorityMetadata)}catch{throw ie(jr)}return null}getEndpointMetadataFromNetwork(){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityGetEndpointMetadataFromNetwork,this.correlationId);let e={},t=this.defaultOpenIdConfigurationEndpoint;this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: attempting to retrieve OAuth endpoints from ${t}`);try{let n=yield this.networkInterface.sendGetRequestAsync(t,e);return Wh(n.body)?n.body:(this.logger.verbose("Authority.getEndpointMetadataFromNetwork: could not parse response as OpenID configuration"),null)}catch(n){return this.logger.verbose(`Authority.getEndpointMetadataFromNetwork: ${n}`),null}})}getEndpointMetadataFromHardcodedValues(){return this.hostnameAndPort in Al?Al[this.hostnameAndPort]:null}updateMetadataWithRegionalInformation(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityUpdateMetadataWithRegionalInformation,this.correlationId);let t=this.authorityOptions.azureRegionConfiguration?.azureRegion;if(t){if(t!==p.AZURE_REGION_AUTO_DISCOVER_FLAG)return this.regionDiscoveryMetadata.region_outcome=Ts.CONFIGURED_NO_AUTO_DETECTION,this.regionDiscoveryMetadata.region_used=t,r.replaceWithRegionalInformation(e,t);let n=yield E(this.regionDiscovery.detectRegion.bind(this.regionDiscovery),d.RegionDiscoveryDetectRegion,this.logger,this.performanceClient,this.correlationId)(this.authorityOptions.azureRegionConfiguration?.environmentRegion,this.regionDiscoveryMetadata);if(n)return this.regionDiscoveryMetadata.region_outcome=Ts.AUTO_DETECTION_REQUESTED_SUCCESSFUL,this.regionDiscoveryMetadata.region_used=n,r.replaceWithRegionalInformation(e,n);this.regionDiscoveryMetadata.region_outcome=Ts.AUTO_DETECTION_REQUESTED_FAILED}return e})}updateCloudDiscoveryMetadata(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityUpdateCloudDiscoveryMetadata,this.correlationId);let t=this.updateCloudDiscoveryMetadataFromLocalSources(e);if(t)return t;let n=yield E(this.getCloudDiscoveryMetadataFromNetwork.bind(this),d.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.logger,this.performanceClient,this.correlationId)();if(n)return ha(e,n,!0),Qe.NETWORK;throw ie(Qr)})}updateCloudDiscoveryMetadataFromLocalSources(e){this.logger.verbose("Attempting to get cloud discovery metadata  from authority configuration"),this.logger.verbosePii(`Known Authorities: ${this.authorityOptions.knownAuthorities||p.NOT_APPLICABLE}`),this.logger.verbosePii(`Authority Metadata: ${this.authorityOptions.authorityMetadata||p.NOT_APPLICABLE}`),this.logger.verbosePii(`Canonical Authority: ${e.canonical_authority||p.NOT_APPLICABLE}`);let t=this.getCloudDiscoveryMetadataFromConfig();if(t)return this.logger.verbose("Found cloud discovery metadata in authority configuration"),ha(e,t,!1),Qe.CONFIG;if(this.logger.verbose("Did not find cloud discovery metadata in the config... Attempting to get cloud discovery metadata from the hardcoded values."),this.options.skipAuthorityMetadataCache)this.logger.verbose("Skipping hardcoded cloud discovery metadata cache since skipAuthorityMetadataCache is set to true. Attempting to get cloud discovery metadata from the network metadata cache.");else{let i=Xh(this.hostnameAndPort);if(i)return this.logger.verbose("Found cloud discovery metadata from hardcoded values."),ha(e,i,!1),Qe.HARDCODED_VALUES;this.logger.verbose("Did not find cloud discovery metadata in hardcoded values... Attempting to get cloud discovery metadata from the network metadata cache.")}let n=As(e);return this.isAuthoritySameType(e)&&e.aliasesFromNetwork&&!n?(this.logger.verbose("Found cloud discovery metadata in the cache."),Qe.CACHE):(n&&this.logger.verbose("The metadata entity is expired."),null)}getCloudDiscoveryMetadataFromConfig(){if(this.authorityType===Je.Ciam)return this.logger.verbose("CIAM authorities do not support cloud discovery metadata, generate the aliases from authority host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort);if(this.authorityOptions.cloudDiscoveryMetadata){this.logger.verbose("The cloud discovery metadata has been provided as a network response, in the config.");try{this.logger.verbose("Attempting to parse the cloud discovery metadata.");let e=JSON.parse(this.authorityOptions.cloudDiscoveryMetadata),t=la(e.metadata,this.hostnameAndPort);if(this.logger.verbose("Parsed the cloud discovery metadata."),t)return this.logger.verbose("There is returnable metadata attached to the parsed cloud discovery metadata."),t;this.logger.verbose("There is no metadata attached to the parsed cloud discovery metadata.")}catch{throw this.logger.verbose("Unable to parse the cloud discovery metadata. Throwing Invalid Cloud Discovery Metadata Error."),ie(Yn)}}return this.isInKnownAuthorities()?(this.logger.verbose("The host is included in knownAuthorities. Creating new cloud discovery metadata from the host."),r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)):null}getCloudDiscoveryMetadataFromNetwork(){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthorityGetCloudDiscoveryMetadataFromNetwork,this.correlationId);let e=`${p.AAD_INSTANCE_DISCOVERY_ENDPT}${this.canonicalAuthority}oauth2/v2.0/authorize`,t={},n=null;try{let i=yield this.networkInterface.sendGetRequestAsync(e,t),o,a;if(Jh(i.body))o=i.body,a=o.metadata,this.logger.verbosePii(`tenant_discovery_endpoint is: ${o.tenant_discovery_endpoint}`);else if(Zh(i.body)){if(this.logger.warning(`A CloudInstanceDiscoveryErrorResponse was returned. The cloud instance discovery network request's status code is: ${i.status}`),o=i.body,o.error===p.INVALID_INSTANCE)return this.logger.error("The CloudInstanceDiscoveryErrorResponse error is invalid_instance."),null;this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error is ${o.error}`),this.logger.warning(`The CloudInstanceDiscoveryErrorResponse error description is ${o.error_description}`),this.logger.warning("Setting the value of the CloudInstanceDiscoveryMetadata (returned from the network) to []"),a=[]}else return this.logger.error("AAD did not return a CloudInstanceDiscoveryResponse or CloudInstanceDiscoveryErrorResponse"),null;this.logger.verbose("Attempting to find a match between the developer's authority and the CloudInstanceDiscoveryMetadata returned from the network request."),n=la(a,this.hostnameAndPort)}catch(i){if(i instanceof re)this.logger.error(`There was a network error while attempting to get the cloud discovery instance metadata.
Error: ${i.errorCode}
Error Description: ${i.errorMessage}`);else{let o=i;this.logger.error(`A non-MSALJS error was thrown while attempting to get the cloud instance discovery metadata.
Error: ${o.name}
Error Description: ${o.message}`)}return null}return n||(this.logger.warning("The developer's authority was not found within the CloudInstanceDiscoveryMetadata returned from the network request."),this.logger.verbose("Creating custom Authority for custom domain scenario."),n=r.createCloudDiscoveryMetadataFromHost(this.hostnameAndPort)),n})}isInKnownAuthorities(){return this.authorityOptions.knownAuthorities.filter(t=>t&&Q.getDomainFromUrl(t).toLowerCase()===this.hostnameAndPort).length>0}static generateAuthority(e,t){let n;if(t&&t.azureCloudInstance!==Qn.None){let i=t.tenant?t.tenant:p.DEFAULT_COMMON_TENANT;n=`${t.azureCloudInstance}/${i}/`}return n||e}static createCloudDiscoveryMetadataFromHost(e){return{preferred_network:e,preferred_cache:e,aliases:[e]}}getPreferredCache(){if(this.managedIdentity)return p.DEFAULT_AUTHORITY_HOST;if(this.discoveryComplete())return this.metadata.preferred_cache;throw T(Xe)}isAlias(e){return this.metadata.aliases.indexOf(e)>-1}isAliasOfKnownMicrosoftAuthority(e){return kl.has(e)}static isPublicCloudAuthority(e){return p.KNOWN_PUBLIC_CLOUDS.indexOf(e)>=0}static buildRegionalAuthorityString(e,t,n){let i=new Q(e);i.validateAsUri();let o=i.getUrlComponents(),a=`${t}.${o.HostNameAndPort}`;this.isPublicCloudAuthority(o.HostNameAndPort)&&(a=`${t}.${p.REGIONAL_AUTH_PUBLIC_CLOUD_SUFFIX}`);let s=Q.constructAuthorityUriFromObject(z(_({},i.getUrlComponents()),{HostNameAndPort:a})).urlString;return n?`${s}?${n}`:s}static replaceWithRegionalInformation(e,t){let n=_({},e);return n.authorization_endpoint=r.buildRegionalAuthorityString(n.authorization_endpoint,t),n.token_endpoint=r.buildRegionalAuthorityString(n.token_endpoint,t),n.end_session_endpoint&&(n.end_session_endpoint=r.buildRegionalAuthorityString(n.end_session_endpoint,t)),n}static transformCIAMAuthority(e){let t=e,i=new Q(e).getUrlComponents();if(i.PathSegments.length===0&&i.HostNameAndPort.endsWith(p.CIAM_AUTH_URL)){let o=i.HostNameAndPort.split(".")[0];t=`${t}${o}${p.AAD_TENANT_DOMAIN_SUFFIX}`}return t}};It.reservedTenantDomains=new Set(["{tenant}","{tenantid}",Kt.COMMON,Kt.CONSUMERS,Kt.ORGANIZATIONS]);function tm(r){let n=new Q(r).getUrlComponents().PathSegments.slice(-1)[0]?.toLowerCase();switch(n){case Kt.COMMON:case Kt.ORGANIZATIONS:case Kt.CONSUMERS:return;default:return n}}function Is(r){return r.endsWith(p.FORWARD_SLASH)?r:`${r}${p.FORWARD_SLASH}`}function Pl(r){let e=r.cloudDiscoveryMetadata,t;if(e)try{t=JSON.parse(e)}catch{throw ie(Yn)}return{canonicalAuthority:r.authority?Is(r.authority):void 0,knownAuthorities:r.knownAuthorities,cloudDiscoveryMetadata:t}}function Nl(r,e,t,n,i,o,a){return h(this,null,function*(){a?.addQueueMeasurement(d.AuthorityFactoryCreateDiscoveredInstance,o);let s=It.transformCIAMAuthority(Is(r)),c=new It(s,e,t,n,i,o,a);try{return yield E(c.resolveEndpointsAsync.bind(c),d.AuthorityResolveEndpointsAsync,i,a,o)(),c}catch{throw T(Xe)}})}function bs(r,e,t){return h(this,null,function*(){return typeof r=="string"?r:r({clientId:e,tokenEndpoint:t})})}var Si={};Ot(Si,{ACCESS_TOKEN:()=>WC,CCS_HEADER:()=>ZC,CLAIMS:()=>Fl,CLIENT_ASSERTION:()=>cd,CLIENT_ASSERTION_TYPE:()=>ld,CLIENT_ID:()=>Xn,CLIENT_INFO:()=>QC,CLIENT_REQUEST_ID:()=>Yl,CLIENT_SECRET:()=>sd,CODE:()=>ql,CODE_CHALLENGE:()=>Wl,CODE_CHALLENGE_METHOD:()=>Gl,CODE_VERIFIER:()=>$l,DEVICE_CODE:()=>ad,DOMAIN_HINT:()=>fd,ERROR:()=>zC,ERROR_DESCRIPTION:()=>qC,EXPIRES_IN:()=>$C,FOCI:()=>JC,GRANT_TYPE:()=>Hl,ID_TOKEN:()=>GC,ID_TOKEN_HINT:()=>od,LOGIN_HINT:()=>gd,LOGOUT_HINT:()=>md,NATIVE_BROKER:()=>hd,NONCE:()=>Kl,OBO_ASSERTION:()=>dd,ON_BEHALF_OF:()=>XC,POST_LOGOUT_URI:()=>id,PROMPT:()=>zl,REDIRECT_URI:()=>xl,REFRESH_TOKEN:()=>Bl,REFRESH_TOKEN_EXPIRES_IN:()=>YC,REQUESTED_TOKEN_USE:()=>ud,REQ_CNF:()=>Ms,RESPONSE_MODE:()=>Ll,RESPONSE_TYPE:()=>Rs,RETURN_SPA_CODE:()=>Os,SCOPE:()=>Ul,SESSION_STATE:()=>jC,SID:()=>pd,STATE:()=>Vl,TOKEN_TYPE:()=>Ds,X_APP_NAME:()=>nd,X_APP_VER:()=>rd,X_CLIENT_CPU:()=>Jl,X_CLIENT_CURR_TELEM:()=>Zl,X_CLIENT_EXTRA_SKU:()=>ev,X_CLIENT_LAST_TELEM:()=>ed,X_CLIENT_OS:()=>Xl,X_CLIENT_SKU:()=>jl,X_CLIENT_VER:()=>Ql,X_MS_LIB_CAPABILITY:()=>td});var Xn="client_id",xl="redirect_uri",Rs="response_type",Ll="response_mode",Hl="grant_type",Fl="claims",Ul="scope",zC="error",qC="error_description",WC="access_token",GC="id_token",Bl="refresh_token",$C="expires_in",YC="refresh_token_expires_in",Vl="state",Kl="nonce",zl="prompt",jC="session_state",QC="client_info",ql="code",Wl="code_challenge",Gl="code_challenge_method",$l="code_verifier",Yl="client-request-id",jl="x-client-SKU",Ql="x-client-VER",Xl="x-client-OS",Jl="x-client-CPU",Zl="x-client-current-telemetry",ed="x-client-last-telemetry",td="x-ms-lib-capability",nd="x-app-name",rd="x-app-ver",id="post_logout_redirect_uri",od="id_token_hint",ad="device_code",sd="client_secret",cd="client_assertion",ld="client_assertion_type",Ds="token_type",Ms="req_cnf",dd="assertion",ud="requested_token_use",XC="on_behalf_of",JC="foci",ZC="X-AnchorMailbox",Os="return_spa_code",hd="nativebroker",md="logout_hint",pd="sid",gd="login_hint",fd="domain_hint",ev="x-client-xtra-sku";var Jn={createNewGuid:()=>{throw T(Y)},base64Decode:()=>{throw T(Y)},base64Encode:()=>{throw T(Y)},base64UrlEncode:()=>{throw T(Y)},encodeKid:()=>{throw T(Y)},getPublicKeyThumbprint(){return h(this,null,function*(){throw T(Y)})},removeTokenBindingKey(){return h(this,null,function*(){throw T(Y)})},clearKeystore(){return h(this,null,function*(){throw T(Y)})},signJwt(){return h(this,null,function*(){throw T(Y)})},hashString(){return h(this,null,function*(){throw T(Y)})}};var le=function(r){return r[r.Error=0]="Error",r[r.Warning=1]="Warning",r[r.Info=2]="Info",r[r.Verbose=3]="Verbose",r[r.Trace=4]="Trace",r}(le||{}),kt=class r{constructor(e,t,n){this.level=le.Info;let i=()=>{},o=e||r.createDefaultLoggerOptions();this.localCallback=o.loggerCallback||i,this.piiLoggingEnabled=o.piiLoggingEnabled||!1,this.level=typeof o.logLevel=="number"?o.logLevel:le.Info,this.correlationId=o.correlationId||p.EMPTY_STRING,this.packageName=t||p.EMPTY_STRING,this.packageVersion=n||p.EMPTY_STRING}static createDefaultLoggerOptions(){return{loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:le.Info}}clone(e,t,n){return new r({loggerCallback:this.localCallback,piiLoggingEnabled:this.piiLoggingEnabled,logLevel:this.level,correlationId:n||this.correlationId},e,t)}logMessage(e,t){if(t.logLevel>this.level||!this.piiLoggingEnabled&&t.containsPii)return;let o=`${`[${new Date().toUTCString()}] : [${t.correlationId||this.correlationId||""}]`} : ${this.packageName}@${this.packageVersion} : ${le[t.logLevel]} - ${e}`;this.executeCallback(t.logLevel,o,t.containsPii||!1)}executeCallback(e,t,n){this.localCallback&&this.localCallback(e,t,n)}error(e,t){this.logMessage(e,{logLevel:le.Error,containsPii:!1,correlationId:t||p.EMPTY_STRING})}errorPii(e,t){this.logMessage(e,{logLevel:le.Error,containsPii:!0,correlationId:t||p.EMPTY_STRING})}warning(e,t){this.logMessage(e,{logLevel:le.Warning,containsPii:!1,correlationId:t||p.EMPTY_STRING})}warningPii(e,t){this.logMessage(e,{logLevel:le.Warning,containsPii:!0,correlationId:t||p.EMPTY_STRING})}info(e,t){this.logMessage(e,{logLevel:le.Info,containsPii:!1,correlationId:t||p.EMPTY_STRING})}infoPii(e,t){this.logMessage(e,{logLevel:le.Info,containsPii:!0,correlationId:t||p.EMPTY_STRING})}verbose(e,t){this.logMessage(e,{logLevel:le.Verbose,containsPii:!1,correlationId:t||p.EMPTY_STRING})}verbosePii(e,t){this.logMessage(e,{logLevel:le.Verbose,containsPii:!0,correlationId:t||p.EMPTY_STRING})}trace(e,t){this.logMessage(e,{logLevel:le.Trace,containsPii:!1,correlationId:t||p.EMPTY_STRING})}tracePii(e,t){this.logMessage(e,{logLevel:le.Trace,containsPii:!0,correlationId:t||p.EMPTY_STRING})}isPiiLoggingEnabled(){return this.piiLoggingEnabled||!1}};var Ps="@azure/msal-common",Ai="14.14.1";var ve=class r{constructor(e){let t=e?_e.trimArrayEntries([...e]):[],n=t?_e.removeEmptyStringsFromArray(t):[];this.validateInputScopes(n),this.scopes=new Set,n.forEach(i=>this.scopes.add(i))}static fromString(e){let n=(e||p.EMPTY_STRING).split(" ");return new r(n)}static createSearchScopes(e){let t=new r(e);return t.containsOnlyOIDCScopes()?t.removeScope(p.OFFLINE_ACCESS_SCOPE):t.removeOIDCScopes(),t}validateInputScopes(e){if(!e||e.length<1)throw ie(qr)}containsScope(e){let t=this.printScopesLowerCase().split(" "),n=new r(t);return e?n.scopes.has(e.toLowerCase()):!1}containsScopeSet(e){return!e||e.scopes.size<=0?!1:this.scopes.size>=e.scopes.size&&e.asArray().every(t=>this.containsScope(t))}containsOnlyOIDCScopes(){let e=0;return wl.forEach(t=>{this.containsScope(t)&&(e+=1)}),this.scopes.size===e}appendScope(e){e&&this.scopes.add(e.trim())}appendScopes(e){try{e.forEach(t=>this.appendScope(t))}catch{throw T(Pr)}}removeScope(e){if(!e)throw T(Or);this.scopes.delete(e.trim())}removeOIDCScopes(){wl.forEach(e=>{this.scopes.delete(e)})}unionScopeSets(e){if(!e)throw T(Wn);let t=new Set;return e.scopes.forEach(n=>t.add(n.toLowerCase())),this.scopes.forEach(n=>t.add(n.toLowerCase())),t}intersectingScopeSets(e){if(!e)throw T(Wn);e.containsOnlyOIDCScopes()||e.removeOIDCScopes();let t=this.unionScopeSets(e),n=e.getScopeCount(),i=this.getScopeCount();return t.size<i+n}getScopeCount(){return this.scopes.size}asArray(){let e=[];return this.scopes.forEach(t=>e.push(t)),e}printScopes(){return this.scopes?this.asArray().join(" "):p.EMPTY_STRING}printScopesLowerCase(){return this.printScopes().toLowerCase()}};function Ii(r,e){if(!r)throw T(_r);try{let t=e(r);return JSON.parse(t)}catch{throw T(Kn)}}function Tn(r){if(!r)throw T(Kn);let e=r.split(ke.CLIENT_INFO_SEPARATOR,2);return{uid:e[0],utid:e.length<2?p.EMPTY_STRING:e[1]}}function ki(r,e){return!!r&&!!e&&r===e.split(".")[1]}function bi(r,e,t,n){if(n){let{oid:i,sub:o,tid:a,name:s,tfp:c,acr:l}=n,u=a||c||l||"";return{tenantId:u,localAccountId:i||o||"",name:s,isHomeTenant:ki(u,r)}}else return{tenantId:t,localAccountId:e,isHomeTenant:ki(t,r)}}function Xr(r,e,t,n){let i=r;if(e){let o=e,{isHomeTenant:s}=o,c=vt(o,["isHomeTenant"]);i=_(_({},r),c)}if(t){let a=bi(r.homeAccountId,r.localAccountId,r.tenantId,t),{isHomeTenant:s}=a,c=vt(a,["isHomeTenant"]);return i=z(_(_({},i),c),{idTokenClaims:t,idToken:n}),i}return i}function Ns(r){return r&&(r.tid||r.tfp||r.acr)||null}var pe=class r{generateAccountId(){return[this.homeAccountId,this.environment].join(ke.CACHE_KEY_SEPARATOR).toLowerCase()}generateAccountKey(){return r.generateAccountCacheKey({homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId})}getAccountInfo(){return{homeAccountId:this.homeAccountId,environment:this.environment,tenantId:this.realm,username:this.username,localAccountId:this.localAccountId,name:this.name,nativeAccountId:this.nativeAccountId,authorityType:this.authorityType,tenantProfiles:new Map((this.tenantProfiles||[]).map(e=>[e.tenantId,e]))}}isSingleTenant(){return!this.tenantProfiles}static generateAccountCacheKey(e){let t=e.homeAccountId.split(".")[1];return[e.homeAccountId,e.environment||"",t||e.tenantId||""].join(ke.CACHE_KEY_SEPARATOR).toLowerCase()}static createAccount(e,t,n){let i=new r;t.authorityType===Je.Adfs?i.authorityType=Ti.ADFS_ACCOUNT_TYPE:t.protocolMode===qe.AAD?i.authorityType=Ti.MSSTS_ACCOUNT_TYPE:i.authorityType=Ti.GENERIC_ACCOUNT_TYPE;let o;e.clientInfo&&n&&(o=Ii(e.clientInfo,n)),i.clientInfo=e.clientInfo,i.homeAccountId=e.homeAccountId,i.nativeAccountId=e.nativeAccountId;let a=e.environment||t&&t.getPreferredCache();if(!a)throw T(gn);i.environment=a,i.realm=o?.utid||Ns(e.idTokenClaims)||"",i.localAccountId=o?.uid||e.idTokenClaims?.oid||e.idTokenClaims?.sub||"";let s=e.idTokenClaims?.preferred_username||e.idTokenClaims?.upn,c=e.idTokenClaims?.emails?e.idTokenClaims.emails[0]:null;if(i.username=s||c||"",i.name=e.idTokenClaims?.name||"",i.cloudGraphHostName=e.cloudGraphHostName,i.msGraphHost=e.msGraphHost,e.tenantProfiles)i.tenantProfiles=e.tenantProfiles;else{let l=bi(e.homeAccountId,i.localAccountId,i.realm,e.idTokenClaims);i.tenantProfiles=[l]}return i}static createFromAccountInfo(e,t,n){let i=new r;return i.authorityType=e.authorityType||Ti.GENERIC_ACCOUNT_TYPE,i.homeAccountId=e.homeAccountId,i.localAccountId=e.localAccountId,i.nativeAccountId=e.nativeAccountId,i.realm=e.tenantId,i.environment=e.environment,i.username=e.username,i.name=e.name,i.cloudGraphHostName=t,i.msGraphHost=n,i.tenantProfiles=Array.from(e.tenantProfiles?.values()||[]),i}static generateHomeAccountId(e,t,n,i,o){if(!(t===Je.Adfs||t===Je.Dsts)){if(e)try{let a=Ii(e,i.base64Decode);if(a.uid&&a.utid)return`${a.uid}.${a.utid}`}catch{}n.warning("No client info in response")}return o?.sub||""}static isAccountEntity(e){return e?e.hasOwnProperty("homeAccountId")&&e.hasOwnProperty("environment")&&e.hasOwnProperty("realm")&&e.hasOwnProperty("localAccountId")&&e.hasOwnProperty("username")&&e.hasOwnProperty("authorityType"):!1}static accountInfoIsEqual(e,t,n){if(!e||!t)return!1;let i=!0;if(n){let o=e.idTokenClaims||{},a=t.idTokenClaims||{};i=o.iat===a.iat&&o.nonce===a.nonce}return e.homeAccountId===t.homeAccountId&&e.localAccountId===t.localAccountId&&e.username===t.username&&e.tenantId===t.tenantId&&e.environment===t.environment&&e.nativeAccountId===t.nativeAccountId&&i}};var xs="cache_quota_exceeded",ma="cache_error_unknown";var Cd={[xs]:"Exceeded cache storage capacity.",[ma]:"Unexpected error occurred when using cache storage."},wn=class r extends Error{constructor(e,t){let n=t||(Cd[e]?Cd[e]:Cd[ma]);super(`${e}: ${n}`),Object.setPrototypeOf(this,r.prototype),this.name="CacheError",this.errorCode=e,this.errorMessage=n}};var _n=class r{constructor(e,t,n,i){this.clientId=e,this.cryptoImpl=t,this.commonLogger=n.clone(Ps,Ai),this.staticAuthorityOptions=i}getAllAccounts(e){return this.buildTenantProfiles(this.getAccountsFilteredBy(e||{}),e)}getAccountInfoFilteredBy(e){let t=this.getAllAccounts(e);return t.length>1?t.sort(i=>i.idTokenClaims?-1:1)[0]:t.length===1?t[0]:null}getBaseAccountInfo(e){let t=this.getAccountsFilteredBy(e);return t.length>0?t[0].getAccountInfo():null}buildTenantProfiles(e,t){return e.flatMap(n=>this.getTenantProfilesFromAccountEntity(n,t?.tenantId,t))}getTenantedAccountInfoByFilter(e,t,n,i){let o=null,a;if(i&&!this.tenantProfileMatchesFilter(n,i))return null;let s=this.getIdToken(e,t,n.tenantId);return s&&(a=fn(s.secret,this.cryptoImpl.base64Decode),!this.idTokenClaimsMatchTenantProfileFilter(a,i))?null:(o=Xr(e,n,a,s?.secret),o)}getTenantProfilesFromAccountEntity(e,t,n){let i=e.getAccountInfo(),o=i.tenantProfiles||new Map,a=this.getTokenKeys();if(t){let c=o.get(t);if(c)o=new Map([[t,c]]);else return[]}let s=[];return o.forEach(c=>{let l=this.getTenantedAccountInfoByFilter(i,a,c,n);l&&s.push(l)}),s}tenantProfileMatchesFilter(e,t){return!(t.localAccountId&&!this.matchLocalAccountIdFromTenantProfile(e,t.localAccountId)||t.name&&e.name!==t.name||t.isHomeTenant!==void 0&&e.isHomeTenant!==t.isHomeTenant)}idTokenClaimsMatchTenantProfileFilter(e,t){return!(t&&(t.localAccountId&&!this.matchLocalAccountIdFromTokenClaims(e,t.localAccountId)||t.loginHint&&!this.matchLoginHintFromTokenClaims(e,t.loginHint)||t.username&&!this.matchUsername(e.preferred_username,t.username)||t.name&&!this.matchName(e,t.name)||t.sid&&!this.matchSid(e,t.sid)))}saveCacheRecord(e,t,n){return h(this,null,function*(){if(!e)throw T(Nr);try{e.account&&this.setAccount(e.account),e.idToken&&t?.idToken!==!1&&this.setIdTokenCredential(e.idToken),e.accessToken&&t?.accessToken!==!1&&(yield this.saveAccessToken(e.accessToken)),e.refreshToken&&t?.refreshToken!==!1&&this.setRefreshTokenCredential(e.refreshToken),e.appMetadata&&this.setAppMetadata(e.appMetadata)}catch(i){throw this.commonLogger?.error("CacheManager.saveCacheRecord: failed"),i instanceof Error?(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${i.message}`,n),i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED"||i.message.includes("exceeded the quota")?(this.commonLogger?.error("CacheManager.saveCacheRecord: exceeded storage quota",n),new wn(xs)):new wn(i.name,i.message)):(this.commonLogger?.errorPii(`CacheManager.saveCacheRecord: ${i}`,n),new wn(ma))}})}saveAccessToken(e){return h(this,null,function*(){let t={clientId:e.clientId,credentialType:e.credentialType,environment:e.environment,homeAccountId:e.homeAccountId,realm:e.realm,tokenType:e.tokenType,requestedClaimsHash:e.requestedClaimsHash},n=this.getTokenKeys(),i=ve.fromString(e.target),o=[];n.accessToken.forEach(a=>{if(!this.accessTokenKeyMatchesFilter(a,t,!1))return;let s=this.getAccessTokenCredential(a);s&&this.credentialMatchesFilter(s,t)&&ve.fromString(s.target).intersectingScopeSets(i)&&o.push(this.removeAccessToken(a))}),yield Promise.all(o),this.setAccessTokenCredential(e)})}getAccountsFilteredBy(e){let t=this.getAccountKeys(),n=[];return t.forEach(i=>{if(!this.isAccountKey(i,e.homeAccountId))return;let o=this.getAccount(i,this.commonLogger);if(!o||e.homeAccountId&&!this.matchHomeAccountId(o,e.homeAccountId)||e.username&&!this.matchUsername(o.username,e.username)||e.environment&&!this.matchEnvironment(o,e.environment)||e.realm&&!this.matchRealm(o,e.realm)||e.nativeAccountId&&!this.matchNativeAccountId(o,e.nativeAccountId)||e.authorityType&&!this.matchAuthorityType(o,e.authorityType))return;let a={localAccountId:e?.localAccountId,name:e?.name},s=o.tenantProfiles?.filter(c=>this.tenantProfileMatchesFilter(c,a));s&&s.length===0||n.push(o)}),n}isAccountKey(e,t,n){return!(e.split(ke.CACHE_KEY_SEPARATOR).length<3||t&&!e.toLowerCase().includes(t.toLowerCase())||n&&!e.toLowerCase().includes(n.toLowerCase()))}isCredentialKey(e){if(e.split(ke.CACHE_KEY_SEPARATOR).length<6)return!1;let t=e.toLowerCase();if(t.indexOf(G.ID_TOKEN.toLowerCase())===-1&&t.indexOf(G.ACCESS_TOKEN.toLowerCase())===-1&&t.indexOf(G.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase())===-1&&t.indexOf(G.REFRESH_TOKEN.toLowerCase())===-1)return!1;if(t.indexOf(G.REFRESH_TOKEN.toLowerCase())>-1){let n=`${G.REFRESH_TOKEN}${ke.CACHE_KEY_SEPARATOR}${this.clientId}${ke.CACHE_KEY_SEPARATOR}`,i=`${G.REFRESH_TOKEN}${ke.CACHE_KEY_SEPARATOR}${Vn}${ke.CACHE_KEY_SEPARATOR}`;if(t.indexOf(n.toLowerCase())===-1&&t.indexOf(i.toLowerCase())===-1)return!1}else if(t.indexOf(this.clientId.toLowerCase())===-1)return!1;return!0}credentialMatchesFilter(e,t){return!(t.clientId&&!this.matchClientId(e,t.clientId)||t.userAssertionHash&&!this.matchUserAssertionHash(e,t.userAssertionHash)||typeof t.homeAccountId=="string"&&!this.matchHomeAccountId(e,t.homeAccountId)||t.environment&&!this.matchEnvironment(e,t.environment)||t.realm&&!this.matchRealm(e,t.realm)||t.credentialType&&!this.matchCredentialType(e,t.credentialType)||t.familyId&&!this.matchFamilyId(e,t.familyId)||t.target&&!this.matchTarget(e,t.target)||(t.requestedClaimsHash||e.requestedClaimsHash)&&e.requestedClaimsHash!==t.requestedClaimsHash||e.credentialType===G.ACCESS_TOKEN_WITH_AUTH_SCHEME&&(t.tokenType&&!this.matchTokenType(e,t.tokenType)||t.tokenType===ne.SSH&&t.keyId&&!this.matchKeyId(e,t.keyId)))}getAppMetadataFilteredBy(e){let t=this.getKeys(),n={};return t.forEach(i=>{if(!this.isAppMetadata(i))return;let o=this.getAppMetadata(i);o&&(e.environment&&!this.matchEnvironment(o,e.environment)||e.clientId&&!this.matchClientId(o,e.clientId)||(n[i]=o))}),n}getAuthorityMetadataByAlias(e){let t=this.getAuthorityMetadataKeys(),n=null;return t.forEach(i=>{if(!this.isAuthorityMetadata(i)||i.indexOf(this.clientId)===-1)return;let o=this.getAuthorityMetadata(i);o&&o.aliases.indexOf(e)!==-1&&(n=o)}),n}removeAllAccounts(){return h(this,null,function*(){let e=this.getAccountKeys(),t=[];e.forEach(n=>{t.push(this.removeAccount(n))}),yield Promise.all(t)})}removeAccount(e){return h(this,null,function*(){let t=this.getAccount(e,this.commonLogger);t&&(yield this.removeAccountContext(t),this.removeItem(e))})}removeAccountContext(e){return h(this,null,function*(){let t=this.getTokenKeys(),n=e.generateAccountId(),i=[];t.idToken.forEach(o=>{o.indexOf(n)===0&&this.removeIdToken(o)}),t.accessToken.forEach(o=>{o.indexOf(n)===0&&i.push(this.removeAccessToken(o))}),t.refreshToken.forEach(o=>{o.indexOf(n)===0&&this.removeRefreshToken(o)}),yield Promise.all(i)})}updateOutdatedCachedAccount(e,t,n){if(t&&t.isSingleTenant()){this.commonLogger?.verbose("updateOutdatedCachedAccount: Found a single-tenant (outdated) account entity in the cache, migrating to multi-tenant account entity");let i=this.getAccountKeys().filter(l=>l.startsWith(t.homeAccountId)),o=[];i.forEach(l=>{let u=this.getCachedAccountEntity(l);u&&o.push(u)});let a=o.find(l=>ki(l.realm,l.homeAccountId))||o[0];a.tenantProfiles=o.map(l=>({tenantId:l.realm,localAccountId:l.localAccountId,name:l.name,isHomeTenant:ki(l.realm,l.homeAccountId)}));let s=r.toObject(new pe,_({},a)),c=s.generateAccountKey();return i.forEach(l=>{l!==c&&this.removeOutdatedAccount(e)}),this.setAccount(s),n?.verbose("Updated an outdated account entity in the cache"),s}return t}removeAccessToken(e){return h(this,null,function*(){let t=this.getAccessTokenCredential(e);if(t){if(t.credentialType.toLowerCase()===G.ACCESS_TOKEN_WITH_AUTH_SCHEME.toLowerCase()&&t.tokenType===ne.POP){let i=t.keyId;if(i)try{yield this.cryptoImpl.removeTokenBindingKey(i)}catch{throw T(Hr)}}return this.removeItem(e)}})}removeAppMetadata(){return this.getKeys().forEach(t=>{this.isAppMetadata(t)&&this.removeItem(t)}),!0}readAccountFromCache(e){let t=pe.generateAccountCacheKey(e);return this.getAccount(t,this.commonLogger)}getIdToken(e,t,n,i,o){this.commonLogger.trace("CacheManager - getIdToken called");let a={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:G.ID_TOKEN,clientId:this.clientId,realm:n},s=this.getIdTokensByFilter(a,t),c=s.size;if(c<1)return this.commonLogger.info("CacheManager:getIdToken - No token found"),null;if(c>1){let l=s;if(!n){let u=new Map;s.forEach((v,g)=>{v.realm===e.tenantId&&u.set(g,v)});let m=u.size;if(m<1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account but none match account entity tenant id, returning first result"),s.values().next().value;if(m===1)return this.commonLogger.info("CacheManager:getIdToken - Multiple ID tokens found for account, defaulting to home tenant profile"),u.values().next().value;l=u}return this.commonLogger.info("CacheManager:getIdToken - Multiple matching ID tokens found, clearing them"),l.forEach((u,m)=>{this.removeIdToken(m)}),i&&o&&i.addFields({multiMatchedID:s.size},o),null}return this.commonLogger.info("CacheManager:getIdToken - Returning ID token"),s.values().next().value}getIdTokensByFilter(e,t){let n=t&&t.idToken||this.getTokenKeys().idToken,i=new Map;return n.forEach(o=>{if(!this.idTokenKeyMatchesFilter(o,_({clientId:this.clientId},e)))return;let a=this.getIdTokenCredential(o);a&&this.credentialMatchesFilter(a,e)&&i.set(o,a)}),i}idTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}removeIdToken(e){this.removeItem(e)}removeRefreshToken(e){this.removeItem(e)}getAccessToken(e,t,n,i,o,a){this.commonLogger.trace("CacheManager - getAccessToken called");let s=ve.createSearchScopes(t.scopes),c=t.authenticationScheme||ne.BEARER,l=c&&c.toLowerCase()!==ne.BEARER.toLowerCase()?G.ACCESS_TOKEN_WITH_AUTH_SCHEME:G.ACCESS_TOKEN,u={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:l,clientId:this.clientId,realm:i||e.tenantId,target:s,tokenType:c,keyId:t.sshKid,requestedClaimsHash:t.requestedClaimsHash},m=n&&n.accessToken||this.getTokenKeys().accessToken,v=[];m.forEach(A=>{if(this.accessTokenKeyMatchesFilter(A,u,!0)){let k=this.getAccessTokenCredential(A);k&&this.credentialMatchesFilter(k,u)&&v.push(k)}});let g=v.length;return g<1?(this.commonLogger.info("CacheManager:getAccessToken - No token found"),null):g>1?(this.commonLogger.info("CacheManager:getAccessToken - Multiple access tokens found, clearing them"),v.forEach(A=>{this.removeAccessToken(ua(A))}),o&&a&&o.addFields({multiMatchedAT:v.length},a),null):(this.commonLogger.info("CacheManager:getAccessToken - Returning access token"),v[0])}accessTokenKeyMatchesFilter(e,t,n){let i=e.toLowerCase();if(t.clientId&&i.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&i.indexOf(t.homeAccountId.toLowerCase())===-1||t.realm&&i.indexOf(t.realm.toLowerCase())===-1||t.requestedClaimsHash&&i.indexOf(t.requestedClaimsHash.toLowerCase())===-1)return!1;if(t.target){let o=t.target.asArray();for(let a=0;a<o.length;a++){if(n&&!i.includes(o[a].toLowerCase()))return!1;if(!n&&i.includes(o[a].toLowerCase()))return!0}}return!0}getAccessTokensByFilter(e){let t=this.getTokenKeys(),n=[];return t.accessToken.forEach(i=>{if(!this.accessTokenKeyMatchesFilter(i,e,!0))return;let o=this.getAccessTokenCredential(i);o&&this.credentialMatchesFilter(o,e)&&n.push(o)}),n}getRefreshToken(e,t,n,i,o){this.commonLogger.trace("CacheManager - getRefreshToken called");let a=t?Vn:void 0,s={homeAccountId:e.homeAccountId,environment:e.environment,credentialType:G.REFRESH_TOKEN,clientId:this.clientId,familyId:a},c=n&&n.refreshToken||this.getTokenKeys().refreshToken,l=[];c.forEach(m=>{if(this.refreshTokenKeyMatchesFilter(m,s)){let v=this.getRefreshTokenCredential(m);v&&this.credentialMatchesFilter(v,s)&&l.push(v)}});let u=l.length;return u<1?(this.commonLogger.info("CacheManager:getRefreshToken - No refresh token found."),null):(u>1&&i&&o&&i.addFields({multiMatchedRT:u},o),this.commonLogger.info("CacheManager:getRefreshToken - returning refresh token"),l[0])}refreshTokenKeyMatchesFilter(e,t){let n=e.toLowerCase();return!(t.familyId&&n.indexOf(t.familyId.toLowerCase())===-1||!t.familyId&&t.clientId&&n.indexOf(t.clientId.toLowerCase())===-1||t.homeAccountId&&n.indexOf(t.homeAccountId.toLowerCase())===-1)}readAppMetadataFromCache(e){let t={environment:e,clientId:this.clientId},n=this.getAppMetadataFilteredBy(t),i=Object.keys(n).map(a=>n[a]),o=i.length;if(o<1)return null;if(o>1)throw T(Dr);return i[0]}isAppMetadataFOCI(e){let t=this.readAppMetadataFromCache(e);return!!(t&&t.familyId===Vn)}matchHomeAccountId(e,t){return typeof e.homeAccountId=="string"&&t===e.homeAccountId}matchLocalAccountIdFromTokenClaims(e,t){let n=e.oid||e.sub;return t===n}matchLocalAccountIdFromTenantProfile(e,t){return e.localAccountId===t}matchName(e,t){return t.toLowerCase()===e.name?.toLowerCase()}matchUsername(e,t){return!!(e&&typeof e=="string"&&t?.toLowerCase()===e.toLowerCase())}matchUserAssertionHash(e,t){return!!(e.userAssertionHash&&t===e.userAssertionHash)}matchEnvironment(e,t){if(this.staticAuthorityOptions){let i=Qh(this.staticAuthorityOptions,this.commonLogger);if(i.includes(t)&&i.includes(e.environment))return!0}let n=this.getAuthorityMetadataByAlias(t);return!!(n&&n.aliases.indexOf(e.environment)>-1)}matchCredentialType(e,t){return e.credentialType&&t.toLowerCase()===e.credentialType.toLowerCase()}matchClientId(e,t){return!!(e.clientId&&t===e.clientId)}matchFamilyId(e,t){return!!(e.familyId&&t===e.familyId)}matchRealm(e,t){return e.realm?.toLowerCase()===t.toLowerCase()}matchNativeAccountId(e,t){return!!(e.nativeAccountId&&t===e.nativeAccountId)}matchLoginHintFromTokenClaims(e,t){return e.login_hint===t||e.preferred_username===t||e.upn===t}matchSid(e,t){return e.sid===t}matchAuthorityType(e,t){return!!(e.authorityType&&t.toLowerCase()===e.authorityType.toLowerCase())}matchTarget(e,t){return e.credentialType!==G.ACCESS_TOKEN&&e.credentialType!==G.ACCESS_TOKEN_WITH_AUTH_SCHEME||!e.target?!1:ve.fromString(e.target).containsScopeSet(t)}matchTokenType(e,t){return!!(e.tokenType&&e.tokenType===t)}matchKeyId(e,t){return!!(e.keyId&&e.keyId===t)}isAppMetadata(e){return e.indexOf(xo)!==-1}isAuthorityMetadata(e){return e.indexOf(wi.CACHE_KEY)!==-1}generateAuthorityMetadataCacheKey(e){return`${wi.CACHE_KEY}-${this.clientId}-${e}`}static toObject(e,t){for(let n in t)e[n]=t[n];return e}},pa=class extends _n{setAccount(){throw T(Y)}getAccount(){throw T(Y)}getCachedAccountEntity(){throw T(Y)}setIdTokenCredential(){throw T(Y)}getIdTokenCredential(){throw T(Y)}setAccessTokenCredential(){throw T(Y)}getAccessTokenCredential(){throw T(Y)}setRefreshTokenCredential(){throw T(Y)}getRefreshTokenCredential(){throw T(Y)}setAppMetadata(){throw T(Y)}getAppMetadata(){throw T(Y)}setServerTelemetry(){throw T(Y)}getServerTelemetry(){throw T(Y)}setAuthorityMetadata(){throw T(Y)}getAuthorityMetadata(){throw T(Y)}getAuthorityMetadataKeys(){throw T(Y)}setThrottlingCache(){throw T(Y)}getThrottlingCache(){throw T(Y)}removeItem(){throw T(Y)}getKeys(){throw T(Y)}getAccountKeys(){throw T(Y)}getTokenKeys(){throw T(Y)}clear(){return h(this,null,function*(){throw T(Y)})}updateCredentialCacheKey(){throw T(Y)}removeOutdatedAccount(){throw T(Y)}};var Ls={tokenRenewalOffsetSeconds:El,preventCorsPreflight:!1},tv={loggerCallback:()=>{},piiLoggingEnabled:!1,logLevel:le.Info,correlationId:p.EMPTY_STRING},nv={claimsBasedCachingEnabled:!1},rv={sendGetRequestAsync(){return h(this,null,function*(){throw T(Y)})},sendPostRequestAsync(){return h(this,null,function*(){throw T(Y)})}},iv={sku:p.SKU,version:Ai,cpu:p.EMPTY_STRING,os:p.EMPTY_STRING},ov={clientSecret:p.EMPTY_STRING,clientAssertion:void 0},av={azureCloudInstance:Qn.None,tenant:`${p.DEFAULT_COMMON_TENANT}`},sv={application:{appName:"",appVersion:""}};function nm({authOptions:r,systemOptions:e,loggerOptions:t,cacheOptions:n,storageInterface:i,networkInterface:o,cryptoInterface:a,clientCredentials:s,libraryInfo:c,telemetry:l,serverTelemetryManager:u,persistencePlugin:m,serializableCache:v}){let g=_(_({},tv),t);return{authOptions:cv(r),systemOptions:_(_({},Ls),e),loggerOptions:g,cacheOptions:_(_({},nv),n),storageInterface:i||new pa(r.clientId,Jn,new kt(g)),networkInterface:o||rv,cryptoInterface:a||Jn,clientCredentials:s||ov,libraryInfo:_(_({},iv),c),telemetry:_(_({},sv),l),serverTelemetryManager:u||null,persistencePlugin:m||null,serializableCache:v||null}}function cv(r){return _({clientCapabilities:[],azureCloudOptions:av,skipAuthorityMetadataCache:!1},r)}function ga(r){return r.authOptions.authority.options.protocolMode===qe.OIDC}var Re=class r extends re{constructor(e,t,n,i,o){super(e,t,n),this.name="ServerError",this.errorNo=i,this.status=o,Object.setPrototypeOf(this,r.prototype)}};var Jt=class r{static generateThrottlingStorageKey(e){return`${hn.THROTTLING_PREFIX}.${JSON.stringify(e)}`}static preProcess(e,t){let n=r.generateThrottlingStorageKey(t),i=e.getThrottlingCache(n);if(i){if(i.throttleTime<Date.now()){e.removeItem(n);return}throw new Re(i.errorCodes?.join(" ")||p.EMPTY_STRING,i.errorMessage,i.subError)}}static postProcess(e,t,n){if(r.checkResponseStatus(n)||r.checkResponseForRetryAfter(n)){let i={throttleTime:r.calculateThrottleTime(parseInt(n.headers[je.RETRY_AFTER])),error:n.body.error,errorCodes:n.body.error_codes,errorMessage:n.body.error_description,subError:n.body.suberror};e.setThrottlingCache(r.generateThrottlingStorageKey(t),i)}}static checkResponseStatus(e){return e.status===429||e.status>=500&&e.status<600}static checkResponseForRetryAfter(e){return e.headers?e.headers.hasOwnProperty(je.RETRY_AFTER)&&(e.status<200||e.status>=300):!1}static calculateThrottleTime(e){let t=e<=0?0:e,n=Date.now()/1e3;return Math.floor(Math.min(n+(t||hn.DEFAULT_THROTTLE_TIME_SECONDS),n+hn.DEFAULT_MAX_THROTTLE_TIME_SECONDS)*1e3)}static removeThrottle(e,t,n,i){let o={clientId:t,authority:n.authority,scopes:n.scopes,homeAccountIdentifier:i,claims:n.claims,authenticationScheme:n.authenticationScheme,resourceRequestMethod:n.resourceRequestMethod,resourceRequestUri:n.resourceRequestUri,shrClaims:n.shrClaims,sshKid:n.sshKid},a=this.generateThrottlingStorageKey(o);e.removeItem(a)}};var Hs=class{constructor(e,t){this.networkClient=e,this.cacheManager=t}sendPostRequest(e,t,n){return h(this,null,function*(){Jt.preProcess(this.cacheManager,e);let i;try{i=yield this.networkClient.sendPostRequestAsync(t,n)}catch(o){throw o instanceof re?o:T(Sr)}return Jt.postProcess(this.cacheManager,e,i),i})}};var Le={HOME_ACCOUNT_ID:"home_account_id",UPN:"UPN"};var Zt=class{static validateRedirectUri(e){if(!e)throw ie(Vr)}static validatePrompt(e){let t=[];for(let n in Ce)t.push(Ce[n]);if(t.indexOf(e)<0)throw ie(Wr)}static validateClaims(e){try{JSON.parse(e)}catch{throw ie(Cn)}}static validateCodeChallengeParams(e,t){if(!e||!t)throw ie(vn);this.validateCodeChallengeMethod(t)}static validateCodeChallengeMethod(e){if([Cs.PLAIN,Cs.S256].indexOf(e)<0)throw ie(Yr)}};var en=class{constructor(){this.parameters=new Map}addResponseTypeCode(){this.parameters.set(Rs,encodeURIComponent(p.CODE_RESPONSE_TYPE))}addResponseTypeForTokenAndIdToken(){this.parameters.set(Rs,encodeURIComponent(`${p.TOKEN_RESPONSE_TYPE} ${p.ID_TOKEN_RESPONSE_TYPE}`))}addResponseMode(e){this.parameters.set(Ll,encodeURIComponent(e||_l.QUERY))}addNativeBroker(){this.parameters.set(hd,encodeURIComponent("1"))}addScopes(e,t=!0,n=pt){t&&!n.includes("openid")&&!e.includes("openid")&&n.push("openid");let i=t?[...e||[],...n]:e||[],o=new ve(i);this.parameters.set(Ul,encodeURIComponent(o.printScopes()))}addClientId(e){this.parameters.set(Xn,encodeURIComponent(e))}addRedirectUri(e){Zt.validateRedirectUri(e),this.parameters.set(xl,encodeURIComponent(e))}addPostLogoutRedirectUri(e){Zt.validateRedirectUri(e),this.parameters.set(id,encodeURIComponent(e))}addIdTokenHint(e){this.parameters.set(od,encodeURIComponent(e))}addDomainHint(e){this.parameters.set(fd,encodeURIComponent(e))}addLoginHint(e){this.parameters.set(gd,encodeURIComponent(e))}addCcsUpn(e){this.parameters.set(je.CCS_HEADER,encodeURIComponent(`UPN:${e}`))}addCcsOid(e){this.parameters.set(je.CCS_HEADER,encodeURIComponent(`Oid:${e.uid}@${e.utid}`))}addSid(e){this.parameters.set(pd,encodeURIComponent(e))}addClaims(e,t){let n=this.addClientCapabilitiesToClaims(e,t);Zt.validateClaims(n),this.parameters.set(Fl,encodeURIComponent(n))}addCorrelationId(e){this.parameters.set(Yl,encodeURIComponent(e))}addLibraryInfo(e){this.parameters.set(jl,e.sku),this.parameters.set(Ql,e.version),e.os&&this.parameters.set(Xl,e.os),e.cpu&&this.parameters.set(Jl,e.cpu)}addApplicationTelemetry(e){e?.appName&&this.parameters.set(nd,e.appName),e?.appVersion&&this.parameters.set(rd,e.appVersion)}addPrompt(e){Zt.validatePrompt(e),this.parameters.set(`${zl}`,encodeURIComponent(e))}addState(e){e&&this.parameters.set(Vl,encodeURIComponent(e))}addNonce(e){this.parameters.set(Kl,encodeURIComponent(e))}addCodeChallengeParams(e,t){if(Zt.validateCodeChallengeParams(e,t),e&&t)this.parameters.set(Wl,encodeURIComponent(e)),this.parameters.set(Gl,encodeURIComponent(t));else throw ie(vn)}addAuthorizationCode(e){this.parameters.set(ql,encodeURIComponent(e))}addDeviceCode(e){this.parameters.set(ad,encodeURIComponent(e))}addRefreshToken(e){this.parameters.set(Bl,encodeURIComponent(e))}addCodeVerifier(e){this.parameters.set($l,encodeURIComponent(e))}addClientSecret(e){this.parameters.set(sd,encodeURIComponent(e))}addClientAssertion(e){e&&this.parameters.set(cd,encodeURIComponent(e))}addClientAssertionType(e){e&&this.parameters.set(ld,encodeURIComponent(e))}addOboAssertion(e){this.parameters.set(dd,encodeURIComponent(e))}addRequestTokenUse(e){this.parameters.set(ud,encodeURIComponent(e))}addGrantType(e){this.parameters.set(Hl,encodeURIComponent(e))}addClientInfo(){this.parameters.set(Vh,"1")}addExtraQueryParameters(e){Object.entries(e).forEach(([t,n])=>{!this.parameters.has(t)&&n&&this.parameters.set(t,n)})}addClientCapabilitiesToClaims(e,t){let n;if(!e)n={};else try{n=JSON.parse(e)}catch{throw ie(Cn)}return t&&t.length>0&&(n.hasOwnProperty(yi.ACCESS_TOKEN)||(n[yi.ACCESS_TOKEN]={}),n[yi.ACCESS_TOKEN][yi.XMS_CC]={values:t}),JSON.stringify(n)}addUsername(e){this.parameters.set(ys.username,encodeURIComponent(e))}addPassword(e){this.parameters.set(ys.password,encodeURIComponent(e))}addPopToken(e){e&&(this.parameters.set(Ds,ne.POP),this.parameters.set(Ms,encodeURIComponent(e)))}addSshJwk(e){e&&(this.parameters.set(Ds,ne.SSH),this.parameters.set(Ms,encodeURIComponent(e)))}addServerTelemetry(e){this.parameters.set(Zl,e.generateCurrentRequestHeaderValue()),this.parameters.set(ed,e.generateLastRequestHeaderValue())}addThrottling(){this.parameters.set(td,hn.X_MS_LIB_CAPABILITY_VALUE)}addLogoutHint(e){this.parameters.set(md,encodeURIComponent(e))}createQueryString(){let e=new Array;return this.parameters.forEach((t,n)=>{e.push(`${n}=${t}`)}),e.join("&")}};var Zn=class{constructor(e,t){this.config=nm(e),this.logger=new kt(this.config.loggerOptions,Ps,Ai),this.cryptoUtils=this.config.cryptoInterface,this.cacheManager=this.config.storageInterface,this.networkClient=this.config.networkInterface,this.networkManager=new Hs(this.networkClient,this.cacheManager),this.serverTelemetryManager=this.config.serverTelemetryManager,this.authority=this.config.authOptions.authority,this.performanceClient=t}createTokenRequestHeaders(e){let t={};if(t[je.CONTENT_TYPE]=p.URL_FORM_CONTENT_TYPE,!this.config.systemOptions.preventCorsPreflight&&e)switch(e.type){case Le.HOME_ACCOUNT_ID:try{let n=Tn(e.credential);t[je.CCS_HEADER]=`Oid:${n.uid}@${n.utid}`}catch(n){this.logger.verbose("Could not parse home account ID for CCS Header: "+n)}break;case Le.UPN:t[je.CCS_HEADER]=`UPN: ${e.credential}`;break}return t}executePostToTokenEndpoint(e,t,n,i,o,a){return h(this,null,function*(){a&&this.performanceClient?.addQueueMeasurement(a,o);let s=yield this.networkManager.sendPostRequest(i,e,{body:t,headers:n});return this.performanceClient?.addFields({refreshTokenSize:s.body.refresh_token?.length||0,httpVerToken:s.headers?.[je.X_MS_HTTP_VERSION]||""},o),this.config.serverTelemetryManager&&s.status<500&&s.status!==429&&this.config.serverTelemetryManager.clearTelemetryCache(),s})}updateAuthority(e,t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.UpdateTokenEndpointAuthority,t);let n=`https://${e}/${this.authority.tenant}/`,i=yield Nl(n,this.networkClient,this.cacheManager,this.authority.options,this.logger,t,this.performanceClient);this.authority=i})}createTokenQueryParameters(e){let t=new en;return e.tokenQueryParameters&&t.addExtraQueryParameters(e.tokenQueryParameters),t.createQueryString()}};var En={};Ot(En,{badToken:()=>tr,consentRequired:()=>yd,interactionRequired:()=>vd,loginRequired:()=>Td,nativeAccountUnavailable:()=>fa,noTokensFound:()=>er,refreshTokenExpired:()=>Ca});var er="no_tokens_found",fa="native_account_unavailable",Ca="refresh_token_expired",vd="interaction_required",yd="consent_required",Td="login_required",tr="bad_token";var rm=[vd,yd,Td,tr],lv=["message_only","additional_action","basic_action","user_password_expired","consent_required","bad_token"],Fs={[er]:"No refresh token found in the cache. Please sign-in.",[fa]:"The requested account is not available in the native broker. It may have been deleted or logged out. Please sign-in again using an interactive API.",[Ca]:"Refresh token has expired.",[tr]:"Identity provider returned bad_token due to an expired or invalid refresh token. Please invoke an interactive API to resolve."},im={noTokensFoundError:{code:er,desc:Fs[er]},native_account_unavailable:{code:fa,desc:Fs[fa]},bad_token:{code:tr,desc:Fs[tr]}},We=class r extends re{constructor(e,t,n,i,o,a,s,c){super(e,t,n),Object.setPrototypeOf(this,r.prototype),this.timestamp=i||p.EMPTY_STRING,this.traceId=o||p.EMPTY_STRING,this.correlationId=a||p.EMPTY_STRING,this.claims=s||p.EMPTY_STRING,this.name="InteractionRequiredAuthError",this.errorNo=c}};function wd(r,e,t){let n=!!r&&rm.indexOf(r)>-1,i=!!t&&lv.indexOf(t)>-1,o=!!e&&rm.some(a=>e.indexOf(a)>-1);return n||o||i}function Ri(r){return new We(r,Fs[r])}var He=class r{static setRequestState(e,t,n){let i=r.generateLibraryState(e,n);return t?`${i}${p.RESOURCE_DELIM}${t}`:i}static generateLibraryState(e,t){if(!e)throw T(Gn);let n={id:e.createNewGuid()};t&&(n.meta=t);let i=JSON.stringify(n);return e.base64Encode(i)}static parseRequestState(e,t){if(!e)throw T(Gn);if(!t)throw T(Wt);try{let n=t.split(p.RESOURCE_DELIM),i=n[0],o=n.length>1?n.slice(1).join(p.RESOURCE_DELIM):p.EMPTY_STRING,a=e.base64Decode(i),s=JSON.parse(a);return{userRequestState:o||p.EMPTY_STRING,libraryState:s}}catch{throw T(Wt)}}};var dv={SW:"sw",UHW:"uhw"},ft=class{constructor(e,t){this.cryptoUtils=e,this.performanceClient=t}generateCnf(e,t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.PopTokenGenerateCnf,e.correlationId);let n=yield E(this.generateKid.bind(this),d.PopTokenGenerateCnf,t,this.performanceClient,e.correlationId)(e),i=this.cryptoUtils.base64UrlEncode(JSON.stringify(n));return{kid:n.kid,reqCnfString:i}})}generateKid(e){return h(this,null,function*(){return this.performanceClient?.addQueueMeasurement(d.PopTokenGenerateKid,e.correlationId),{kid:yield this.cryptoUtils.getPublicKeyThumbprint(e),xms_ksl:dv.SW}})}signPopToken(e,t,n){return h(this,null,function*(){return this.signPayload(e,t,n)})}signPayload(e,t,n,i){return h(this,null,function*(){let{resourceRequestMethod:o,resourceRequestUri:a,shrClaims:s,shrNonce:c,shrOptions:l}=n,m=(a?new Q(a):void 0)?.getUrlComponents();return this.cryptoUtils.signJwt(_({at:e,ts:gt(),m:o?.toUpperCase(),u:m?.HostNameAndPort,nonce:c||this.cryptoUtils.createNewGuid(),p:m?.AbsolutePath,q:m?.QueryString?[[],m.QueryString]:void 0,client_claims:s||void 0},i),t,l,n.correlationId)})}};var Us=class{constructor(e,t){this.cache=e,this.hasChanged=t}get cacheHasChanged(){return this.hasChanged}get tokenCache(){return this.cache}};function uv(r){let e="code=",t=r.error_uri?.lastIndexOf(e);return t&&t>=0?r.error_uri?.substring(t+e.length):void 0}var tn=class r{constructor(e,t,n,i,o,a,s){this.clientId=e,this.cacheStorage=t,this.cryptoObj=n,this.logger=i,this.serializableCache=o,this.persistencePlugin=a,this.performanceClient=s}validateServerAuthorizationCodeResponse(e,t){if(!e.state||!t)throw e.state?T(qn,"Cached State"):T(qn,"Server State");let n,i;try{n=decodeURIComponent(e.state)}catch{throw T(Wt,e.state)}try{i=decodeURIComponent(t)}catch{throw T(Wt,e.state)}if(n!==i)throw T(kr);if(e.error||e.error_description||e.suberror){let o=uv(e);throw wd(e.error,e.error_description,e.suberror)?new We(e.error||"",e.error_description,e.suberror,e.timestamp||"",e.trace_id||"",e.correlation_id||"",e.claims||"",o):new Re(e.error||"",e.error_description,e.suberror,o)}}validateTokenResponse(e,t){if(e.error||e.error_description||e.suberror){let n=`Error(s): ${e.error_codes||p.NOT_AVAILABLE} - Timestamp: ${e.timestamp||p.NOT_AVAILABLE} - Description: ${e.error_description||p.NOT_AVAILABLE} - Correlation ID: ${e.correlation_id||p.NOT_AVAILABLE} - Trace ID: ${e.trace_id||p.NOT_AVAILABLE}`,i=e.error_codes?.length?e.error_codes[0]:void 0,o=new Re(e.error,n,e.suberror,i,e.status);if(t&&e.status&&e.status>=vi.SERVER_ERROR_RANGE_START&&e.status<=vi.SERVER_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently unavailable and the access token is unable to be refreshed.
${o}`);return}else if(t&&e.status&&e.status>=vi.CLIENT_ERROR_RANGE_START&&e.status<=vi.CLIENT_ERROR_RANGE_END){this.logger.warning(`executeTokenRequest:validateTokenResponse - AAD is currently available but is unable to refresh the access token.
${o}`);return}throw wd(e.error,e.error_description,e.suberror)?new We(e.error,e.error_description,e.suberror,e.timestamp||p.EMPTY_STRING,e.trace_id||p.EMPTY_STRING,e.correlation_id||p.EMPTY_STRING,e.claims||p.EMPTY_STRING,i):o}}handleServerTokenResponse(e,t,n,i,o,a,s,c,l){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.HandleServerTokenResponse,e.correlation_id);let u;if(e.id_token){if(u=fn(e.id_token||p.EMPTY_STRING,this.cryptoObj.base64Decode),o&&o.nonce&&u.nonce!==o.nonce)throw T(br);if(i.maxAge||i.maxAge===0){let A=u.auth_time;if(!A)throw T(mn);ea(A,i.maxAge)}}this.homeAccountIdentifier=pe.generateHomeAccountId(e.client_info||p.EMPTY_STRING,t.authorityType,this.logger,this.cryptoObj,u);let m;o&&o.state&&(m=He.parseRequestState(this.cryptoObj,o.state)),e.key_id=e.key_id||i.sshKid||void 0;let v=this.generateCacheRecord(e,t,n,i,u,a,o),g;try{if(this.persistencePlugin&&this.serializableCache&&(this.logger.verbose("Persistence enabled, calling beforeCacheAccess"),g=new Us(this.serializableCache,!0),yield this.persistencePlugin.beforeCacheAccess(g)),s&&!c&&v.account){let A=v.account.generateAccountKey();if(!this.cacheStorage.getAccount(A,this.logger))return this.logger.warning("Account used to refresh tokens not in persistence, refreshed tokens will not be stored in the cache"),yield r.generateAuthenticationResult(this.cryptoObj,t,v,!1,i,u,m,void 0,l)}yield this.cacheStorage.saveCacheRecord(v,i.storeInCache,i.correlationId)}finally{this.persistencePlugin&&this.serializableCache&&g&&(this.logger.verbose("Persistence enabled, calling afterCacheAccess"),yield this.persistencePlugin.afterCacheAccess(g))}return r.generateAuthenticationResult(this.cryptoObj,t,v,!1,i,u,m,e,l)})}generateCacheRecord(e,t,n,i,o,a,s){let c=t.getPreferredCache();if(!c)throw T(gn);let l=Ns(o),u,m;e.id_token&&o&&(u=Dl(this.homeAccountIdentifier,c,e.id_token,this.clientId,l||""),m=Di(this.cacheStorage,t,this.homeAccountIdentifier,this.cryptoObj.base64Decode,o,e.client_info,c,l,s,void 0,this.logger));let v=null;if(e.access_token){let k=e.scope?ve.fromString(e.scope):new ve(i.scopes||[]),M=(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,B=(typeof e.ext_expires_in=="string"?parseInt(e.ext_expires_in,10):e.ext_expires_in)||0,W=(typeof e.refresh_in=="string"?parseInt(e.refresh_in,10):e.refresh_in)||void 0,V=n+M,X=V+B,te=W&&W>0?n+W:void 0;v=Ml(this.homeAccountIdentifier,c,e.access_token,this.clientId,l||t.tenant||"",k.printScopes(),V,X,this.cryptoObj.base64Decode,te,e.token_type,a,e.key_id,i.claims,i.requestedClaimsHash)}let g=null;if(e.refresh_token){let k;if(e.refresh_token_expires_in){let M=typeof e.refresh_token_expires_in=="string"?parseInt(e.refresh_token_expires_in,10):e.refresh_token_expires_in;k=n+M}g=Ol(this.homeAccountIdentifier,c,e.refresh_token,this.clientId,e.foci,a,k)}let A=null;return e.foci&&(A={clientId:this.clientId,environment:c,familyId:e.foci}),{account:m,idToken:u,accessToken:v,refreshToken:g,appMetadata:A}}static generateAuthenticationResult(e,t,n,i,o,a,s,c,l){return h(this,null,function*(){let u=p.EMPTY_STRING,m=[],v=null,g,A,k=p.EMPTY_STRING;if(n.accessToken){if(n.accessToken.tokenType===ne.POP&&!o.popKid){let V=new ft(e),{secret:X,keyId:te}=n.accessToken;if(!te)throw T(Ur);u=yield V.signPopToken(X,te,o)}else u=n.accessToken.secret;m=ve.fromString(n.accessToken.target).asArray(),v=new Date(Number(n.accessToken.expiresOn)*1e3),g=new Date(Number(n.accessToken.extendedExpiresOn)*1e3),n.accessToken.refreshOn&&(A=new Date(Number(n.accessToken.refreshOn)*1e3))}n.appMetadata&&(k=n.appMetadata.familyId===Vn?Vn:"");let M=a?.oid||a?.sub||"",B=a?.tid||"";c?.spa_accountid&&n.account&&(n.account.nativeAccountId=c?.spa_accountid);let W=n.account?Xr(n.account.getAccountInfo(),void 0,a,n.idToken?.secret):null;return{authority:t.canonicalAuthority,uniqueId:M,tenantId:B,scopes:m,account:W,idToken:n?.idToken?.secret||"",idTokenClaims:a||{},accessToken:u,fromCache:i,expiresOn:v,extExpiresOn:g,refreshOn:A,correlationId:o.correlationId,requestId:l||p.EMPTY_STRING,familyId:k,tokenType:n.accessToken?.tokenType||p.EMPTY_STRING,state:s?s.userRequestState:p.EMPTY_STRING,cloudGraphHostName:n.account?.cloudGraphHostName||p.EMPTY_STRING,msGraphHost:n.account?.msGraphHost||p.EMPTY_STRING,code:c?.spa_code,fromNativeBroker:!1}})}};function Di(r,e,t,n,i,o,a,s,c,l,u){u?.verbose("setCachedAccount called");let v=r.getAccountKeys().find(B=>B.startsWith(t)),g=null;v&&(g=r.getAccount(v,u));let A=g||pe.createAccount({homeAccountId:t,idTokenClaims:i,clientInfo:o,environment:a,cloudGraphHostName:c?.cloud_graph_host_name,msGraphHost:c?.msgraph_host,nativeAccountId:l},e,n),k=A.tenantProfiles||[],M=s||A.realm;if(M&&!k.find(B=>B.tenantId===M)){let B=bi(t,A.localAccountId,M,i);k.push(B)}return A.tenantProfiles=k,A}var Jr=class extends Zn{constructor(e,t){super(e,t),this.includeRedirectUri=!0,this.oidcDefaultScopes=this.config.authOptions.authority.options.OIDCOptions?.defaultScopes}getAuthCodeUrl(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.GetAuthCodeUrl,e.correlationId);let t=yield E(this.createAuthCodeUrlQueryString.bind(this),d.AuthClientCreateQueryString,this.logger,this.performanceClient,e.correlationId)(e);return Q.appendQueryString(this.authority.authorizationEndpoint,t)})}acquireToken(e,t){return h(this,null,function*(){if(this.performanceClient?.addQueueMeasurement(d.AuthClientAcquireToken,e.correlationId),!e.code)throw T(Mr);let n=gt(),i=yield E(this.executeTokenRequest.bind(this),d.AuthClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(this.authority,e),o=i.headers?.[je.X_MS_REQUEST_ID],a=new tn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin,this.performanceClient);return a.validateTokenResponse(i.body),E(a.handleServerTokenResponse.bind(a),d.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(i.body,this.authority,n,e,t,void 0,void 0,void 0,o)})}handleFragmentResponse(e,t){if(new tn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,null,null).validateServerAuthorizationCodeResponse(e,t),!e.code)throw T(Lr);return e}getLogoutUri(e){if(!e)throw ie($r);let t=this.createLogoutUrlQueryString(e);return Q.appendQueryString(this.authority.endSessionEndpoint,t)}executeTokenRequest(e,t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthClientExecuteTokenRequest,t.correlationId);let n=this.createTokenQueryParameters(t),i=Q.appendQueryString(e.tokenEndpoint,n),o=yield E(this.createTokenRequestBody.bind(this),d.AuthClientCreateTokenRequestBody,this.logger,this.performanceClient,t.correlationId)(t),a;if(t.clientInfo)try{let l=Ii(t.clientInfo,this.cryptoUtils.base64Decode);a={credential:`${l.uid}${ke.CLIENT_INFO_SEPARATOR}${l.utid}`,type:Le.HOME_ACCOUNT_ID}}catch(l){this.logger.verbose("Could not parse client info for CCS Header: "+l)}let s=this.createTokenRequestHeaders(a||t.ccsCredential),c={clientId:t.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:e.canonicalAuthority,scopes:t.scopes,claims:t.claims,authenticationScheme:t.authenticationScheme,resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,sshKid:t.sshKid};return E(this.executePostToTokenEndpoint.bind(this),d.AuthorizationCodeClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,t.correlationId)(i,o,s,c,t.correlationId,d.AuthorizationCodeClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthClientCreateTokenRequestBody,e.correlationId);let t=new en;if(t.addClientId(e.tokenBodyParameters?.[Xn]||this.config.authOptions.clientId),this.includeRedirectUri?t.addRedirectUri(e.redirectUri):Zt.validateRedirectUri(e.redirectUri),t.addScopes(e.scopes,!0,this.oidcDefaultScopes),t.addAuthorizationCode(e.code),t.addLibraryInfo(this.config.libraryInfo),t.addApplicationTelemetry(this.config.telemetry.application),t.addThrottling(),this.serverTelemetryManager&&!ga(this.config)&&t.addServerTelemetry(this.serverTelemetryManager),e.codeVerifier&&t.addCodeVerifier(e.codeVerifier),this.config.clientCredentials.clientSecret&&t.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let o=this.config.clientCredentials.clientAssertion;t.addClientAssertion(yield bs(o.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),t.addClientAssertionType(o.assertionType)}if(t.addGrantType(No.AUTHORIZATION_CODE_GRANT),t.addClientInfo(),e.authenticationScheme===ne.POP){let o=new ft(this.cryptoUtils,this.performanceClient),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(yield E(o.generateCnf.bind(o),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}else if(e.authenticationScheme===ne.SSH)if(e.sshJwk)t.addSshJwk(e.sshJwk);else throw ie(yn);let n=e.correlationId||this.config.cryptoInterface.createNewGuid();t.addCorrelationId(n),(!_e.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities);let i;if(e.clientInfo)try{let o=Ii(e.clientInfo,this.cryptoUtils.base64Decode);i={credential:`${o.uid}${ke.CLIENT_INFO_SEPARATOR}${o.utid}`,type:Le.HOME_ACCOUNT_ID}}catch(o){this.logger.verbose("Could not parse client info for CCS Header: "+o)}else i=e.ccsCredential;if(this.config.systemOptions.preventCorsPreflight&&i)switch(i.type){case Le.HOME_ACCOUNT_ID:try{let o=Tn(i.credential);t.addCcsOid(o)}catch(o){this.logger.verbose("Could not parse home account ID for CCS Header: "+o)}break;case Le.UPN:t.addCcsUpn(i.credential);break}return e.tokenBodyParameters&&t.addExtraQueryParameters(e.tokenBodyParameters),e.enableSpaAuthorizationCode&&(!e.tokenBodyParameters||!e.tokenBodyParameters[Os])&&t.addExtraQueryParameters({[Os]:"1"}),t.createQueryString()})}createAuthCodeUrlQueryString(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.AuthClientCreateQueryString,e.correlationId);let t=new en;t.addClientId(e.extraQueryParameters?.[Xn]||this.config.authOptions.clientId);let n=[...e.scopes||[],...e.extraScopesToConsent||[]];t.addScopes(n,!0,this.oidcDefaultScopes),t.addRedirectUri(e.redirectUri);let i=e.correlationId||this.config.cryptoInterface.createNewGuid();if(t.addCorrelationId(i),t.addResponseMode(e.responseMode),t.addResponseTypeCode(),t.addLibraryInfo(this.config.libraryInfo),ga(this.config)||t.addApplicationTelemetry(this.config.telemetry.application),t.addClientInfo(),e.codeChallenge&&e.codeChallengeMethod&&t.addCodeChallengeParams(e.codeChallenge,e.codeChallengeMethod),e.prompt&&t.addPrompt(e.prompt),e.domainHint&&t.addDomainHint(e.domainHint),e.prompt!==Ce.SELECT_ACCOUNT)if(e.sid&&e.prompt===Ce.NONE)this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from request"),t.addSid(e.sid);else if(e.account){let o=this.extractAccountSid(e.account),a=this.extractLoginHint(e.account);if(a&&e.domainHint&&(this.logger.warning('AuthorizationCodeClient.createAuthCodeUrlQueryString: "domainHint" param is set, skipping opaque "login_hint" claim. Please consider not passing domainHint'),a=null),a){this.logger.verbose("createAuthCodeUrlQueryString: login_hint claim present on account"),t.addLoginHint(a);try{let s=Tn(e.account.homeAccountId);t.addCcsOid(s)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(o&&e.prompt===Ce.NONE){this.logger.verbose("createAuthCodeUrlQueryString: Prompt is none, adding sid from account"),t.addSid(o);try{let s=Tn(e.account.homeAccountId);t.addCcsOid(s)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}else if(e.loginHint)this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint);else if(e.account.username){this.logger.verbose("createAuthCodeUrlQueryString: Adding login_hint from account"),t.addLoginHint(e.account.username);try{let s=Tn(e.account.homeAccountId);t.addCcsOid(s)}catch{this.logger.verbose("createAuthCodeUrlQueryString: Could not parse home account ID for CCS Header")}}}else e.loginHint&&(this.logger.verbose("createAuthCodeUrlQueryString: No account, adding login_hint from request"),t.addLoginHint(e.loginHint),t.addCcsUpn(e.loginHint));else this.logger.verbose("createAuthCodeUrlQueryString: Prompt is select_account, ignoring account hints");if(e.nonce&&t.addNonce(e.nonce),e.state&&t.addState(e.state),(e.claims||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&t.addClaims(e.claims,this.config.authOptions.clientCapabilities),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),e.nativeBroker&&(t.addNativeBroker(),e.authenticationScheme===ne.POP)){let o=new ft(this.cryptoUtils),a;e.popKid?a=this.cryptoUtils.encodeKid(e.popKid):a=(yield E(o.generateCnf.bind(o),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,t.addPopToken(a)}return t.createQueryString()})}createLogoutUrlQueryString(e){let t=new en;return e.postLogoutRedirectUri&&t.addPostLogoutRedirectUri(e.postLogoutRedirectUri),e.correlationId&&t.addCorrelationId(e.correlationId),e.idTokenHint&&t.addIdTokenHint(e.idTokenHint),e.state&&t.addState(e.state),e.logoutHint&&t.addLogoutHint(e.logoutHint),e.extraQueryParameters&&t.addExtraQueryParameters(e.extraQueryParameters),t.createQueryString()}extractAccountSid(e){return e.idTokenClaims?.sid||null}extractLoginHint(e){return e.idTokenClaims?.login_hint||null}};var hv=300,nr=class extends Zn{constructor(e,t){super(e,t)}acquireToken(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientAcquireToken,e.correlationId);let t=gt(),n=yield E(this.executeTokenRequest.bind(this),d.RefreshTokenClientExecuteTokenRequest,this.logger,this.performanceClient,e.correlationId)(e,this.authority),i=n.headers?.[je.X_MS_REQUEST_ID],o=new tn(this.config.authOptions.clientId,this.cacheManager,this.cryptoUtils,this.logger,this.config.serializableCache,this.config.persistencePlugin);return o.validateTokenResponse(n.body),E(o.handleServerTokenResponse.bind(o),d.HandleServerTokenResponse,this.logger,this.performanceClient,e.correlationId)(n.body,this.authority,t,e,void 0,void 0,!0,e.forceCache,i)})}acquireTokenByRefreshToken(e){return h(this,null,function*(){if(!e)throw ie(Gr);if(this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientAcquireTokenByRefreshToken,e.correlationId),!e.account)throw T(pn);if(this.cacheManager.isAppMetadataFOCI(e.account.environment))try{return yield E(this.acquireTokenWithCachedRefreshToken.bind(this),d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!0)}catch(n){let i=n instanceof We&&n.errorCode===er,o=n instanceof Re&&n.errorCode===vs.INVALID_GRANT_ERROR&&n.subError===vs.CLIENT_MISMATCH_ERROR;if(i||o)return E(this.acquireTokenWithCachedRefreshToken.bind(this),d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1);throw n}return E(this.acquireTokenWithCachedRefreshToken.bind(this),d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,!1)})}acquireTokenWithCachedRefreshToken(e,t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientAcquireTokenWithCachedRefreshToken,e.correlationId);let n=Ze(this.cacheManager.getRefreshToken.bind(this.cacheManager),d.CacheManagerGetRefreshToken,this.logger,this.performanceClient,e.correlationId)(e.account,t,void 0,this.performanceClient,e.correlationId);if(!n)throw Ri(er);if(n.expiresOn&&_i(n.expiresOn,e.refreshTokenExpirationOffsetSeconds||hv))throw Ri(Ca);let i=z(_({},e),{refreshToken:n.secret,authenticationScheme:e.authenticationScheme||ne.BEARER,ccsCredential:{credential:e.account.homeAccountId,type:Le.HOME_ACCOUNT_ID}});try{return yield E(this.acquireToken.bind(this),d.RefreshTokenClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(i)}catch(o){if(o instanceof We&&o.subError===tr){this.logger.verbose("acquireTokenWithRefreshToken: bad refresh token, removing from cache");let a=ua(n);this.cacheManager.removeRefreshToken(a)}throw o}})}executeTokenRequest(e,t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientExecuteTokenRequest,e.correlationId);let n=this.createTokenQueryParameters(e),i=Q.appendQueryString(t.tokenEndpoint,n),o=yield E(this.createTokenRequestBody.bind(this),d.RefreshTokenClientCreateTokenRequestBody,this.logger,this.performanceClient,e.correlationId)(e),a=this.createTokenRequestHeaders(e.ccsCredential),s={clientId:e.tokenBodyParameters?.clientId||this.config.authOptions.clientId,authority:t.canonicalAuthority,scopes:e.scopes,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid};return E(this.executePostToTokenEndpoint.bind(this),d.RefreshTokenClientExecutePostToTokenEndpoint,this.logger,this.performanceClient,e.correlationId)(i,o,a,s,e.correlationId,d.RefreshTokenClientExecutePostToTokenEndpoint)})}createTokenRequestBody(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.RefreshTokenClientCreateTokenRequestBody,e.correlationId);let t=e.correlationId,n=new en;if(n.addClientId(e.tokenBodyParameters?.[Xn]||this.config.authOptions.clientId),e.redirectUri&&n.addRedirectUri(e.redirectUri),n.addScopes(e.scopes,!0,this.config.authOptions.authority.options.OIDCOptions?.defaultScopes),n.addGrantType(No.REFRESH_TOKEN_GRANT),n.addClientInfo(),n.addLibraryInfo(this.config.libraryInfo),n.addApplicationTelemetry(this.config.telemetry.application),n.addThrottling(),this.serverTelemetryManager&&!ga(this.config)&&n.addServerTelemetry(this.serverTelemetryManager),n.addCorrelationId(t),n.addRefreshToken(e.refreshToken),this.config.clientCredentials.clientSecret&&n.addClientSecret(this.config.clientCredentials.clientSecret),this.config.clientCredentials.clientAssertion){let i=this.config.clientCredentials.clientAssertion;n.addClientAssertion(yield bs(i.assertion,this.config.authOptions.clientId,e.resourceRequestUri)),n.addClientAssertionType(i.assertionType)}if(e.authenticationScheme===ne.POP){let i=new ft(this.cryptoUtils,this.performanceClient),o;e.popKid?o=this.cryptoUtils.encodeKid(e.popKid):o=(yield E(i.generateCnf.bind(i),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(e,this.logger)).reqCnfString,n.addPopToken(o)}else if(e.authenticationScheme===ne.SSH)if(e.sshJwk)n.addSshJwk(e.sshJwk);else throw ie(yn);if((!_e.isEmptyObj(e.claims)||this.config.authOptions.clientCapabilities&&this.config.authOptions.clientCapabilities.length>0)&&n.addClaims(e.claims,this.config.authOptions.clientCapabilities),this.config.systemOptions.preventCorsPreflight&&e.ccsCredential)switch(e.ccsCredential.type){case Le.HOME_ACCOUNT_ID:try{let i=Tn(e.ccsCredential.credential);n.addCcsOid(i)}catch(i){this.logger.verbose("Could not parse home account ID for CCS Header: "+i)}break;case Le.UPN:n.addCcsUpn(e.ccsCredential.credential);break}return e.tokenBodyParameters&&n.addExtraQueryParameters(e.tokenBodyParameters),n.createQueryString()})}};var va=class extends Zn{constructor(e,t){super(e,t)}acquireToken(e){return h(this,null,function*(){try{let[t,n]=yield this.acquireCachedToken(z(_({},e),{scopes:e.scopes?.length?e.scopes:[...pt]}));return n===qt.PROACTIVELY_REFRESHED&&(this.logger.info("SilentFlowClient:acquireCachedToken - Cached access token's refreshOn property has been exceeded'. It's not expired, but must be refreshed."),new nr(this.config,this.performanceClient).acquireTokenByRefreshToken(e).catch(()=>{})),t}catch(t){if(t instanceof Br&&t.errorCode===Qt)return new nr(this.config,this.performanceClient).acquireTokenByRefreshToken(e);throw t}})}acquireCachedToken(e){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.SilentFlowClientAcquireCachedToken,e.correlationId);let t=qt.NOT_APPLICABLE;if(e.forceRefresh||!this.config.cacheOptions.claimsBasedCachingEnabled&&!_e.isEmptyObj(e.claims))throw this.setCacheOutcome(qt.FORCE_REFRESH_OR_CLAIMS,e.correlationId),T(Qt);if(!e.account)throw T(pn);let n=e.account.tenantId||tm(e.authority),i=this.cacheManager.getTokenKeys(),o=this.cacheManager.getAccessToken(e.account,e,i,n,this.performanceClient,e.correlationId);if(o){if(Rl(o.cachedAt)||_i(o.expiresOn,this.config.systemOptions.tokenRenewalOffsetSeconds))throw this.setCacheOutcome(qt.CACHED_ACCESS_TOKEN_EXPIRED,e.correlationId),T(Qt);o.refreshOn&&_i(o.refreshOn,0)&&(t=qt.PROACTIVELY_REFRESHED)}else throw this.setCacheOutcome(qt.NO_CACHED_ACCESS_TOKEN,e.correlationId),T(Qt);let a=e.authority||this.authority.getPreferredCache(),s={account:this.cacheManager.readAccountFromCache(e.account),accessToken:o,idToken:this.cacheManager.getIdToken(e.account,i,n,this.performanceClient,e.correlationId),refreshToken:null,appMetadata:this.cacheManager.readAppMetadataFromCache(a)};return this.setCacheOutcome(t,e.correlationId),this.config.serverTelemetryManager&&this.config.serverTelemetryManager.incrementCacheHits(),[yield E(this.generateResultFromCacheRecord.bind(this),d.SilentFlowClientGenerateResultFromCacheRecord,this.logger,this.performanceClient,e.correlationId)(s,e),t]})}setCacheOutcome(e,t){this.serverTelemetryManager?.setCacheOutcome(e),this.performanceClient?.addFields({cacheOutcome:e},t),e!==qt.NOT_APPLICABLE&&this.logger.info(`Token refresh is required due to cache outcome: ${e}`)}generateResultFromCacheRecord(e,t){return h(this,null,function*(){this.performanceClient?.addQueueMeasurement(d.SilentFlowClientGenerateResultFromCacheRecord,t.correlationId);let n;if(e.idToken&&(n=fn(e.idToken.secret,this.config.cryptoInterface.base64Decode)),t.maxAge||t.maxAge===0){let i=n?.auth_time;if(!i)throw T(mn);ea(i,t.maxAge)}return tn.generateAuthenticationResult(this.cryptoUtils,this.authority,e,!0,t,n)})}};var _d={sendGetRequestAsync:()=>Promise.reject(T(Y)),sendPostRequestAsync:()=>Promise.reject(T(Y))};var Bs="missing_kid_error",Vs="missing_alg_error";var mv={[Bs]:"The JOSE Header for the requested JWT, JWS or JWK object requires a keyId to be configured as the 'kid' header claim. No 'kid' value was provided.",[Vs]:"The JOSE Header for the requested JWT, JWS or JWK object requires an algorithm to be specified as the 'alg' header claim. No 'alg' value was provided."},Ed=class r extends re{constructor(e,t){super(e,t),this.name="JoseHeaderError",Object.setPrototypeOf(this,r.prototype)}};function Sd(r){return new Ed(r,mv[r])}var ya=class r{constructor(e){this.typ=e.typ,this.alg=e.alg,this.kid=e.kid}static getShrHeaderString(e){if(!e.kid)throw Sd(Bs);if(!e.alg)throw Sd(Vs);let t=new r({typ:e.typ||ws.Pop,kid:e.kid,alg:e.alg});return JSON.stringify(t)}};var om=",",am="|";function pv(r){let{skus:e,libraryName:t,libraryVersion:n,extensionName:i,extensionVersion:o}=r,a=new Map([[0,[t,n]],[2,[i,o]]]),s=[];if(e?.length){if(s=e.split(om),s.length<4)return e}else s=Array.from({length:4},()=>am);return a.forEach((c,l)=>{c.length===2&&c[0]?.length&&c[1]?.length&&gv({skuArr:s,index:l,skuName:c[0],skuVersion:c[1]})}),s.join(om)}function gv(r){let{skuArr:e,index:t,skuName:n,skuVersion:i}=r;t>=e.length||(e[t]=[n,i].join(am))}var Zr=class r{constructor(e,t){this.cacheOutcome=qt.NOT_APPLICABLE,this.cacheManager=t,this.apiId=e.apiId,this.correlationId=e.correlationId,this.wrapperSKU=e.wrapperSKU||p.EMPTY_STRING,this.wrapperVer=e.wrapperVer||p.EMPTY_STRING,this.telemetryCacheKey=Ne.CACHE_KEY+ke.CACHE_KEY_SEPARATOR+e.clientId}generateCurrentRequestHeaderValue(){let e=`${this.apiId}${Ne.VALUE_SEPARATOR}${this.cacheOutcome}`,t=[this.wrapperSKU,this.wrapperVer],n=this.getNativeBrokerErrorCode();n?.length&&t.push(`broker_error=${n}`);let i=t.join(Ne.VALUE_SEPARATOR),o=this.getRegionDiscoveryFields(),a=[e,o].join(Ne.VALUE_SEPARATOR);return[Ne.SCHEMA_VERSION,a,i].join(Ne.CATEGORY_SEPARATOR)}generateLastRequestHeaderValue(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.failedRequests.slice(0,2*t).join(Ne.VALUE_SEPARATOR),i=e.errors.slice(0,t).join(Ne.VALUE_SEPARATOR),o=e.errors.length,a=t<o?Ne.OVERFLOW_TRUE:Ne.OVERFLOW_FALSE,s=[o,a].join(Ne.VALUE_SEPARATOR);return[Ne.SCHEMA_VERSION,e.cacheHits,n,i,s].join(Ne.CATEGORY_SEPARATOR)}cacheFailedRequest(e){let t=this.getLastRequests();t.errors.length>=Ne.MAX_CACHED_ERRORS&&(t.failedRequests.shift(),t.failedRequests.shift(),t.errors.shift()),t.failedRequests.push(this.apiId,this.correlationId),e instanceof Error&&e&&e.toString()?e instanceof re?e.subError?t.errors.push(e.subError):e.errorCode?t.errors.push(e.errorCode):t.errors.push(e.toString()):t.errors.push(e.toString()):t.errors.push(Ne.UNKNOWN_ERROR),this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}incrementCacheHits(){let e=this.getLastRequests();return e.cacheHits+=1,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e),e.cacheHits}getLastRequests(){let e={failedRequests:[],errors:[],cacheHits:0};return this.cacheManager.getServerTelemetry(this.telemetryCacheKey)||e}clearTelemetryCache(){let e=this.getLastRequests(),t=r.maxErrorsToSend(e),n=e.errors.length;if(t===n)this.cacheManager.removeItem(this.telemetryCacheKey);else{let i={failedRequests:e.failedRequests.slice(t*2),errors:e.errors.slice(t),cacheHits:0};this.cacheManager.setServerTelemetry(this.telemetryCacheKey,i)}}static maxErrorsToSend(e){let t,n=0,i=0,o=e.errors.length;for(t=0;t<o;t++){let a=e.failedRequests[2*t]||p.EMPTY_STRING,s=e.failedRequests[2*t+1]||p.EMPTY_STRING,c=e.errors[t]||p.EMPTY_STRING;if(i+=a.toString().length+s.toString().length+c.length+3,i<Ne.MAX_LAST_HEADER_BYTES)n+=1;else break}return n}getRegionDiscoveryFields(){let e=[];return e.push(this.regionUsed||p.EMPTY_STRING),e.push(this.regionSource||p.EMPTY_STRING),e.push(this.regionOutcome||p.EMPTY_STRING),e.join(",")}updateRegionDiscoveryMetadata(e){this.regionUsed=e.region_used,this.regionSource=e.region_source,this.regionOutcome=e.region_outcome}setCacheOutcome(e){this.cacheOutcome=e}setNativeBrokerErrorCode(e){let t=this.getLastRequests();t.nativeBrokerErrorCode=e,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,t)}getNativeBrokerErrorCode(){return this.getLastRequests().nativeBrokerErrorCode}clearNativeBrokerErrorCode(){let e=this.getLastRequests();delete e.nativeBrokerErrorCode,this.cacheManager.setServerTelemetry(this.telemetryCacheKey,e)}static makeExtraSkuString(e){return pv(e)}};var Ks=class{startMeasurement(){}endMeasurement(){}flushMeasurement(){return null}},Mi=class{generateId(){return"callback-id"}startMeasurement(e,t){return{end:()=>null,discard:()=>{},add:()=>{},increment:()=>{},event:{eventId:this.generateId(),status:bl.InProgress,authority:"",libraryName:"",libraryVersion:"",clientId:"",name:e,startTimeMs:Date.now(),correlationId:t||""},measurement:new Ks}}startPerformanceMeasurement(){return new Ks}calculateQueuedTime(){return 0}addQueueMeasurement(){}setPreQueueTime(){}endMeasurement(){return null}discardMeasurements(){}removePerformanceCallback(){return!0}addPerformanceCallback(){return""}emitEvents(){}addFields(){}incrementFields(){}cacheEventByCorrelationId(){}};var ei="pkce_not_created",Oi="crypto_nonexistent",nn="empty_navigate_uri",Pi="hash_empty_error",rr="no_state_in_hash",Ni="hash_does_not_contain_known_properties",xi="unable_to_parse_state",Li="state_interaction_type_mismatch",Hi="interaction_in_progress",Fi="popup_window_error",Ui="empty_window_error",at="user_cancelled",zs="monitor_popup_timeout",Bi="monitor_window_timeout",Vi="redirect_in_iframe",Ki="block_iframe_reload",zi="block_nested_popups",qs="iframe_closed_prematurely",rn="silent_logout_unsupported",qi="no_account_error",Ws="silent_prompt_value_error",Wi="no_token_request_cache_error",Gi="unable_to_parse_token_request_cache_error",ir="no_cached_authority_error",Gs="auth_request_not_set_error",$s="invalid_cache_type",or="non_browser_environment",on="database_not_open",Sn="no_network_connectivity",$i="post_request_failed",Yi="get_request_failed",ti="failed_to_parse_response",ji="unable_to_load_token",ar="crypto_key_not_found",Qi="auth_code_required",Xi="auth_code_or_nativeAccountId_required",Ji="spa_code_and_nativeAccountId_present",sr="database_unavailable",Zi="unable_to_acquire_token_from_native_platform",eo="native_handshake_timeout",to="native_extension_not_installed",bt="native_connection_not_established",no="uninitialized_public_client_application",ro="native_prompt_not_supported",io="invalid_base64_string",oo="invalid_pop_token_request",Ys="failed_to_retry";var An="For more visit: aka.ms/msaljs/browser-errors",$={[ei]:"The PKCE code challenge and verifier could not be generated.",[Oi]:"The crypto object or function is not available.",[nn]:"Navigation URI is empty. Please check stack trace for more info.",[Pi]:`Hash value cannot be processed because it is empty. Please verify that your redirectUri is not clearing the hash. ${An}`,[rr]:"Hash does not contain state. Please verify that the request originated from msal.",[Ni]:`Hash does not contain known properites. Please verify that your redirectUri is not changing the hash.  ${An}`,[xi]:"Unable to parse state. Please verify that the request originated from msal.",[Li]:"Hash contains state but the interaction type does not match the caller.",[Hi]:`Interaction is currently in progress. Please ensure that this interaction has been completed before calling an interactive API.   ${An}`,[Fi]:"Error opening popup window. This can happen if you are using IE or if popups are blocked in the browser.",[Ui]:"window.open returned null or undefined window object.",[at]:"User cancelled the flow.",[zs]:`Token acquisition in popup failed due to timeout.  ${An}`,[Bi]:`Token acquisition in iframe failed due to timeout.  ${An}`,[Vi]:"Redirects are not supported for iframed or brokered applications. Please ensure you are using MSAL.js in a top frame of the window if using the redirect APIs, or use the popup APIs.",[Ki]:`Request was blocked inside an iframe because MSAL detected an authentication response.  ${An}`,[zi]:"Request was blocked inside a popup because MSAL detected it was running in a popup.",[qs]:"The iframe being monitored was closed prematurely.",[rn]:"Silent logout not supported. Please call logoutRedirect or logoutPopup instead.",[qi]:"No account object provided to acquireTokenSilent and no active account has been set. Please call setActiveAccount or provide an account on the request.",[Ws]:"The value given for the prompt value is not valid for silent requests - must be set to 'none' or 'no_session'.",[Wi]:"No token request found in cache.",[Gi]:"The cached token request could not be parsed.",[ir]:"No cached authority found.",[Gs]:"Auth Request not set. Please ensure initiateAuthRequest was called from the InteractionHandler",[$s]:"Invalid cache type",[or]:"Login and token requests are not supported in non-browser environments.",[on]:"Database is not open!",[Sn]:"No network connectivity. Check your internet connection.",[$i]:"Network request failed: If the browser threw a CORS error, check that the redirectUri is registered in the Azure App Portal as type 'SPA'",[Yi]:"Network request failed. Please check the network trace to determine root cause.",[ti]:"Failed to parse network response. Check network trace.",[ji]:"Error loading token to cache.",[ar]:"Cryptographic Key or Keypair not found in browser storage.",[Qi]:"An authorization code must be provided (as the `code` property on the request) to this flow.",[Xi]:"An authorization code or nativeAccountId must be provided to this flow.",[Ji]:"Request cannot contain both spa code and native account id.",[sr]:"IndexedDB, which is required for persistent cryptographic key storage, is unavailable. This may be caused by browser privacy features which block persistent storage in third-party contexts.",[Zi]:`Unable to acquire token from native platform.  ${An}`,[eo]:"Timed out while attempting to establish connection to browser extension",[to]:"Native extension is not installed. If you think this is a mistake call the initialize function.",[bt]:`Connection to native platform has not been established. Please install a compatible browser extension and run initialize().  ${An}`,[no]:`You must call and await the initialize function before attempting to call any other MSAL API.  ${An}`,[ro]:"The provided prompt is not supported by the native platform. This request should be routed to the web based flow.",[io]:"Invalid base64 encoded string.",[oo]:"Invalid PoP token request. The request should not have both a popKid value and signPopToken set to true.",[Ys]:"Unable to retry failed auth code redemption due to usage of the onRedirectNavigate request parameter. Please set onRedirectNavigate on the PublicClientApplication configuration instead or call loginRedirect again."},AI={pkceNotGenerated:{code:ei,desc:$[ei]},cryptoDoesNotExist:{code:Oi,desc:$[Oi]},emptyNavigateUriError:{code:nn,desc:$[nn]},hashEmptyError:{code:Pi,desc:$[Pi]},hashDoesNotContainStateError:{code:rr,desc:$[rr]},hashDoesNotContainKnownPropertiesError:{code:Ni,desc:$[Ni]},unableToParseStateError:{code:xi,desc:$[xi]},stateInteractionTypeMismatchError:{code:Li,desc:$[Li]},interactionInProgress:{code:Hi,desc:$[Hi]},popupWindowError:{code:Fi,desc:$[Fi]},emptyWindowError:{code:Ui,desc:$[Ui]},userCancelledError:{code:at,desc:$[at]},monitorPopupTimeoutError:{code:zs,desc:$[zs]},monitorIframeTimeoutError:{code:Bi,desc:$[Bi]},redirectInIframeError:{code:Vi,desc:$[Vi]},blockTokenRequestsInHiddenIframeError:{code:Ki,desc:$[Ki]},blockAcquireTokenInPopupsError:{code:zi,desc:$[zi]},iframeClosedPrematurelyError:{code:qs,desc:$[qs]},silentLogoutUnsupportedError:{code:rn,desc:$[rn]},noAccountError:{code:qi,desc:$[qi]},silentPromptValueError:{code:Ws,desc:$[Ws]},noTokenRequestCacheError:{code:Wi,desc:$[Wi]},unableToParseTokenRequestCacheError:{code:Gi,desc:$[Gi]},noCachedAuthorityError:{code:ir,desc:$[ir]},authRequestNotSet:{code:Gs,desc:$[Gs]},invalidCacheType:{code:$s,desc:$[$s]},notInBrowserEnvironment:{code:or,desc:$[or]},databaseNotOpen:{code:on,desc:$[on]},noNetworkConnectivity:{code:Sn,desc:$[Sn]},postRequestFailed:{code:$i,desc:$[$i]},getRequestFailed:{code:Yi,desc:$[Yi]},failedToParseNetworkResponse:{code:ti,desc:$[ti]},unableToLoadTokenError:{code:ji,desc:$[ji]},signingKeyNotFoundInStorage:{code:ar,desc:$[ar]},authCodeRequired:{code:Qi,desc:$[Qi]},authCodeOrNativeAccountRequired:{code:Xi,desc:$[Xi]},spaCodeAndNativeAccountPresent:{code:Ji,desc:$[Ji]},databaseUnavailable:{code:sr,desc:$[sr]},unableToAcquireTokenFromNativePlatform:{code:Zi,desc:$[Zi]},nativeHandshakeTimeout:{code:eo,desc:$[eo]},nativeExtensionNotInstalled:{code:to,desc:$[to]},nativeConnectionNotEstablished:{code:bt,desc:$[bt]},uninitializedPublicClientApplication:{code:no,desc:$[no]},nativePromptNotSupported:{code:ro,desc:$[ro]},invalidBase64StringError:{code:io,desc:$[io]},invalidPopTokenRequest:{code:oo,desc:$[oo]}},ni=class r extends re{constructor(e){super(e,$[e]),Object.setPrototypeOf(this,r.prototype),this.name="BrowserAuthError"}};function I(r){return new ni(r)}var Ee={INTERACTION_IN_PROGRESS_VALUE:"interaction_in_progress",INVALID_GRANT_ERROR:"invalid_grant",POPUP_WIDTH:483,POPUP_HEIGHT:600,POPUP_NAME_PREFIX:"msal",DEFAULT_POLL_INTERVAL_MS:30,MSAL_SKU:"msal.js.browser"},cr={CHANNEL_ID:"53ee284d-920a-4b59-9d30-a60315b26836",PREFERRED_EXTENSION_ID:"ppnbnpeolgkicgegkbkbjmhlideopiji",MATS_TELEMETRY:"MATS"},In={HandshakeRequest:"Handshake",HandshakeResponse:"HandshakeResponse",GetToken:"GetToken",Response:"Response"},ue={LocalStorage:"localStorage",SessionStorage:"sessionStorage",MemoryStorage:"memoryStorage"},Ad={GET:"GET",POST:"POST"},ee={AUTHORITY:"authority",ACQUIRE_TOKEN_ACCOUNT:"acquireToken.account",SESSION_STATE:"session.state",REQUEST_STATE:"request.state",NONCE_IDTOKEN:"nonce.id_token",ORIGIN_URI:"request.origin",RENEW_STATUS:"token.renew.status",URL_HASH:"urlHash",REQUEST_PARAMS:"request.params",SCOPES:"scopes",INTERACTION_STATUS_KEY:"interaction.status",CCS_CREDENTIAL:"ccs.credential",CORRELATION_ID:"request.correlationId",NATIVE_REQUEST:"request.native",REDIRECT_CONTEXT:"request.redirect.context",REDIRECT_REQUEST:"request.redirect",REQUEST_RETRY:"request.retry"},kn={ACCOUNT_KEYS:"msal.account.keys",TOKEN_KEYS:"msal.token.keys"},Ta={WRAPPER_SKU:"wrapper.sku",WRAPPER_VER:"wrapper.version"},ce={acquireTokenRedirect:861,acquireTokenPopup:862,ssoSilent:863,acquireTokenSilent_authCode:864,handleRedirectPromise:865,acquireTokenByCode:866,acquireTokenSilent_silentFlow:61,logout:961,logoutPopup:962},D=function(r){return r.Redirect="redirect",r.Popup="popup",r.Silent="silent",r.None="none",r}(D||{}),De={Startup:"startup",Login:"login",Logout:"logout",AcquireToken:"acquireToken",SsoSilent:"ssoSilent",HandleRedirect:"handleRedirect",None:"none"},Id={scopes:pt},kd="jwk",bd={React:"@azure/msal-react",Angular:"@azure/msal-angular"},js="msal.db",sm=1,cm=`${js}.keys`,et={Default:0,AccessToken:1,AccessTokenAndRefreshToken:2,RefreshToken:3,RefreshTokenAndNetwork:4,Skip:5},lm=[et.Default,et.Skip,et.RefreshTokenAndNetwork],dm="msal.browser.log.level",um="msal.browser.log.pii";function wa(r){return encodeURIComponent(_a(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_"))}function ri(r){return hm(r).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function _a(r){return hm(new TextEncoder().encode(r))}function hm(r){let e=Array.from(r,t=>String.fromCodePoint(t)).join("");return btoa(e)}var fv="RSASSA-PKCS1-v1_5",gm="SHA-256",Cv=2048,vv=new Uint8Array([1,0,1]),mm="0123456789abcdef",pm=new Uint32Array(1),Dd={name:fv,hash:gm,modulusLength:Cv,publicExponent:vv};function fm(r){if("crypto"in window)r.verbose("BrowserCrypto: modern crypto interface available");else throw r.error("BrowserCrypto: crypto interface is unavailable"),I(Oi)}function Md(r,e,t){return h(this,null,function*(){e?.addQueueMeasurement(d.Sha256Digest,t);let i=new TextEncoder().encode(r);return window.crypto.subtle.digest(gm,i)})}function Cm(r){return window.crypto.getRandomValues(r)}function Rd(){return window.crypto.getRandomValues(pm),pm[0]}function Be(){let r=Date.now(),e=Rd()*1024+(Rd()&1023),t=new Uint8Array(16),n=Math.trunc(e/2**30),i=e&2**30-1,o=Rd();t[0]=r/2**40,t[1]=r/2**32,t[2]=r/2**24,t[3]=r/2**16,t[4]=r/2**8,t[5]=r,t[6]=112|n>>>8,t[7]=n,t[8]=128|i>>>24,t[9]=i>>>16,t[10]=i>>>8,t[11]=i,t[12]=o>>>24,t[13]=o>>>16,t[14]=o>>>8,t[15]=o;let a="";for(let s=0;s<t.length;s++)a+=mm.charAt(t[s]>>>4),a+=mm.charAt(t[s]&15),(s===3||s===5||s===7||s===9)&&(a+="-");return a}function vm(r,e){return h(this,null,function*(){return window.crypto.subtle.generateKey(Dd,r,e)})}function Qs(r){return h(this,null,function*(){return window.crypto.subtle.exportKey(kd,r)})}function ym(r,e,t){return h(this,null,function*(){return window.crypto.subtle.importKey(kd,r,Dd,e,t)})}function Tm(r,e){return h(this,null,function*(){return window.crypto.subtle.sign(Dd,r,e)})}function Xs(r){return h(this,null,function*(){let e=yield Md(r),t=new Uint8Array(e);return ri(t)})}var ao="storage_not_supported",Js="stubbed_public_client_application_called",so="in_mem_redirect_unavailable";var Zs={[ao]:"Given storage configuration option was not supported.",[Js]:"Stub instance of Public Client Application was called. If using msal-react, please ensure context is not used without a provider. For more visit: aka.ms/msaljs/browser-errors",[so]:"Redirect cannot be supported. In-memory storage was selected and storeAuthStateInCookie=false, which would cause the library to be unable to handle the incoming hash. If you would like to use the redirect API, please use session/localStorage or set storeAuthStateInCookie=true."},yv={storageNotSupportedError:{code:ao,desc:Zs[ao]},stubPcaInstanceCalled:{code:Js,desc:Zs[Js]},inMemRedirectUnavailable:{code:so,desc:Zs[so]}},ii=class r extends re{constructor(e,t){super(e,t),this.name="BrowserConfigurationAuthError",Object.setPrototypeOf(this,r.prototype)}};function ec(r){return new ii(r,Zs[r])}function Od(r){r.location.hash="",typeof r.history.replaceState=="function"&&r.history.replaceState(null,"",`${r.location.origin}${r.location.pathname}${r.location.search}`)}function Pd(r){let e=r.split("#");e.shift(),window.location.hash=e.length>0?e.join("#"):""}function Ea(){return window.parent!==window}function wm(){return typeof window<"u"&&!!window.opener&&window.opener!==window&&typeof window.name=="string"&&window.name.indexOf(`${Ee.POPUP_NAME_PREFIX}.`)===0}function st(){return window.location.href.split("?")[0].split("#")[0]}function Nd(){let e=new Q(window.location.href).getUrlComponents();return`${e.Protocol}//${e.HostNameAndPort}/`}function _m(){if(Q.hashContainsKnownProperties(window.location.hash)&&Ea())throw I(Ki)}function Em(r){if(Ea()&&!r)throw I(Vi)}function Sm(){if(wm())throw I(zi)}function Am(){if(typeof window>"u")throw I(or)}function tc(r){if(!r)throw I(no)}function Sa(r){Am(),_m(),Sm(),tc(r)}function nc(r,e){if(Sa(r),Em(e.system.allowRedirectInIframe),e.cache.cacheLocation===ue.MemoryStorage&&!e.cache.storeAuthStateInCookie)throw ec(so)}function Aa(r){let e=document.createElement("link");e.rel="preconnect",e.href=new URL(r).origin,e.crossOrigin="anonymous",document.head.appendChild(e),window.setTimeout(()=>{try{document.head.removeChild(e)}catch{}},1e4)}function Tv(){return Be()}var Ia=class r{navigateInternal(e,t){return r.defaultNavigateWindow(e,t)}navigateExternal(e,t){return r.defaultNavigateWindow(e,t)}static defaultNavigateWindow(e,t){return t.noHistory?window.location.replace(e):window.location.assign(e),new Promise(n=>{setTimeout(()=>{n(!0)},t.timeout)})}};var ic=class{sendGetRequestAsync(e,t){return h(this,null,function*(){let n;try{n=yield fetch(e,{method:Ad.GET,headers:this.getFetchHeaders(t)})}catch{throw window.navigator.onLine?I(Yi):I(Sn)}try{return{headers:this.getHeaderDict(n.headers),body:yield n.json(),status:n.status}}catch{throw I(ti)}})}sendPostRequestAsync(e,t){return h(this,null,function*(){let n=t&&t.body||p.EMPTY_STRING,i;try{i=yield fetch(e,{method:Ad.POST,headers:this.getFetchHeaders(t),body:n})}catch{throw window.navigator.onLine?I($i):I(Sn)}try{return{headers:this.getHeaderDict(i.headers),body:yield i.json(),status:i.status}}catch{throw I(ti)}})}getFetchHeaders(e){let t=new Headers;if(!(e&&e.headers))return t;let n=e.headers;return Object.keys(n).forEach(i=>{t.append(i,n[i])}),t}getHeaderDict(e){let t={};return e.forEach((n,i)=>{t[i]=n}),t}};var wv=6e4,oc=1e4,_v=3e4,Ev=2e3;function Im({auth:r,cache:e,system:t,telemetry:n},i){let o={clientId:p.EMPTY_STRING,authority:`${p.DEFAULT_AUTHORITY}`,knownAuthorities:[],cloudDiscoveryMetadata:p.EMPTY_STRING,authorityMetadata:p.EMPTY_STRING,redirectUri:p.EMPTY_STRING,postLogoutRedirectUri:p.EMPTY_STRING,navigateToLoginRequestUrl:!0,clientCapabilities:[],protocolMode:qe.AAD,OIDCOptions:{serverResponseType:zt.FRAGMENT,defaultScopes:[p.OPENID_SCOPE,p.PROFILE_SCOPE,p.OFFLINE_ACCESS_SCOPE]},azureCloudOptions:{azureCloudInstance:Qn.None,tenant:p.EMPTY_STRING},skipAuthorityMetadataCache:!1,supportsNestedAppAuth:!1},a={cacheLocation:ue.SessionStorage,temporaryCacheLocation:ue.SessionStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!!(e&&e.cacheLocation===ue.LocalStorage),claimsBasedCachingEnabled:!1},s={loggerCallback:()=>{},logLevel:le.Info,piiLoggingEnabled:!1},c=z(_({},Ls),{loggerOptions:s,networkClient:i?new ic:_d,navigationClient:new Ia,loadFrameTimeout:0,windowHashTimeout:t?.loadFrameTimeout||wv,iframeHashTimeout:t?.loadFrameTimeout||oc,navigateFrameWait:0,redirectNavigationTimeout:_v,asyncPopups:!1,allowRedirectInIframe:!1,allowNativeBroker:!1,nativeBrokerHandshakeTimeout:t?.nativeBrokerHandshakeTimeout||Ev,pollIntervalMilliseconds:Ee.DEFAULT_POLL_INTERVAL_MS}),l=z(_(_({},c),t),{loggerOptions:t?.loggerOptions||s}),u={application:{appName:p.EMPTY_STRING,appVersion:p.EMPTY_STRING},client:new Mi};if(r?.protocolMode!==qe.OIDC&&r?.OIDCOptions&&new kt(l.loggerOptions).warning(JSON.stringify(ie(Gt.cannotSetOIDCOptions))),r?.protocolMode&&r.protocolMode!==qe.AAD&&l?.allowNativeBroker)throw ie(Gt.cannotAllowNativeBroker);return{auth:z(_(_({},o),r),{OIDCOptions:_(_({},o.OIDCOptions),r?.OIDCOptions)}),cache:_(_({},a),e),system:l,telemetry:_(_({},u),n)}}var km="@azure/msal-browser",lr="3.21.0";var ac=class r{static loggerCallback(e,t){switch(e){case le.Error:console.error(t);return;case le.Info:console.info(t);return;case le.Verbose:console.debug(t);return;case le.Warning:console.warn(t);return;default:console.log(t);return}}constructor(e){this.browserEnvironment=typeof window<"u",this.config=Im(e,this.browserEnvironment);let t;try{t=window[ue.SessionStorage]}catch{}let n=t?.getItem(dm),i=t?.getItem(um)?.toLowerCase(),o=i==="true"?!0:i==="false"?!1:void 0,a=_({},this.config.system.loggerOptions),s=n&&Object.keys(le).includes(n)?le[n]:void 0;s&&(a.loggerCallback=r.loggerCallback,a.logLevel=s),o!==void 0&&(a.piiLoggingEnabled=o),this.logger=new kt(a,km,lr),this.available=!1}getConfig(){return this.config}getLogger(){return this.logger}isAvailable(){return this.available}isBrowserEnvironment(){return this.browserEnvironment}};var sc=(()=>{class r extends ac{getModuleName(){return r.MODULE_NAME}getId(){return r.ID}initialize(){return h(this,null,function*(){return this.available=typeof window<"u",this.available})}}return r.MODULE_NAME="",r.ID="StandardOperatingContext",r})();function ct(r){return new TextDecoder().decode(Sv(r))}function Sv(r){let e=r.replace(/-/g,"+").replace(/_/g,"/");switch(e.length%4){case 0:break;case 2:e+="==";break;case 3:e+="=";break;default:throw I(io)}let t=atob(e);return Uint8Array.from(t,n=>n.codePointAt(0)||0)}var cc=class{constructor(){this.dbName=js,this.version=sm,this.tableName=cm,this.dbOpen=!1}open(){return h(this,null,function*(){return new Promise((e,t)=>{let n=window.indexedDB.open(this.dbName,this.version);n.addEventListener("upgradeneeded",i=>{i.target.result.createObjectStore(this.tableName)}),n.addEventListener("success",i=>{let o=i;this.db=o.target.result,this.dbOpen=!0,e()}),n.addEventListener("error",()=>t(I(sr)))})})}closeConnection(){let e=this.db;e&&this.dbOpen&&(e.close(),this.dbOpen=!1)}validateDbIsOpen(){return h(this,null,function*(){if(!this.dbOpen)return this.open()})}getItem(e){return h(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(I(on));let a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).get(e);a.addEventListener("success",s=>{let c=s;this.closeConnection(),t(c.target.result)}),a.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}setItem(e,t){return h(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((n,i)=>{if(!this.db)return i(I(on));let s=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).put(t,e);s.addEventListener("success",()=>{this.closeConnection(),n()}),s.addEventListener("error",c=>{this.closeConnection(),i(c)})})})}removeItem(e){return h(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(I(on));let a=this.db.transaction([this.tableName],"readwrite").objectStore(this.tableName).delete(e);a.addEventListener("success",()=>{this.closeConnection(),t()}),a.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}getKeys(){return h(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((e,t)=>{if(!this.db)return t(I(on));let o=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).getAllKeys();o.addEventListener("success",a=>{let s=a;this.closeConnection(),e(s.target.result)}),o.addEventListener("error",a=>{this.closeConnection(),t(a)})})})}containsKey(e){return h(this,null,function*(){return yield this.validateDbIsOpen(),new Promise((t,n)=>{if(!this.db)return n(I(on));let a=this.db.transaction([this.tableName],"readonly").objectStore(this.tableName).count(e);a.addEventListener("success",s=>{let c=s;this.closeConnection(),t(c.target.result===1)}),a.addEventListener("error",s=>{this.closeConnection(),n(s)})})})}deleteDatabase(){return h(this,null,function*(){return this.db&&this.dbOpen&&this.closeConnection(),new Promise((e,t)=>{let n=window.indexedDB.deleteDatabase(js),i=setTimeout(()=>t(!1),200);n.addEventListener("success",()=>(clearTimeout(i),e(!0))),n.addEventListener("blocked",()=>(clearTimeout(i),e(!0))),n.addEventListener("error",()=>(clearTimeout(i),t(!1)))})})}};var oi=class{constructor(){this.cache=new Map}getItem(e){return this.cache.get(e)||null}setItem(e,t){this.cache.set(e,t)}removeItem(e){this.cache.delete(e)}getKeys(){let e=[];return this.cache.forEach((t,n)=>{e.push(n)}),e}containsKey(e){return this.cache.has(e)}clear(){this.cache.clear()}};var lc=class{constructor(e){this.inMemoryCache=new oi,this.indexedDBCache=new cc,this.logger=e}handleDatabaseAccessError(e){if(e instanceof ni&&e.errorCode===sr)this.logger.error("Could not access persistent storage. This may be caused by browser privacy features which block persistent storage in third-party contexts.");else throw e}getItem(e){return h(this,null,function*(){let t=this.inMemoryCache.getItem(e);if(!t)try{return this.logger.verbose("Queried item not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.getItem(e)}catch(n){this.handleDatabaseAccessError(n)}return t})}setItem(e,t){return h(this,null,function*(){this.inMemoryCache.setItem(e,t);try{yield this.indexedDBCache.setItem(e,t)}catch(n){this.handleDatabaseAccessError(n)}})}removeItem(e){return h(this,null,function*(){this.inMemoryCache.removeItem(e);try{yield this.indexedDBCache.removeItem(e)}catch(t){this.handleDatabaseAccessError(t)}})}getKeys(){return h(this,null,function*(){let e=this.inMemoryCache.getKeys();if(e.length===0)try{return this.logger.verbose("In-memory cache is empty, now querying persistent storage."),yield this.indexedDBCache.getKeys()}catch(t){this.handleDatabaseAccessError(t)}return e})}containsKey(e){return h(this,null,function*(){let t=this.inMemoryCache.containsKey(e);if(!t)try{return this.logger.verbose("Key not found in in-memory cache, now querying persistent storage."),yield this.indexedDBCache.containsKey(e)}catch(n){this.handleDatabaseAccessError(n)}return t})}clearInMemory(){this.logger.verbose("Deleting in-memory keystore"),this.inMemoryCache.clear(),this.logger.verbose("In-memory keystore deleted")}clearPersistent(){return h(this,null,function*(){try{this.logger.verbose("Deleting persistent keystore");let e=yield this.indexedDBCache.deleteDatabase();return e&&this.logger.verbose("Persistent keystore deleted"),e}catch(e){return this.handleDatabaseAccessError(e),!1}})}};var Rm=(()=>{class r{constructor(t,n){this.logger=t,fm(t),this.cache=new lc(this.logger),this.performanceClient=n}createNewGuid(){return Be()}base64Encode(t){return _a(t)}base64Decode(t){return ct(t)}base64UrlEncode(t){return wa(t)}encodeKid(t){return this.base64UrlEncode(JSON.stringify({kid:t}))}getPublicKeyThumbprint(t){return h(this,null,function*(){let n=this.performanceClient?.startMeasurement(d.CryptoOptsGetPublicKeyThumbprint,t.correlationId),i=yield vm(r.EXTRACTABLE,r.POP_KEY_USAGES),o=yield Qs(i.publicKey),a={e:o.e,kty:o.kty,n:o.n},s=bm(a),c=yield this.hashString(s),l=yield Qs(i.privateKey),u=yield ym(l,!1,["sign"]);return yield this.cache.setItem(c,{privateKey:u,publicKey:i.publicKey,requestMethod:t.resourceRequestMethod,requestUri:t.resourceRequestUri}),n&&n.end({success:!0}),c})}removeTokenBindingKey(t){return h(this,null,function*(){return yield this.cache.removeItem(t),!(yield this.cache.containsKey(t))})}clearKeystore(){return h(this,null,function*(){this.cache.clearInMemory();try{return yield this.cache.clearPersistent(),!0}catch(t){return t instanceof Error?this.logger.error(`Clearing keystore failed with error: ${t.message}`):this.logger.error("Clearing keystore failed with unknown error"),!1}})}signJwt(t,n,i,o){return h(this,null,function*(){let a=this.performanceClient?.startMeasurement(d.CryptoOptsSignJwt,o),s=yield this.cache.getItem(n);if(!s)throw I(ar);let c=yield Qs(s.publicKey),l=bm(c),u=wa(JSON.stringify({kid:n})),m=ya.getShrHeaderString(z(_({},i?.header),{alg:c.alg,kid:u})),v=wa(m);t.cnf={jwk:JSON.parse(l)};let g=wa(JSON.stringify(t)),A=`${v}.${g}`,M=new TextEncoder().encode(A),B=yield Tm(s.privateKey,M),W=ri(new Uint8Array(B)),V=`${A}.${W}`;return a&&a.end({success:!0}),V})}hashString(t){return h(this,null,function*(){return Xs(t)})}}return r.POP_KEY_USAGES=["sign","verify"],r.EXTRACTABLE=!0,r})();function bm(r){return JSON.stringify(r,Object.keys(r).sort())}var ka=class{constructor(e){this.validateWindowStorage(e),this.windowStorage=window[e]}validateWindowStorage(e){if(e!==ue.LocalStorage&&e!==ue.SessionStorage||!window[e])throw ec(ao)}getItem(e){return this.windowStorage.getItem(e)}setItem(e,t){this.windowStorage.setItem(e,t)}removeItem(e){this.windowStorage.removeItem(e)}getKeys(){return Object.keys(this.windowStorage)}containsKey(e){return this.windowStorage.hasOwnProperty(e)}};function dc(r,e){if(!e)return null;try{return He.parseRequestState(r,e).libraryState.meta}catch{throw T(xe.invalidState)}}var co=class r extends _n{constructor(e,t,n,i,o,a){super(e,n,i,o),this.COOKIE_LIFE_MULTIPLIER=24*60*60*1e3,this.cacheConfig=t,this.logger=i,this.internalStorage=new oi,this.browserStorage=this.setupBrowserStorage(this.cacheConfig.cacheLocation),this.temporaryCacheStorage=this.setupTemporaryCacheStorage(this.cacheConfig.temporaryCacheLocation,this.cacheConfig.cacheLocation),t.cacheMigrationEnabled&&(this.migrateCacheEntries(),this.createKeyMaps()),this.performanceClient=a}setupBrowserStorage(e){switch(e){case ue.LocalStorage:case ue.SessionStorage:try{return new ka(e)}catch(t){this.logger.verbose(t);break}}return this.cacheConfig.cacheLocation=ue.MemoryStorage,new oi}setupTemporaryCacheStorage(e,t){switch(t){case ue.LocalStorage:case ue.SessionStorage:try{return new ka(e||ue.SessionStorage)}catch(n){return this.logger.verbose(n),this.internalStorage}case ue.MemoryStorage:default:return this.internalStorage}}migrateCacheEntries(){let e=`${p.CACHE_PREFIX}.${be.ID_TOKEN}`,t=`${p.CACHE_PREFIX}.${be.CLIENT_INFO}`,n=`${p.CACHE_PREFIX}.${be.ERROR}`,i=`${p.CACHE_PREFIX}.${be.ERROR_DESC}`,o=this.browserStorage.getItem(e),a=this.browserStorage.getItem(t),s=this.browserStorage.getItem(n),c=this.browserStorage.getItem(i),l=[o,a,s,c];[be.ID_TOKEN,be.CLIENT_INFO,be.ERROR,be.ERROR_DESC].forEach((m,v)=>{let g=l[v];g&&this.setTemporaryCache(m,g,!0)})}createKeyMaps(){this.logger.trace("BrowserCacheManager - createKeyMaps called.");let e=this.getItem(kn.ACCOUNT_KEYS),t=this.getItem(`${kn.TOKEN_KEYS}.${this.clientId}`);if(e&&t){this.logger.verbose("BrowserCacheManager:createKeyMaps - account and token key maps already exist, skipping migration.");return}this.browserStorage.getKeys().forEach(i=>{if(this.isCredentialKey(i)){let o=this.getItem(i);if(o){let a=this.validateAndParseJson(o);if(a&&a.hasOwnProperty("credentialType"))switch(a.credentialType){case G.ID_TOKEN:if(me.isIdTokenEntity(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - idToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - idToken with key: ${i} found, saving key to token key map`);let s=a,c=this.updateCredentialCacheKey(i,s);this.addTokenKey(c,G.ID_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching idToken schema with value containing idToken credentialType field but value failed IdTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed idToken validation on key: ${i}`);break;case G.ACCESS_TOKEN:case G.ACCESS_TOKEN_WITH_AUTH_SCHEME:if(me.isAccessTokenEntity(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - accessToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - accessToken with key: ${i} found, saving key to token key map`);let s=a,c=this.updateCredentialCacheKey(i,s);this.addTokenKey(c,G.ACCESS_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching accessToken schema with value containing accessToken credentialType field but value failed AccessTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed accessToken validation on key: ${i}`);break;case G.REFRESH_TOKEN:if(me.isRefreshTokenEntity(a)){this.logger.trace("BrowserCacheManager:createKeyMaps - refreshToken found, saving key to token key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - refreshToken with key: ${i} found, saving key to token key map`);let s=a,c=this.updateCredentialCacheKey(i,s);this.addTokenKey(c,G.REFRESH_TOKEN);return}else this.logger.trace("BrowserCacheManager:createKeyMaps - key found matching refreshToken schema with value containing refreshToken credentialType field but value failed RefreshTokenEntity validation, skipping."),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - failed refreshToken validation on key: ${i}`);break}}}if(this.isAccountKey(i)){let o=this.getItem(i);if(o){let a=this.validateAndParseJson(o);a&&pe.isAccountEntity(a)&&(this.logger.trace("BrowserCacheManager:createKeyMaps - account found, saving key to account key map"),this.logger.tracePii(`BrowserCacheManager:createKeyMaps - account with key: ${i} found, saving key to account key map`),this.addAccountKeyToMap(i))}}})}validateAndParseJson(e){try{let t=JSON.parse(e);return t&&typeof t=="object"?t:null}catch{return null}}getItem(e){return this.browserStorage.getItem(e)}setItem(e,t){this.browserStorage.setItem(e,t)}getAccount(e,t){this.logger.trace("BrowserCacheManager.getAccount called");let n=this.getCachedAccountEntity(e);return this.updateOutdatedCachedAccount(e,n,t)}getCachedAccountEntity(e){let t=this.getItem(e);if(!t)return this.removeAccountKeyFromMap(e),null;let n=this.validateAndParseJson(t);return!n||!pe.isAccountEntity(n)?(this.removeAccountKeyFromMap(e),null):_n.toObject(new pe,n)}setAccount(e){this.logger.trace("BrowserCacheManager.setAccount called");let t=e.generateAccountKey();this.setItem(t,JSON.stringify(e)),this.addAccountKeyToMap(t)}getAccountKeys(){this.logger.trace("BrowserCacheManager.getAccountKeys called");let e=this.getItem(kn.ACCOUNT_KEYS);return e?JSON.parse(e):(this.logger.verbose("BrowserCacheManager.getAccountKeys - No account keys found"),[])}addAccountKeyToMap(e){this.logger.trace("BrowserCacheManager.addAccountKeyToMap called"),this.logger.tracePii(`BrowserCacheManager.addAccountKeyToMap called with key: ${e}`);let t=this.getAccountKeys();t.indexOf(e)===-1?(t.push(e),this.setItem(kn.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key added")):this.logger.verbose("BrowserCacheManager.addAccountKeyToMap account key already exists in map")}removeAccountKeyFromMap(e){this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap called"),this.logger.tracePii(`BrowserCacheManager.removeAccountKeyFromMap called with key: ${e}`);let t=this.getAccountKeys(),n=t.indexOf(e);n>-1?(t.splice(n,1),this.setItem(kn.ACCOUNT_KEYS,JSON.stringify(t)),this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap account key removed")):this.logger.trace("BrowserCacheManager.removeAccountKeyFromMap key not found in existing map")}removeAccount(e){return h(this,null,function*(){vo(r.prototype,this,"removeAccount").call(this,e),this.removeAccountKeyFromMap(e)})}removeOutdatedAccount(e){this.removeItem(e),this.removeAccountKeyFromMap(e)}removeIdToken(e){super.removeIdToken(e),this.removeTokenKey(e,G.ID_TOKEN)}removeAccessToken(e){return h(this,null,function*(){vo(r.prototype,this,"removeAccessToken").call(this,e),this.removeTokenKey(e,G.ACCESS_TOKEN)})}removeRefreshToken(e){super.removeRefreshToken(e),this.removeTokenKey(e,G.REFRESH_TOKEN)}getTokenKeys(){this.logger.trace("BrowserCacheManager.getTokenKeys called");let e=this.getItem(`${kn.TOKEN_KEYS}.${this.clientId}`);if(e){let t=this.validateAndParseJson(e);if(t&&t.hasOwnProperty("idToken")&&t.hasOwnProperty("accessToken")&&t.hasOwnProperty("refreshToken"))return t;this.logger.error("BrowserCacheManager.getTokenKeys - Token keys found but in an unknown format. Returning empty key map.")}else this.logger.verbose("BrowserCacheManager.getTokenKeys - No token keys found");return{idToken:[],accessToken:[],refreshToken:[]}}addTokenKey(e,t){this.logger.trace("BrowserCacheManager addTokenKey called");let n=this.getTokenKeys();switch(t){case G.ID_TOKEN:n.idToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - idToken added to map"),n.idToken.push(e));break;case G.ACCESS_TOKEN:n.accessToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - accessToken added to map"),n.accessToken.push(e));break;case G.REFRESH_TOKEN:n.refreshToken.indexOf(e)===-1&&(this.logger.info("BrowserCacheManager: addTokenKey - refreshToken added to map"),n.refreshToken.push(e));break;default:throw this.logger.error(`BrowserCacheManager:addTokenKey - CredentialType provided invalid. CredentialType: ${t}`),T(xe.unexpectedCredentialType)}this.setItem(`${kn.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}removeTokenKey(e,t){this.logger.trace("BrowserCacheManager removeTokenKey called");let n=this.getTokenKeys();switch(t){case G.ID_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove idToken with key: ${e} from map`);let i=n.idToken.indexOf(e);i>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - idToken removed from map"),n.idToken.splice(i,1)):this.logger.info("BrowserCacheManager: removeTokenKey - idToken does not exist in map. Either it was previously removed or it was never added.");break;case G.ACCESS_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove accessToken with key: ${e} from map`);let o=n.accessToken.indexOf(e);o>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - accessToken removed from map"),n.accessToken.splice(o,1)):this.logger.info("BrowserCacheManager: removeTokenKey - accessToken does not exist in map. Either it was previously removed or it was never added.");break;case G.REFRESH_TOKEN:this.logger.infoPii(`BrowserCacheManager: removeTokenKey - attempting to remove refreshToken with key: ${e} from map`);let a=n.refreshToken.indexOf(e);a>-1?(this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken removed from map"),n.refreshToken.splice(a,1)):this.logger.info("BrowserCacheManager: removeTokenKey - refreshToken does not exist in map. Either it was previously removed or it was never added.");break;default:throw this.logger.error(`BrowserCacheManager:removeTokenKey - CredentialType provided invalid. CredentialType: ${t}`),T(xe.unexpectedCredentialType)}this.setItem(`${kn.TOKEN_KEYS}.${this.clientId}`,JSON.stringify(n))}getIdTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,G.ID_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!me.isIdTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getIdTokenCredential: called, no cache hit"),this.removeTokenKey(e,G.ID_TOKEN),null):(this.logger.trace("BrowserCacheManager.getIdTokenCredential: cache hit"),n)}setIdTokenCredential(e){this.logger.trace("BrowserCacheManager.setIdTokenCredential called");let t=me.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,G.ID_TOKEN)}getAccessTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,G.ACCESS_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!me.isAccessTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: called, no cache hit"),this.removeTokenKey(e,G.ACCESS_TOKEN),null):(this.logger.trace("BrowserCacheManager.getAccessTokenCredential: cache hit"),n)}setAccessTokenCredential(e){this.logger.trace("BrowserCacheManager.setAccessTokenCredential called");let t=me.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,G.ACCESS_TOKEN)}getRefreshTokenCredential(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,G.REFRESH_TOKEN),null;let n=this.validateAndParseJson(t);return!n||!me.isRefreshTokenEntity(n)?(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: called, no cache hit"),this.removeTokenKey(e,G.REFRESH_TOKEN),null):(this.logger.trace("BrowserCacheManager.getRefreshTokenCredential: cache hit"),n)}setRefreshTokenCredential(e){this.logger.trace("BrowserCacheManager.setRefreshTokenCredential called");let t=me.generateCredentialKey(e);this.setItem(t,JSON.stringify(e)),this.addTokenKey(t,G.REFRESH_TOKEN)}getAppMetadata(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!me.isAppMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAppMetadata: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getAppMetadata: cache hit"),n)}setAppMetadata(e){this.logger.trace("BrowserCacheManager.setAppMetadata called");let t=me.generateAppMetadataKey(e);this.setItem(t,JSON.stringify(e))}getServerTelemetry(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!me.isServerTelemetryEntity(e,n)?(this.logger.trace("BrowserCacheManager.getServerTelemetry: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getServerTelemetry: cache hit"),n)}setServerTelemetry(e,t){this.logger.trace("BrowserCacheManager.setServerTelemetry called"),this.setItem(e,JSON.stringify(t))}getAuthorityMetadata(e){let t=this.internalStorage.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getAuthorityMetadata: called, no cache hit"),null;let n=this.validateAndParseJson(t);return n&&me.isAuthorityMetadataEntity(e,n)?(this.logger.trace("BrowserCacheManager.getAuthorityMetadata: cache hit"),n):null}getAuthorityMetadataKeys(){return this.internalStorage.getKeys().filter(t=>this.isAuthorityMetadata(t))}setWrapperMetadata(e,t){this.internalStorage.setItem(Ta.WRAPPER_SKU,e),this.internalStorage.setItem(Ta.WRAPPER_VER,t)}getWrapperMetadata(){let e=this.internalStorage.getItem(Ta.WRAPPER_SKU)||p.EMPTY_STRING,t=this.internalStorage.getItem(Ta.WRAPPER_VER)||p.EMPTY_STRING;return[e,t]}setAuthorityMetadata(e,t){this.logger.trace("BrowserCacheManager.setAuthorityMetadata called"),this.internalStorage.setItem(e,JSON.stringify(t))}getActiveAccount(){let e=this.generateCacheKey(be.ACTIVE_ACCOUNT_FILTERS),t=this.getItem(e);if(!t){this.logger.trace("BrowserCacheManager.getActiveAccount: No active account filters cache schema found, looking for legacy schema");let i=this.generateCacheKey(be.ACTIVE_ACCOUNT),o=this.getItem(i);if(!o)return this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null;let a=this.getAccountInfoFilteredBy({localAccountId:o});return a?(this.logger.trace("BrowserCacheManager.getActiveAccount: Legacy active account cache schema found"),this.logger.trace("BrowserCacheManager.getActiveAccount: Adding active account filters cache schema"),this.setActiveAccount(a),a):null}let n=this.validateAndParseJson(t);return n?(this.logger.trace("BrowserCacheManager.getActiveAccount: Active account filters schema found"),this.getAccountInfoFilteredBy({homeAccountId:n.homeAccountId,localAccountId:n.localAccountId,tenantId:n.tenantId})):(this.logger.trace("BrowserCacheManager.getActiveAccount: No active account found"),null)}setActiveAccount(e){let t=this.generateCacheKey(be.ACTIVE_ACCOUNT_FILTERS),n=this.generateCacheKey(be.ACTIVE_ACCOUNT);if(e){this.logger.verbose("setActiveAccount: Active account set");let i={homeAccountId:e.homeAccountId,localAccountId:e.localAccountId,tenantId:e.tenantId};this.browserStorage.setItem(t,JSON.stringify(i)),this.browserStorage.setItem(n,e.localAccountId)}else this.logger.verbose("setActiveAccount: No account passed, active account not set"),this.browserStorage.removeItem(t),this.browserStorage.removeItem(n)}getThrottlingCache(e){let t=this.getItem(e);if(!t)return this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null;let n=this.validateAndParseJson(t);return!n||!me.isThrottlingEntity(e,n)?(this.logger.trace("BrowserCacheManager.getThrottlingCache: called, no cache hit"),null):(this.logger.trace("BrowserCacheManager.getThrottlingCache: cache hit"),n)}setThrottlingCache(e,t){this.logger.trace("BrowserCacheManager.setThrottlingCache called"),this.setItem(e,JSON.stringify(t))}getTemporaryCache(e,t){let n=t?this.generateCacheKey(e):e;if(this.cacheConfig.storeAuthStateInCookie){let o=this.getItemCookie(n);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: storeAuthStateInCookies set to true, retrieving from cookies"),o}let i=this.temporaryCacheStorage.getItem(n);if(!i){if(this.cacheConfig.cacheLocation===ue.LocalStorage){let o=this.browserStorage.getItem(n);if(o)return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item found in local storage"),o}return this.logger.trace("BrowserCacheManager.getTemporaryCache: No cache item found in local storage"),null}return this.logger.trace("BrowserCacheManager.getTemporaryCache: Temporary cache item returned"),i}setTemporaryCache(e,t,n){let i=n?this.generateCacheKey(e):e;this.temporaryCacheStorage.setItem(i,t),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.setTemporaryCache: storeAuthStateInCookie set to true, setting item cookie"),this.setItemCookie(i,t))}removeItem(e){this.browserStorage.removeItem(e)}removeTemporaryItem(e){this.temporaryCacheStorage.removeItem(e),this.cacheConfig.storeAuthStateInCookie&&(this.logger.trace("BrowserCacheManager.removeItem: storeAuthStateInCookie is true, clearing item cookie"),this.clearItemCookie(e))}getKeys(){return this.browserStorage.getKeys()}clear(){return h(this,null,function*(){yield this.removeAllAccounts(),this.removeAppMetadata(),this.temporaryCacheStorage.getKeys().forEach(e=>{(e.indexOf(p.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.removeTemporaryItem(e)}),this.browserStorage.getKeys().forEach(e=>{(e.indexOf(p.CACHE_PREFIX)!==-1||e.indexOf(this.clientId)!==-1)&&this.browserStorage.removeItem(e)}),this.internalStorage.clear()})}clearTokensAndKeysWithClaims(e,t){return h(this,null,function*(){e.addQueueMeasurement(d.ClearTokensAndKeysWithClaims,t);let n=this.getTokenKeys(),i=[];n.accessToken.forEach(o=>{let a=this.getAccessTokenCredential(o);a?.requestedClaimsHash&&o.includes(a.requestedClaimsHash.toLowerCase())&&i.push(this.removeAccessToken(o))}),yield Promise.all(i),i.length>0&&this.logger.warning(`${i.length} access tokens with claims in the cache keys have been removed from the cache.`)})}setItemCookie(e,t,n){let i=`${encodeURIComponent(e)}=${encodeURIComponent(t)};path=/;SameSite=Lax;`;if(n){let o=this.getCookieExpirationTime(n);i+=`expires=${o};`}this.cacheConfig.secureCookies&&(i+="Secure;"),document.cookie=i}getItemCookie(e){let t=`${encodeURIComponent(e)}=`,n=document.cookie.split(";");for(let i=0;i<n.length;i++){let o=n[i];for(;o.charAt(0)===" ";)o=o.substring(1);if(o.indexOf(t)===0)return decodeURIComponent(o.substring(t.length,o.length))}return p.EMPTY_STRING}clearMsalCookies(){let e=`${p.CACHE_PREFIX}.${this.clientId}`;document.cookie.split(";").forEach(n=>{for(;n.charAt(0)===" ";)n=n.substring(1);if(n.indexOf(e)===0){let i=n.split("=")[0];this.clearItemCookie(i)}})}clearItemCookie(e){this.setItemCookie(e,p.EMPTY_STRING,-1)}getCookieExpirationTime(e){let t=new Date;return new Date(t.getTime()+e*this.COOKIE_LIFE_MULTIPLIER).toUTCString()}generateCacheKey(e){return this.validateAndParseJson(e)?JSON.stringify(e):_e.startsWith(e,p.CACHE_PREFIX)||_e.startsWith(e,be.ADAL_ID_TOKEN)?e:`${p.CACHE_PREFIX}.${this.clientId}.${e}`}generateAuthorityKey(e){let{libraryState:{id:t}}=He.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ee.AUTHORITY}.${t}`)}generateNonceKey(e){let{libraryState:{id:t}}=He.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ee.NONCE_IDTOKEN}.${t}`)}generateStateKey(e){let{libraryState:{id:t}}=He.parseRequestState(this.cryptoImpl,e);return this.generateCacheKey(`${ee.REQUEST_STATE}.${t}`)}getCachedAuthority(e){let t=this.generateStateKey(e),n=this.getTemporaryCache(t);if(!n)return null;let i=this.generateAuthorityKey(n);return this.getTemporaryCache(i)}updateCacheEntries(e,t,n,i,o){this.logger.trace("BrowserCacheManager.updateCacheEntries called");let a=this.generateStateKey(e);this.setTemporaryCache(a,e,!1);let s=this.generateNonceKey(e);this.setTemporaryCache(s,t,!1);let c=this.generateAuthorityKey(e);if(this.setTemporaryCache(c,n,!1),o){let l={credential:o.homeAccountId,type:Le.HOME_ACCOUNT_ID};this.setTemporaryCache(ee.CCS_CREDENTIAL,JSON.stringify(l),!0)}else if(i){let l={credential:i,type:Le.UPN};this.setTemporaryCache(ee.CCS_CREDENTIAL,JSON.stringify(l),!0)}}resetRequestCache(e){this.logger.trace("BrowserCacheManager.resetRequestCache called"),e&&(this.temporaryCacheStorage.getKeys().forEach(t=>{t.indexOf(e)!==-1&&this.removeTemporaryItem(t)}),this.removeTemporaryItem(this.generateStateKey(e)),this.removeTemporaryItem(this.generateNonceKey(e)),this.removeTemporaryItem(this.generateAuthorityKey(e))),this.removeTemporaryItem(this.generateCacheKey(ee.REQUEST_PARAMS)),this.removeTemporaryItem(this.generateCacheKey(ee.ORIGIN_URI)),this.removeTemporaryItem(this.generateCacheKey(ee.URL_HASH)),this.removeTemporaryItem(this.generateCacheKey(ee.CORRELATION_ID)),this.removeTemporaryItem(this.generateCacheKey(ee.CCS_CREDENTIAL)),this.removeTemporaryItem(this.generateCacheKey(ee.NATIVE_REQUEST)),this.removeTemporaryItem(this.generateCacheKey(ee.REDIRECT_REQUEST)),this.setInteractionInProgress(!1)}cleanRequestByState(e){if(this.logger.trace("BrowserCacheManager.cleanRequestByState called"),e){let t=this.generateStateKey(e),n=this.temporaryCacheStorage.getItem(t);this.logger.infoPii(`BrowserCacheManager.cleanRequestByState: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n||p.EMPTY_STRING)}this.clearMsalCookies()}cleanRequestByInteractionType(e){this.logger.trace("BrowserCacheManager.cleanRequestByInteractionType called"),this.temporaryCacheStorage.getKeys().forEach(t=>{if(t.indexOf(ee.REQUEST_STATE)===-1)return;let n=this.temporaryCacheStorage.getItem(t);if(!n)return;let i=dc(this.cryptoImpl,n);i&&i.interactionType===e&&(this.logger.infoPii(`BrowserCacheManager.cleanRequestByInteractionType: Removing temporary cache items for state: ${n}`),this.resetRequestCache(n))}),this.clearMsalCookies(),this.setInteractionInProgress(!1)}generateRequestRetriedKey(){return`${p.CACHE_PREFIX}.${ee.REQUEST_RETRY}.${this.clientId}`}getRequestRetried(){let e=this.generateRequestRetriedKey(),t=this.getTemporaryCache(e);return t?parseInt(t):null}setRequestRetried(){this.logger.trace("BrowserCacheManager.setRequestRetried called");let e=this.generateRequestRetriedKey();this.setTemporaryCache(e,"1",!1)}removeRequestRetried(){let e=this.generateRequestRetriedKey();this.removeTemporaryItem(e)}cacheRedirectRequest(e){this.logger.trace("BrowserCacheManager.cacheRedirectRequest called");let t=vt(e,[]);delete t.onRedirectNavigate;let n=JSON.stringify(t);this.setTemporaryCache(ee.REDIRECT_REQUEST,n,!0)}getCachedRedirectRequest(){this.logger.trace("BrowserCacheManager.getCachedRedirectRequest called");let e=this.getTemporaryCache(ee.REDIRECT_REQUEST,!0);if(!e)this.logger.error("No cached redirect request found.");else{this.removeTemporaryItem(this.generateCacheKey(ee.REDIRECT_REQUEST));let t;try{t=JSON.parse(e)}catch(n){this.logger.errorPii(`Attempted to parse: ${e}`),this.logger.error(`Parsing cached redirect request threw with error: ${n}`);return}if(t)return t}}cacheCodeRequest(e){this.logger.trace("BrowserCacheManager.cacheCodeRequest called");let t=_a(JSON.stringify(e));this.setTemporaryCache(ee.REQUEST_PARAMS,t,!0)}getCachedRequest(e){this.logger.trace("BrowserCacheManager.getCachedRequest called");let t=this.getTemporaryCache(ee.REQUEST_PARAMS,!0);if(!t)throw I(Wi);let n;try{n=JSON.parse(ct(t))}catch(i){throw this.logger.errorPii(`Attempted to parse: ${t}`),this.logger.error(`Parsing cached token request threw with error: ${i}`),I(Gi)}if(this.removeTemporaryItem(this.generateCacheKey(ee.REQUEST_PARAMS)),!n.authority){let i=this.generateAuthorityKey(e),o=this.getTemporaryCache(i);if(!o)throw I(ir);n.authority=o}return n}getCachedNativeRequest(){this.logger.trace("BrowserCacheManager.getCachedNativeRequest called");let e=this.getTemporaryCache(ee.NATIVE_REQUEST,!0);if(!e)return this.logger.trace("BrowserCacheManager.getCachedNativeRequest: No cached native request found"),null;let t=this.validateAndParseJson(e);return t||(this.logger.error("BrowserCacheManager.getCachedNativeRequest: Unable to parse native request"),null)}isInteractionInProgress(e){let t=this.getInteractionInProgress();return e?t===this.clientId:!!t}getInteractionInProgress(){let e=`${p.CACHE_PREFIX}.${ee.INTERACTION_STATUS_KEY}`;return this.getTemporaryCache(e,!1)}setInteractionInProgress(e){let t=`${p.CACHE_PREFIX}.${ee.INTERACTION_STATUS_KEY}`;if(e){if(this.getInteractionInProgress())throw I(Hi);this.setTemporaryCache(t,this.clientId,!1)}else!e&&this.getInteractionInProgress()===this.clientId&&this.removeTemporaryItem(t)}getLegacyLoginHint(){let e=this.getTemporaryCache(be.ADAL_ID_TOKEN);e&&(this.browserStorage.removeItem(be.ADAL_ID_TOKEN),this.logger.verbose("Cached ADAL id token retrieved."));let t=this.getTemporaryCache(be.ID_TOKEN,!0);t&&(this.browserStorage.removeItem(this.generateCacheKey(be.ID_TOKEN)),this.logger.verbose("Cached MSAL.js v1 id token retrieved"));let n=t||e;if(n){let i=$n.extractTokenClaims(n,ct);if(i.preferred_username)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 preferred_username as loginHint"),i.preferred_username;if(i.upn)return this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, setting ADAL/MSAL v1 upn as loginHint"),i.upn;this.logger.verbose("No SSO params used and ADAL/MSAL v1 token retrieved, however, no account hint claim found. Enable preferred_username or upn id token claim to get SSO.")}return null}updateCredentialCacheKey(e,t){let n=me.generateCredentialKey(t);if(e!==n){let i=this.getItem(e);if(i)return this.browserStorage.removeItem(e),this.setItem(n,i),this.logger.verbose(`Updated an outdated ${t.credentialType} cache key`),n;this.logger.error(`Attempted to update an outdated ${t.credentialType} cache key but no item matching the outdated key was found in storage`)}return e}hydrateCache(e,t){return h(this,null,function*(){let n=me.createIdTokenEntity(e.account?.homeAccountId,e.account?.environment,e.idToken,this.clientId,e.tenantId),i;t.claims&&(i=yield this.cryptoImpl.hashString(t.claims));let o=me.createAccessTokenEntity(e.account?.homeAccountId,e.account.environment,e.accessToken,this.clientId,e.tenantId,e.scopes.join(" "),e.expiresOn?e.expiresOn.getTime()/1e3:0,e.extExpiresOn?e.extExpiresOn.getTime()/1e3:0,ct,void 0,e.tokenType,void 0,t.sshKid,t.claims,i),a={idToken:n,accessToken:o};return this.saveCacheRecord(a)})}saveCacheRecord(e,t,n){return h(this,null,function*(){try{yield vo(r.prototype,this,"saveCacheRecord").call(this,e,t,n)}catch(i){if(i instanceof wn&&this.performanceClient&&n)try{let o=this.getTokenKeys();this.performanceClient.addFields({cacheRtCount:o.refreshToken.length,cacheIdCount:o.idToken.length,cacheAtCount:o.accessToken.length},n)}catch{}throw i}})}},Dm=(r,e)=>{let t={cacheLocation:ue.MemoryStorage,temporaryCacheLocation:ue.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};return new co(r,t,Jn,e)};function Mm(r,e,t,n){return r.verbose("getAllAccounts called"),t?e.getAllAccounts(n):[]}function Om(r,e,t){if(e.trace("getAccount called"),Object.keys(r).length===0)return e.warning("getAccount: No accountFilter provided"),null;let n=t.getAccountInfoFilteredBy(r);return n?(e.verbose("getAccount: Account matching provided filter found, returning"),n):(e.verbose("getAccount: No matching account found, returning null"),null)}function Pm(r,e,t){if(e.trace("getAccountByUsername called"),!r)return e.warning("getAccountByUsername: No username provided"),null;let n=t.getAccountInfoFilteredBy({username:r});return n?(e.verbose("getAccountByUsername: Account matching username found, returning"),e.verbosePii(`getAccountByUsername: Returning signed-in accounts matching username: ${r}`),n):(e.verbose("getAccountByUsername: No matching account found, returning null"),null)}function Nm(r,e,t){if(e.trace("getAccountByHomeId called"),!r)return e.warning("getAccountByHomeId: No homeAccountId provided"),null;let n=t.getAccountInfoFilteredBy({homeAccountId:r});return n?(e.verbose("getAccountByHomeId: Account matching homeAccountId found, returning"),e.verbosePii(`getAccountByHomeId: Returning signed-in accounts matching homeAccountId: ${r}`),n):(e.verbose("getAccountByHomeId: No matching account found, returning null"),null)}function xm(r,e,t){if(e.trace("getAccountByLocalId called"),!r)return e.warning("getAccountByLocalId: No localAccountId provided"),null;let n=t.getAccountInfoFilteredBy({localAccountId:r});return n?(e.verbose("getAccountByLocalId: Account matching localAccountId found, returning"),e.verbosePii(`getAccountByLocalId: Returning signed-in accounts matching localAccountId: ${r}`),n):(e.verbose("getAccountByLocalId: No matching account found, returning null"),null)}function Lm(r,e){e.setActiveAccount(r)}function Hm(r){return r.getActiveAccount()}var H={INITIALIZE_START:"msal:initializeStart",INITIALIZE_END:"msal:initializeEnd",ACCOUNT_ADDED:"msal:accountAdded",ACCOUNT_REMOVED:"msal:accountRemoved",ACTIVE_ACCOUNT_CHANGED:"msal:activeAccountChanged",LOGIN_START:"msal:loginStart",LOGIN_SUCCESS:"msal:loginSuccess",LOGIN_FAILURE:"msal:loginFailure",ACQUIRE_TOKEN_START:"msal:acquireTokenStart",ACQUIRE_TOKEN_SUCCESS:"msal:acquireTokenSuccess",ACQUIRE_TOKEN_FAILURE:"msal:acquireTokenFailure",ACQUIRE_TOKEN_NETWORK_START:"msal:acquireTokenFromNetworkStart",SSO_SILENT_START:"msal:ssoSilentStart",SSO_SILENT_SUCCESS:"msal:ssoSilentSuccess",SSO_SILENT_FAILURE:"msal:ssoSilentFailure",ACQUIRE_TOKEN_BY_CODE_START:"msal:acquireTokenByCodeStart",ACQUIRE_TOKEN_BY_CODE_SUCCESS:"msal:acquireTokenByCodeSuccess",ACQUIRE_TOKEN_BY_CODE_FAILURE:"msal:acquireTokenByCodeFailure",HANDLE_REDIRECT_START:"msal:handleRedirectStart",HANDLE_REDIRECT_END:"msal:handleRedirectEnd",POPUP_OPENED:"msal:popupOpened",LOGOUT_START:"msal:logoutStart",LOGOUT_SUCCESS:"msal:logoutSuccess",LOGOUT_FAILURE:"msal:logoutFailure",LOGOUT_END:"msal:logoutEnd",RESTORE_FROM_BFCACHE:"msal:restoreFromBFCache"};var uc=class{constructor(e,t){this.eventCallbacks=new Map,this.logger=e,this.browserCrypto=t,this.listeningToStorageEvents=!1,this.handleAccountCacheChange=this.handleAccountCacheChange.bind(this)}addEventCallback(e){if(typeof window<"u"){let t=Be();return this.eventCallbacks.set(t,e),this.logger.verbose(`Event callback registered with id: ${t}`),t}return null}removeEventCallback(e){this.eventCallbacks.delete(e),this.logger.verbose(`Event callback ${e} removed.`)}enableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?this.logger.verbose("Account storage listener already registered."):(this.logger.verbose("Adding account storage listener."),this.listeningToStorageEvents=!0,window.addEventListener("storage",this.handleAccountCacheChange)))}disableAccountStorageEvents(){typeof window>"u"||(this.listeningToStorageEvents?(this.logger.verbose("Removing account storage listener."),window.removeEventListener("storage",this.handleAccountCacheChange),this.listeningToStorageEvents=!1):this.logger.verbose("No account storage listener registered."))}emitEvent(e,t,n,i){if(typeof window<"u"){let o={eventType:e,interactionType:t||null,payload:n||null,error:i||null,timestamp:Date.now()};this.logger.info(`Emitting event: ${e}`),this.eventCallbacks.forEach((a,s)=>{this.logger.verbose(`Emitting event to callback ${s}: ${e}`),a.apply(null,[o])})}}handleAccountCacheChange(e){try{e.key?.includes(be.ACTIVE_ACCOUNT_FILTERS)&&this.emitEvent(H.ACTIVE_ACCOUNT_CHANGED);let t=e.newValue||e.oldValue;if(!t)return;let n=JSON.parse(t);if(typeof n!="object"||!pe.isAccountEntity(n))return;let o=_n.toObject(new pe,n).getAccountInfo();!e.oldValue&&e.newValue?(this.logger.info("Account was added to cache in a different window"),this.emitEvent(H.ACCOUNT_ADDED,void 0,o)):!e.newValue&&e.oldValue&&(this.logger.info("Account was removed from cache in a different window"),this.emitEvent(H.ACCOUNT_REMOVED,void 0,o))}catch{return}}};var lo=class{constructor(e,t,n,i,o,a,s,c,l){this.config=e,this.browserStorage=t,this.browserCrypto=n,this.networkClient=this.config.system.networkClient,this.eventHandler=o,this.navigationClient=a,this.nativeMessageHandler=c,this.correlationId=l||Be(),this.logger=i.clone(Ee.MSAL_SKU,lr,this.correlationId),this.performanceClient=s}clearCacheOnLogout(e){return h(this,null,function*(){if(e){pe.accountInfoIsEqual(e,this.browserStorage.getActiveAccount(),!1)&&(this.logger.verbose("Setting active account to null"),this.browserStorage.setActiveAccount(null));try{yield this.browserStorage.removeAccount(pe.generateAccountCacheKey(e)),this.logger.verbose("Cleared cache items belonging to the account provided in the logout request.")}catch{this.logger.error("Account provided in logout request was not found. Local cache unchanged.")}}else try{this.logger.verbose("No account provided in logout request, clearing all cache items.",this.correlationId),yield this.browserStorage.clear(),yield this.browserCrypto.clearKeystore()}catch{this.logger.error("Attempted to clear all MSAL cache items and failed. Local cache unchanged.")}})}getRedirectUri(e){this.logger.verbose("getRedirectUri called");let t=e||this.config.auth.redirectUri||st();return Q.getAbsoluteUrl(t,st())}initializeServerTelemetryManager(e,t){this.logger.verbose("initializeServerTelemetryManager called");let n={clientId:this.config.auth.clientId,correlationId:this.correlationId,apiId:e,forceRefresh:t||!1,wrapperSKU:this.browserStorage.getWrapperMetadata()[0],wrapperVer:this.browserStorage.getWrapperMetadata()[1]};return new Zr(n,this.browserStorage)}getDiscoveredAuthority(e,t,n){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientGetDiscoveredAuthority,this.correlationId);let i={protocolMode:this.config.auth.protocolMode,OIDCOptions:this.config.auth.OIDCOptions,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},o=e||this.config.auth.authority,a=It.generateAuthority(o,t||this.config.auth.azureCloudOptions),s=yield E(ks.createDiscoveredInstance,d.AuthorityFactoryCreateDiscoveredInstance,this.logger,this.performanceClient,this.correlationId)(a,this.config.system.networkClient,this.browserStorage,i,this.logger,this.correlationId,this.performanceClient);if(n&&!s.isAlias(n.environment))throw ie(Gt.authorityMismatch);return s})}};var Av=32;function Fm(r,e,t){return h(this,null,function*(){r.addQueueMeasurement(d.GeneratePkceCodes,t);let n=Ze(Iv,d.GenerateCodeVerifier,e,r,t)(r,e,t),i=yield E(kv,d.GenerateCodeChallengeFromVerifier,e,r,t)(n,r,e,t);return{verifier:n,challenge:i}})}function Iv(r,e,t){try{let n=new Uint8Array(Av);return Ze(Cm,d.GetRandomValues,e,r,t)(n),ri(n)}catch{throw I(ei)}}function kv(r,e,t,n){return h(this,null,function*(){e.addQueueMeasurement(d.GenerateCodeChallengeFromVerifier,n);try{let i=yield E(Md,d.Sha256Digest,t,e,n)(r,e,n);return ri(new Uint8Array(i))}catch{throw I(ei)}})}function ba(r,e,t,n){return h(this,null,function*(){t.addQueueMeasurement(d.InitializeBaseRequest,r.correlationId);let i=r.authority||e.auth.authority,o=[...r&&r.scopes||[]],a=z(_({},r),{correlationId:r.correlationId,authority:i,scopes:o});if(!a.authenticationScheme)a.authenticationScheme=ne.BEARER,n.verbose(`Authentication Scheme wasn't explicitly set in request, defaulting to "Bearer" request`);else{if(a.authenticationScheme===ne.SSH){if(!r.sshJwk)throw ie(Gt.missingSshJwk);if(!r.sshKid)throw ie(Gt.missingSshKid)}n.verbose(`Authentication Scheme set to "${a.authenticationScheme}" as configured in Auth request`)}return e.cache.claimsBasedCachingEnabled&&r.claims&&!_e.isEmptyObj(r.claims)&&(a.requestedClaimsHash=yield Xs(r.claims)),a})}function Um(r,e,t,n,i){return h(this,null,function*(){n.addQueueMeasurement(d.InitializeSilentRequest,r.correlationId);let o=yield E(ba,d.InitializeBaseRequest,i,n,r.correlationId)(r,t,n,i);return z(_(_({},r),o),{account:e,forceRefresh:r.forceRefresh||!1})})}var lt=class extends lo{initializeAuthorizationCodeRequest(e){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.correlationId);let t=yield E(Fm,d.GeneratePkceCodes,this.logger,this.performanceClient,this.correlationId)(this.performanceClient,this.logger,this.correlationId),n=z(_({},e),{redirectUri:e.redirectUri,code:p.EMPTY_STRING,codeVerifier:t.verifier});return e.codeChallenge=t.challenge,e.codeChallengeMethod=p.S256_CODE_CHALLENGE_METHOD,n})}initializeLogoutRequest(e){this.logger.verbose("initializeLogoutRequest called",e?.correlationId);let t=_({correlationId:this.correlationId||Be()},e);if(e)if(e.logoutHint)this.logger.verbose("logoutHint has already been set in logoutRequest");else if(e.account){let n=this.getLogoutHintFromIdTokenClaims(e.account);n&&(this.logger.verbose("Setting logoutHint to login_hint ID Token Claim value for the account provided"),t.logoutHint=n)}else this.logger.verbose("logoutHint was not set and account was not passed into logout request, logoutHint will not be set");else this.logger.verbose("logoutHint will not be set since no logout request was configured");return!e||e.postLogoutRedirectUri!==null?e&&e.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to uri set on logout request",t.correlationId),t.postLogoutRedirectUri=Q.getAbsoluteUrl(e.postLogoutRedirectUri,st())):this.config.auth.postLogoutRedirectUri===null?this.logger.verbose("postLogoutRedirectUri configured as null and no uri set on request, not passing post logout redirect",t.correlationId):this.config.auth.postLogoutRedirectUri?(this.logger.verbose("Setting postLogoutRedirectUri to configured uri",t.correlationId),t.postLogoutRedirectUri=Q.getAbsoluteUrl(this.config.auth.postLogoutRedirectUri,st())):(this.logger.verbose("Setting postLogoutRedirectUri to current page",t.correlationId),t.postLogoutRedirectUri=Q.getAbsoluteUrl(st(),st())):this.logger.verbose("postLogoutRedirectUri passed as null, not setting post logout redirect uri",t.correlationId),t}getLogoutHintFromIdTokenClaims(e){let t=e.idTokenClaims;if(t){if(t.login_hint)return t.login_hint;this.logger.verbose("The ID Token Claims tied to the provided account do not contain a login_hint claim, logoutHint will not be added to logout request")}else this.logger.verbose("The provided account does not contain ID Token Claims, logoutHint will not be added to logout request");return null}createAuthCodeClient(e,t,n,i){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientCreateAuthCodeClient,this.correlationId);let o=yield E(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,n,i);return new Jr(o,this.performanceClient)})}getClientConfiguration(e,t,n,i){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientGetClientConfiguration,this.correlationId);let o=yield E(this.getDiscoveredAuthority.bind(this),d.StandardInteractionClientGetDiscoveredAuthority,this.logger,this.performanceClient,this.correlationId)(t,n,i),a=this.config.system.loggerOptions;return{authOptions:{clientId:this.config.auth.clientId,authority:o,clientCapabilities:this.config.auth.clientCapabilities},systemOptions:{tokenRenewalOffsetSeconds:this.config.system.tokenRenewalOffsetSeconds,preventCorsPreflight:!0},loggerOptions:{loggerCallback:a.loggerCallback,piiLoggingEnabled:a.piiLoggingEnabled,logLevel:a.logLevel,correlationId:this.correlationId},cacheOptions:{claimsBasedCachingEnabled:this.config.cache.claimsBasedCachingEnabled},cryptoInterface:this.browserCrypto,networkInterface:this.networkClient,storageInterface:this.browserStorage,serverTelemetryManager:e,libraryInfo:{sku:Ee.MSAL_SKU,version:lr,cpu:p.EMPTY_STRING,os:p.EMPTY_STRING},telemetry:this.config.telemetry}})}initializeAuthorizationRequest(e,t){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.StandardInteractionClientInitializeAuthorizationRequest,this.correlationId);let n=this.getRedirectUri(e.redirectUri),i={interactionType:t},o=He.setRequestState(this.browserCrypto,e&&e.state||p.EMPTY_STRING,i),a=yield E(ba,d.InitializeBaseRequest,this.logger,this.performanceClient,this.correlationId)(z(_({},e),{correlationId:this.correlationId}),this.config,this.performanceClient,this.logger),s=z(_({},a),{redirectUri:n,state:o,nonce:e.nonce||Be(),responseMode:this.config.auth.OIDCOptions.serverResponseType}),c=e.account||this.browserStorage.getActiveAccount();if(c&&(this.logger.verbose("Setting validated request account",this.correlationId),this.logger.verbosePii(`Setting validated request account: ${c.homeAccountId}`,this.correlationId),s.account=c),!s.loginHint&&!c){let l=this.browserStorage.getLegacyLoginHint();l&&(s.loginHint=l)}return s})}};var Bm="ContentError",hc="user_switch";var Vm="USER_INTERACTION_REQUIRED",Km="USER_CANCEL",zm="NO_NETWORK",qm="PERSISTENT_ERROR",Wm="DISABLED",Gm="ACCOUNT_UNAVAILABLE";var bv=-2147186943,Rv={[hc]:"User attempted to switch accounts in the native broker, which is not allowed. All new accounts must sign-in through the standard web flow first, please try again."},Rt=class r extends re{constructor(e,t,n){super(e,t),Object.setPrototypeOf(this,r.prototype),this.name="NativeAuthError",this.ext=n}};function dr(r){if(r.ext&&r.ext.status&&(r.ext.status===qm||r.ext.status===Wm)||r.ext&&r.ext.error&&r.ext.error===bv)return!0;switch(r.errorCode){case Bm:return!0;default:return!1}}function Ra(r,e,t){if(t&&t.status)switch(t.status){case Gm:return Ri(En.nativeAccountUnavailable);case Vm:return new We(r,e);case Km:return I(at);case zm:return I(Sn)}return new Rt(r,Rv[r]||e,t)}var uo=class extends lt{acquireToken(e){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.SilentCacheClientAcquireToken,e.correlationId);let t=this.initializeServerTelemetryManager(ce.acquireTokenSilent_silentFlow),n=yield E(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(t,e.authority,e.azureCloudOptions,e.account),i=new va(n,this.performanceClient);this.logger.verbose("Silent auth client created");try{let a=(yield E(i.acquireCachedToken.bind(i),d.SilentFlowClientAcquireCachedToken,this.logger,this.performanceClient,e.correlationId)(e))[0];return this.performanceClient.addFields({fromCache:!0},e.correlationId),a}catch(o){throw o instanceof ni&&o.errorCode===ar&&this.logger.verbose("Signing keypair for bound access token not found. Refreshing bound access token and generating a new crypto keypair."),o}})}logout(e){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e);return this.clearCacheOnLogout(t?.account)}};var xd={BROKER_CLIENT_ID:"brk_client_id",BROKER_REDIRECT_URI:"brk_redirect_uri"},Dt=class extends lo{constructor(e,t,n,i,o,a,s,c,l,u,m,v){super(e,t,n,i,o,a,c,l,v),this.apiId=s,this.accountId=u,this.nativeMessageHandler=l,this.nativeStorageManager=m,this.silentCacheClient=new uo(e,this.nativeStorageManager,n,i,o,a,c,l,v),this.serverTelemetryManager=this.initializeServerTelemetryManager(this.apiId);let g=this.nativeMessageHandler.getExtensionId()===cr.PREFERRED_EXTENSION_ID?"chrome":this.nativeMessageHandler.getExtensionId()?.length?"unknown":void 0;this.skus=Zr.makeExtraSkuString({libraryName:Ee.MSAL_SKU,libraryVersion:lr,extensionName:g,extensionVersion:this.nativeMessageHandler.getExtensionVersion()})}addRequestSKUs(e){e.extraParameters=z(_({},e.extraParameters),{[Si.X_CLIENT_EXTRA_SKU]:this.skus})}acquireToken(e){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.NativeInteractionClientAcquireToken,e.correlationId),this.logger.trace("NativeInteractionClient - acquireToken called.");let t=this.performanceClient.startMeasurement(d.NativeInteractionClientAcquireToken,e.correlationId),n=da.nowSeconds();try{let i=yield this.initializeNativeRequest(e);try{let l=yield this.acquireTokensFromCache(this.accountId,i);return t.end({success:!0,isNativeBroker:!1,fromCache:!0}),l}catch{this.logger.info("MSAL internal Cache does not contain tokens, proceed to make a native call")}let o=vt(i,[]),a={method:In.GetToken,request:o},s=yield this.nativeMessageHandler.sendMessage(a),c=this.validateNativeResponse(s);return yield this.handleNativeResponse(c,i,n).then(l=>(t.end({success:!0,isNativeBroker:!0,requestId:l.requestId}),this.serverTelemetryManager.clearNativeBrokerErrorCode(),l)).catch(l=>{throw t.end({success:!1,errorCode:l.errorCode,subErrorCode:l.subError,isNativeBroker:!0}),l})}catch(i){throw i instanceof Rt&&this.serverTelemetryManager.setNativeBrokerErrorCode(i.errorCode),i}})}createSilentCacheRequest(e,t){return{authority:e.authority,correlationId:this.correlationId,scopes:ve.fromString(e.scope).asArray(),account:t,forceRefresh:!1}}acquireTokensFromCache(e,t){return h(this,null,function*(){if(!e)throw this.logger.warning("NativeInteractionClient:acquireTokensFromCache - No nativeAccountId provided"),T(xe.noAccountFound);let n=this.browserStorage.getBaseAccountInfo({nativeAccountId:e});if(!n)throw T(xe.noAccountFound);try{let i=this.createSilentCacheRequest(t,n),o=yield this.silentCacheClient.acquireToken(i),a=z(_({},n),{idTokenClaims:o?.idTokenClaims,idToken:o?.idToken});return z(_({},o),{account:a})}catch(i){throw i}})}acquireTokenRedirect(e,t){return h(this,null,function*(){this.logger.trace("NativeInteractionClient - acquireTokenRedirect called.");let n=vt(e,[]);delete n.onRedirectNavigate;let i=yield this.initializeNativeRequest(n),o={method:In.GetToken,request:i};try{let c=yield this.nativeMessageHandler.sendMessage(o);this.validateNativeResponse(c)}catch(c){if(c instanceof Rt&&(this.serverTelemetryManager.setNativeBrokerErrorCode(c.errorCode),dr(c)))throw c}this.browserStorage.setTemporaryCache(ee.NATIVE_REQUEST,JSON.stringify(i),!0);let a={apiId:ce.acquireTokenRedirect,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},s=this.config.auth.navigateToLoginRequestUrl?window.location.href:this.getRedirectUri(e.redirectUri);t.end({success:!0}),yield this.navigationClient.navigateExternal(s,a)})}handleRedirectPromise(e,t){return h(this,null,function*(){if(this.logger.trace("NativeInteractionClient - handleRedirectPromise called."),!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let n=this.browserStorage.getCachedNativeRequest();if(!n)return this.logger.verbose("NativeInteractionClient - handleRedirectPromise called but there is no cached request, returning null."),e&&t&&e?.addFields({errorCode:"no_cached_request"},t),null;let c=n,{prompt:i}=c,o=vt(c,["prompt"]);i&&this.logger.verbose("NativeInteractionClient - handleRedirectPromise called and prompt was included in the original request, removing prompt from cached request to prevent second interaction with native broker window."),this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ee.NATIVE_REQUEST));let a={method:In.GetToken,request:o},s=da.nowSeconds();try{this.logger.verbose("NativeInteractionClient - handleRedirectPromise sending message to native broker.");let l=yield this.nativeMessageHandler.sendMessage(a);this.validateNativeResponse(l);let u=this.handleNativeResponse(l,o,s);this.browserStorage.setInteractionInProgress(!1);let m=yield u;return this.serverTelemetryManager.clearNativeBrokerErrorCode(),m}catch(l){throw this.browserStorage.setInteractionInProgress(!1),l}})}logout(){return this.logger.trace("NativeInteractionClient - logout called."),Promise.reject("Logout not implemented yet")}handleNativeResponse(e,t,n){return h(this,null,function*(){this.logger.trace("NativeInteractionClient - handleNativeResponse called.");let i=$n.extractTokenClaims(e.id_token,ct),o=this.createHomeAccountIdentifier(e,i),a=this.browserStorage.getAccountInfoFilteredBy({nativeAccountId:t.accountId})?.homeAccountId;if(o!==a&&e.account.id!==t.accountId)throw Ra(hc);let s=yield this.getDiscoveredAuthority(t.authority),c=Di(this.browserStorage,s,o,ct,i,e.client_info,void 0,i.tid,void 0,e.account.id,this.logger),l=yield this.generateAuthenticationResult(e,t,i,c,s.canonicalAuthority,n);return this.cacheAccount(c),this.cacheNativeTokens(e,t,o,i,e.access_token,l.tenantId,n),l})}createHomeAccountIdentifier(e,t){return pe.generateHomeAccountId(e.client_info||p.EMPTY_STRING,Je.Default,this.logger,this.browserCrypto,t)}generateScopes(e,t){return e.scope?ve.fromString(e.scope):ve.fromString(t.scope)}generatePopAccessToken(e,t){return h(this,null,function*(){if(t.tokenType===ne.POP&&t.signPopToken){if(e.shr)return this.logger.trace("handleNativeServerResponse: SHR is enabled in native layer"),e.shr;let n=new ft(this.browserCrypto),i={resourceRequestMethod:t.resourceRequestMethod,resourceRequestUri:t.resourceRequestUri,shrClaims:t.shrClaims,shrNonce:t.shrNonce};if(!t.keyId)throw T(xe.keyIdMissing);return n.signPopToken(e.access_token,t.keyId,i)}else return e.access_token})}generateAuthenticationResult(e,t,n,i,o,a){return h(this,null,function*(){let s=this.addTelemetryFromNativeResponse(e),c=e.scope?ve.fromString(e.scope):ve.fromString(t.scope),l=e.account.properties||{},u=l.UID||n.oid||n.sub||p.EMPTY_STRING,m=l.TenantId||n.tid||p.EMPTY_STRING,v=Xr(i.getAccountInfo(),void 0,n,e.id_token);v.nativeAccountId!==e.account.id&&(v.nativeAccountId=e.account.id);let g=yield this.generatePopAccessToken(e,t),A=t.tokenType===ne.POP?ne.POP:ne.BEARER;return{authority:o,uniqueId:u,tenantId:m,scopes:c.asArray(),account:v,idToken:e.id_token,idTokenClaims:n,accessToken:g,fromCache:s?this.isResponseFromCache(s):!1,expiresOn:new Date(Number(a+e.expires_in)*1e3),tokenType:A,correlationId:this.correlationId,state:e.state,fromNativeBroker:!0}})}cacheAccount(e){this.browserStorage.setAccount(e),this.browserStorage.removeAccountContext(e).catch(t=>{this.logger.error(`Error occurred while removing account context from browser storage. ${t}`)})}cacheNativeTokens(e,t,n,i,o,a,s){let c=me.createIdTokenEntity(n,t.authority,e.id_token||"",t.clientId,i.tid||""),l=t.tokenType===ne.POP?p.SHR_NONCE_VALIDITY:(typeof e.expires_in=="string"?parseInt(e.expires_in,10):e.expires_in)||0,u=s+l,m=this.generateScopes(e,t),v=me.createAccessTokenEntity(n,t.authority,o,t.clientId,i.tid||a,m.printScopes(),u,0,ct,void 0,t.tokenType,void 0,t.keyId),g={idToken:c,accessToken:v};this.nativeStorageManager.saveCacheRecord(g,t.storeInCache)}addTelemetryFromNativeResponse(e){let t=this.getMATSFromResponse(e);return t?(this.performanceClient.addFields({extensionId:this.nativeMessageHandler.getExtensionId(),extensionVersion:this.nativeMessageHandler.getExtensionVersion(),matsBrokerVersion:t.broker_version,matsAccountJoinOnStart:t.account_join_on_start,matsAccountJoinOnEnd:t.account_join_on_end,matsDeviceJoin:t.device_join,matsPromptBehavior:t.prompt_behavior,matsApiErrorCode:t.api_error_code,matsUiVisible:t.ui_visible,matsSilentCode:t.silent_code,matsSilentBiSubCode:t.silent_bi_sub_code,matsSilentMessage:t.silent_message,matsSilentStatus:t.silent_status,matsHttpStatus:t.http_status,matsHttpEventCount:t.http_event_count},this.correlationId),t):null}validateNativeResponse(e){if(e.hasOwnProperty("access_token")&&e.hasOwnProperty("id_token")&&e.hasOwnProperty("client_info")&&e.hasOwnProperty("account")&&e.hasOwnProperty("scope")&&e.hasOwnProperty("expires_in"))return e;throw Uo(wr.unexpectedError,"Response missing expected properties.")}getMATSFromResponse(e){if(e.properties.MATS)try{return JSON.parse(e.properties.MATS)}catch{this.logger.error("NativeInteractionClient - Error parsing MATS telemetry, returning null instead")}return null}isResponseFromCache(e){return typeof e.is_cached>"u"?(this.logger.verbose("NativeInteractionClient - MATS telemetry does not contain field indicating if response was served from cache. Returning false."),!1):!!e.is_cached}initializeNativeRequest(e){return h(this,null,function*(){this.logger.trace("NativeInteractionClient - initializeNativeRequest called");let t=e.authority||this.config.auth.authority;e.account&&(yield this.getDiscoveredAuthority(t,e.azureCloudOptions,e.account));let n=new Q(t);n.validateAsUri();let l=e,{scopes:i}=l,o=vt(l,["scopes"]),a=new ve(i||[]);a.appendScopes(pt);let s=()=>{switch(this.apiId){case ce.ssoSilent:case ce.acquireTokenSilent_silentFlow:return this.logger.trace("initializeNativeRequest: silent request sets prompt to none"),Ce.NONE}if(!e.prompt){this.logger.trace("initializeNativeRequest: prompt was not provided");return}switch(e.prompt){case Ce.NONE:case Ce.CONSENT:case Ce.LOGIN:return this.logger.trace("initializeNativeRequest: prompt is compatible with native flow"),e.prompt;default:throw this.logger.trace(`initializeNativeRequest: prompt = ${e.prompt} is not compatible with native flow`),I(ro)}},c=z(_({},o),{accountId:this.accountId,clientId:this.config.auth.clientId,authority:n.urlString,scope:a.printScopes(),redirectUri:this.getRedirectUri(e.redirectUri),prompt:s(),correlationId:this.correlationId,tokenType:e.authenticationScheme,windowTitleSubstring:document.title,extraParameters:_(_({},e.extraQueryParameters),e.tokenQueryParameters),extendedExpiryToken:!1,keyId:e.popKid});if(c.signPopToken&&e.popKid)throw I(oo);if(this.handleExtraBrokerParams(c),c.extraParameters=c.extraParameters||{},c.extraParameters.telemetry=cr.MATS_TELEMETRY,e.authenticationScheme===ne.POP){let u={resourceRequestUri:e.resourceRequestUri,resourceRequestMethod:e.resourceRequestMethod,shrClaims:e.shrClaims,shrNonce:e.shrNonce},m=new ft(this.browserCrypto),v;if(c.keyId)v=this.browserCrypto.base64UrlEncode(JSON.stringify({kid:c.keyId})),c.signPopToken=!1;else{let g=yield E(m.generateCnf.bind(m),d.PopTokenGenerateCnf,this.logger,this.performanceClient,e.correlationId)(u,this.logger);v=g.reqCnfString,c.keyId=g.kid,c.signPopToken=!0}c.reqCnf=v}return this.addRequestSKUs(c),c})}handleExtraBrokerParams(e){if(e.extraParameters&&e.extraParameters.hasOwnProperty(xd.BROKER_CLIENT_ID)&&e.extraParameters.hasOwnProperty(xd.BROKER_REDIRECT_URI)&&e.extraParameters.hasOwnProperty(Si.CLIENT_ID)){let t=e.extraParameters[Si.CLIENT_ID],n=e.redirectUri,i=e.extraParameters[xd.BROKER_REDIRECT_URI];e.extraParameters={child_client_id:t,child_redirect_uri:n},e.redirectUri=i}}};var Ct=class r{constructor(e,t,n,i){this.logger=e,this.handshakeTimeoutMs=t,this.extensionId=i,this.resolvers=new Map,this.handshakeResolvers=new Map,this.messageChannel=new MessageChannel,this.windowListener=this.onWindowMessage.bind(this),this.performanceClient=n,this.handshakeEvent=n.startMeasurement(d.NativeMessageHandlerHandshake)}sendMessage(e){return h(this,null,function*(){this.logger.trace("NativeMessageHandler - sendMessage called.");let t={channel:cr.CHANNEL_ID,extensionId:this.extensionId,responseId:Be(),body:e};return this.logger.trace("NativeMessageHandler - Sending request to browser extension"),this.logger.tracePii(`NativeMessageHandler - Sending request to browser extension: ${JSON.stringify(t)}`),this.messageChannel.port1.postMessage(t),new Promise((n,i)=>{this.resolvers.set(t.responseId,{resolve:n,reject:i})})})}static createProvider(e,t,n){return h(this,null,function*(){e.trace("NativeMessageHandler - createProvider called.");try{let i=new r(e,t,n,cr.PREFERRED_EXTENSION_ID);return yield i.sendHandshakeRequest(),i}catch{let o=new r(e,t,n);return yield o.sendHandshakeRequest(),o}})}sendHandshakeRequest(){return h(this,null,function*(){this.logger.trace("NativeMessageHandler - sendHandshakeRequest called."),window.addEventListener("message",this.windowListener,!1);let e={channel:cr.CHANNEL_ID,extensionId:this.extensionId,responseId:Be(),body:{method:In.HandshakeRequest}};return this.handshakeEvent.add({extensionId:this.extensionId,extensionHandshakeTimeoutMs:this.handshakeTimeoutMs}),this.messageChannel.port1.onmessage=t=>{this.onChannelMessage(t)},window.postMessage(e,window.origin,[this.messageChannel.port2]),new Promise((t,n)=>{this.handshakeResolvers.set(e.responseId,{resolve:t,reject:n}),this.timeoutId=window.setTimeout(()=>{window.removeEventListener("message",this.windowListener,!1),this.messageChannel.port1.close(),this.messageChannel.port2.close(),this.handshakeEvent.end({extensionHandshakeTimedOut:!0,success:!1}),n(I(eo)),this.handshakeResolvers.delete(e.responseId)},this.handshakeTimeoutMs)})})}onWindowMessage(e){if(this.logger.trace("NativeMessageHandler - onWindowMessage called"),e.source!==window)return;let t=e.data;if(!(!t.channel||t.channel!==cr.CHANNEL_ID)&&!(t.extensionId&&t.extensionId!==this.extensionId)&&t.body.method===In.HandshakeRequest){let n=this.handshakeResolvers.get(t.responseId);if(!n){this.logger.trace(`NativeMessageHandler.onWindowMessage - resolver can't be found for request ${t.responseId}`);return}this.logger.verbose(t.extensionId?`Extension with id: ${t.extensionId} not installed`:"No extension installed"),clearTimeout(this.timeoutId),this.messageChannel.port1.close(),this.messageChannel.port2.close(),window.removeEventListener("message",this.windowListener,!1),this.handshakeEvent.end({success:!1,extensionInstalled:!1}),n.reject(I(to))}}onChannelMessage(e){this.logger.trace("NativeMessageHandler - onChannelMessage called.");let t=e.data,n=this.resolvers.get(t.responseId),i=this.handshakeResolvers.get(t.responseId);try{let o=t.body.method;if(o===In.Response){if(!n)return;let a=t.body.response;if(this.logger.trace("NativeMessageHandler - Received response from browser extension"),this.logger.tracePii(`NativeMessageHandler - Received response from browser extension: ${JSON.stringify(a)}`),a.status!=="Success")n.reject(Ra(a.code,a.description,a.ext));else if(a.result)a.result.code&&a.result.description?n.reject(Ra(a.result.code,a.result.description,a.result.ext)):n.resolve(a.result);else throw Uo(wr.unexpectedError,"Event does not contain result.");this.resolvers.delete(t.responseId)}else if(o===In.HandshakeResponse){if(!i){this.logger.trace(`NativeMessageHandler.onChannelMessage - resolver can't be found for request ${t.responseId}`);return}clearTimeout(this.timeoutId),window.removeEventListener("message",this.windowListener,!1),this.extensionId=t.extensionId,this.extensionVersion=t.body.version,this.logger.verbose(`NativeMessageHandler - Received HandshakeResponse from extension: ${this.extensionId}`),this.handshakeEvent.end({extensionInstalled:!0,success:!0}),i.resolve(),this.handshakeResolvers.delete(t.responseId)}}catch(o){this.logger.error("Error parsing response from WAM Extension"),this.logger.errorPii(`Error parsing response from WAM Extension: ${o}`),this.logger.errorPii(`Unable to parse ${e}`),n?n.reject(o):i&&i.reject(o)}}getExtensionId(){return this.extensionId}getExtensionVersion(){return this.extensionVersion}static isNativeAvailable(e,t,n,i){if(t.trace("isNativeAvailable called"),!e.system.allowNativeBroker)return t.trace("isNativeAvailable: allowNativeBroker is not enabled, returning false"),!1;if(!n)return t.trace("isNativeAvailable: WAM extension provider is not initialized, returning false"),!1;if(i)switch(i){case ne.BEARER:case ne.POP:return t.trace("isNativeAvailable: authenticationScheme is supported, returning true"),!0;default:return t.trace("isNativeAvailable: authenticationScheme is not supported, returning false"),!1}return!0}};var ur=class{constructor(e,t,n,i,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=i,this.performanceClient=o}handleCodeResponse(e,t){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.HandleCodeResponse,t.correlationId);let n;try{n=this.authModule.handleFragmentResponse(e,t.state)}catch(i){throw i instanceof Re&&i.subError===at?I(at):i}return E(this.handleCodeResponseFromServer.bind(this),d.HandleCodeResponseFromServer,this.logger,this.performanceClient,t.correlationId)(n,t)})}handleCodeResponseFromServer(e,t,n=!0){return h(this,null,function*(){if(this.performanceClient.addQueueMeasurement(d.HandleCodeResponseFromServer,t.correlationId),this.logger.trace("InteractionHandler.handleCodeResponseFromServer called"),this.authCodeRequest.code=e.code,e.cloud_instance_host_name&&(yield E(this.authModule.updateAuthority.bind(this.authModule),d.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,t.correlationId)(e.cloud_instance_host_name,t.correlationId)),n&&(e.nonce=t.nonce||void 0),e.state=t.state,e.client_info)this.authCodeRequest.clientInfo=e.client_info;else{let o=this.createCcsCredentials(t);o&&(this.authCodeRequest.ccsCredential=o)}return yield E(this.authModule.acquireToken.bind(this.authModule),d.AuthClientAcquireToken,this.logger,this.performanceClient,t.correlationId)(this.authCodeRequest,e)})}createCcsCredentials(e){return e.account?{credential:e.account.homeAccountId,type:Le.HOME_ACCOUNT_ID}:e.loginHint?{credential:e.loginHint,type:Le.UPN}:null}};function mc(r,e,t){let n=jn.getDeserializedResponse(r);if(!n)throw jn.stripLeadingHashOrQuery(r)?(t.error(`A ${e} is present in the iframe but it does not contain known properties. It's likely that the ${e} has been replaced by code running on the redirectUri page.`),t.errorPii(`The ${e} detected is: ${r}`),I(Ni)):(t.error(`The request has returned to the redirectUri but a ${e} is not present. It's likely that the ${e} has been removed or the page has been redirected by code running on the redirectUri page.`),I(Pi));return n}function $m(r,e,t){if(!r.state)throw I(rr);let n=dc(e,r.state);if(!n)throw I(xi);if(n.interactionType!==t)throw I(Li)}var pc=class extends lt{constructor(e,t,n,i,o,a,s,c,l,u){super(e,t,n,i,o,a,s,l,u),this.unloadWindow=this.unloadWindow.bind(this),this.nativeStorage=c}acquireToken(e){try{let t=this.generatePopupName(e.scopes||pt,e.authority||this.config.auth.authority),n=e.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true, acquiring token"),this.acquireTokenPopupAsync(e,t,n);{this.logger.verbose("asyncPopup set to false, opening popup before acquiring token");let i=this.openSizedPopup("about:blank",t,n);return this.acquireTokenPopupAsync(e,t,n,i)}}catch(t){return Promise.reject(t)}}logout(e){try{this.logger.verbose("logoutPopup called");let t=this.initializeLogoutRequest(e),n=this.generateLogoutPopupName(t),i=e&&e.authority,o=e&&e.mainWindowRedirectUri,a=e?.popupWindowAttributes||{};if(this.config.system.asyncPopups)return this.logger.verbose("asyncPopups set to true"),this.logoutPopupAsync(t,n,a,i,void 0,o);{this.logger.verbose("asyncPopup set to false, opening popup");let s=this.openSizedPopup("about:blank",n,a);return this.logoutPopupAsync(t,n,a,i,s,o)}}catch(t){return Promise.reject(t)}}acquireTokenPopupAsync(e,t,n,i){return h(this,null,function*(){this.logger.verbose("acquireTokenPopupAsync called");let o=this.initializeServerTelemetryManager(ce.acquireTokenPopup),a=yield E(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,D.Popup);Aa(a.authority);let s;try{let c=yield E(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(a);return s=yield E(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(o,a.authority,a.azureCloudOptions,a.account),yield E(this.acquireTokenPopupAsyncHelper.bind(this),d.PopupClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(s,c,a,e,t,n,i)}catch(c){if(i&&i.close(),c instanceof re&&(c.setCorrelationId(this.correlationId),o.cacheFailedRequest(c)),!s||!(c instanceof Re)||c.errorCode!==Ee.INVALID_GRANT_ERROR)throw c;this.performanceClient.addFields({retryError:c.errorCode},this.correlationId);let l=yield E(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(a);return yield E(this.acquireTokenPopupAsyncHelper.bind(this),d.PopupClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(s,l,a,e,t,n,i)}})}acquireTokenPopupAsyncHelper(e,t,n,i,o,a,s){return h(this,null,function*(){let c=n.correlationId;this.performanceClient.addQueueMeasurement(d.PopupClientTokenHelper,c);let l=Ct.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,i.authenticationScheme),u;l&&(u=this.performanceClient.startMeasurement(d.FetchAccountIdWithNativeBroker,i.correlationId));let m=yield e.getAuthCodeUrl(z(_({},n),{nativeBroker:l})),v=new ur(e,this.browserStorage,t,this.logger,this.performanceClient),g={popup:s,popupName:o,popupWindowAttributes:a},A=this.initiateAuthRequest(m,g);this.eventHandler.emitEvent(H.POPUP_OPENED,D.Popup,{popupWindow:A},null);let k=yield this.monitorPopupForHash(A),M=Ze(mc,d.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(k,this.config.auth.OIDCOptions.serverResponseType,this.logger);if(Jt.removeThrottle(this.browserStorage,this.config.auth.clientId,t),M.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),u&&u.end({success:!0,isNativeBroker:!0}),!this.nativeMessageHandler)throw I(bt);let W=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ce.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,M.accountId,this.nativeStorage,n.correlationId),{userRequestState:V}=He.parseRequestState(this.browserCrypto,n.state);return W.acquireToken(z(_({},n),{state:V,prompt:void 0}))}return yield v.handleCodeResponse(M,n)})}logoutPopupAsync(e,t,n,i,o,a){return h(this,null,function*(){this.logger.verbose("logoutPopupAsync called"),this.eventHandler.emitEvent(H.LOGOUT_START,D.Popup,e);let s=this.initializeServerTelemetryManager(ce.logoutPopup);try{yield this.clearCacheOnLogout(e.account);let c=yield E(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(s,i,void 0,e.account||void 0);try{c.authority.endSessionEndpoint}catch{if(e.account?.homeAccountId&&e.postLogoutRedirectUri&&c.authority.protocolMode===qe.OIDC){if(this.browserStorage.removeAccount(e.account?.homeAccountId),this.eventHandler.emitEvent(H.LOGOUT_SUCCESS,D.Popup,e),a){let m={apiId:ce.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=Q.getAbsoluteUrl(a,st());yield this.navigationClient.navigateInternal(v,m)}o&&o.close();return}}let l=c.getLogoutUri(e);this.eventHandler.emitEvent(H.LOGOUT_SUCCESS,D.Popup,e);let u=this.openPopup(l,{popupName:t,popupWindowAttributes:n,popup:o});if(this.eventHandler.emitEvent(H.POPUP_OPENED,D.Popup,{popupWindow:u},null),yield this.monitorPopupForHash(u).catch(()=>{}),a){let m={apiId:ce.logoutPopup,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},v=Q.getAbsoluteUrl(a,st());this.logger.verbose("Redirecting main window to url specified in the request"),this.logger.verbosePii(`Redirecting main window to: ${v}`),yield this.navigationClient.navigateInternal(v,m)}else this.logger.verbose("No main window navigation requested")}catch(c){throw o&&o.close(),c instanceof re&&(c.setCorrelationId(this.correlationId),s.cacheFailedRequest(c)),this.browserStorage.setInteractionInProgress(!1),this.eventHandler.emitEvent(H.LOGOUT_FAILURE,D.Popup,null,c),this.eventHandler.emitEvent(H.LOGOUT_END,D.Popup),c}this.eventHandler.emitEvent(H.LOGOUT_END,D.Popup)})}initiateAuthRequest(e,t){if(e)return this.logger.infoPii(`Navigate to: ${e}`),this.openPopup(e,t);throw this.logger.error("Navigate url is empty"),I(nn)}monitorPopupForHash(e){return new Promise((t,n)=>{this.logger.verbose("PopupHandler.monitorPopupForHash - polling started");let i=setInterval(()=>{if(e.closed){this.logger.error("PopupHandler.monitorPopupForHash - window closed"),clearInterval(i),n(I(at));return}let o="";try{o=e.location.href}catch{}if(!o||o==="about:blank")return;clearInterval(i);let a="",s=this.config.auth.OIDCOptions.serverResponseType;e&&(s===zt.QUERY?a=e.location.search:a=e.location.hash),this.logger.verbose("PopupHandler.monitorPopupForHash - popup window is on same origin as caller"),t(a)},this.config.system.pollIntervalMilliseconds)}).finally(()=>{this.cleanPopup(e)})}openPopup(e,t){try{let n;if(t.popup?(n=t.popup,this.logger.verbosePii(`Navigating popup window to: ${e}`),n.location.assign(e)):typeof t.popup>"u"&&(this.logger.verbosePii(`Opening popup window to: ${e}`),n=this.openSizedPopup(e,t.popupName,t.popupWindowAttributes)),!n)throw I(Ui);return n.focus&&n.focus(),this.currentWindow=n,window.addEventListener("beforeunload",this.unloadWindow),n}catch(n){throw this.logger.error("error opening popup "+n.message),this.browserStorage.setInteractionInProgress(!1),I(Fi)}}openSizedPopup(e,t,n){let i=window.screenLeft?window.screenLeft:window.screenX,o=window.screenTop?window.screenTop:window.screenY,a=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,s=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,c=n.popupSize?.width,l=n.popupSize?.height,u=n.popupPosition?.top,m=n.popupPosition?.left;return(!c||c<0||c>a)&&(this.logger.verbose("Default popup window width used. Window width not configured or invalid."),c=Ee.POPUP_WIDTH),(!l||l<0||l>s)&&(this.logger.verbose("Default popup window height used. Window height not configured or invalid."),l=Ee.POPUP_HEIGHT),(!u||u<0||u>s)&&(this.logger.verbose("Default popup window top position used. Window top not configured or invalid."),u=Math.max(0,s/2-Ee.POPUP_HEIGHT/2+o)),(!m||m<0||m>a)&&(this.logger.verbose("Default popup window left position used. Window left not configured or invalid."),m=Math.max(0,a/2-Ee.POPUP_WIDTH/2+i)),window.open(e,t,`width=${c}, height=${l}, top=${u}, left=${m}, scrollbars=yes`)}unloadWindow(e){this.browserStorage.cleanRequestByInteractionType(D.Popup),this.currentWindow&&this.currentWindow.close(),e.preventDefault()}cleanPopup(e){e&&e.close(),window.removeEventListener("beforeunload",this.unloadWindow),this.browserStorage.setInteractionInProgress(!1)}generatePopupName(e,t){return`${Ee.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${e.join("-")}.${t}.${this.correlationId}`}generateLogoutPopupName(e){let t=e.account&&e.account.homeAccountId;return`${Ee.POPUP_NAME_PREFIX}.${this.config.auth.clientId}.${t}.${this.correlationId}`}};var Da=class{constructor(e,t,n,i,o){this.authModule=e,this.browserStorage=t,this.authCodeRequest=n,this.logger=i,this.performanceClient=o}initiateAuthRequest(e,t){return h(this,null,function*(){if(this.logger.verbose("RedirectHandler.initiateAuthRequest called"),e){t.redirectStartPage&&(this.logger.verbose("RedirectHandler.initiateAuthRequest: redirectStartPage set, caching start page"),this.browserStorage.setTemporaryCache(ee.ORIGIN_URI,t.redirectStartPage,!0)),this.browserStorage.setTemporaryCache(ee.CORRELATION_ID,this.authCodeRequest.correlationId,!0),this.browserStorage.cacheCodeRequest(this.authCodeRequest),this.logger.infoPii(`RedirectHandler.initiateAuthRequest: Navigate to: ${e}`);let n={apiId:ce.acquireTokenRedirect,timeout:t.redirectTimeout,noHistory:!1};if(typeof t.onRedirectNavigate=="function")if(this.logger.verbose("RedirectHandler.initiateAuthRequest: Invoking onRedirectNavigate callback"),t.onRedirectNavigate(e)!==!1){this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate did not return false, navigating"),yield t.navigationClient.navigateExternal(e,n);return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: onRedirectNavigate returned false, stopping navigation");return}else{this.logger.verbose("RedirectHandler.initiateAuthRequest: Navigating window to navigate url"),yield t.navigationClient.navigateExternal(e,n);return}}else throw this.logger.info("RedirectHandler.initiateAuthRequest: Navigate url is empty"),I(nn)})}handleCodeResponse(e,t){return h(this,null,function*(){this.logger.verbose("RedirectHandler.handleCodeResponse called"),this.browserStorage.setInteractionInProgress(!1);let n=this.browserStorage.generateStateKey(t),i=this.browserStorage.getTemporaryCache(n);if(!i)throw T(xe.stateNotFound,"Cached State");let o;try{o=this.authModule.handleFragmentResponse(e,i)}catch(l){throw l instanceof Re&&l.subError===at?I(at):l}let a=this.browserStorage.generateNonceKey(i),s=this.browserStorage.getTemporaryCache(a);if(this.authCodeRequest.code=o.code,o.cloud_instance_host_name&&(yield E(this.authModule.updateAuthority.bind(this.authModule),d.UpdateTokenEndpointAuthority,this.logger,this.performanceClient,this.authCodeRequest.correlationId)(o.cloud_instance_host_name,this.authCodeRequest.correlationId)),o.nonce=s||void 0,o.state=i,o.client_info)this.authCodeRequest.clientInfo=o.client_info;else{let l=this.checkCcsCredentials();l&&(this.authCodeRequest.ccsCredential=l)}let c=yield this.authModule.acquireToken(this.authCodeRequest,o);return this.browserStorage.cleanRequestByState(t),this.browserStorage.removeRequestRetried(),c})}checkCcsCredentials(){let e=this.browserStorage.getTemporaryCache(ee.CCS_CREDENTIAL,!0);if(e)try{return JSON.parse(e)}catch{this.authModule.logger.error("Cache credential could not be parsed"),this.authModule.logger.errorPii(`Cache credential could not be parsed: ${e}`)}return null}};var gc=class extends lt{constructor(e,t,n,i,o,a,s,c,l,u){super(e,t,n,i,o,a,s,l,u),this.nativeStorage=c}acquireToken(e){return h(this,null,function*(){e.onRedirectNavigate?this.logger.warning("Unable to cache redirect request, onRedirectNavigate request option has been deprecated. Please set onRedirectNavigate on PublicClientApplication config instead."):this.browserStorage.cacheRedirectRequest(e);let t=yield E(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,this.correlationId)(e,D.Redirect);this.browserStorage.updateCacheEntries(t.state,t.nonce,t.authority,t.loginHint||"",t.account||null);let n=this.initializeServerTelemetryManager(ce.acquireTokenRedirect),i=o=>{o.persisted&&(this.logger.verbose("Page was restored from back/forward cache. Clearing temporary cache."),this.browserStorage.cleanRequestByState(t.state),this.eventHandler.emitEvent(H.RESTORE_FROM_BFCACHE,D.Redirect))};try{let o=yield E(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,this.correlationId)(t),a=yield E(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(n,t.authority,t.azureCloudOptions,t.account),s=new Da(a,this.browserStorage,o,this.logger,this.performanceClient),c=yield a.getAuthCodeUrl(z(_({},t),{nativeBroker:Ct.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,e.authenticationScheme)})),l=this.getRedirectStartPage(e.redirectStartPage);return this.logger.verbosePii(`Redirect start page: ${l}`),window.addEventListener("pageshow",i),yield s.initiateAuthRequest(c,{navigationClient:this.navigationClient,redirectTimeout:this.config.system.redirectNavigationTimeout,redirectStartPage:l,onRedirectNavigate:e.onRedirectNavigate||this.config.auth.onRedirectNavigate})}catch(o){throw o instanceof re&&(o.setCorrelationId(this.correlationId),n.cacheFailedRequest(o)),window.removeEventListener("pageshow",i),this.browserStorage.cleanRequestByState(t.state),o}})}handleRedirectPromise(e="",t){return h(this,null,function*(){let n=this.initializeServerTelemetryManager(ce.handleRedirectPromise);try{if(!this.browserStorage.isInteractionInProgress(!0))return this.logger.info("handleRedirectPromise called but there is no interaction in progress, returning null."),null;let[i,o]=this.getRedirectResponse(e||"");if(!i)return this.logger.info("handleRedirectPromise did not detect a response as a result of a redirect. Cleaning temporary cache."),this.browserStorage.cleanRequestByInteractionType(D.Redirect),t.event.errorCode="no_server_response",null;let a=this.browserStorage.getTemporaryCache(ee.ORIGIN_URI,!0)||p.EMPTY_STRING,s=Q.removeHashFromUrl(a),c=Q.removeHashFromUrl(window.location.href);if(s===c&&this.config.auth.navigateToLoginRequestUrl)return this.logger.verbose("Current page is loginRequestUrl, handling response"),a.indexOf("#")>-1&&Pd(a),yield this.handleResponse(i,n);if(this.config.auth.navigateToLoginRequestUrl){if(!Ea()||this.config.system.allowRedirectInIframe){this.browserStorage.setTemporaryCache(ee.URL_HASH,o,!0);let l={apiId:ce.handleRedirectPromise,timeout:this.config.system.redirectNavigationTimeout,noHistory:!0},u=!0;if(!a||a==="null"){let m=Nd();this.browserStorage.setTemporaryCache(ee.ORIGIN_URI,m,!0),this.logger.warning("Unable to get valid login request url from cache, redirecting to home page"),u=yield this.navigationClient.navigateInternal(m,l)}else this.logger.verbose(`Navigating to loginRequestUrl: ${a}`),u=yield this.navigationClient.navigateInternal(a,l);if(!u)return yield this.handleResponse(i,n)}}else return this.logger.verbose("NavigateToLoginRequestUrl set to false, handling response"),yield this.handleResponse(i,n);return null}catch(i){if(i instanceof re&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i instanceof Re&&i.errorCode===Ee.INVALID_GRANT_ERROR){if(this.performanceClient.addFields({retryError:i.errorCode},this.correlationId),this.browserStorage.getRequestRetried())throw this.logger.error("Retried request already detected. Throwing error."),this.browserStorage.removeRequestRetried(),i;let a=this.browserStorage.getCachedRedirectRequest();if(!a)throw this.logger.error("Unable to retry. Please retry with redirect request"),this.browserStorage.setRequestRetried(),I(Ys);return this.browserStorage.setRequestRetried(),yield this.acquireToken(a),null}throw this.browserStorage.removeTemporaryItem(this.browserStorage.generateCacheKey(ee.REDIRECT_REQUEST)),this.browserStorage.removeRequestRetried(),i}finally{this.browserStorage.cleanRequestByInteractionType(D.Redirect)}})}getRedirectResponse(e){this.logger.verbose("getRedirectResponseHash called");let t=e;t||(this.config.auth.OIDCOptions.serverResponseType===zt.QUERY?t=window.location.search:t=window.location.hash);let n=jn.getDeserializedResponse(t);if(n){try{$m(n,this.browserCrypto,D.Redirect)}catch(o){return o instanceof re&&this.logger.error(`Interaction type validation failed due to ${o.errorCode}: ${o.errorMessage}`),[null,""]}return Od(window),this.logger.verbose("Hash contains known properties, returning response hash"),[n,t]}let i=this.browserStorage.getTemporaryCache(ee.URL_HASH,!0);return this.browserStorage.removeItem(this.browserStorage.generateCacheKey(ee.URL_HASH)),i&&(n=jn.getDeserializedResponse(i),n)?(this.logger.verbose("Hash does not contain known properties, returning cached hash"),[n,i]):[null,""]}handleResponse(e,t){return h(this,null,function*(){let n=e.state;if(!n)throw I(rr);let i=this.browserStorage.getCachedRequest(n);if(this.logger.verbose("handleResponse called, retrieved cached request"),e.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw I(bt);let c=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ce.acquireTokenPopup,this.performanceClient,this.nativeMessageHandler,e.accountId,this.nativeStorage,i.correlationId),{userRequestState:l}=He.parseRequestState(this.browserCrypto,n);return c.acquireToken(z(_({},i),{state:l,prompt:void 0})).finally(()=>{this.browserStorage.cleanRequestByState(n)})}let o=this.browserStorage.getCachedAuthority(n);if(!o)throw I(ir);let a=yield E(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(t,o);return Jt.removeThrottle(this.browserStorage,this.config.auth.clientId,i),new Da(a,this.browserStorage,i,this.logger,this.performanceClient).handleCodeResponse(e,n)})}logout(e){return h(this,null,function*(){this.logger.verbose("logoutRedirect called");let t=this.initializeLogoutRequest(e),n=this.initializeServerTelemetryManager(ce.logout);try{this.eventHandler.emitEvent(H.LOGOUT_START,D.Redirect,e),yield this.clearCacheOnLogout(t.account);let i={apiId:ce.logout,timeout:this.config.system.redirectNavigationTimeout,noHistory:!1},o=yield E(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,this.correlationId)(n,e&&e.authority,void 0,e&&e.account||void 0);if(o.authority.protocolMode===qe.OIDC)try{o.authority.endSessionEndpoint}catch{if(t.account?.homeAccountId){this.browserStorage.removeAccount(t.account?.homeAccountId),this.eventHandler.emitEvent(H.LOGOUT_SUCCESS,D.Redirect,t);return}}let a=o.getLogoutUri(t);if(this.eventHandler.emitEvent(H.LOGOUT_SUCCESS,D.Redirect,t),e&&typeof e.onRedirectNavigate=="function")if(e.onRedirectNavigate(a)!==!1){this.logger.verbose("Logout onRedirectNavigate did not return false, navigating"),this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(a,i);return}else this.browserStorage.setInteractionInProgress(!1),this.logger.verbose("Logout onRedirectNavigate returned false, stopping navigation");else{this.browserStorage.getInteractionInProgress()||this.browserStorage.setInteractionInProgress(!0),yield this.navigationClient.navigateExternal(a,i);return}}catch(i){throw i instanceof re&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),this.eventHandler.emitEvent(H.LOGOUT_FAILURE,D.Redirect,null,i),this.eventHandler.emitEvent(H.LOGOUT_END,D.Redirect),i}this.eventHandler.emitEvent(H.LOGOUT_END,D.Redirect)})}getRedirectStartPage(e){let t=e||window.location.href;return Q.getAbsoluteUrl(t,st())}};function Ym(r,e,t,n,i){return h(this,null,function*(){if(e.addQueueMeasurement(d.SilentHandlerInitiateAuthRequest,n),!r)throw t.info("Navigate url is empty"),I(nn);return i?E(Dv,d.SilentHandlerLoadFrame,t,e,n)(r,i,e,n):Ze(Mv,d.SilentHandlerLoadFrameSync,t,e,n)(r)})}function jm(r,e,t,n,i,o,a){return h(this,null,function*(){return n.addQueueMeasurement(d.SilentHandlerMonitorIframeForHash,o),new Promise((s,c)=>{e<oc&&i.warning(`system.loadFrameTimeout or system.iframeHashTimeout set to lower (${e}ms) than the default (${oc}ms). This may result in timeouts.`);let l=window.setTimeout(()=>{window.clearInterval(u),c(I(Bi))},e),u=window.setInterval(()=>{let m="",v=r.contentWindow;try{m=v?v.location.href:""}catch{}if(!m||m==="about:blank")return;let g="";v&&(a===zt.QUERY?g=v.location.search:g=v.location.hash),window.clearTimeout(l),window.clearInterval(u),s(g)},t)}).finally(()=>{Ze(Ov,d.RemoveHiddenIframe,i,n,o)(r)})})}function Dv(r,e,t,n){return t.addQueueMeasurement(d.SilentHandlerLoadFrame,n),new Promise((i,o)=>{let a=Qm();window.setTimeout(()=>{if(!a){o("Unable to load iframe");return}a.src=r,i(a)},e)})}function Mv(r){let e=Qm();return e.src=r,e}function Qm(){let r=document.createElement("iframe");return r.className="msalSilentIframe",r.style.visibility="hidden",r.style.position="absolute",r.style.width=r.style.height="0",r.style.border="0",r.setAttribute("sandbox","allow-scripts allow-same-origin allow-forms"),document.body.appendChild(r),r}function Ov(r){document.body===r.parentNode&&document.body.removeChild(r)}var fc=class extends lt{constructor(e,t,n,i,o,a,s,c,l,u,m){super(e,t,n,i,o,a,c,u,m),this.apiId=s,this.nativeStorage=l}acquireToken(e){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.SilentIframeClientAcquireToken,e.correlationId),!e.loginHint&&!e.sid&&(!e.account||!e.account.username)&&this.logger.warning("No user hint provided. The authorization server may need more information to complete this request.");let t=_({},e);t.prompt?t.prompt!==Ce.NONE&&t.prompt!==Ce.NO_SESSION&&(this.logger.warning(`SilentIframeClient. Replacing invalid prompt ${t.prompt} with ${Ce.NONE}`),t.prompt=Ce.NONE):t.prompt=Ce.NONE;let n=yield E(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,D.Silent);Aa(n.authority);let i=this.initializeServerTelemetryManager(this.apiId),o;try{return o=yield E(this.createAuthCodeClient.bind(this),d.StandardInteractionClientCreateAuthCodeClient,this.logger,this.performanceClient,e.correlationId)(i,n.authority,n.azureCloudOptions,n.account),yield E(this.silentTokenHelper.bind(this),d.SilentIframeClientTokenHelper,this.logger,this.performanceClient,e.correlationId)(o,n)}catch(a){if(a instanceof re&&(a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a)),!o||!(a instanceof Re)||a.errorCode!==Ee.INVALID_GRANT_ERROR)throw a;this.performanceClient.addFields({retryError:a.errorCode},this.correlationId);let s=yield E(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(t,D.Silent);return yield E(this.silentTokenHelper.bind(this),d.SilentIframeClientTokenHelper,this.logger,this.performanceClient,this.correlationId)(o,s)}})}logout(){return Promise.reject(I(rn))}silentTokenHelper(e,t){return h(this,null,function*(){let n=t.correlationId;this.performanceClient.addQueueMeasurement(d.SilentIframeClientTokenHelper,n);let i=yield E(this.initializeAuthorizationCodeRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationCodeRequest,this.logger,this.performanceClient,n)(t),o=yield E(e.getAuthCodeUrl.bind(e),d.GetAuthCodeUrl,this.logger,this.performanceClient,n)(z(_({},t),{nativeBroker:Ct.isNativeAvailable(this.config,this.logger,this.nativeMessageHandler,t.authenticationScheme)})),a=new ur(e,this.browserStorage,i,this.logger,this.performanceClient),s=yield E(Ym,d.SilentHandlerInitiateAuthRequest,this.logger,this.performanceClient,n)(o,this.performanceClient,this.logger,n,this.config.system.navigateFrameWait),c=this.config.auth.OIDCOptions.serverResponseType,l=yield E(jm,d.SilentHandlerMonitorIframeForHash,this.logger,this.performanceClient,n)(s,this.config.system.iframeHashTimeout,this.config.system.pollIntervalMilliseconds,this.performanceClient,this.logger,n,c),u=Ze(mc,d.DeserializeResponse,this.logger,this.performanceClient,this.correlationId)(l,c,this.logger);if(u.accountId){if(this.logger.verbose("Account id found in hash, calling WAM for token"),!this.nativeMessageHandler)throw I(bt);let m=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.apiId,this.performanceClient,this.nativeMessageHandler,u.accountId,this.browserStorage,n),{userRequestState:v}=He.parseRequestState(this.browserCrypto,t.state);return E(m.acquireToken.bind(m),d.NativeInteractionClientAcquireToken,this.logger,this.performanceClient,n)(z(_({},t),{state:v,prompt:t.prompt||Ce.NONE}))}return E(a.handleCodeResponse.bind(a),d.HandleCodeResponse,this.logger,this.performanceClient,n)(u,t)})}};var Cc=class extends lt{acquireToken(e){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.SilentRefreshClientAcquireToken,e.correlationId);let t=yield E(ba,d.InitializeBaseRequest,this.logger,this.performanceClient,e.correlationId)(e,this.config,this.performanceClient,this.logger),n=_(_({},e),t);e.redirectUri&&(n.redirectUri=this.getRedirectUri(e.redirectUri));let i=this.initializeServerTelemetryManager(ce.acquireTokenSilent_silentFlow),o=yield this.createRefreshTokenClient(i,n.authority,n.azureCloudOptions,n.account);return E(o.acquireTokenByRefreshToken.bind(o),d.RefreshTokenClientAcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(n).catch(a=>{throw a.setCorrelationId(this.correlationId),i.cacheFailedRequest(a),a})})}logout(){return Promise.reject(I(rn))}createRefreshTokenClient(e,t,n,i){return h(this,null,function*(){let o=yield E(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,this.correlationId)(e,t,n,i);return new nr(o,this.performanceClient)})}};var vc=class{constructor(e,t,n,i){this.isBrowserEnvironment=typeof window<"u",this.config=e,this.storage=t,this.logger=n,this.cryptoObj=i}loadExternalTokens(e,t,n){if(!this.isBrowserEnvironment)throw I(or);let i=t.id_token?$n.extractTokenClaims(t.id_token,ct):void 0,o={protocolMode:this.config.auth.protocolMode,knownAuthorities:this.config.auth.knownAuthorities,cloudDiscoveryMetadata:this.config.auth.cloudDiscoveryMetadata,authorityMetadata:this.config.auth.authorityMetadata,skipAuthorityMetadataCache:this.config.auth.skipAuthorityMetadataCache},a=e.authority?new It(It.generateAuthority(e.authority,e.azureCloudOptions),this.config.system.networkClient,this.storage,o,this.logger,e.correlationId||Be()):void 0,s=this.loadAccount(e,n.clientInfo||t.client_info||"",i,a),c=this.loadIdToken(t,s.homeAccountId,s.environment,s.realm),l=this.loadAccessToken(e,t,s.homeAccountId,s.environment,s.realm,n),u=this.loadRefreshToken(t,s.homeAccountId,s.environment);return this.generateAuthenticationResult(e,{account:s,idToken:c,accessToken:l,refreshToken:u},i,a)}loadAccount(e,t,n,i){if(this.logger.verbose("TokenCache - loading account"),e.account){let c=pe.createFromAccountInfo(e.account);return this.storage.setAccount(c),c}else if(!i||!t&&!n)throw this.logger.error("TokenCache - if an account is not provided on the request, authority and either clientInfo or idToken must be provided instead."),I(ji);let o=pe.generateHomeAccountId(t,i.authorityType,this.logger,this.cryptoObj,n),a=n?.tid,s=Di(this.storage,i,o,ct,n,t,i.hostnameAndPort,a,void 0,void 0,this.logger);return this.storage.setAccount(s),s}loadIdToken(e,t,n,i){if(!e.id_token)return this.logger.verbose("TokenCache - no id token found in response"),null;this.logger.verbose("TokenCache - loading id token");let o=me.createIdTokenEntity(t,n,e.id_token,this.config.auth.clientId,i);return this.storage.setIdTokenCredential(o),o}loadAccessToken(e,t,n,i,o,a){if(t.access_token)if(t.expires_in){if(!t.scope&&(!e.scopes||!e.scopes.length))return this.logger.error("TokenCache - scopes not specified in the request or response. Cannot add token to the cache."),null}else return this.logger.error("TokenCache - no expiration set on the access token. Cannot add it to the cache."),null;else return this.logger.verbose("TokenCache - no access token found in response"),null;this.logger.verbose("TokenCache - loading access token");let s=t.scope?ve.fromString(t.scope):new ve(e.scopes),c=a.expiresOn||t.expires_in+new Date().getTime()/1e3,l=a.extendedExpiresOn||(t.ext_expires_in||t.expires_in)+new Date().getTime()/1e3,u=me.createAccessTokenEntity(n,i,t.access_token,this.config.auth.clientId,o,s.printScopes(),c,l,ct);return this.storage.setAccessTokenCredential(u),u}loadRefreshToken(e,t,n){if(!e.refresh_token)return this.logger.verbose("TokenCache - no refresh token found in response"),null;this.logger.verbose("TokenCache - loading refresh token");let i=me.createRefreshTokenEntity(t,n,e.refresh_token,this.config.auth.clientId,e.foci,void 0,e.refresh_token_expires_in);return this.storage.setRefreshTokenCredential(i),i}generateAuthenticationResult(e,t,n,i){let o="",a=[],s=null,c;t?.accessToken&&(o=t.accessToken.secret,a=ve.fromString(t.accessToken.target).asArray(),s=new Date(Number(t.accessToken.expiresOn)*1e3),c=new Date(Number(t.accessToken.extendedExpiresOn)*1e3));let l=t.account;return{authority:i?i.canonicalAuthority:"",uniqueId:t.account.localAccountId,tenantId:t.account.realm,scopes:a,account:l.getAccountInfo(),idToken:t.idToken?.secret||"",idTokenClaims:n||{},accessToken:o,fromCache:!0,expiresOn:s,correlationId:e.correlationId||"",requestId:"",extExpiresOn:c,familyId:t.refreshToken?.familyId||"",tokenType:t?.accessToken?.tokenType||"",state:e.state||"",cloudGraphHostName:l.cloudGraphHostName||"",msGraphHost:l.msGraphHost||"",fromNativeBroker:!1}}};var yc=class extends Jr{constructor(e){super(e),this.includeRedirectUri=!1}};var Tc=class extends lt{constructor(e,t,n,i,o,a,s,c,l,u){super(e,t,n,i,o,a,c,l,u),this.apiId=s}acquireToken(e){return h(this,null,function*(){if(!e.code)throw I(Qi);let t=yield E(this.initializeAuthorizationRequest.bind(this),d.StandardInteractionClientInitializeAuthorizationRequest,this.logger,this.performanceClient,e.correlationId)(e,D.Silent),n=this.initializeServerTelemetryManager(this.apiId);try{let i=z(_({},t),{code:e.code}),o=yield E(this.getClientConfiguration.bind(this),d.StandardInteractionClientGetClientConfiguration,this.logger,this.performanceClient,e.correlationId)(n,t.authority,t.azureCloudOptions,t.account),a=new yc(o);this.logger.verbose("Auth code client created");let s=new ur(a,this.browserStorage,i,this.logger,this.performanceClient);return yield E(s.handleCodeResponseFromServer.bind(s),d.HandleCodeResponseFromServer,this.logger,this.performanceClient,e.correlationId)({code:e.code,msgraph_host:e.msGraphHost,cloud_graph_host_name:e.cloudGraphHostName,cloud_instance_host_name:e.cloudInstanceHostName},t,!1)}catch(i){throw i instanceof re&&(i.setCorrelationId(this.correlationId),n.cacheFailedRequest(i)),i}})}logout(){return Promise.reject(I(rn))}};function an(r){let e=r?.idTokenClaims;if(e?.tfp||e?.acr)return"B2C";if(e?.tid){if(e?.tid==="9188040d-6c67-4c5b-b112-36a304b66dad")return"MSA"}else return;return"AAD"}function wc(r,e){try{Sa(r)}catch(t){throw e.end({success:!1},t),t}}var ho=class r{constructor(e){this.operatingContext=e,this.isBrowserEnvironment=this.operatingContext.isBrowserEnvironment(),this.config=e.getConfig(),this.initialized=!1,this.logger=this.operatingContext.getLogger(),this.networkClient=this.config.system.networkClient,this.navigationClient=this.config.system.navigationClient,this.redirectResponse=new Map,this.hybridAuthCodeResponses=new Map,this.performanceClient=this.config.telemetry.client,this.browserCrypto=this.isBrowserEnvironment?new Rm(this.logger,this.performanceClient):Jn,this.eventHandler=new uc(this.logger,this.browserCrypto),this.browserStorage=this.isBrowserEnvironment?new co(this.config.auth.clientId,this.config.cache,this.browserCrypto,this.logger,Pl(this.config.auth),this.performanceClient):Dm(this.config.auth.clientId,this.logger);let t={cacheLocation:ue.MemoryStorage,temporaryCacheLocation:ue.MemoryStorage,storeAuthStateInCookie:!1,secureCookies:!1,cacheMigrationEnabled:!1,claimsBasedCachingEnabled:!1};this.nativeInternalStorage=new co(this.config.auth.clientId,t,this.browserCrypto,this.logger,void 0,this.performanceClient),this.tokenCache=new vc(this.config,this.browserStorage,this.logger,this.browserCrypto),this.activeSilentTokenRequests=new Map,this.trackPageVisibility=this.trackPageVisibility.bind(this),this.trackPageVisibilityWithMeasurement=this.trackPageVisibilityWithMeasurement.bind(this)}static createController(e,t){return h(this,null,function*(){let n=new r(e);return yield n.initialize(t),n})}trackPageVisibility(e){e&&(this.logger.info("Perf: Visibility change detected"),this.performanceClient.incrementFields({visibilityChangeCount:1},e))}initialize(e){return h(this,null,function*(){if(this.logger.trace("initialize called"),this.initialized){this.logger.info("initialize has already been called, exiting early.");return}let t=e?.correlationId||this.getRequestCorrelationId(),n=this.config.system.allowNativeBroker,i=this.performanceClient.startMeasurement(d.InitializeClientApplication,t);if(this.eventHandler.emitEvent(H.INITIALIZE_START),n)try{this.nativeExtensionProvider=yield Ct.createProvider(this.logger,this.config.system.nativeBrokerHandshakeTimeout,this.performanceClient)}catch(o){this.logger.verbose(o)}this.config.cache.claimsBasedCachingEnabled||(this.logger.verbose("Claims-based caching is disabled. Clearing the previous cache with claims"),yield E(this.browserStorage.clearTokensAndKeysWithClaims.bind(this.browserStorage),d.ClearTokensAndKeysWithClaims,this.logger,this.performanceClient,t)(this.performanceClient,t)),this.initialized=!0,this.eventHandler.emitEvent(H.INITIALIZE_END),i.end({allowNativeBroker:n,success:!0})})}handleRedirectPromise(e){return h(this,null,function*(){if(this.logger.verbose("handleRedirectPromise called"),tc(this.initialized),this.isBrowserEnvironment){let t=e||"",n=this.redirectResponse.get(t);return typeof n>"u"?(n=this.handleRedirectPromiseInternal(e),this.redirectResponse.set(t,n),this.logger.verbose("handleRedirectPromise has been called for the first time, storing the promise")):this.logger.verbose("handleRedirectPromise has been called previously, returning the result from the first call"),n}return this.logger.verbose("handleRedirectPromise returns null, not browser environment"),null})}handleRedirectPromiseInternal(e){return h(this,null,function*(){let t=this.getAllAccounts(),n=this.browserStorage.getCachedNativeRequest(),i=n&&Ct.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider)&&this.nativeExtensionProvider&&!e,o=i?n?.correlationId:this.browserStorage.getTemporaryCache(ee.CORRELATION_ID,!0)||"",a=this.performanceClient.startMeasurement(d.AcquireTokenRedirect,o);this.eventHandler.emitEvent(H.HANDLE_REDIRECT_START,D.Redirect);let s;if(i&&this.nativeExtensionProvider){this.logger.trace("handleRedirectPromise - acquiring token from native platform");let c=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ce.handleRedirectPromise,this.performanceClient,this.nativeExtensionProvider,n.accountId,this.nativeInternalStorage,n.correlationId);s=E(c.handleRedirectPromise.bind(c),d.HandleNativeRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(this.performanceClient,a.event.correlationId)}else{this.logger.trace("handleRedirectPromise - acquiring token from web flow");let c=this.createRedirectClient(o);s=E(c.handleRedirectPromise.bind(c),d.HandleRedirectPromiseMeasurement,this.logger,this.performanceClient,a.event.correlationId)(e,a)}return s.then(c=>(c?(t.length<this.getAllAccounts().length?(this.eventHandler.emitEvent(H.LOGIN_SUCCESS,D.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, login success")):(this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_SUCCESS,D.Redirect,c),this.logger.verbose("handleRedirectResponse returned result, acquire token success")),a.end({success:!0,accountType:an(c.account)})):a.event.errorCode?a.end({success:!1}):a.discard(),this.eventHandler.emitEvent(H.HANDLE_REDIRECT_END,D.Redirect),c)).catch(c=>{let l=c;throw t.length>0?this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_FAILURE,D.Redirect,null,l):this.eventHandler.emitEvent(H.LOGIN_FAILURE,D.Redirect,null,l),this.eventHandler.emitEvent(H.HANDLE_REDIRECT_END,D.Redirect),a.end({success:!1},l),c})})}acquireTokenRedirect(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e);this.logger.verbose("acquireTokenRedirect called",t);let n=this.performanceClient.startMeasurement(d.AcquireTokenPreRedirect,t);n.add({accountType:an(e.account),scenarioId:e.scenarioId});let i=e.onRedirectNavigate;if(i)e.onRedirectNavigate=a=>{let s=typeof i=="function"?i(a):void 0;return s!==!1?n.end({success:!0}):n.discard(),s};else{let a=this.config.auth.onRedirectNavigate;this.config.auth.onRedirectNavigate=s=>{let c=typeof a=="function"?a(s):void 0;return c!==!1?n.end({success:!0}):n.discard(),c}}let o=this.getAllAccounts().length>0;try{nc(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),o?this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_START,D.Redirect,e):this.eventHandler.emitEvent(H.LOGIN_START,D.Redirect,e);let a;return this.nativeExtensionProvider&&this.canUseNative(e)?a=new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ce.acquireTokenRedirect,this.performanceClient,this.nativeExtensionProvider,this.getNativeAccountId(e),this.nativeInternalStorage,t).acquireTokenRedirect(e,n).catch(c=>{if(c instanceof Rt&&dr(c))return this.nativeExtensionProvider=void 0,this.createRedirectClient(t).acquireToken(e);if(c instanceof We)return this.logger.verbose("acquireTokenRedirect - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createRedirectClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),c}):a=this.createRedirectClient(t).acquireToken(e),yield a}catch(a){throw n.end({success:!1},a),o?this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_FAILURE,D.Redirect,null,a):this.eventHandler.emitEvent(H.LOGIN_FAILURE,D.Redirect,null,a),a}})}acquireTokenPopup(e){let t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(d.AcquireTokenPopup,t);n.add({scenarioId:e.scenarioId,accountType:an(e.account)});try{this.logger.verbose("acquireTokenPopup called",t),wc(this.initialized,n),this.browserStorage.setInteractionInProgress(!0)}catch(a){return Promise.reject(a)}let i=this.getAllAccounts();i.length>0?this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_START,D.Popup,e):this.eventHandler.emitEvent(H.LOGIN_START,D.Popup,e);let o;return this.canUseNative(e)?o=this.acquireTokenNative(z(_({},e),{correlationId:t}),ce.acquireTokenPopup).then(a=>(this.browserStorage.setInteractionInProgress(!1),n.end({success:!0,isNativeBroker:!0,requestId:a.requestId,accountType:an(a.account)}),a)).catch(a=>{if(a instanceof Rt&&dr(a))return this.nativeExtensionProvider=void 0,this.createPopupClient(t).acquireToken(e);if(a instanceof We)return this.logger.verbose("acquireTokenPopup - Resolving interaction required error thrown by native broker by falling back to web flow"),this.createPopupClient(t).acquireToken(e);throw this.browserStorage.setInteractionInProgress(!1),a}):o=this.createPopupClient(t).acquireToken(e),o.then(a=>(i.length<this.getAllAccounts().length?this.eventHandler.emitEvent(H.LOGIN_SUCCESS,D.Popup,a):this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_SUCCESS,D.Popup,a),n.end({success:!0,requestId:a.requestId,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:an(a.account)}),a)).catch(a=>(i.length>0?this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_FAILURE,D.Popup,null,a):this.eventHandler.emitEvent(H.LOGIN_FAILURE,D.Popup,null,a),n.end({success:!1},a),Promise.reject(a)))}trackPageVisibilityWithMeasurement(){let e=this.ssoSilentMeasurement||this.acquireTokenByCodeAsyncMeasurement;e&&(this.logger.info("Perf: Visibility change detected in ",e.event.name),e.increment({visibilityChangeCount:1}))}ssoSilent(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e),n=z(_({},e),{prompt:e.prompt,correlationId:t});this.ssoSilentMeasurement=this.performanceClient.startMeasurement(d.SsoSilent,t),this.ssoSilentMeasurement?.add({scenarioId:e.scenarioId,accountType:an(e.account)}),wc(this.initialized,this.ssoSilentMeasurement),this.ssoSilentMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),this.logger.verbose("ssoSilent called",t),this.eventHandler.emitEvent(H.SSO_SILENT_START,D.Silent,n);let i;return this.canUseNative(n)?i=this.acquireTokenNative(n,ce.ssoSilent).catch(o=>{if(o instanceof Rt&&dr(o))return this.nativeExtensionProvider=void 0,this.createSilentIframeClient(n.correlationId).acquireToken(n);throw o}):i=this.createSilentIframeClient(n.correlationId).acquireToken(n),i.then(o=>(this.eventHandler.emitEvent(H.SSO_SILENT_SUCCESS,D.Silent,o),this.ssoSilentMeasurement?.end({success:!0,isNativeBroker:o.fromNativeBroker,requestId:o.requestId,accessTokenSize:o.accessToken.length,idTokenSize:o.idToken.length,accountType:an(o.account)}),o)).catch(o=>{throw this.eventHandler.emitEvent(H.SSO_SILENT_FAILURE,D.Silent,null,o),this.ssoSilentMeasurement?.end({success:!1},o),o}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenByCode(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e);this.logger.trace("acquireTokenByCode called",t);let n=this.performanceClient.startMeasurement(d.AcquireTokenByCode,t);wc(this.initialized,n),this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_BY_CODE_START,D.Silent,e),n.add({scenarioId:e.scenarioId});try{if(e.code&&e.nativeAccountId)throw I(Ji);if(e.code){let i=e.code,o=this.hybridAuthCodeResponses.get(i);return o?(this.logger.verbose("Existing acquireTokenByCode request found",t),n.discard()):(this.logger.verbose("Initiating new acquireTokenByCode request",t),o=this.acquireTokenByCodeAsync(z(_({},e),{correlationId:t})).then(a=>(this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_BY_CODE_SUCCESS,D.Silent,a),this.hybridAuthCodeResponses.delete(i),n.end({success:!0,isNativeBroker:a.fromNativeBroker,requestId:a.requestId,accessTokenSize:a.accessToken.length,idTokenSize:a.idToken.length,accountType:an(a.account)}),a)).catch(a=>{throw this.hybridAuthCodeResponses.delete(i),this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_BY_CODE_FAILURE,D.Silent,null,a),n.end({success:!1},a),a}),this.hybridAuthCodeResponses.set(i,o)),yield o}else if(e.nativeAccountId)if(this.canUseNative(e,e.nativeAccountId)){let i=yield this.acquireTokenNative(z(_({},e),{correlationId:t}),ce.acquireTokenByCode,e.nativeAccountId).catch(o=>{throw o instanceof Rt&&dr(o)&&(this.nativeExtensionProvider=void 0),o});return n.end({accountType:an(i.account),success:!0}),i}else throw I(Zi);else throw I(Xi)}catch(i){throw this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_BY_CODE_FAILURE,D.Silent,null,i),n.end({success:!1},i),i}})}acquireTokenByCodeAsync(e){return h(this,null,function*(){return this.logger.trace("acquireTokenByCodeAsync called",e.correlationId),this.acquireTokenByCodeAsyncMeasurement=this.performanceClient.startMeasurement(d.AcquireTokenByCodeAsync,e.correlationId),this.acquireTokenByCodeAsyncMeasurement?.increment({visibilityChangeCount:0}),document.addEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement),yield this.createSilentAuthCodeClient(e.correlationId).acquireToken(e).then(i=>(this.acquireTokenByCodeAsyncMeasurement?.end({success:!0,fromCache:i.fromCache,isNativeBroker:i.fromNativeBroker,requestId:i.requestId}),i)).catch(i=>{throw this.acquireTokenByCodeAsyncMeasurement?.end({success:!1},i),i}).finally(()=>{document.removeEventListener("visibilitychange",this.trackPageVisibilityWithMeasurement)})})}acquireTokenFromCache(e,t){return h(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(d.AcquireTokenFromCache,e.correlationId),t){case et.Default:case et.AccessToken:case et.AccessTokenAndRefreshToken:let n=this.createSilentCacheClient(e.correlationId);return E(n.acquireToken.bind(n),d.SilentCacheClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw T(xe.tokenRefreshRequired)}})}acquireTokenByRefreshToken(e,t){return h(this,null,function*(){switch(this.performanceClient.addQueueMeasurement(d.AcquireTokenByRefreshToken,e.correlationId),t){case et.Default:case et.AccessTokenAndRefreshToken:case et.RefreshToken:case et.RefreshTokenAndNetwork:let n=this.createSilentRefreshClient(e.correlationId);return E(n.acquireToken.bind(n),d.SilentRefreshClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e);default:throw T(xe.tokenRefreshRequired)}})}acquireTokenBySilentIframe(e){return h(this,null,function*(){this.performanceClient.addQueueMeasurement(d.AcquireTokenBySilentIframe,e.correlationId);let t=this.createSilentIframeClient(e.correlationId);return E(t.acquireToken.bind(t),d.SilentIframeClientAcquireToken,this.logger,this.performanceClient,e.correlationId)(e)})}logout(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.logger.warning("logout API is deprecated and will be removed in msal-browser v3.0.0. Use logoutRedirect instead.",t),this.logoutRedirect(_({correlationId:t},e))})}logoutRedirect(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e);return nc(this.initialized,this.config),this.browserStorage.setInteractionInProgress(!0),this.createRedirectClient(t).logout(e)})}logoutPopup(e){try{let t=this.getRequestCorrelationId(e);return Sa(this.initialized),this.browserStorage.setInteractionInProgress(!0),this.createPopupClient(t).logout(e)}catch(t){return Promise.reject(t)}}clearCache(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.createSilentCacheClient(t).logout(e)})}getAllAccounts(e){return Mm(this.logger,this.browserStorage,this.isBrowserEnvironment,e)}getAccount(e){return Om(e,this.logger,this.browserStorage)}getAccountByUsername(e){return Pm(e,this.logger,this.browserStorage)}getAccountByHomeId(e){return Nm(e,this.logger,this.browserStorage)}getAccountByLocalId(e){return xm(e,this.logger,this.browserStorage)}setActiveAccount(e){Lm(e,this.browserStorage)}getActiveAccount(){return Hm(this.browserStorage)}hydrateCache(e,t){return h(this,null,function*(){this.logger.verbose("hydrateCache called");let n=pe.createFromAccountInfo(e.account,e.cloudGraphHostName,e.msGraphHost);return this.browserStorage.setAccount(n),e.fromNativeBroker?(this.logger.verbose("Response was from native broker, storing in-memory"),this.nativeInternalStorage.hydrateCache(e,t)):this.browserStorage.hydrateCache(e,t)})}acquireTokenNative(e,t,n){return h(this,null,function*(){if(this.logger.trace("acquireTokenNative called"),!this.nativeExtensionProvider)throw I(bt);return new Dt(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,t,this.performanceClient,this.nativeExtensionProvider,n||this.getNativeAccountId(e),this.nativeInternalStorage,e.correlationId).acquireToken(e)})}canUseNative(e,t){if(this.logger.trace("canUseNative called"),!Ct.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme))return this.logger.trace("canUseNative: isNativeAvailable returned false, returning false"),!1;if(e.prompt)switch(e.prompt){case Ce.NONE:case Ce.CONSENT:case Ce.LOGIN:this.logger.trace("canUseNative: prompt is compatible with native flow");break;default:return this.logger.trace(`canUseNative: prompt = ${e.prompt} is not compatible with native flow, returning false`),!1}return!t&&!this.getNativeAccountId(e)?(this.logger.trace("canUseNative: nativeAccountId is not available, returning false"),!1):!0}getNativeAccountId(e){let t=e.account||this.getAccount({loginHint:e.loginHint,sid:e.sid})||this.getActiveAccount();return t&&t.nativeAccountId||""}createPopupClient(e){return new pc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createRedirectClient(e){return new gc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentIframeClient(e){return new fc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ce.ssoSilent,this.performanceClient,this.nativeInternalStorage,this.nativeExtensionProvider,e)}createSilentCacheClient(e){return new uo(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentRefreshClient(e){return new Cc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,this.performanceClient,this.nativeExtensionProvider,e)}createSilentAuthCodeClient(e){return new Tc(this.config,this.browserStorage,this.browserCrypto,this.logger,this.eventHandler,this.navigationClient,ce.acquireTokenByCode,this.performanceClient,this.nativeExtensionProvider,e)}addEventCallback(e){return this.eventHandler.addEventCallback(e)}removeEventCallback(e){this.eventHandler.removeEventCallback(e)}addPerformanceCallback(e){return this.performanceClient.addPerformanceCallback(e)}removePerformanceCallback(e){return this.performanceClient.removePerformanceCallback(e)}enableAccountStorageEvents(){this.eventHandler.enableAccountStorageEvents()}disableAccountStorageEvents(){this.eventHandler.disableAccountStorageEvents()}getTokenCache(){return this.tokenCache}getLogger(){return this.logger}setLogger(e){this.logger=e}initializeWrapperLibrary(e,t){this.browserStorage.setWrapperMetadata(e,t)}setNavigationClient(e){this.navigationClient=e}getConfiguration(){return this.config}getPerformanceClient(){return this.performanceClient}isBrowserEnv(){return this.isBrowserEnvironment}getEventHandler(){return this.eventHandler}getRequestCorrelationId(e){return e?.correlationId?e.correlationId:this.isBrowserEnvironment?Be():p.EMPTY_STRING}loginRedirect(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginRedirect called",t),this.acquireTokenRedirect(_({correlationId:t},e||Id))})}loginPopup(e){let t=this.getRequestCorrelationId(e);return this.logger.verbose("loginPopup called",t),this.acquireTokenPopup(_({correlationId:t},e||Id))}acquireTokenSilent(e){return h(this,null,function*(){let t=this.getRequestCorrelationId(e),n=this.performanceClient.startMeasurement(d.AcquireTokenSilent,t);n.add({cacheLookupPolicy:e.cacheLookupPolicy,scenarioId:e.scenarioId}),wc(this.initialized,n),this.logger.verbose("acquireTokenSilent called",t);let i=e.account||this.getActiveAccount();if(!i)throw I(qi);n.add({accountType:an(i)});let o={clientId:this.config.auth.clientId,authority:e.authority||p.EMPTY_STRING,scopes:e.scopes,homeAccountIdentifier:i.homeAccountId,claims:e.claims,authenticationScheme:e.authenticationScheme,resourceRequestMethod:e.resourceRequestMethod,resourceRequestUri:e.resourceRequestUri,shrClaims:e.shrClaims,sshKid:e.sshKid,shrOptions:e.shrOptions},a=JSON.stringify(o),s=this.activeSilentTokenRequests.get(a);if(typeof s>"u"){this.logger.verbose("acquireTokenSilent called for the first time, storing active request",t);let c=E(this.acquireTokenSilentAsync.bind(this),d.AcquireTokenSilentAsync,this.logger,this.performanceClient,t)(z(_({},e),{correlationId:t}),i).then(l=>(this.activeSilentTokenRequests.delete(a),n.end({success:!0,fromCache:l.fromCache,isNativeBroker:l.fromNativeBroker,cacheLookupPolicy:e.cacheLookupPolicy,requestId:l.requestId,accessTokenSize:l.accessToken.length,idTokenSize:l.idToken.length}),l)).catch(l=>{throw this.activeSilentTokenRequests.delete(a),n.end({success:!1},l),l});return this.activeSilentTokenRequests.set(a,c),z(_({},yield c),{state:e.state})}else return this.logger.verbose("acquireTokenSilent has been called previously, returning the result from the first call",t),n.discard(),z(_({},yield s),{state:e.state})})}acquireTokenSilentAsync(e,t){return h(this,null,function*(){let n=()=>this.trackPageVisibility(e.correlationId);this.performanceClient.addQueueMeasurement(d.AcquireTokenSilentAsync,e.correlationId),this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_START,D.Silent,e),e.correlationId&&this.performanceClient.incrementFields({visibilityChangeCount:0},e.correlationId),document.addEventListener("visibilitychange",n);let i=yield E(Um,d.InitializeSilentRequest,this.logger,this.performanceClient,e.correlationId)(e,t,this.config,this.performanceClient,this.logger),o=e.cacheLookupPolicy||et.Default;return this.acquireTokenSilentNoIframe(i,o).catch(s=>h(this,null,function*(){if(Pv(s,o))if(this.activeIframeRequest)if(o!==et.Skip){let[l,u]=this.activeIframeRequest;this.logger.verbose(`Iframe request is already in progress, awaiting resolution for request with correlationId: ${u}`,i.correlationId);let m=this.performanceClient.startMeasurement(d.AwaitConcurrentIframe,i.correlationId);m.add({awaitIframeCorrelationId:u});let v=yield l;if(m.end({success:v}),v)return this.logger.verbose(`Parallel iframe request with correlationId: ${u} succeeded. Retrying cache and/or RT redemption`,i.correlationId),this.acquireTokenSilentNoIframe(i,o);throw this.logger.info(`Iframe request with correlationId: ${u} failed. Interaction is required.`),s}else return this.logger.warning("Another iframe request is currently in progress and CacheLookupPolicy is set to Skip. This may result in degraded performance and/or reliability for both calls. Please consider changing the CacheLookupPolicy to take advantage of request queuing and token cache.",i.correlationId),E(this.acquireTokenBySilentIframe.bind(this),d.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i);else{let l;return this.activeIframeRequest=[new Promise(u=>{l=u}),i.correlationId],this.logger.verbose("Refresh token expired/invalid or CacheLookupPolicy is set to Skip, attempting acquire token by iframe.",i.correlationId),E(this.acquireTokenBySilentIframe.bind(this),d.AcquireTokenBySilentIframe,this.logger,this.performanceClient,i.correlationId)(i).then(u=>(l(!0),u)).catch(u=>{throw l(!1),u}).finally(()=>{this.activeIframeRequest=void 0})}else throw s})).then(s=>(this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_SUCCESS,D.Silent,s),e.correlationId&&this.performanceClient.addFields({fromCache:s.fromCache,isNativeBroker:s.fromNativeBroker,requestId:s.requestId},e.correlationId),s)).catch(s=>{throw this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_FAILURE,D.Silent,null,s),s}).finally(()=>{document.removeEventListener("visibilitychange",n)})})}acquireTokenSilentNoIframe(e,t){return h(this,null,function*(){return Ct.isNativeAvailable(this.config,this.logger,this.nativeExtensionProvider,e.authenticationScheme)&&e.account.nativeAccountId?(this.logger.verbose("acquireTokenSilent - attempting to acquire token from native platform"),this.acquireTokenNative(e,ce.acquireTokenSilent_silentFlow).catch(n=>h(this,null,function*(){throw n instanceof Rt&&dr(n)?(this.logger.verbose("acquireTokenSilent - native platform unavailable, falling back to web flow"),this.nativeExtensionProvider=void 0,T(xe.tokenRefreshRequired)):n}))):(this.logger.verbose("acquireTokenSilent - attempting to acquire token from web flow"),E(this.acquireTokenFromCache.bind(this),d.AcquireTokenFromCache,this.logger,this.performanceClient,e.correlationId)(e,t).catch(n=>{if(t===et.AccessToken)throw n;return this.eventHandler.emitEvent(H.ACQUIRE_TOKEN_NETWORK_START,D.Silent,e),E(this.acquireTokenByRefreshToken.bind(this),d.AcquireTokenByRefreshToken,this.logger,this.performanceClient,e.correlationId)(e,t)}))})}};function Pv(r,e){let t=!(r instanceof We&&r.subError!==En.badToken),n=r.errorCode===Ee.INVALID_GRANT_ERROR||r.errorCode===xe.tokenRefreshRequired,i=t&&n||r.errorCode===En.noTokensFound||r.errorCode===En.refreshTokenExpired,o=lm.includes(e);return i&&o}function Xm(r,e){return h(this,null,function*(){let t=new sc(r);return yield t.initialize(),ho.createController(t,e)})}var Ma=class r{static createPublicClientApplication(e){return h(this,null,function*(){let t=yield Xm(e);return new r(e,t)})}constructor(e,t){this.controller=t||new ho(new sc(e))}initialize(e){return h(this,null,function*(){return this.controller.initialize(e)})}acquireTokenPopup(e){return h(this,null,function*(){return this.controller.acquireTokenPopup(e)})}acquireTokenRedirect(e){return this.controller.acquireTokenRedirect(e)}acquireTokenSilent(e){return this.controller.acquireTokenSilent(e)}acquireTokenByCode(e){return this.controller.acquireTokenByCode(e)}addEventCallback(e){return this.controller.addEventCallback(e)}removeEventCallback(e){return this.controller.removeEventCallback(e)}addPerformanceCallback(e){return this.controller.addPerformanceCallback(e)}removePerformanceCallback(e){return this.controller.removePerformanceCallback(e)}enableAccountStorageEvents(){this.controller.enableAccountStorageEvents()}disableAccountStorageEvents(){this.controller.disableAccountStorageEvents()}getAccount(e){return this.controller.getAccount(e)}getAccountByHomeId(e){return this.controller.getAccountByHomeId(e)}getAccountByLocalId(e){return this.controller.getAccountByLocalId(e)}getAccountByUsername(e){return this.controller.getAccountByUsername(e)}getAllAccounts(e){return this.controller.getAllAccounts(e)}handleRedirectPromise(e){return this.controller.handleRedirectPromise(e)}loginPopup(e){return this.controller.loginPopup(e)}loginRedirect(e){return this.controller.loginRedirect(e)}logout(e){return this.controller.logout(e)}logoutRedirect(e){return this.controller.logoutRedirect(e)}logoutPopup(e){return this.controller.logoutPopup(e)}ssoSilent(e){return this.controller.ssoSilent(e)}getTokenCache(){return this.controller.getTokenCache()}getLogger(){return this.controller.getLogger()}setLogger(e){this.controller.setLogger(e)}setActiveAccount(e){this.controller.setActiveAccount(e)}getActiveAccount(){return this.controller.getActiveAccount()}initializeWrapperLibrary(e,t){return this.controller.initializeWrapperLibrary(e,t)}setNavigationClient(e){this.controller.setNavigationClient(e)}getConfiguration(){return this.controller.getConfiguration()}hydrateCache(e,t){return h(this,null,function*(){return this.controller.hydrateCache(e,t)})}clearCache(e){return this.controller.clearCache(e)}};var Oa=class{static getInteractionStatusFromEvent(e,t){switch(e.eventType){case H.LOGIN_START:return De.Login;case H.SSO_SILENT_START:return De.SsoSilent;case H.ACQUIRE_TOKEN_START:if(e.interactionType===D.Redirect||e.interactionType===D.Popup)return De.AcquireToken;break;case H.HANDLE_REDIRECT_START:return De.HandleRedirect;case H.LOGOUT_START:return De.Logout;case H.SSO_SILENT_SUCCESS:case H.SSO_SILENT_FAILURE:if(t&&t!==De.SsoSilent)break;return De.None;case H.LOGOUT_END:if(t&&t!==De.Logout)break;return De.None;case H.HANDLE_REDIRECT_END:if(t&&t!==De.HandleRedirect)break;return De.None;case H.LOGIN_SUCCESS:case H.LOGIN_FAILURE:case H.ACQUIRE_TOKEN_SUCCESS:case H.ACQUIRE_TOKEN_FAILURE:case H.RESTORE_FROM_BFCACHE:if(e.interactionType===D.Redirect||e.interactionType===D.Popup){if(t&&t!==De.Login&&t!==De.AcquireToken)break;return De.None}break}return null}};var Jm="@azure/msal-angular",Ld="3.0.23",_c=new mr("MSAL_INSTANCE"),Pa=new mr("MSAL_GUARD_CONFIG"),Hd=new mr("MSAL_INTERCEPTOR_CONFIG"),Nv=new mr("MSAL_BROADCAST_CONFIG"),bn=(()=>{class r{constructor(t,n){this.instance=t,this.location=n;let i=this.location.path(!0).split("#").pop();i&&(this.redirectHash=`#${i}`),this.instance.initializeWrapperLibrary(bd.Angular,Ld)}initialize(){return yt(this.instance.initialize())}acquireTokenPopup(t){return yt(this.instance.acquireTokenPopup(t))}acquireTokenRedirect(t){return yt(this.instance.acquireTokenRedirect(t))}acquireTokenSilent(t){return yt(this.instance.acquireTokenSilent(t))}handleRedirectObservable(t){return yt(this.instance.initialize().then(()=>this.instance.handleRedirectPromise(t||this.redirectHash)))}loginPopup(t){return yt(this.instance.loginPopup(t))}loginRedirect(t){return yt(this.instance.loginRedirect(t))}logout(t){return yt(this.instance.logout(t))}logoutRedirect(t){return yt(this.instance.logoutRedirect(t))}logoutPopup(t){return yt(this.instance.logoutPopup(t))}ssoSilent(t){return yt(this.instance.ssoSilent(t))}getLogger(){return this.logger||(this.logger=this.instance.getLogger().clone(Jm,Ld)),this.logger}setLogger(t){this.logger=t.clone(Jm,Ld),this.instance.setLogger(t)}}return r.\u0275fac=function(t){return new(t||r)(Oe(_c),Oe(za))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),mo=(()=>{class r{constructor(t,n,i){this.msalInstance=t,this.authService=n,this.msalBroadcastConfig=i,this.msalBroadcastConfig&&this.msalBroadcastConfig.eventsToReplay>0?(this.authService.getLogger().verbose(`BroadcastService - eventsToReplay set on BroadcastConfig, replaying the last ${this.msalBroadcastConfig.eventsToReplay} events`),this._msalSubject=new Ha(this.msalBroadcastConfig.eventsToReplay)):this._msalSubject=new Me,this.msalSubject$=this._msalSubject.asObservable(),this._inProgress=new La(De.Startup),this.inProgress$=this._inProgress.asObservable(),this.msalInstance.addEventCallback(o=>{this._msalSubject.next(o);let a=Oa.getInteractionStatusFromEvent(o,this._inProgress.value);a!==null&&(this.authService.getLogger().verbose(`BroadcastService - ${o.eventType} results in setting inProgress from ${this._inProgress.value} to ${a}`),this._inProgress.next(a))})}}return r.\u0275fac=function(t){return new(t||r)(Oe(_c),Oe(bn),Oe(Nv,8))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),po=(()=>{class r{constructor(t,n,i,o,a){this.msalGuardConfig=t,this.msalBroadcastService=n,this.authService=i,this.location=o,this.router=a,this.msalBroadcastService.inProgress$.subscribe()}parseUrl(t){return this.router.parseUrl(t)}getDestinationUrl(t){this.authService.getLogger().verbose("Guard - getting destination url");let n=document.getElementsByTagName("base"),i=this.location.normalize(n.length?n[0].href:window.location.origin),o=this.location.prepareExternalUrl(t);return o.startsWith("#")?(this.authService.getLogger().verbose("Guard - destination by hash routing"),`${i}/${o}`):`${i}${t}`}loginInteractively(t){let n=typeof this.msalGuardConfig.authRequest=="function"?this.msalGuardConfig.authRequest(this.authService,t):_({},this.msalGuardConfig.authRequest);if(this.msalGuardConfig.interactionType===D.Popup)return this.authService.getLogger().verbose("Guard - logging in by popup"),this.authService.loginPopup(n).pipe(Se(o=>(this.authService.getLogger().verbose("Guard - login by popup successful, can activate, setting active account"),this.authService.instance.setActiveAccount(o.account),!0)));this.authService.getLogger().verbose("Guard - logging in by redirect");let i=this.getDestinationUrl(t.url);return this.authService.loginRedirect(_({redirectStartPage:i},n)).pipe(Se(()=>!1))}activateHelper(t){if(this.msalGuardConfig.interactionType!==D.Popup&&this.msalGuardConfig.interactionType!==D.Redirect)throw new ii("invalid_interaction_type","Invalid interaction type provided to MSAL Guard. InteractionType.Popup or InteractionType.Redirect must be provided in the MsalGuardConfiguration");if(this.authService.getLogger().verbose("MSAL Guard activated"),typeof window<"u"){if(Q.hashContainsKnownProperties(window.location.hash)&&rc.isInIframe()&&!this.authService.instance.getConfiguration().system.allowRedirectInIframe)return this.authService.getLogger().warning("Guard - redirectUri set to page with MSAL Guard. It is recommended to not set redirectUri to a page that requires authentication."),Tt(!1)}else return this.authService.getLogger().info("Guard - window is undefined, MSAL does not support server-side token acquisition"),Tt(!0);this.msalGuardConfig.loginFailedRoute&&(this.loginFailedRoute=this.parseUrl(this.msalGuardConfig.loginFailedRoute));let n=this.location.path(!0);return this.authService.initialize().pipe(Hc(()=>this.authService.handleRedirectObservable()),Hc(()=>{if(!this.authService.instance.getAllAccounts().length)return t?(this.authService.getLogger().verbose("Guard - no accounts retrieved, log in required to activate"),this.loginInteractively(t)):(this.authService.getLogger().verbose("Guard - no accounts retrieved, no state, cannot load"),Tt(!1));if(this.authService.getLogger().verbose("Guard - at least 1 account exists, can activate or load"),t){let i=this.includesCode(t.url),o=!!t.root&&!!t.root.fragment&&this.includesCode(`#${t.root.fragment}`),a=this.location.prepareExternalUrl(t.url).indexOf("#")===0;if(i&&(o||a))return this.authService.getLogger().info("Guard - Hash contains known code response, stopping navigation."),n.indexOf("#")>-1?Tt(this.parseUrl(this.location.path())):Tt(this.parseUrl(""))}return Tt(!0)}),wo(i=>(this.authService.getLogger().error("Guard - error while logging in, unable to activate"),this.authService.getLogger().errorPii(`Guard - error: ${i.message}`),this.loginFailedRoute&&t?(this.authService.getLogger().verbose("Guard - loginFailedRoute set, redirecting"),Tt(this.loginFailedRoute)):Tt(!1))))}includesCode(t){return t.lastIndexOf("/code")>-1&&t.lastIndexOf("/code")===t.length-5||t.indexOf("#code=")>-1||t.indexOf("&code=")>-1}canActivate(t,n){return this.authService.getLogger().verbose("Guard - canActivate"),this.activateHelper(n)}canActivateChild(t,n){return this.authService.getLogger().verbose("Guard - canActivateChild"),this.activateHelper(n)}canMatch(){return this.authService.getLogger().verbose("Guard - canLoad"),this.activateHelper()}}return r.\u0275fac=function(t){return new(t||r)(Oe(Pa),Oe(mo),Oe(bn),Oe(za),Oe(Mu))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})(),Zm=(()=>{class r{constructor(t,n,i,o,a){this.msalInterceptorConfig=t,this.authService=n,this.location=i,this.msalBroadcastService=o,this._document=a}intercept(t,n){if(this.msalInterceptorConfig.interactionType!==D.Popup&&this.msalInterceptorConfig.interactionType!==D.Redirect)throw new ii("invalid_interaction_type","Invalid interaction type provided to MSAL Interceptor. InteractionType.Popup, InteractionType.Redirect must be provided in the msalInterceptorConfiguration");this.authService.getLogger().verbose("MSAL Interceptor activated");let i=this.getScopesForEndpoint(t.url,t.method);if(!i||i.length===0)return this.authService.getLogger().verbose("Interceptor - no scopes for endpoint"),n.handle(t);let o;this.authService.instance.getActiveAccount()?(this.authService.getLogger().verbose("Interceptor - active account selected"),o=this.authService.instance.getActiveAccount()):(this.authService.getLogger().verbose("Interceptor - no active account, fallback to first account"),o=this.authService.instance.getAllAccounts()[0]);let a=typeof this.msalInterceptorConfig.authRequest=="function"?this.msalInterceptorConfig.authRequest(this.authService,t,{account:o}):z(_({},this.msalInterceptorConfig.authRequest),{account:o});return this.authService.getLogger().info(`Interceptor - ${i.length} scopes found for endpoint`),this.authService.getLogger().infoPii(`Interceptor - [${i}] scopes found for ${t.url}`),this.acquireToken(a,i,o).pipe(Mn(s=>{this.authService.getLogger().verbose("Interceptor - setting authorization headers");let c=t.headers.set("Authorization",`Bearer ${s.accessToken}`),l=t.clone({headers:c});return n.handle(l)}))}acquireToken(t,n,i){return this.authService.acquireTokenSilent(z(_({},t),{scopes:n,account:i})).pipe(wo(()=>(this.authService.getLogger().error("Interceptor - acquireTokenSilent rejected with error. Invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe(Nt(1),Mn(o=>o===De.None?this.acquireTokenInteractively(t,n):this.msalBroadcastService.inProgress$.pipe($e(a=>a===De.None),Nt(1),Mn(()=>this.acquireToken(t,n,i))))))),Mn(o=>o.accessToken?Tt(o):(this.authService.getLogger().error("Interceptor - acquireTokenSilent resolved with null access token. Known issue with B2C tenants, invoking interaction to resolve."),this.msalBroadcastService.inProgress$.pipe($e(a=>a===De.None),Nt(1),Mn(()=>this.acquireTokenInteractively(t,n))))))}acquireTokenInteractively(t,n){if(this.msalInterceptorConfig.interactionType===D.Popup)return this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by popup"),this.authService.acquireTokenPopup(z(_({},t),{scopes:n}));this.authService.getLogger().verbose("Interceptor - error acquiring token silently, acquiring by redirect");let i=window.location.href;return this.authService.acquireTokenRedirect(z(_({},t),{scopes:n,redirectStartPage:i})),Wd}getScopesForEndpoint(t,n){this.authService.getLogger().verbose("Interceptor - getting scopes for endpoint");let i=this.location.normalize(t),o=Array.from(this.msalInterceptorConfig.protectedResourceMap.keys()),a=this.matchResourcesToEndpoint(o,i);return a.length>0?this.matchScopesToEndpoint(this.msalInterceptorConfig.protectedResourceMap,a,n):null}matchResourcesToEndpoint(t,n){let i=[];return t.forEach(o=>{let a=this.location.normalize(o),s=this.getAbsoluteUrl(a),c=new URL(s),l=this.getAbsoluteUrl(n),u=new URL(l);this.checkUrlComponents(c,u)&&i.push(o)}),i}checkUrlComponents(t,n){let i=["protocol","host","pathname","search","hash"];for(let o of i)if(t[o]){let a=decodeURIComponent(t[o]);if(!_e.matchPattern(a,n[o]))return!1}return!0}getAbsoluteUrl(t){let n=this._document.createElement("a");return n.href=t,n.href}matchScopesToEndpoint(t,n,i){let o=[];return n.forEach(a=>{let s=[],c=t.get(a);if(c===null){o.push(null);return}c.forEach(l=>{if(typeof l=="string")s.push(l);else{let u=i.toLowerCase();l.httpMethod.toLowerCase()===u&&(l.scopes===null?o.push(null):l.scopes.forEach(v=>{s.push(v)}))}}),s.length>0&&o.push(s)}),o.length>0?(o.length>1&&this.authService.getLogger().warning("Interceptor - More than 1 matching scopes for endpoint found."),o[0]):null}}return r.\u0275fac=function(t){return new(t||r)(Oe(Hd),Oe(bn),Oe(za),Oe(mo),Oe(gr))},r.\u0275prov=tt({token:r,factory:r.\u0275fac}),r})();var xv=()=>["/","event-list"],Lv=()=>["/","calendar"];function Hv(r,e){if(r&1){let t=ae();f(0,"div",1)(1,"div",2)(2,"div",3)(3,"ul",4)(4,"li")(5,"a",5),K(6,"img",6),x(7," Events List "),C()(),f(8,"li")(9,"a",5),K(10,"img",7),x(11," Calendar "),C()()(),f(12,"div",8)(13,"button",9),O("click",function(){b(t);let i=S();return R(i.logout())}),x(14," Logout "),C()()()()()}r&2&&(y(5),w("routerLink",Ue(2,xv)),y(4),w("routerLink",Ue(3,Lv)))}var tp=(()=>{class r{authService;isAuthorized=!1;ngOnInit(){this.isAuthorized=this.authService.instance.getAllAccounts().length>0}constructor(t){this.authService=t}logout(){this.authService.instance.logoutRedirect()}login(){this.authService.instance.loginRedirect()}static \u0275fac=function(n){return new(n||r)(N(bn))};static \u0275cmp=J({type:r,selectors:[["app-header"]],standalone:!0,features:[we],decls:2,vars:1,consts:[["class","px-3 py-2 text-bg-dark border-bottom",4,"ngIf"],[1,"px-3","py-2","text-bg-dark","border-bottom"],[1,"container"],[1,"d-flex","flex-wrap","align-items-center","justify-content-between"],[1,"nav","col-12","col-lg-auto","my-2","justify-content-center","my-md-0","text-small"],[1,"nav-link","text-white",3,"routerLink"],["src","events-list-ico.svg","width","24","height","24","alt","",1,"bi","d-block","mx-auto","mb-1"],["src","calendar-ico.svg","width","24","height","24","alt","",1,"bi","d-block","mx-auto","mb-1"],[1,"text-end"],["type","button",1,"btn","btn-outline-light","me-2",3,"click"]],template:function(n,i){n&1&&(f(0,"header"),U(1,Hv,15,4,"div",0),C()),n&2&&(y(),w("ngIf",i.isAuthorized))},dependencies:[Ou,St,Ut],styles:["a[_ngcontent-%COMP%]{z-index:10}svg[_ngcontent-%COMP%]{z-index:9}"]})}return r})();var np=(()=>{class r{msalGuardConfig;authService;msalBroadcastService;constructor(t,n,i){this.msalGuardConfig=t,this.authService=n,this.msalBroadcastService=i,this.authService.instance.initialize().then(()=>{console.log("MsalService is initialized.")}).catch(o=>{console.error("MsalService failed to initialize:",o)})}clearInteractionStatus(){console.log("MsalService clearInteractionStatus.");let t=this.authService.instance;t.getLogger().verbose("Clearing interaction status."),t.clearCache(),localStorage.removeItem("msal.interaction.status"),sessionStorage.removeItem("msal.interaction.status")}login(){this.clearInteractionStatus(),this.msalGuardConfig.authRequest?this.authService.loginRedirect(_({},this.msalGuardConfig.authRequest)):this.authService.loginRedirect()}static \u0275fac=function(n){return new(n||r)(N(Pa),N(bn),N(mo))};static \u0275cmp=J({type:r,selectors:[["app-login"]],standalone:!0,features:[we],decls:15,vars:0,consts:[[1,"container","mt-4"],[1,"display-4","text-center"],[1,"lead","text-center"],[1,"login-container"],[1,"login-box"],[1,"login-header"],["src","https://cdn-icons-png.flaticon.com/512/732/732223.png","alt","Outlook Logo",1,"outlook-logo"],[1,"login-body"],[1,"login-button",3,"click"],["src","https://upload.wikimedia.org/wikipedia/commons/4/44/Microsoft_logo.svg","alt","Microsoft Logo",1,"microsoft-logo"]],template:function(n,i){n&1&&(f(0,"div",0)(1,"h1",1),x(2,"Private IdeoDigital Login"),C(),f(3,"p",2),x(4," Welcome to the ideo vacation management system. Please log in to access your private room and manage your vacation plans. "),C()(),f(5,"div",3)(6,"div",4)(7,"div",5),K(8,"img",6),f(9,"h2"),x(10,"Sign in with your Outlook Account"),C()(),f(11,"div",7)(12,"button",8),O("click",function(){return i.login()}),K(13,"img",9),x(14," Sign in with Microsoft "),C()()()())},styles:[".login-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;height:100vh;background-color:#f3f3f3}.login-box[_ngcontent-%COMP%]{background-color:#fff;padding:2rem;border-radius:8px;box-shadow:0 2px 10px #0000001a;text-align:center;max-width:350px}.login-header[_ngcontent-%COMP%]{margin-bottom:1.5rem}.outlook-logo[_ngcontent-%COMP%]{height:50px;margin-bottom:1rem}.login-body[_ngcontent-%COMP%]{margin-top:1.5rem}.login-button[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:.75rem;background-color:#0078d4;color:#fff;border:none;border-radius:4px;cursor:pointer;font-size:1rem;width:100%}.microsoft-logo[_ngcontent-%COMP%]{height:24px;margin-right:10px}.login-button[_ngcontent-%COMP%]:hover{background-color:#005a9e}"]})}return r})();var rp=(()=>{class r{title="ideo-private-room";static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-root"]],standalone:!0,features:[we],decls:3,vars:0,template:function(n,i){n&1&&(K(0,"app-header"),f(1,"main"),K(2,"router-outlet"),C())},dependencies:[Du,tp]})}return r})();function F(r){let e=Object.prototype.toString.call(r);return r instanceof Date||typeof r=="object"&&e==="[object Date]"?new r.constructor(+r):typeof r=="number"||e==="[object Number]"||typeof r=="string"||e==="[object String]"?new Date(r):new Date(NaN)}function Ve(r,e){return r instanceof Date?new r.constructor(e):new Date(e)}function go(r,e){let t=F(r);return isNaN(e)?Ve(r,NaN):(e&&t.setDate(t.getDate()+e),t)}function Ec(r,e){let t=F(r);if(isNaN(e))return Ve(r,NaN);if(!e)return t;let n=t.getDate(),i=Ve(r,t.getTime());i.setMonth(t.getMonth()+e+1,0);let o=i.getDate();return n>=o?i:(t.setFullYear(i.getFullYear(),i.getMonth(),n),t)}function fo(r,e){let t=+F(r);return Ve(r,t+e)}var Fv=Math.pow(10,8)*24*60*60*1e3,IM=-Fv,ip=6048e5,op=864e5,Sc=6e4,ap=36e5;var Uv=3600;var sp=Uv*24,kM=sp*7,Bv=sp*365.2425,Vv=Bv/12,bM=Vv*3;function cp(r,e){return fo(r,e*ap)}var Kv={};function Ac(){return Kv}function Ic(r,e){let t=Ac(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=F(r),o=i.getDay(),a=(o<n?7:0)+o-n;return i.setDate(i.getDate()-a),i.setHours(0,0,0,0),i}function ai(r){return Ic(r,{weekStartsOn:1})}function lp(r){let e=F(r),t=e.getFullYear(),n=Ve(r,0);n.setFullYear(t+1,0,4),n.setHours(0,0,0,0);let i=ai(n),o=Ve(r,0);o.setFullYear(t,0,4),o.setHours(0,0,0,0);let a=ai(o);return e.getTime()>=i.getTime()?t+1:e.getTime()>=a.getTime()?t:t-1}function hr(r){let e=F(r);return e.setHours(0,0,0,0),e}function Fd(r){let e=F(r),t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));return t.setUTCFullYear(e.getFullYear()),+r-+t}function dp(r,e){let t=hr(r),n=hr(e),i=+t-Fd(t),o=+n-Fd(n);return Math.round((i-o)/op)}function up(r){let e=lp(r),t=Ve(r,0);return t.setFullYear(e,0,4),t.setHours(0,0,0,0),ai(t)}function hp(r,e){return fo(r,e*Sc)}function mp(r,e){return fo(r,e*1e3)}function kc(r,e){let t=e*7;return go(r,t)}function pp(r){let e;return r.forEach(function(t){let n=F(t);(e===void 0||e<n||isNaN(Number(n)))&&(e=n)}),e||new Date(NaN)}function gp(r,e){let t=hr(r),n=hr(e);return+t==+n}function Cp(r,e){let t=F(r),n=F(e),i=fp(t,n),o=Math.abs(dp(t,n));t.setDate(t.getDate()-i*o);let a=+(fp(t,n)===-i),s=i*(o-a);return s===0?0:s}function fp(r,e){let t=r.getFullYear()-e.getFullYear()||r.getMonth()-e.getMonth()||r.getDate()-e.getDate()||r.getHours()-e.getHours()||r.getMinutes()-e.getMinutes()||r.getSeconds()-e.getSeconds()||r.getMilliseconds()-e.getMilliseconds();return t<0?-1:t>0?1:t}function bc(r){return e=>{let n=(r?Math[r]:Math.trunc)(e);return n===0?0:n}}function Rc(r,e){return+F(r)-+F(e)}function vp(r,e,t){let n=Rc(r,e)/Sc;return bc(t?.roundingMethod)(n)}function yp(r){let e=F(r);return e.setHours(23,59,59,999),e}function Tp(r){let e=F(r),t=e.getMonth();return e.setFullYear(e.getFullYear(),t+1,0),e.setHours(23,59,59,999),e}function wp(r,e,t){let n=Rc(r,e)/1e3;return bc(t?.roundingMethod)(n)}function _p(r){let e=F(r);return e.setSeconds(0,0),e}function Ep(r){let e=F(r);return e.setDate(1),e.setHours(0,0,0,0),e}function Sp(r,e){let t=Ac(),n=e?.weekStartsOn??e?.locale?.options?.weekStartsOn??t.weekStartsOn??t.locale?.options?.weekStartsOn??0,i=F(r),o=i.getDay(),a=(o<n?-7:0)+6-(o-n);return i.setDate(i.getDate()+a),i.setHours(23,59,59,999),i}function Ap(r){let e=F(r),t=+ai(e)-+up(e);return Math.round(t/ip)+1}function Ip(r){return F(r).getDate()}function kp(r){return F(r).getDay()}function bp(r){let e=F(r),t=e.getFullYear(),n=e.getMonth(),i=Ve(r,0);return i.setFullYear(t,n+1,0),i.setHours(0,0,0,0),i.getDate()}function Rp(r){return F(r).getHours()}function Dp(r){return F(r).getMinutes()}function Mp(r){return F(r).getMonth()}function Op(r){return F(r).getFullYear()}function Ud(r,e){let t=F(r),n=F(e);return+t<+n}function Pp(r,e){let t=F(r),n=F(e);return t.getFullYear()===n.getFullYear()&&t.getMonth()===n.getMonth()}function Bd(r){let e=F(r);return e.setMilliseconds(0),e}function Np(r,e){let t=Bd(r),n=Bd(e);return+t==+n}function xp(r,e){return go(r,-e)}function Lp(r,e){let t=F(r),n=t.getFullYear(),i=t.getDate(),o=Ve(r,0);o.setFullYear(n,e,15),o.setHours(0,0,0,0);let a=bp(o);return t.setMonth(e,Math.min(i,a)),t}function Hp(r,e){let t=F(r);return t.setDate(e),t}function Fp(r,e){let t=F(r);return t.setHours(e),t}function Up(r,e){let t=F(r);return t.setMinutes(e),t}function Bp(r,e){let t=F(r);return isNaN(+t)?Ve(r,NaN):(t.setFullYear(e),t)}function Vp(r,e){return Ec(r,-e)}function Kp(r,e){return kc(r,-e)}function Vd(r){return typeof r.setHours=="function"}function Kd(){return r=>{let e=r.value;if(!Vd(e))return{notADate:!0};let t=new Date;return e.setHours(0,0,0,0),t.setHours(0,0,0,0),e===null||Ud(e,t)?{dateBeforeToday:!0}:null}}function zp(r,e){return t=>{let n=t.get(r),i=t.get(e),o=n?.value,a=i?.value;return Vd(o)?Vd(a)?(o.setHours(0,0,0,0),a.setHours(0,0,0,0),Ud(a,o)?{endsBeforeStart:!0}:null):{endDateNotADate:!0}:{startDateNotADate:!0}}}function qp(r){return{id:r.id,name:r.name,icon:r.icon}}var Dc=(()=>{class r{usersUrl=`${Ln.apiUrl}/users`;http=de(Tu);users=rt([]);allUsers=this.users.asReadonly();loadUsers(){return this.fetchUsers("Something gone wrong trying to load users...").pipe(Ua(t=>this.users.set(t)))}fetchUsers(t){return this.http.get(this.usersUrl).pipe(Se(n=>n.map(qp)),wo(()=>Gd(()=>new Error(t))))}static \u0275fac=function(n){return new(n||r)};static \u0275prov=tt({token:r,factory:r.\u0275fac,providedIn:"root"})}return r})();var zv=r=>({"dropdown-multiselect--active":r});function qv(r,e){if(r&1&&(f(0,"span"),x(1),C()),r&2){let t=S();y(),mt(t._placeholder)}}function Wv(r,e){if(r&1){let t=ae();f(0,"span",15)(1,"span",16)(2,"span"),x(3),C(),f(4,"a",17),O("click",function(i){let o=b(t).$implicit,a=S();return R(a.onItemClick(i,o))}),x(5,"x"),C()()()}if(r&2){let t=e.$implicit,n=e.index,i=S();y(),w("hidden",n>i._settings.itemsShowLimit-1),y(2),Pn("",t.text,"\xA0")}}function Gv(r,e){if(r&1&&(f(0,"span",18),x(1),C()),r&2){let t=S();y(),Pn("+",t.itemShowRemaining(),"")}}function $v(r,e){if(r&1){let t=ae();f(0,"li",19),O("click",function(){b(t);let i=S();return R(i.toggleSelectAll())}),K(1,"input",20),f(2,"div"),x(3),C()()}if(r&2){let t=S();y(),w("checked",t.isAllItemsSelected())("disabled",t.disabled||t.isLimitSelectionReached()),y(2),mt(t.isAllItemsSelected()?t._settings.unSelectAllText:t._settings.selectAllText)}}function Yv(r,e){if(r&1){let t=ae();f(0,"li",21)(1,"input",22),xn("ngModelChange",function(i){b(t);let o=S();return ln(o.filter.text,i)||(o.filter.text=i),R(i)}),O("ngModelChange",function(i){b(t);let o=S();return R(o.onFilterTextChange(i))}),C()()}if(r&2){let t=S();y(),w("readOnly",t.disabled)("placeholder",t._settings.searchPlaceholderText),Nn("ngModel",t.filter.text)}}function jv(r,e){if(r&1){let t=ae();f(0,"li",23),O("click",function(i){let o=b(t).$implicit,a=S();return R(a.onItemClick(i,o))}),K(1,"input",24),f(2,"div"),x(3),C()()}if(r&2){let t=e.$implicit,n=S();y(),w("checked",n.isSelected(t))("disabled",n.disabled||n.isLimitSelectionReached()&&!n.isSelected(t)||t.isDisabled),ht("aria-label",t.text),y(2),mt(t.text)}}function Qv(r,e){if(r&1&&(f(0,"li",25)(1,"h5"),x(2),C()()),r&2){let t=S();y(2),mt(t._settings.noFilteredDataAvailablePlaceholderText)}}function Xv(r,e){if(r&1&&(f(0,"li",26)(1,"h5"),x(2),C()()),r&2){let t=S();y(2),mt(t._settings.noDataAvailablePlaceholderText)}}var Rn=class{id;text;isDisabled;constructor(e){(typeof e=="string"||typeof e=="number")&&(this.id=this.text=e,this.isDisabled=!1),typeof e=="object"&&(this.id=e.id,this.text=e.text,this.isDisabled=e.isDisabled)}},zd=(()=>{class r{transform(t,n){return!t||!n?t:t.filter(i=>this.applyFilter(i,n))}applyFilter(t,n){return typeof t.text=="string"&&typeof n.text=="string"?!(n.text&&t.text&&t.text.toLowerCase().indexOf(n.text.toLowerCase())===-1):!(n.text&&t.text&&t.text.toString().toLowerCase().indexOf(n.text.toString().toLowerCase())===-1)}static \u0275fac=function(n){return new(n||r)};static \u0275pipe=ci({name:"multiSelectFilter",type:r,pure:!1})}return r})(),Jv=(()=>{class r{_elementRef;constructor(t){this._elementRef=t}clickOutside=new q;onClick(t,n){if(!n)return;this._elementRef.nativeElement.contains(n)||this.clickOutside.emit(t)}static \u0275fac=function(n){return new(n||r)(N(nt))};static \u0275dir=Ye({type:r,selectors:[["","clickOutside",""]],hostBindings:function(n,i){n&1&&O("click",function(a){return i.onClick(a,a.target)},!1,ou)},outputs:{clickOutside:"clickOutside"}})}return r})(),Zv={provide:Wa,useExisting:eu(()=>Na),multi:!0},Wp=()=>{},Na=(()=>{class r{listFilterPipe;cdr;_settings;_data=[];selectedItems=[];isDropdownOpen=!0;_placeholder="Select";_sourceDataType=null;_sourceDataFields=[];filter=new Rn(this.data);defaultSettings={singleSelection:!1,idField:"id",textField:"text",disabledField:"isDisabled",enableCheckAll:!0,selectAllText:"Select All",unSelectAllText:"UnSelect All",allowSearchFilter:!1,limitSelection:-1,clearSearchFilter:!0,maxHeight:197,itemsShowLimit:999999999999,searchPlaceholderText:"Search",noDataAvailablePlaceholderText:"No data available",noFilteredDataAvailablePlaceholderText:"No filtered data available",closeDropDownOnSelection:!1,showSelectedItemsAtTop:!1,defaultOpen:!1,allowRemoteDataSearch:!1};set placeholder(t){t?this._placeholder=t:this._placeholder="Select"}disabled=!1;set settings(t){t?this._settings=Object.assign(this.defaultSettings,t):this._settings=Object.assign(this.defaultSettings)}set data(t){if(!t)this._data=[];else{let n=t[0];this._sourceDataType=typeof n,this._sourceDataFields=this.getFields(n),this._data=t.map(i=>typeof i=="string"||typeof i=="number"?new Rn(i):new Rn({id:i[this._settings.idField],text:i[this._settings.textField],isDisabled:i[this._settings.disabledField]}))}}onFilterChange=new q;onDropDownClose=new q;onSelect=new q;onDeSelect=new q;onSelectAll=new q;onDeSelectAll=new q;onTouchedCallback=Wp;onChangeCallback=Wp;onFilterTextChange(t){this.onFilterChange.emit(t)}constructor(t,n){this.listFilterPipe=t,this.cdr=n}onItemClick(t,n){if(this.disabled||n.isDisabled)return!1;let i=this.isSelected(n),o=this._settings.limitSelection===-1||this._settings.limitSelection>0&&this.selectedItems.length<this._settings.limitSelection;i?this.removeSelected(n):o&&this.addSelected(n),this._settings.singleSelection&&this._settings.closeDropDownOnSelection&&this.closeDropdown()}writeValue(t){if(t!=null&&t.length>0)if(this._settings.singleSelection)try{if(t.length>=1){let n=t[0];this.selectedItems=[typeof n=="string"||typeof n=="number"?new Rn(n):new Rn({id:n[this._settings.idField],text:n[this._settings.textField],isDisabled:n[this._settings.disabledField]})]}}catch{}else{let n=t.map(i=>typeof i=="string"||typeof i=="number"?new Rn(i):new Rn({id:i[this._settings.idField],text:i[this._settings.textField],isDisabled:i[this._settings.disabledField]}));this._settings.limitSelection>0?this.selectedItems=n.splice(0,this._settings.limitSelection):this.selectedItems=n}else this.selectedItems=[];this.onChangeCallback(t),this.cdr.markForCheck()}registerOnChange(t){this.onChangeCallback=t}registerOnTouched(t){this.onTouchedCallback=t}onTouched(){this.onTouchedCallback()}trackByFn(t,n){return n.id}isSelected(t){let n=!1;return this.selectedItems.forEach(i=>{t.id===i.id&&(n=!0)}),n}isLimitSelectionReached(){return this._settings.limitSelection===this.selectedItems.length}isAllItemsSelected(){let t=this.listFilterPipe.transform(this._data,this.filter),n=t.filter(i=>i.isDisabled).length;return(!this.data||this.data.length===0)&&this._settings.allowRemoteDataSearch?!1:t.length===this.selectedItems.length+n}showButton(){return this._settings.singleSelection?!1:!(this._settings.limitSelection>0)}itemShowRemaining(){return this.selectedItems.length-this._settings.itemsShowLimit}addSelected(t){this._settings.singleSelection?(this.selectedItems=[],this.selectedItems.push(t)):this.selectedItems.push(t),this.onChangeCallback(this.emittedValue(this.selectedItems)),this.onSelect.emit(this.emittedValue(t))}removeSelected(t){this.selectedItems.forEach(n=>{t.id===n.id&&this.selectedItems.splice(this.selectedItems.indexOf(n),1)}),this.onChangeCallback(this.emittedValue(this.selectedItems)),this.onDeSelect.emit(this.emittedValue(t))}emittedValue(t){let n=[];if(Array.isArray(t))t.map(i=>{n.push(this.objectify(i))});else if(t)return this.objectify(t);return n}objectify(t){if(this._sourceDataType==="object"){let n={};return n[this._settings.idField]=t.id,n[this._settings.textField]=t.text,this._sourceDataFields.includes(this._settings.disabledField)&&(n[this._settings.disabledField]=t.isDisabled),n}return this._sourceDataType==="number"?Number(t.id):t.text}toggleDropdown(t){t.preventDefault(),!(this.disabled&&this._settings.singleSelection)&&(this._settings.defaultOpen=!this._settings.defaultOpen,this._settings.defaultOpen||this.onDropDownClose.emit())}closeDropdown(){this._settings.defaultOpen=!1,this._settings.clearSearchFilter&&(this.filter.text=""),this.onDropDownClose.emit()}toggleSelectAll(){if(this.disabled)return!1;this.isAllItemsSelected()?(this.selectedItems=[],this.onDeSelectAll.emit(this.emittedValue(this.selectedItems))):(this.selectedItems=this.listFilterPipe.transform(this._data,this.filter).filter(t=>!t.isDisabled).slice(),this.onSelectAll.emit(this.emittedValue(this.selectedItems))),this.onChangeCallback(this.emittedValue(this.selectedItems))}getFields(t){let n=[];if(typeof t!="object")return n;for(let i in t)n.push(i);return n}static \u0275fac=function(n){return new(n||r)(N(zd),N(So))};static \u0275cmp=J({type:r,selectors:[["ng-multiselect-dropdown"]],hostBindings:function(n,i){n&1&&O("blur",function(){return i.onTouched()})},inputs:{placeholder:"placeholder",disabled:"disabled",settings:"settings",data:"data"},outputs:{onFilterChange:"onFilterChange",onDropDownClose:"onDropDownClose",onSelect:"onSelect",onDeSelect:"onDeSelect",onSelectAll:"onSelectAll",onDeSelectAll:"onDeSelectAll"},features:[li([Zv])],decls:18,vars:23,consts:[["tabindex","0",1,"multiselect-dropdown",3,"blur","clickOutside"],["tabindex","-1",1,"dropdown-btn",3,"click"],[4,"ngIf"],["class","selected-item-container",4,"ngFor","ngForOf","ngForTrackBy"],[2,"float","right !important","padding-right","4px",3,"ngClass"],["style","padding-right: 15px;",4,"ngIf"],[1,"dropdown-multiselect__caret"],[1,"dropdown-list",3,"hidden"],[1,"item1"],["class","multiselect-item-checkbox","style","border-bottom: 1px solid #ccc;padding:10px",3,"click",4,"ngIf"],["class","filter-textbox",4,"ngIf"],[1,"item2"],["class","multiselect-item-checkbox",3,"click",4,"ngFor","ngForOf"],["class","no-filtered-data",4,"ngIf"],["class","no-data",4,"ngIf"],[1,"selected-item-container"],[1,"selected-item",3,"hidden"],[2,"padding-left","2px","color","white",3,"click"],[2,"padding-right","15px"],[1,"multiselect-item-checkbox",2,"border-bottom","1px solid #ccc","padding","10px",3,"click"],["type","checkbox","aria-label","multiselect-select-all",3,"checked","disabled"],[1,"filter-textbox"],["type","text","aria-label","multiselect-search",3,"ngModelChange","readOnly","placeholder","ngModel"],[1,"multiselect-item-checkbox",3,"click"],["type","checkbox",3,"checked","disabled"],[1,"no-filtered-data"],[1,"no-data"]],template:function(n,i){n&1&&(f(0,"div",0),O("blur",function(){return i.onTouched()})("clickOutside",function(){return i.closeDropdown()}),f(1,"div")(2,"span",1),O("click",function(a){return i.toggleDropdown(a)}),U(3,qv,2,1,"span",2)(4,Wv,6,2,"span",3),f(5,"span",4),U(6,Gv,2,1,"span",5),K(7,"span",6),C()()(),f(8,"div",7)(9,"ul",8),U(10,$v,4,3,"li",9)(11,Yv,2,3,"li",10),C(),f(12,"ul",11),U(13,jv,4,4,"li",12),he(14,"multiSelectFilter"),U(15,Qv,3,1,"li",13),he(16,"multiSelectFilter"),U(17,Xv,3,1,"li",14),C()()()),n&2&&(y(),Ae("disabled",i.disabled),y(2),w("ngIf",i.selectedItems.length==0),y(),w("ngForOf",i.selectedItems)("ngForTrackBy",i.trackByFn),y(),w("ngClass",dn(21,zv,i._settings.defaultOpen)),y(),w("ngIf",i.itemShowRemaining()>0),y(2),w("hidden",!i._settings.defaultOpen),y(2),w("ngIf",(i._data.length>0||i._settings.allowRemoteDataSearch)&&!i._settings.singleSelection&&i._settings.enableCheckAll&&i._settings.limitSelection===-1),y(),w("ngIf",(i._data.length>0||i._settings.allowRemoteDataSearch)&&i._settings.allowSearchFilter),y(),cn("max-height",i._settings.maxHeight+"px"),y(),w("ngForOf",it(14,15,i._data,i.filter)),y(2),w("ngIf",i._data.length!=0&&it(16,18,i._data,i.filter).length==0&&!i._settings.allowRemoteDataSearch),y(2),w("ngIf",i._data.length==0&&!i._settings.allowRemoteDataSearch))},dependencies:[_t,Yt,Ut,Ga,ui,Hu,Jv,zd],styles:['.multiselect-dropdown[_ngcontent-%COMP%]{position:relative;width:100%;font-size:inherit;font-family:inherit}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]{display:inline-block;border:1px solid #adadad;width:100%;padding:6px 12px;margin-bottom:0;font-weight:400;line-height:1.52857143;text-align:left;vertical-align:middle;cursor:pointer;background-image:none;border-radius:4px}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]{display:flex;float:left}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]{border:1px solid #337ab7;margin-right:4px;background:#337ab7;padding:0 5px;color:#fff;border-radius:2px;float:left;max-width:100px}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{overflow:hidden;text-overflow:ellipsis}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item-container[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{text-decoration:none}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .selected-item[_ngcontent-%COMP%]:hover{box-shadow:1px 1px #959595}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]{line-height:16px;display:block;position:absolute;box-sizing:border-box;width:40px;height:38px;right:1px;top:0;padding:4px 8px;margin:0;text-decoration:none;text-align:center;cursor:pointer;transition:transform .2s ease}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]:before{position:relative;right:0;top:65%;color:#999;margin-top:4px;border-style:solid;border-width:8px 8px 0 8px;border-color:#999999 transparent;content:""}.multiselect-dropdown[_ngcontent-%COMP%]   .dropdown-btn[_ngcontent-%COMP%]   .dropdown-multiselect--active[_ngcontent-%COMP%]   .dropdown-multiselect__caret[_ngcontent-%COMP%]{transform:rotate(180deg)}.multiselect-dropdown[_ngcontent-%COMP%]   .disabled[_ngcontent-%COMP%] > span[_ngcontent-%COMP%]{background-color:#eceeef}.dropdown-list[_ngcontent-%COMP%]{position:absolute;padding-top:6px;width:100%;z-index:9999;border:1px solid #ccc;border-radius:3px;background:#fff;margin-top:10px;box-shadow:0 1px 5px #959595}.dropdown-list[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{padding:0;list-style:none;overflow:auto;margin:0}.dropdown-list[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{padding:6px 10px;cursor:pointer;text-align:left}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]{border-bottom:1px solid #ccc;position:relative;padding:10px}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{border:0px;width:100%;padding:0 0 0 26px}.dropdown-list[_ngcontent-%COMP%]   .filter-textbox[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{outline:none}.multiselect-item-checkbox[_ngcontent-%COMP%]:hover{background-color:#e4e3e3}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]{border:0;clip:rect(0 0 0 0);height:1px;margin:-1px;overflow:hidden;padding:0;position:absolute;width:1px}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:focus + div[_ngcontent-%COMP%]:before, .multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:hover + div[_ngcontent-%COMP%]:before{border-color:#337ab7;background-color:#f2f2f2}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:active + div[_ngcontent-%COMP%]:before{transition-duration:0s}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]{position:relative;padding-left:2em;vertical-align:middle;-webkit-user-select:none;user-select:none;cursor:pointer;margin:0;color:#000}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:before{box-sizing:content-box;content:"";color:#337ab7;position:absolute;top:50%;left:0;width:14px;height:14px;margin-top:-9px;border:2px solid #337ab7;text-align:center;transition:all .4s ease}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:after{box-sizing:content-box;content:"";background-color:#337ab7;position:absolute;top:50%;left:4px;width:10px;height:10px;margin-top:-5px;transform:scale(0);transform-origin:50%;transition:transform .2s ease-out}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled + div[_ngcontent-%COMP%]:before{border-color:#ccc}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:focus + div[_ngcontent-%COMP%]:before   .multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:hover + div[_ngcontent-%COMP%]:before{background-color:inherit}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:disabled:checked + div[_ngcontent-%COMP%]:before{background-color:#ccc}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%] + div[_ngcontent-%COMP%]:after{background-color:transparent;top:50%;left:4px;width:8px;height:3px;margin-top:-4px;border-style:solid;border-color:#fff;border-width:0 0 3px 3px;border-image:none;transform:rotate(-45deg) scale(0)}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:after{content:"";transform:rotate(-45deg) scale(1);transition:transform .2s ease-out}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:before{animation:_ngcontent-%COMP%_borderscale .2s ease-in;background:#337ab7}.multiselect-item-checkbox[_ngcontent-%COMP%]   input[type=checkbox][_ngcontent-%COMP%]:checked + div[_ngcontent-%COMP%]:after{transform:rotate(-45deg) scale(1)}@keyframes _ngcontent-%COMP%_borderscale{50%{box-shadow:0 0 0 2px #337ab7}}'],changeDetection:0})}return r})(),Co=(()=>{class r{static forRoot(){return{ngModule:r}}static \u0275fac=function(n){return new(n||r)};static \u0275mod=ut({type:r});static \u0275inj=dt({providers:[zd],imports:[St,Uu]})}return r})();function ey(r,e){r&1&&(f(0,"div",13),x(1,"Select an employee."),C())}function ty(r,e){if(r&1&&(f(0,"div",3)(1,"label",19),x(2,"Employee"),C(),K(3,"ng-multiselect-dropdown",20),U(4,ey,2,0,"div",13),C()),r&2){let t=S();y(3),w("settings",t.employeeDropdownSettings)("data",t.employees()),y(),Ht(t.invalidEmployee?4:-1)}}function ny(r,e){r&1&&(f(0,"div",13),x(1,"Start date is invalid."),C())}function ry(r,e){r&1&&(f(0,"div",13),x(1," End date should be greater or equal to start date. "),C())}function iy(r,e){r&1&&(f(0,"div",13),x(1,"End date is invalid."),C())}var jp=(()=>{class r{modalService=de(Za);userService=de(Dc);eventListService=de(Hn);eventFiltersService=de(Fn);destroyRef=de(On);isFetching=rt(!1);error=rt("");employees=Ft(()=>this.userService.allUsers());form=new Io({employee:new un(void 0,{validators:[$c.required]}),comment:new un(""),dates:new Io({startDate:new un(new Date,{validators:[Kd()]}),endDate:new un(new Date,{validators:[Kd()]})},{validators:[$c.required,zp("startDate","endDate")]})});employeeDropdownSettings={singleSelection:!0,idField:"id",textField:"name",selectAllText:"Select All",unSelectAllText:"UnSelect All",itemsShowLimit:3,allowRemoteDataSearch:!0,allowSearchFilter:!0,defaultOpen:!1};get invalidEmployee(){let t=this.form.controls.employee;return t.touched&&t.invalid}get invalidStartDate(){let t=this.form.controls.dates.get("startDate");return t?.touched&&t?.errors||this.form.controls.dates.errors?.startDateNotADate}get invalidEndDate(){let t=this.form.controls.dates.get("endDate");return t?.touched&&t?.errors||this.form.controls.dates.errors?.endDateNotADate}get endDateBeforeStartDate(){let t=this.form.controls.dates;return(t.get("endDate")?.touched||t.get("startDate")?.touched)&&t?.errors&&t.errors.endsBeforeStart==!0}get currentDate(){return new Date}onSubmit(){if(this.form.markAllAsTouched(),this.form.invalid)return;let t=this.form.controls.employee.value,n=this.form.controls.comment.value,i=this.form.controls.dates.controls.startDate.value,o=this.form.controls.dates.controls.endDate.value;if(t?.[0]&&i&&o){let a=this.eventListService.createEvent(t[0].id,i,o,n).subscribe({complete:()=>this.eventFiltersService.loadFilteredEvents().subscribe(),error:s=>{this.error.set(s.message)}});this.destroyRef.onDestroy(()=>{a.unsubscribe()}),this.modalService.close()}}onCancel(){this.modalService.close()}ngOnInit(){this.isFetching.set(!0);let t=this.userService.loadUsers().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-add-event-form"]],standalone:!0,features:[li([{provide:Vu,useClass:zu}]),we],decls:31,vars:4,consts:[["startDate","ngbDatepicker"],["endDate","ngbDatepicker"],[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","comment",1,"form-label"],["type","text","id","comment","formControlName","comment",1,"form-control"],["formGroupName","dates",1,"row","mb-3"],[1,"col-6"],["for","startDate",1,"form-label"],[1,"input-group"],["ngbDatepicker","","id","startDate","formControlName","startDate",1,"form-control"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],["src","date-select-ico.svg","width","24px","height","24px"],[1,"invalid"],["for","endDate",1,"form-label"],["ngbDatepicker","","id","endDate","formControlName","endDate",1,"form-control"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-danger","btn-action"],["type","button",1,"btn","btn-secondary","ms-2","btn-action",3,"click"],["for","employee",1,"form-label"],["formControlName","employee","id","employee","name","employee","placeholder","Select employees",3,"settings","data"]],template:function(n,i){if(n&1){let o=ae();f(0,"form",2),O("ngSubmit",function(){return b(o),R(i.onSubmit())}),U(1,ty,5,3,"div",3),f(2,"div",3)(3,"label",4),x(4,"Comment (Optional)"),C(),K(5,"input",5),C(),f(6,"div",6)(7,"div",7)(8,"label",8),x(9,"Start"),C(),f(10,"div",9),K(11,"input",10,0),f(13,"button",11),O("click",function(){b(o);let s=fe(12);return R(s.toggle())}),K(14,"img",12),C()(),U(15,ny,2,0,"div",13)(16,ry,2,0,"div",13),C(),f(17,"div",7)(18,"label",14),x(19,"End"),C(),f(20,"div",9),K(21,"input",15,1),f(23,"button",11),O("click",function(){b(o);let s=fe(22);return R(s.toggle())}),K(24,"img",12),C()(),U(25,iy,2,0,"div",13),C()(),f(26,"div",16)(27,"button",17),x(28,"Submit"),C(),f(29,"button",18),O("click",function(){return b(o),R(i.onCancel())}),x(30," Cancel "),C()()()}n&2&&(w("formGroup",i.form),y(),Ht(i.employees()?1:-1),y(14),Ht(i.invalidStartDate?15:i.endDateBeforeStartDate?16:-1),y(10),Ht(i.invalidEndDate?25:-1))},dependencies:[Xa,Ya,Ga,ui,$a,ja,Qa,Fu,hi,Ja,Co,Na],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}.invalid[_ngcontent-%COMP%]{width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}"]})}return r})();var Qp=(()=>{class r{activeModal=de(Za);onClose(){this.activeModal.close()}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-add-event"]],standalone:!0,features:[we],decls:7,vars:0,consts:[[1,"modal-content","w-100"],[1,"modal-header"],["id","exampleModalLabel1",1,"modal-title"],["type","button","data-mdb-button-init","","data-mdb-ripple-init","","data-mdb-dismiss","modal","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body","p-4"]],template:function(n,i){n&1&&(f(0,"div",0)(1,"div",1)(2,"h5",2),x(3,"Add Event"),C(),f(4,"button",3),O("click",function(){return i.onClose()}),C()(),f(5,"div",4),K(6,"app-add-event-form"),C()())},dependencies:[jp],changeDetection:0})}return r})();function oy(r,e){if(r&1){let t=ae();f(0,"span",11),O("mouseenter",function(){let i=b(t).$implicit,o=S();return R(o.hoveredDate=i)})("mouseleave",function(){b(t);let i=S();return R(i.hoveredDate=null)}),x(1),C()}if(r&2){let t=e.$implicit,n=e.focused,i=S();Ae("focused",n)("range",i.isRange(t))("faded",i.isHovered(t)||i.isInside(t)),y(),Pn(" ",t.day," ")}}var Xp=(()=>{class r{calendar;formatter;hoveredDate=null;fromDate;toDate;constructor(t,n){this.calendar=t,this.formatter=n,this.fromDate=t.getToday(),this.toDate=t.getNext(t.getToday(),"d",10)}onDateSelection(t){this.markAsTouched(),this.disabled||(!this.fromDate&&!this.toDate?this.fromDate=t:this.fromDate&&!this.toDate&&t&&t.after(this.fromDate)?this.toDate=t:(this.toDate=null,this.fromDate=t),this.onChange({fromDate:this.fromDate,toDate:this.toDate}))}isHovered(t){return this.fromDate&&!this.toDate&&this.hoveredDate&&t.after(this.fromDate)&&t.before(this.hoveredDate)}isInside(t){return this.toDate&&t.after(this.fromDate)&&t.before(this.toDate)}isRange(t){return t.equals(this.fromDate)||this.toDate&&t.equals(this.toDate)||this.isInside(t)||this.isHovered(t)}validateInput(t,n){let i=this.formatter.parse(n);return i&&this.calendar.isValid(Yc.from(i))?Yc.from(i):t}touched=!1;disabled=!1;onChange=t=>{};onTouched=()=>{};writeValue(t){this.fromDate=t.fromDate,this.toDate=t.toDate}registerOnChange(t){this.onChange=t}registerOnTouched(t){this.onTouched=t}markAsTouched(){this.touched||(this.onTouched(),this.touched=!0)}setDisabledState(t){this.disabled=t}static \u0275fac=function(n){return new(n||r)(N(Bu),N(Ku))};static \u0275cmp=J({type:r,selectors:[["app-range-datepicker"]],standalone:!0,features:[li([{provide:Wa,multi:!0,useExisting:r}]),we],decls:13,vars:6,consts:[["datepicker","ngbDatepicker"],["t",""],["dpFromDate",""],["dpToDate",""],[1,"col-12"],[1,"dp-hidden","position-absolute"],[1,"input-group"],["name","datepicker","ngbDatepicker","","outsideDays","hidden","tabindex","-1",1,"form-control",3,"dateSelect","autoClose","displayMonths","dayTemplate","startDate"],["placeholder","yyyy-mm-dd","name","dpFromDate",1,"form-control",3,"input","value"],["placeholder","yyyy-mm-dd","name","dpToDate",1,"form-control",3,"input","value"],["type","button",1,"btn","btn-outline-secondary","bi","bi-calendar3",3,"click"],[1,"custom-day",3,"mouseenter","mouseleave"]],template:function(n,i){if(n&1){let o=ae();f(0,"div",4)(1,"div",5)(2,"div",6)(3,"input",7,0),O("dateSelect",function(s){return b(o),R(i.onDateSelection(s))}),C(),U(5,oy,2,7,"ng-template",null,1,ot),C()(),f(7,"div",6)(8,"input",8,2),O("input",function(){b(o);let s=fe(9);return R(i.fromDate=i.validateInput(i.fromDate,s.value))}),C(),f(10,"input",9,3),O("input",function(){b(o);let s=fe(11);return R(i.toDate=i.validateInput(i.toDate,s.value))}),C(),f(12,"button",10),O("click",function(){b(o);let s=fe(4);return R(s.toggle())}),C()()()}if(n&2){let o=fe(6);y(3),w("autoClose","outside")("displayMonths",2)("dayTemplate",o)("startDate",i.fromDate),y(5),w("value",i.formatter.format(i.fromDate)),y(2),w("value",i.formatter.format(i.toDate))}},dependencies:[hi,Ja],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}"]})}return r})();function ay(r,e){if(r&1){let t=ae();f(0,"div",1)(1,"label",2),x(2,"Employee"),C(),K(3,"ng-multiselect-dropdown",3),C(),f(4,"div",1)(5,"label",2),x(6,"Status"),C(),K(7,"ng-multiselect-dropdown",4),C(),f(8,"div",1)(9,"label",5),x(10,"Event dates"),C(),K(11,"app-range-datepicker",6),C(),f(12,"div",7)(13,"button",8),x(14,"Apply"),C(),f(15,"button",9),O("click",function(){b(t);let i=S();return R(i.onClose())}),x(16," Cancel "),C()()}if(r&2){let t=S();y(3),w("settings",t.employeeDropdownSettings)("data",t.employees()),y(4),w("settings",t.statusDropdownSettings)("data",t.statuses)}}var Jp=(()=>{class r{userService=de(Dc);offCanvasService=de(es);eventFiltersService=de(Fn);destroyRef=de(On);isFetching=rt(!1);error=rt("");employeeDropdownSettings={singleSelection:!1,selectAllText:"Select All",unSelectAllText:"UnSelect All",idField:"id",textField:"name",itemsShowLimit:3,allowRemoteDataSearch:!0,allowSearchFilter:!0,defaultOpen:!1};statusDropdownSettings={singleSelection:!1,selectAllText:"Select All",unSelectAllText:"Unselect All",itemsShowLimit:3,allowRemoteDataSearch:!1,allowSearchFilter:!1,defaultOpen:!1};employees=Ft(()=>this.userService.allUsers());statuses=Object.keys(Lu).filter(t=>isNaN(Number(t)));activeFilters=this.eventFiltersService.readonlyEventFilters;form=new Io({employee:new un(this.activeFilters()?.employee??[]),status:new un(this.activeFilters()?.status??[]),dates:new un(this.activeFilters()?.dates??{fromDate:null,toDate:null})});onSubmit(){if(!this.form.valid)return;let t=this.form.controls.employee.value,n=this.form.controls.status.value,i=this.form.controls.dates.value;this.eventFiltersService.setEventFilters({employee:t,status:n,dates:i}),this.offCanvasService.close()}onClose(){this.offCanvasService.close()}ngOnInit(){this.isFetching.set(!0);let t=this.userService.loadUsers().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-event-filters-form"]],standalone:!0,features:[we],decls:2,vars:2,consts:[[3,"ngSubmit","formGroup"],[1,"mb-3"],["for","employee",1,"form-label"],["formControlName","employee","id","employee","name","employee","placeholder","Select employees",3,"settings","data"],["formControlName","status","id","status","name","status","placeholder","Select status",3,"settings","data"],["for","dates",1,"form-label"],["id","dates","name","dates","formControlName","dates"],[1,"d-flex","justify-content-end"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-outline-secondary","ms-2",3,"click"]],template:function(n,i){n&1&&(f(0,"form",0),O("ngSubmit",function(){return i.onSubmit()}),U(1,ay,17,4),C()),n&2&&(w("formGroup",i.form),y(),Ht(i.employees()?1:-1))},dependencies:[Xa,Ya,ui,$a,ja,Qa,Co,Na,hi,Xp],styles:[".dp-hidden[_ngcontent-%COMP%]{width:0;margin:0;border:none;padding:0}.custom-day[_ngcontent-%COMP%]{text-align:center;padding:.185rem .25rem;display:inline-block;height:2rem;width:2rem}.custom-day.focused[_ngcontent-%COMP%]{background-color:#e6e6e6}.custom-day.range[_ngcontent-%COMP%], .custom-day[_ngcontent-%COMP%]:hover{background-color:#0275d8;color:#fff}.custom-day.faded[_ngcontent-%COMP%]{background-color:#0275d880}.invalid[_ngcontent-%COMP%]{width:100%;margin-top:.25rem;font-size:.875em;color:var(--bs-form-invalid-color)}"]})}return r})();var Zp=(()=>{class r{offCanvasService=de(es);onClose(){this.offCanvasService.close()}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-event-filters"]],standalone:!0,features:[we],decls:7,vars:0,consts:[[1,"offcanvas-header"],[1,"offcanvas-title"],["type","button","aria-label","Close",1,"btn-close","text-reset",3,"click"],[1,"offcanvas-body"],[1,"row","mb-2"]],template:function(n,i){n&1&&(f(0,"div",0)(1,"h5",1),x(2,"Filter events"),C(),f(3,"button",2),O("click",function(){return i.onClose()}),C()(),f(4,"div",3)(5,"div",4),K(6,"app-event-filters-form"),C()())},dependencies:[Jp],styles:["[_nghost-%COMP%]{height:100%;display:flex;flex-direction:column}"]})}return r})();function sy(r,e){if(r&1){let t=ae();f(0,"button",15),O("click",function(){b(t);let i=S();return R(i.onClearFilters())}),x(1," Clear "),C()}}var eg=(()=>{class r{modalService=de(Qu);offcanvasService=de(Xu);eventFiltersService=de(Fn);eventListService=de(Hn);activeFilters=this.eventFiltersService.readonlyEventFilters;viewMode=Ft(()=>di[this.eventListService.readonlyViewMode()]);onAddEvent(){this.modalService.open(Qp)}onOpenFiltersMenu(){this.offcanvasService.open(Zp,{backdrop:"static"})}onClearFilters(){this.eventFiltersService.clearFilters()}switchCardsMode(){this.eventListService.changeViewMode(di.Cards)}switchTableMode(){this.eventListService.changeViewMode(di.Table)}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-event-list-header"]],standalone:!0,features:[we],decls:17,vars:5,consts:[[1,"px-3","py-2","border-bottom","mb-3"],[1,"container-flex","d-flex","flex-wrap"],[1,"col-12","col-lg-auto","mb-lg-0","me-lg-auto"],["type","button",1,"btn","btn-outline-primary","btn-menu","me-2",3,"click"],[1,"bi","bi-filter"],["type","button",1,"btn","btn-outline-secondary","me-2"],[1,"text-end"],["type","button",1,"btn","btn-outline-primary","me-2",3,"click"],["ngbDropdown","",1,"d-inline-block","me-2"],["type","button","id","mode-dropdown","ngbDropdownToggle","",1,"btn","btn-outline-primary","dropdown-toggle"],[1,"bi","bi-three-dots-vertical"],["ngbDropdownMenu",""],["ngbDropdownItem","",1,"btn","py-2","btn-outline-primary",3,"click"],[1,"bi","bi-table"],[1,"bi","bi-list-ul"],["type","button",1,"btn","btn-outline-secondary","me-2",3,"click"]],template:function(n,i){n&1&&(f(0,"div",0)(1,"div",1)(2,"div",2)(3,"button",3),O("click",function(){return i.onOpenFiltersMenu()}),K(4,"i",4),C(),U(5,sy,2,0,"button",5),C(),f(6,"div",6)(7,"button",7),O("click",function(){return i.onAddEvent()}),x(8," Add Event "),C(),f(9,"div",8)(10,"button",9),K(11,"i",10),C(),f(12,"div",11)(13,"button",12),O("click",function(){return i.switchTableMode()}),K(14,"i",13),C(),f(15,"button",12),O("click",function(){return i.switchCardsMode()}),K(16,"i",14),C()()()()()()),n&2&&(y(5),Ht(i.activeFilters()?5:-1),y(8),Ae("active",i.viewMode()==="Table"),y(2),Ae("active",i.viewMode()==="Cards"))},dependencies:[ju,Yu,$u,Gu,qu,Wu],styles:[".dropdown-menu[_ngcontent-%COMP%]{min-width:60px;text-align:center}.dropdown-item[_ngcontent-%COMP%]{padding:.5rem;font-size:1.5rem}.dropdown-item[_ngcontent-%COMP%]:not(:focus):not(.active){color:#0d6efd!important}"]})}return r})();var tg=(r,e)=>e.id,cy=()=>[import("./chunk-LMLLML52.mjs").then(r=>r.EventCardComponent),import("./chunk-BLESAXDS.mjs").then(r=>r.EventListTableRowComponent)];function ly(r,e){if(r&1&&K(0,"app-event-list-table-row",7),r&2){let t=e.$implicit;w("card",t)}}function dy(r,e){if(r&1&&(f(0,"table",0)(1,"thead",3)(2,"tr",4)(3,"th",5),x(4,"Name"),C(),f(5,"th",6),x(6,"Dates"),C(),f(7,"th",5),x(8,"Approvals"),C(),f(9,"th",5),x(10,"Status"),C(),f(11,"th",5),x(12,"Actions"),C()()(),f(13,"tbody"),Fc(14,ly,1,1,"app-event-list-table-row",7,tg),C()()),r&2){let t=S(2);y(14),Uc(t.cards())}}function uy(r,e){if(r&1&&K(0,"app-event-card",8),r&2){let t=e.$implicit;w("card",t)}}function hy(r,e){if(r&1&&(f(0,"div",1),Fc(1,uy,1,1,"app-event-card",8,tg),C()),r&2){let t=S(2);y(),Uc(t.cards())}}function my(r,e){r&1&&(f(0,"div",2)(1,"p"),x(2,"There are no added vacation requests yet."),C()())}function py(r,e){if(r&1&&U(0,dy,16,0,"table",0)(1,hy,3,0,"div",1)(2,my,3,0,"div",2),r&2){let t=S();Ht(t.viewMode()==="Table"&&t.cards().length>0?0:t.viewMode()==="Cards"&&t.cards().length>0?1:2)}}function gy(r,e){r&1&&(f(0,"div",9),K(1,"span",10),C())}var ng=(()=>{class r{eventFiltersService=de(Fn);eventListService=de(Hn);destroyRef=de(On);cards=Ft(()=>this.eventFiltersService.loadedEvents());viewMode=Ft(()=>di[this.eventListService.readonlyViewMode()]);isFetching=rt(!1);error=rt("");ngOnInit(){this.isFetching.set(!0);let t=this.eventFiltersService.loadFilteredEvents().subscribe({complete:()=>{this.isFetching.set(!1)},error:n=>{this.error.set(n.message)}});this.destroyRef.onDestroy(()=>{t.unsubscribe()})}static \u0275fac=function(n){return new(n||r)};static \u0275cmp=J({type:r,selectors:[["app-event-list"]],standalone:!0,features:[we],decls:5,vars:0,consts:[[1,"table","container"],[1,"container","mt-5","d-flex","justify-content-start","flex-wrap"],[1,"row","text-center"],[1,"row"],[1,"row","ps-0","pe-4"],["scope","col",1,"col-2","ps-0","pe-0"],["scope","col",1,"col-4","ps-0","pe-0"],[1,"row",3,"card"],[3,"card"],[1,"d-flex","justify-content-center","align-items-center"],[1,"loader","align-self-center"]],template:function(n,i){n&1&&(K(0,"app-event-list-header"),U(1,py,3,1)(2,gy,2,0),su(3,1,cy,null,2),cu())},dependencies:[eg],styles:[".loader[_ngcontent-%COMP%]{width:48px;height:48px;border:5px solid #fff;border-bottom-color:#ff3d00;border-radius:50%;display:inline-block;box-sizing:border-box;animation:_ngcontent-%COMP%_rotation 1s linear infinite}@keyframes _ngcontent-%COMP%_rotation{0%{transform:rotate(0)}to{transform:rotate(360deg)}}"],changeDetection:0})}return r})();var rg=[{path:"event-list",component:ng,runGuardsAndResolvers:"always",canActivate:[po]}];var ig=[...rg,{path:"",redirectTo:"calendar",pathMatch:"full"},{path:"calendar",component:Bh,title:"Calendar",canActivate:[po]},{path:"login",component:np,title:"Login"}];function fy(r){return new Date(r).getTimezoneOffset()}function og(){return{addDays:go,addHours:cp,addMinutes:hp,addSeconds:mp,differenceInDays:Cp,differenceInMinutes:vp,differenceInSeconds:wp,endOfDay:yp,endOfMonth:Tp,endOfWeek:Sp,getDay:kp,getMonth:Mp,isSameDay:gp,isSameMonth:Pp,isSameSecond:Np,max:pp,setHours:Fp,setMinutes:Up,startOfDay:hr,startOfMinute:_p,startOfMonth:Ep,startOfWeek:Ic,getHours:Rp,getMinutes:Dp,getTimezoneOffset:fy}}function ag(){return Lc(Lc({},og()),{addWeeks:kc,addMonths:Ec,subDays:xp,subWeeks:Kp,subMonths:Vp,getISOWeek:Ap,setDate:Hp,setMonth:Lp,setYear:Bp,getDate:Ip,getYear:Op})}function Cy(r,e){console.log(e)}function vy(){return new Ma({auth:{clientId:Ln.msalConfig.auth.clientId,authority:Ln.msalConfig.auth.authority,redirectUri:"/calendar",postLogoutRedirectUri:"/login",navigateToLoginRequestUrl:!0},cache:{cacheLocation:ue.LocalStorage},system:{allowNativeBroker:!1,loggerOptions:{loggerCallback:Cy,logLevel:le.Info,piiLoggingEnabled:!1}}})}function yy(){let r=new Map;return r.set(Ln.apiConfig.uri,Ln.apiConfig.scopes),{interactionType:D.Redirect,protectedResourceMap:r}}function Ty(){return{interactionType:D.Redirect,authRequest:{scopes:[...Ln.apiConfig.scopes]},loginFailedRoute:"/login"}}var sg={providers:[_u(Eu(),Su()),{provide:wu,useClass:Zm,multi:!0},{provide:_c,useFactory:vy},{provide:Pa,useFactory:Ty},{provide:Hd,useFactory:yy},bn,po,mo,mu({eventCoalescing:!0}),Pu(ig,xu(),Nu({paramsInheritanceStrategy:"always"})),Iu(),tu(Ci.forRoot({provide:At,useFactory:ag}),Co.forRoot()),bu()]};var wy={providers:[Ru()]},cg=pu(sg,wy);var _y=()=>Au(rp,cg),kx=_y;export{kx as a};
